(this.webpackJsonporganice=this.webpackJsonporganice||[]).push([[0],{169:function(e,t,n){"use strict";function a(e,t,n,r){this.message=e,this.expected=t,this.found=n,this.location=r,this.name="SyntaxError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(a,Error),a.buildMessage=function(e,t){var n={literal:function(e){return'"'+r(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?s(e.parts[t][0])+"-"+s(e.parts[t][1]):s(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function a(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}return"Expected "+function(e){var t,a,r,s=new Array(e.length);for(t=0;t<e.length;t++)s[t]=(r=e[t],n[r.type](r));if(s.sort(),s.length>0){for(t=1,a=1;t<s.length;t++)s[t-1]!==s[t]&&(s[a]=s[t],a++);s.length=a}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(e)+" but "+function(e){return e?'"'+r(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:a,parse:function(e,t){t=void 0!==t?t:{};var n,r={},s={Expression:Te},i=Te,o=fe("filter expression"),l=fe("filter term"),c=ge("-",!1),d=fe("text filter term"),h=fe("tag filter term"),u=ge(":",!1),p=fe("property filter term"),g=fe("search outside of header"),m=ge("date:",!1),f=ge("clock:",!1),b=ge("sched:",!1),y=ge("scheduled:",!1),E=ge("dead:",!1),w=ge("deadline:",!1),T=fe("moments and timeranges"),v=ge("..",!1),k=fe("moment"),_=ge("today",!1),S=ge("now",!1),I=/^[\-.\/]/,O=me(["-",".","/"],!1,!1),D=/^[hdwmy]/,C=me(["h","d","w","m","y"],!1,!1),A=fe("year"),N=/^[0-9]/,P=me([["0","9"]],!1,!1),R=fe("month"),L=fe("day"),x=fe("offset"),M=fe("alternatives"),F=ge("|",!1),H=function(e,t){return t.reduce((e,t)=>(e.push(t[1]),e),[e])},j=fe("tag alternatives"),B=fe("string"),W=/^[^: \t|'"]/,U=me([":"," ","\t","|","'",'"'],!0,!1),V=function(){return ue()},G=ge("'",!1),K=/^[^']/,z=me(["'"],!0,!1),Y=function(e){return e.join("")},J=ge('"',!1),q=/^[^"]/,X=me(['"'],!0,!1),$=fe("property name"),Z=/^[^: \t]/,Q=me([":"," ","\t"],!0,!1),ee=fe("tag name"),te=/^[a-zA-Z0-9_@]/,ne=me([["a","z"],["A","Z"],["0","9"],"_","@"],!1,!1),ae=fe("whitespace"),re=/^[ \t]/,se=me([" ","\t"],!1,!1),ie=0,oe=0,le=[{line:1,column:1}],ce=0,de=[],he=0;if("startRule"in t){if(!(t.startRule in s))throw new Error("Can't start parsing from rule \""+t.startRule+'".');i=s[t.startRule]}function ue(){return e.substring(oe,ie)}function pe(){return ye(oe,ie)}function ge(e,t){return{type:"literal",text:e,ignoreCase:t}}function me(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function fe(e){return{type:"other",description:e}}function be(t){var n,a=le[t];if(a)return a;for(n=t-1;!le[n];)n--;for(a={line:(a=le[n]).line,column:a.column};n<t;)10===e.charCodeAt(n)?(a.line++,a.column=1):a.column++,n++;return le[t]=a,a}function ye(e,t){var n=be(e),a=be(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:a.line,column:a.column}}}function Ee(e){ie<ce||(ie>ce&&(ce=ie,de=[]),de.push(e))}function we(e,t,n){return new a(a.buildMessage(e,t),e,t,n)}function Te(){var e,t,n,a,s,i,l,c;for(he++,e=ie,t=[],n=Ne();n!==r;)t.push(n),n=Ne();if(t!==r)if((n=ve())!==r){if(a=[],s=ie,i=[],(l=Ne())!==r)for(;l!==r;)i.push(l),l=Ne();else i=r;for(i!==r&&(l=ve())!==r?s=i=[i,l]:(ie=s,s=r);s!==r;){if(a.push(s),s=ie,i=[],(l=Ne())!==r)for(;l!==r;)i.push(l),l=Ne();else i=r;i!==r&&(l=ve())!==r?s=i=[i,l]:(ie=s,s=r)}if(a!==r){for(s=[],i=Ne();i!==r;)s.push(i),i=Ne();s!==r?(oe=e,c=n,e=t=a.reduce((e,t)=>(e.push(t[1]),e),[c])):(ie=e,e=r)}else ie=e,e=r}else ie=e,e=r;else ie=e,e=r;if(e===r){for(e=ie,t=[],n=Ne();n!==r;)t.push(n),n=Ne();t!==r&&(oe=e,t=[]),e=t}return he--,e===r&&(t=r,0===he&&Ee(o)),e}function ve(){var t,n,a;return t=ie,(n=function(){var t,n,a;he++,t=ie,45===e.charCodeAt(ie)?(n="-",ie++):(n=r,0===he&&Ee(c));n!==r&&(a=ke())!==r?(oe=t,n=function(e){if("field"===e.type&&"desc"!==e.field.type)throw{message:"can't negate timerange searches yet"};return e.exclude=!0,e}(a),t=n):(ie=t,t=r);t===r&&(t=ie,(n=ke())!==r&&(oe=t,(s=n).exclude=!1,n=s),t=n);var s;he--,t===r&&(n=r,0===he&&Ee(l));return t}())!==r&&(oe=t,(a=n).offset=pe().start.offset,a.endOffset=pe().end.offset,n=a),t=n}function ke(){var t;return(t=function(){var t,n,a;he++,t=ie,"date:"===e.substr(ie,5)?(n="date:",ie+=5):(n=r,0===he&&Ee(m));n!==r&&(a=_e())!==r?(oe=t,t=n={type:"field",field:{type:"date",timerange:a}}):(ie=t,t=r);t===r&&(t=ie,"clock:"===e.substr(ie,6)?(n="clock:",ie+=6):(n=r,0===he&&Ee(f)),n!==r&&(a=_e())!==r?(oe=t,n=function(e){return{type:"field",field:{type:"clock",timerange:e}}}(a),t=n):(ie=t,t=r),t===r&&(t=ie,"sched:"===e.substr(ie,6)?(n="sched:",ie+=6):(n=r,0===he&&Ee(b)),n===r&&("scheduled:"===e.substr(ie,10)?(n="scheduled:",ie+=10):(n=r,0===he&&Ee(y))),n!==r&&(a=_e())!==r?(oe=t,n=function(e){return{type:"field",field:{type:"scheduled",timerange:e}}}(a),t=n):(ie=t,t=r),t===r&&(t=ie,"dead:"===e.substr(ie,5)?(n="dead:",ie+=5):(n=r,0===he&&Ee(E)),n===r&&("deadline:"===e.substr(ie,9)?(n="deadline:",ie+=9):(n=r,0===he&&Ee(w))),n!==r&&(a=_e())!==r?(oe=t,n=function(e){return{type:"field",field:{type:"deadline",timerange:e}}}(a),t=n):(ie=t,t=r))));he--,t===r&&(n=r,0===he&&Ee(g));return t}())===r&&(t=function(){var e,t;he++,e=ie,(t=De())!==r&&(oe=e,t=function(e){let t="ignore-case";return ue().match(/[A-Z]/)&&(t="case-sensitive"),{type:t,words:e}}(t));he--,(e=t)===r&&(t=r,0===he&&Ee(d));return e}())===r&&(t=function(){var t,n,a,s,i;he++,t=ie,58===e.charCodeAt(ie)?(n=":",ie++):(n=r,0===he&&Ee(u));n!==r&&(a=function(){var t,n,a;he++,t=ie,n=[],Z.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(Q));if(a!==r)for(;a!==r;)n.push(a),Z.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(Q));else n=r;n!==r&&(oe=t,n=V());he--,(t=n)===r&&(n=r,0===he&&Ee($));return t}())!==r?(58===e.charCodeAt(ie)?(s=":",ie++):(s=r,0===he&&Ee(u)),s!==r?((i=De())===r&&(i=null),i!==r?(oe=t,t=n={type:"property",property:a,words:null===(o=i)?[""]:o}):(ie=t,t=r)):(ie=t,t=r)):(ie=t,t=r);var o;he--,t===r&&(n=r,0===he&&Ee(p));return t}())===r&&(t=function(){var t,n,a;he++,t=ie,58===e.charCodeAt(ie)?(n=":",ie++):(n=r,0===he&&Ee(u));n!==r&&(a=function(){var t,n,a,s,i,o;if(he++,t=ie,(n=Ae())!==r){for(a=[],s=ie,124===e.charCodeAt(ie)?(i="|",ie++):(i=r,0===he&&Ee(F)),i!==r&&(o=Ae())!==r?s=i=[i,o]:(ie=s,s=r);s!==r;)a.push(s),s=ie,124===e.charCodeAt(ie)?(i="|",ie++):(i=r,0===he&&Ee(F)),i!==r&&(o=Ae())!==r?s=i=[i,o]:(ie=s,s=r);a!==r?(oe=t,n=H(n,a),t=n):(ie=t,t=r)}else ie=t,t=r;he--,t===r&&(n=r,0===he&&Ee(j));return t}())!==r?(oe=t,t=n={type:"tag",words:a}):(ie=t,t=r);he--,t===r&&(n=r,0===he&&Ee(h));return t}()),t}function _e(){var t,n,a,s;return he++,t=ie,(n=Se())!==r?(".."===e.substr(ie,2)?(a="..",ie+=2):(a=r,0===he&&Ee(v)),a!==r&&(s=Se())!==r?(oe=t,t=n={type:"range",from:n,to:s}):(ie=t,t=r)):(ie=t,t=r),t===r&&(t=ie,(n=Se())!==r?(".."===e.substr(ie,2)?(a="..",ie+=2):(a=r,0===he&&Ee(v)),a!==r?(oe=t,t=n=function(e){return{type:"range",from:e,to:null}}(n)):(ie=t,t=r)):(ie=t,t=r),t===r&&(t=ie,(n=Se())!==r&&(oe=t,n=function(e){return{type:"point",point:e}}(n)),(t=n)===r&&(t=ie,".."===e.substr(ie,2)?(n="..",ie+=2):(n=r,0===he&&Ee(v)),n!==r&&(a=Se())!==r?(oe=t,t=n=function(e){return{type:"range",from:null,to:e}}(a)):(ie=t,t=r),t===r&&(t=ie,".."===e.substr(ie,2)?(n="..",ie+=2):(n=r,0===he&&Ee(v)),n!==r&&(oe=t,n={type:"all"}),t=n)))),he--,t===r&&(n=r,0===he&&Ee(T)),t}function Se(){var t,n,a;return he++,(t=function(){var t,n,a,s;he++,t=ie,n=ie,a=[],N.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(P));if(s!==r)for(;s!==r;)a.push(s),N.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(P));else a=r;n=a!==r?e.substring(n,ie):a;n!==r?(D.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(C)),a!==r?(oe=t,i=a,n={type:"offset",value:parseInt(n),unit:i},t=n):(ie=t,t=r)):(ie=t,t=r);var i;he--,t===r&&(n=r,0===he&&Ee(x));return t}())===r&&(t=function(){var t,n,a,s,i,o;t=ie,(n=Ie())!==r?(I.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(O)),a===r&&(a=null),a!==r&&(s=Oe())!==r?(I.test(e.charAt(ie))?(i=e.charAt(ie),ie++):(i=r,0===he&&Ee(O)),i===r&&(i=null),i!==r&&(o=function(){var t,n,a,s,i;he++,t=ie,n=ie,a=ie,N.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(P));s!==r?(N.test(e.charAt(ie))?(i=e.charAt(ie),ie++):(i=r,0===he&&Ee(P)),i!==r?a=s=[s,i]:(ie=a,a=r)):(ie=a,a=r);n=a!==r?e.substring(n,ie):a;n!==r&&(oe=t,n=n);he--,(t=n)===r&&(n=r,0===he&&Ee(L));return t}())!==r?(oe=t,n=Pe(n,s,o),t=n):(ie=t,t=r)):(ie=t,t=r)):(ie=t,t=r);t===r&&(t=ie,(n=Ie())!==r?(I.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(O)),a===r&&(a=null),a!==r&&(s=Oe())!==r?(oe=t,n=function(e,t){return Re(e,t)}(n,s),t=n):(ie=t,t=r)):(ie=t,t=r),t===r&&(t=ie,(n=Ie())!==r&&(oe=t,n=function(e){return{type:"timestamp",year:parseInt(e),month:null,day:null}}(n)),t=n));return t}())===r&&(t=function(){var t,n;t=ie,D.test(e.charAt(ie))?(n=e.charAt(ie),ie++):(n=r,0===he&&Ee(C));n!==r&&(oe=t,n={type:"unit",unit:n});return t=n}())===r&&(t=ie,n=ie,"today"===e.substr(ie,5)?(a="today",ie+=5):(a=r,0===he&&Ee(_)),a===r&&("now"===e.substr(ie,3)?(a="now",ie+=3):(a=r,0===he&&Ee(S))),(n=a!==r?e.substring(n,ie):a)!==r&&(oe=t,n={type:"special",value:n}),t=n),he--,t===r&&(n=r,0===he&&Ee(k)),t}function Ie(){var t,n,a,s,i,o,l;return he++,t=ie,n=ie,a=ie,N.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(P)),s!==r?(N.test(e.charAt(ie))?(i=e.charAt(ie),ie++):(i=r,0===he&&Ee(P)),i!==r?(N.test(e.charAt(ie))?(o=e.charAt(ie),ie++):(o=r,0===he&&Ee(P)),o!==r?(N.test(e.charAt(ie))?(l=e.charAt(ie),ie++):(l=r,0===he&&Ee(P)),l!==r?a=s=[s,i,o,l]:(ie=a,a=r)):(ie=a,a=r)):(ie=a,a=r)):(ie=a,a=r),(n=a!==r?e.substring(n,ie):a)!==r&&(oe=t,n=n),he--,(t=n)===r&&(n=r,0===he&&Ee(A)),t}function Oe(){var t,n,a,s,i;return he++,t=ie,n=ie,a=ie,N.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(P)),s!==r?(N.test(e.charAt(ie))?(i=e.charAt(ie),ie++):(i=r,0===he&&Ee(P)),i!==r?a=s=[s,i]:(ie=a,a=r)):(ie=a,a=r),(n=a!==r?e.substring(n,ie):a)!==r&&(oe=t,n=n),he--,(t=n)===r&&(n=r,0===he&&Ee(R)),t}function De(){var t,n,a,s,i,o;if(he++,t=ie,(n=Ce())!==r){for(a=[],s=ie,124===e.charCodeAt(ie)?(i="|",ie++):(i=r,0===he&&Ee(F)),i!==r&&(o=Ce())!==r?s=i=[i,o]:(ie=s,s=r);s!==r;)a.push(s),s=ie,124===e.charCodeAt(ie)?(i="|",ie++):(i=r,0===he&&Ee(F)),i!==r&&(o=Ce())!==r?s=i=[i,o]:(ie=s,s=r);a!==r?(oe=t,t=n=H(n,a)):(ie=t,t=r)}else ie=t,t=r;return he--,t===r&&(n=r,0===he&&Ee(M)),t}function Ce(){var t,n,a,s;if(he++,t=ie,n=[],W.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(U)),a!==r)for(;a!==r;)n.push(a),W.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(U));else n=r;if(n!==r&&(oe=t,n=V()),(t=n)===r){if(t=ie,39===e.charCodeAt(ie)?(n="'",ie++):(n=r,0===he&&Ee(G)),n!==r){if(a=[],K.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(z)),s!==r)for(;s!==r;)a.push(s),K.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(z));else a=r;a!==r?(39===e.charCodeAt(ie)?(s="'",ie++):(s=r,0===he&&Ee(G)),s!==r?(oe=t,t=n=Y(a)):(ie=t,t=r)):(ie=t,t=r)}else ie=t,t=r;if(t===r)if(t=ie,34===e.charCodeAt(ie)?(n='"',ie++):(n=r,0===he&&Ee(J)),n!==r){if(a=[],q.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(X)),s!==r)for(;s!==r;)a.push(s),q.test(e.charAt(ie))?(s=e.charAt(ie),ie++):(s=r,0===he&&Ee(X));else a=r;a!==r?(34===e.charCodeAt(ie)?(s='"',ie++):(s=r,0===he&&Ee(J)),s!==r?(oe=t,t=n=Y(a)):(ie=t,t=r)):(ie=t,t=r)}else ie=t,t=r}return he--,t===r&&(n=r,0===he&&Ee(B)),t}function Ae(){var t,n,a;if(he++,t=ie,n=[],te.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(ne)),a!==r)for(;a!==r;)n.push(a),te.test(e.charAt(ie))?(a=e.charAt(ie),ie++):(a=r,0===he&&Ee(ne));else n=r;return n!==r&&(oe=t,n=V()),he--,(t=n)===r&&(n=r,0===he&&Ee(ee)),t}function Ne(){var t;return he++,re.test(e.charAt(ie))?(t=e.charAt(ie),ie++):(t=r,0===he&&Ee(se)),he--,t===r&&(r,0===he&&Ee(ae)),t}const Pe=(e,t,n)=>{const a=new Date(e+"-"+t+"-"+n);if(isNaN(a.valueOf()))throw{message:"invalid date"};return{type:"timestamp",year:parseInt(e),month:parseInt(t),day:parseInt(n)}},Re=(e,t)=>{if(t>=1&&t<=12)return{type:"timestamp",year:parseInt(e),month:parseInt(t),day:null};throw{message:"invalid month"}};if((n=i())!==r&&ie===e.length)return n;throw n!==r&&ie<e.length&&Ee({type:"end"}),we(de,ce<e.length?e.charAt(ce):null,ce<e.length?ye(ce,ce+1):ye(ce,ce))}}},173:function(e,t,n){e.exports=n.p+"static/media/dropbox.b53eaec4.svg"},174:function(e,t,n){e.exports=n.p+"static/media/google_drive.f5fd3e02.png"},176:function(e,t,n){e.exports=n(384)},181:function(e,t,n){},190:function(e,t){},192:function(e,t){},226:function(e,t){},227:function(e,t){},327:function(e,t,n){},328:function(e,t,n){},329:function(e,t,n){},330:function(e,t,n){},332:function(e,t,n){},333:function(e,t,n){},341:function(e,t,n){},343:function(e,t,n){},344:function(e,t,n){},346:function(e,t,n){},347:function(e,t,n){},348:function(e,t,n){},349:function(e,t,n){},350:function(e,t,n){},351:function(e,t,n){},352:function(e,t,n){},353:function(e,t,n){},354:function(e,t,n){},355:function(e,t,n){},356:function(e,t,n){},357:function(e,t,n){},358:function(e,t,n){},359:function(e,t,n){},360:function(e,t,n){},361:function(e,t,n){},362:function(e,t,n){},363:function(e,t,n){},364:function(e,t,n){},365:function(e,t,n){},366:function(e,t,n){},367:function(e,t,n){},368:function(e,t,n){},369:function(e,t,n){},370:function(e,t,n){},371:function(e,t,n){},372:function(e,t,n){},373:function(e,t,n){},374:function(e,t,n){},375:function(e,t,n){},376:function(e,t,n){},377:function(e,t,n){},378:function(e,t,n){},379:function(e,t,n){},380:function(e,t,n){},381:function(e,t,n){},382:function(e,t,n){},383:function(e,t,n){},384:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setLoadingMessage",(function(){return He})),n.d(a,"hideLoadingMessage",(function(){return je})),n.d(a,"setIsLoading",(function(){return Be})),n.d(a,"setIsOnline",(function(){return We})),n.d(a,"setDisappearingLoadingMessage",(function(){return Ue})),n.d(a,"setLastViewedFile",(function(){return Ve})),n.d(a,"restoreStaticFile",(function(){return Ge})),n.d(a,"unloadStaticFile",(function(){return Ke})),n.d(a,"setFontSize",(function(){return ze})),n.d(a,"setBulletStyle",(function(){return Ye})),n.d(a,"setShouldTapTodoToAdvance",(function(){return Je})),n.d(a,"setAgendaDefaultDeadlineDelayUnit",(function(){return qe})),n.d(a,"setAgendaDefaultDeadlineDelayValue",(function(){return Xe})),n.d(a,"setAgendaStartOnWeekday",(function(){return $e})),n.d(a,"setShouldLiveSync",(function(){return Ze})),n.d(a,"setShouldSyncOnBecomingVisibile",(function(){return Qe})),n.d(a,"setShouldShowTitleInOrgFile",(function(){return et})),n.d(a,"setShouldLogIntoDrawer",(function(){return tt})),n.d(a,"setCloseSubheadersRecursively",(function(){return nt})),n.d(a,"setShouldNotIndentOnExport",(function(){return at})),n.d(a,"setShouldStoreSettingsInSyncBackend",(function(){return rt})),n.d(a,"setColorScheme",(function(){return st})),n.d(a,"setTheme",(function(){return it})),n.d(a,"setHasUnseenChangelog",(function(){return ot})),n.d(a,"setLastSeenChangelogHeader",(function(){return lt})),n.d(a,"setCustomKeybinding",(function(){return ct})),n.d(a,"restoreBaseSettings",(function(){return dt})),n.d(a,"pushModalPage",(function(){return ht})),n.d(a,"popModalPage",(function(){return ut})),n.d(a,"clearModalStack",(function(){return pt})),n.d(a,"activatePopup",(function(){return gt})),n.d(a,"closePopup",(function(){return mt})),n.d(a,"setAgendaTimeframe",(function(){return ft}));var r={};n.r(r),n.d(r,"addNewEmptyCaptureTemplate",(function(){return Tt})),n.d(r,"updateTemplateFieldPathValue",(function(){return vt})),n.d(r,"addNewTemplateOrgFileAvailability",(function(){return kt})),n.d(r,"removeTemplateOrgFileAvailability",(function(){return _t})),n.d(r,"addNewTemplateHeaderPath",(function(){return St})),n.d(r,"removeTemplateHeaderPath",(function(){return It})),n.d(r,"deleteTemplate",(function(){return Ot})),n.d(r,"restoreCaptureSettings",(function(){return Dt})),n.d(r,"reorderCaptureTemplate",(function(){return Ct}));var s={};n.r(s),n.d(s,"parseFile",(function(){return tr})),n.d(s,"setLastSyncAt",(function(){return nr})),n.d(s,"resetFileDisplay",(function(){return ar})),n.d(s,"sync",(function(){return ir})),n.d(s,"openHeader",(function(){return lr})),n.d(s,"toggleHeaderOpened",(function(){return cr})),n.d(s,"selectHeader",(function(){return dr})),n.d(s,"setPath",(function(){return hr})),n.d(s,"selectHeaderAndOpenParents",(function(){return ur})),n.d(s,"advanceTodoState",(function(){return pr})),n.d(s,"enterEditMode",(function(){return gr})),n.d(s,"exitEditMode",(function(){return mr})),n.d(s,"updateHeaderTitle",(function(){return fr})),n.d(s,"updateHeaderDescription",(function(){return br})),n.d(s,"addHeader",(function(){return yr})),n.d(s,"selectNextSiblingHeader",(function(){return Er})),n.d(s,"addHeaderAndEdit",(function(){return wr})),n.d(s,"selectNextVisibleHeader",(function(){return Tr})),n.d(s,"selectPreviousVisibleHeader",(function(){return vr})),n.d(s,"removeHeader",(function(){return kr})),n.d(s,"moveHeaderUp",(function(){return _r})),n.d(s,"moveHeaderDown",(function(){return Sr})),n.d(s,"moveHeaderLeft",(function(){return Ir})),n.d(s,"moveHeaderRight",(function(){return Or})),n.d(s,"moveSubtreeLeft",(function(){return Dr})),n.d(s,"moveSubtreeRight",(function(){return Cr})),n.d(s,"refileSubtree",(function(){return Ar})),n.d(s,"addNote",(function(){return Nr})),n.d(s,"narrowHeader",(function(){return Pr})),n.d(s,"widenHeader",(function(){return Rr})),n.d(s,"setOpennessState",(function(){return Lr})),n.d(s,"applyOpennessState",(function(){return xr})),n.d(s,"dirtyAction",(function(){return Mr})),n.d(s,"setDirty",(function(){return Fr})),n.d(s,"setSelectedTableCellId",(function(){return Hr})),n.d(s,"addNewTableRow",(function(){return jr})),n.d(s,"removeTableRow",(function(){return Br})),n.d(s,"addNewTableColumn",(function(){return Wr})),n.d(s,"removeTableColumn",(function(){return Ur})),n.d(s,"moveTableRowDown",(function(){return Vr})),n.d(s,"moveTableRowUp",(function(){return Gr})),n.d(s,"moveTableColumnLeft",(function(){return Kr})),n.d(s,"moveTableColumnRight",(function(){return zr})),n.d(s,"updateTableCellValue",(function(){return Yr})),n.d(s,"insertCapture",(function(){return Jr})),n.d(s,"clearPendingCapture",(function(){return qr})),n.d(s,"insertPendingCapture",(function(){return Xr})),n.d(s,"advanceCheckboxState",(function(){return $r})),n.d(s,"setHeaderTags",(function(){return Zr})),n.d(s,"reorderTags",(function(){return Qr})),n.d(s,"reorderPropertyList",(function(){return es})),n.d(s,"updateTimestampWithId",(function(){return ts})),n.d(s,"updatePlanningItemTimestamp",(function(){return ns})),n.d(s,"addNewPlanningItem",(function(){return as})),n.d(s,"removePlanningItem",(function(){return rs})),n.d(s,"removeTimestamp",(function(){return ss})),n.d(s,"updatePropertyListItems",(function(){return is})),n.d(s,"setOrgFileErrorMessage",(function(){return os})),n.d(s,"setLogEntryStop",(function(){return ls})),n.d(s,"createLogEntryStart",(function(){return cs})),n.d(s,"updateLogEntryTime",(function(){return ds})),n.d(s,"setSearchFilterInformation",(function(){return hs})),n.d(s,"setShowClockDisplay",(function(){return us})),n.d(s,"updateFileSettingFieldPathValue",(function(){return ps})),n.d(s,"reorderFileSetting",(function(){return gs})),n.d(s,"deleteFileSetting",(function(){return ms})),n.d(s,"addNewEmptyFileSetting",(function(){return fs})),n.d(s,"restoreFileSettings",(function(){return bs}));var i={};n.r(i),n.d(i,"signOut",(function(){return Cs})),n.d(i,"setCurrentFileBrowserDirectoryListing",(function(){return As})),n.d(i,"setIsLoadingMoreDirectoryListing",(function(){return Ns})),n.d(i,"getDirectoryListing",(function(){return Ps})),n.d(i,"loadMoreDirectoryListing",(function(){return Rs})),n.d(i,"pushBackup",(function(){return Ls})),n.d(i,"downloadFile",(function(){return xs}));var o=n(0),l=n.n(o),c=n(48),d=n.n(c),h=(n(181),n(10)),u=n(6),p=n(165),g=n(8),m=n(32),f=n(22),b=n.n(f),y=n(4),E=n.n(y),w=n(1),T=n(409),v=(()=>{let e=1;return()=>e++})(),k=n(18),_=n(410),S=n(166),I=n(73),O=n(167),D=n(74),C=n(168),A=n(385),N=n(386),P=n(387),R=n(388),L=n(389),x=n(390),M=n(391);const F=e=>{const t=e.toJS(),n=t.isActive,a=t.year,r=t.month,s=t.day,i=t.dayName,o=t.startHour,l=t.startMinute,c=t.endHour,d=t.endMinute,h=t.repeaterType,u=t.repeaterValue,p=t.repeaterUnit,g=t.repeaterDeadlineValue,m=t.repeaterDeadlineUnit,f=t.delayType,b=t.delayValue,y=t.delayUnit;let E="";return E+=n?"<":"[",E+="".concat(a,"-").concat(r,"-").concat(s),E+=i?" ".concat(i):"",E+=o?" ".concat(o,":").concat(l):"",E+=c?"-".concat(c,":").concat(d):"",E+=h?" ".concat(h).concat(u).concat(p):"",E+=h&&g?"/".concat(g).concat(m):"",E+=f?" ".concat(f).concat(b).concat(y):"",E+=n?">":"]",E},H=(e,{isActive:t=!0,withStartTime:n=!1}={})=>{const a={isActive:t,year:Object(k.a)(e,"yyyy"),month:Object(k.a)(e,"MM"),day:Object(k.a)(e,"dd"),dayName:Object(k.a)(e,"eee"),startHour:null,startMinute:null,endHour:null,endMinute:null,repeaterType:null,repeaterValue:null,repeaterUnit:null,repeaterDeadlineValue:null,repeaterDeadlineUnit:null,delayType:null,delayValue:null,delayUnit:null};return n&&(a.startHour=Object(k.a)(e,"HH"),a.startMinute=Object(k.a)(e,"mm")),a},j=({isActive:e=!0,withStartTime:t=!1}={})=>B(new Date,{isActive:e,withStartTime:t}),B=(e,{isActive:t=!0,withStartTime:n=!1}={})=>{const a=t?"<>":"[]";let r="yyyy-MM-dd eee";return n&&(r+=" HH:mm"),"".concat(a[0]).concat(Object(k.a)(e,r)).concat(a[1])},W=e=>{const t=e.toJS(),n=t.year,a=t.month,r=t.day,s=t.startHour,i=t.startMinute;let o="".concat(n,"-").concat(a,"-").concat(r);return o+=s&&i?" ".concat(s.padStart(2,"0"),":").concat(i):" 12:00",Object(_.a)(o,"yyyy-MM-dd HH:mm",new Date)},U=(e,t,n)=>{switch(n){case"h":return Object(S.a)(e,t);case"d":return Object(I.a)(e,t);case"w":return Object(O.a)(e,t);case"m":return Object(D.a)(e,t);case"y":return Object(C.a)(e,t);default:return e}},V=(e,t,n)=>{switch(n){case"h":return Object(A.a)(e,t);case"d":return Object(N.a)(e,t);case"w":return Object(P.a)(e,t);case"m":return Object(R.a)(e,t);case"y":return Object(L.a)(e,t);default:return e}},G=(e,t)=>{let n=[e,t].map(W),a=Object(g.a)(n,2),r=a[0],s=a[1];return K(r,s)},K=(e,t)=>{let n=" ";if(e>t){n="-";var a=[t,e];e=a[0],t=a[1]}const r=Object(M.a)(t,e),s=Math.floor(r/60);s>=10&&(n="");const i=r%60,o=i>=10?i:"0".concat(i);return"".concat(n).concat(s,":").concat(o)},z=e=>void 0===e?"":K(new Date(0),new Date(e)),Y=e=>e.map(e=>{switch(e.get("type")){case"text":return e.get("contents");case"link":return e.getIn(["contents","title"])?e.getIn(["contents","title"]):e.getIn(["contents","uri"]);case"table":default:return""}}).join(""),J=e=>{if(!e)return"";const t=e.map(e=>e.get("type")).unshift(null);return e.zip(t).map(([e,t])=>{let n="";switch(e.get("type")){case"text":n=e.get("contents");break;case"link":n=(a=e).getIn(["contents","title"])?"[[".concat(a.getIn(["contents","uri"]),"][").concat(a.getIn(["contents","title"]),"]]"):"[[".concat(a.getIn(["contents","uri"]),"]]");break;case"fraction-cookie":n="[".concat(e.getIn(["fraction",0])||"","/").concat(e.getIn(["fraction",1])||"","]");break;case"percentage-cookie":n="[".concat(e.get("percentage")||"","%]");break;case"table":n=(e=>{const t=e.get("contents").map(e=>Math.max(...e.get("contents").map(e=>(E.a.countBy(e.get("rawContents"))["\n"]||0)+1))).toJS(),n=e.getIn(["contents",0,"contents"]).size,a=E.a.times(n).map(t=>Math.max(...e.get("contents").map(e=>{const n=e.getIn(["contents",t,"contents"]),a=Y(n).split("\n").map(e=>e.trim().length);return Math.max(...a)})));return E.a.dropRight(E.a.flatten(e.get("contents").map((e,n)=>{const r=t[n],s=E.a.times(r).map(t=>e.get("contents").map((e,n)=>{const r=e.get("contents"),s=Y(r).split("\n").map(e=>e.trim().length),i=(e.get("rawContents").split("\n")[t]||"").trim(),o=a[n]-s[t];return i+" ".repeat(o)}).toJS().join(" | ")).map(e=>"| ".concat(e," |")),i="|"+a.map(e=>"-".repeat(e+2)).join("+")+"|";return s.concat(i)}).toJS())).join("\n")})(e);break;case"list":n=(e=>{const t=e.get("bulletCharacter");let n=0;return e.get("items").map(a=>{const r=e.get("isOrdered")||"*"!==t?"":" ",s=J(a.get("titleLine")),i=J(a.get("contents")),o=i.split("\n").map(e=>e.trim()?"".concat(r,"  ").concat(e):"").join("\n");let l=null;if(e.get("isOrdered")){let t=++n,r=a.get("forceNumber");if(r&&(t=r,n=t),l="".concat(t).concat(e.get("numberTerminatorCharacter")),r&&(l+=" [@".concat(r,"]")),a.get("isCheckbox")){const e={checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")];l+=" [".concat(e,"]")}l+=" ".concat(s)}else{if(l="".concat(r).concat(t),a.get("isCheckbox")){const e={checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")];l+=" [".concat(e,"]")}l+=" ".concat(s)}return i&&(l+="\n".concat(o)),l}).join("\n")})(e);break;case"timestamp":n=(e=>{let t=F(e.get("firstTimestamp"));return e.get("secondTimestamp")&&(t+="--".concat(F(e.get("secondTimestamp")))),t})(e);break;case"url":case"www-url":case"e-mail":case"phone-number":n=e.get("content");break;default:console.error("Unknown attributed string part type in attributedStringToRawText: ".concat(e.get("type")))}var a;return(["list","table"].includes(t)?"\n":"")+n}).join("")},q=(e,t)=>{let n="*".repeat(e.nestingLevel);if(e.titleLine.todoKeyword&&(n+=" ".concat(e.titleLine.todoKeyword)),n+=" ".concat(e.titleLine.rawTitle),e.titleLine.tags.length){let t=":".concat(e.titleLine.tags.filter(e=>e).join(":"),":");if(!n.match(/\s$/)){let e=77-n.length-t.length;n+=" ".repeat(e>0?e:1)}n+=t}return t||(n=n.substring(1+e.nestingLevel)),n},X=({headers:e,linesBeforeHeadings:t,dontIndent:n})=>t.map(e=>e+"\n").join("")+e.map(e=>$(e,!0,n)).join(""),$=(e,t,n)=>{const a=e;e=e.toJS();const r=n?"":" ".repeat(e.nestingLevel+1);let s="";t&&(s+=q(e,!0)+"\n");const i=a.get("planningItems").filter(Re).toJS();if(i.length){const e=i.map(e=>{const t=F(Object(w.fromJS)(e.timestamp));return"".concat(e.type,": ").concat(t)}).join(" ").trimRight();s+="".concat(r).concat(e,"\n")}if(e.propertyListItems.length){const t=e.propertyListItems.map(e=>"".concat(r,":").concat(e.property,": ").concat(J(Object(w.fromJS)(e.value)))).join("\n");s+="".concat(r,":PROPERTIES:\n"),s+="".concat(t,"\n"),s+="".concat(r,":END:\n")}if(s+=J(Object(w.fromJS)(e.logNotes)).split("\n").map(e=>e.trim()?"".concat(r).concat(e):"").join("\n"),s+=e.logNotes.length?"\n":"",e.logBookEntries.length){const t=e.logBookEntries.map(e=>void 0!==e.raw?e.raw?"".concat(r).concat(e.raw):"":null===e.end?"".concat(r,"CLOCK: ").concat(F(Object(w.fromJS)(e.start))):"".concat(r,"CLOCK: ").concat(F(Object(w.fromJS)(e.start)),"--").concat(F(Object(w.fromJS)(e.end))," => ").concat(G(Object(w.fromJS)(e.start),Object(w.fromJS)(e.end)))).join("\n").trimRight();s+="".concat(r,":LOGBOOK:\n"),s+="".concat(t,"\n"),s+="".concat(r,":END:\n")}let o=e.rawDescription;return e.rawDescription.match(/[^\n]$/)&&(o=e.rawDescription+"\n"),s+=o,s};var Z=(e,t=Object(w.Map)())=>{if(!e)return["",null];const n={"%t":"<".concat(Object(k.a)(new Date,"yyyy-MM-dd eee"),">"),"%T":"<".concat(Object(k.a)(new Date,"yyyy-MM-dd eee HH:mm"),">"),"%u":"[".concat(Object(k.a)(new Date,"yyyy-MM-dd eee"),"]"),"%U":"[".concat(Object(k.a)(new Date,"yyyy-MM-dd eee HH:mm"),"]")};t.entrySeq().forEach(([e,t])=>{n["%".concat(e)]=t});let a=e;E.a.entries(n).forEach(([e,t])=>a=a.replace(RegExp(e,"g"),t));const r=a.includes("%?")?a.indexOf("%?"):null;return a=a.replace(/%\?/,""),[a,r]};const Q=()=>new Promise((e,t)=>{var n;(n="# organice will not reflow if there's hard-wrapped content\n# -*- eval: (auto-fill-mode 0) -*-\n\n* General\n\nAll user visible changes to organice will be documented in this file.\n\nWhen there are updates to the changelog, you will be notified and see a 'gift' icon appear on the top right corner.\n\n* [2021-05-16 Sun]\n** Added\n   - Parse and preserve habit timestamp ranges\n     - A timestamp may have minimum and maximum ranges specified by using the syntax =.+2d/3d=, which says that you want to do the task at least every three days, but at most every two days.\n     - Upstream documentation:\n       https://orgmode.org/manual/Tracking-your-habits.html\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/674\n     - Thank you [[https://github.com/tomonacci][tomonacci]] for the PR\ud83d\ude4f\n\n* [2021-05-13 Thu]\n\n** Changed\n   - Agenda starts on Monday by default (as it does in Emacs Org mode)\n\n** Added\n   - Ability to set the \"Start of week for weekly agenda\" in the Settings\n     - Akin to the Emacs org mode variable =org-agenda-start-on-weekday=\n   - Relevant PRs:\n     - https://github.com/200ok-ch/organice/pull/676\n       - Thank you [[https://github.com/tomonacci][tomonacci]] for the PR\ud83d\ude4f\n     - https://github.com/200ok-ch/organice/pull/677\n\n* [2020-12-29 Tue]\n** Added\n   - *EPIC*: Multiple file support\n     - Agenda, Search, Task List, Refile and Capture Templates have the ability to work on multiple files.\n     - You can adjust the behavior for these on a file per file basis by creating \"file settings\" in the settings menu.\n\n   - *EPIC*: Offline file support\n     - Every file opened in organice will automatically be cached on your device.\n     - When visiting the file, again, it will immediately be loaded from the local storage and then loaded from the remote back-end.\n     - That makes loading and switching between files instant _and_ gives you the ability to work on multiple files when being offline.\n\n   - Relevant PRs:\n     - https://github.com/200ok-ch/organice/pull/550\n     - https://github.com/200ok-ch/organice/pull/560\n     - https://github.com/200ok-ch/organice/pull/565\n     - https://github.com/200ok-ch/organice/pull/574\n     - https://github.com/200ok-ch/organice/pull/575\n     - https://github.com/200ok-ch/organice/pull/570\n     - https://github.com/200ok-ch/organice/pull/607\n\n* [2020-11-21 Sat]\n\n** Added\n   - When going to the Agenda view, the selected tab is persisted - meaning it will be pre-selected when you go to the Agenda next time.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/562\n\n** Fixed\n   - Having an active timestamp with a repeater was broken.\n     - When the TODO state changes for a header that has a repeater (either as SCHEDULED, DEADLINE or active timestamp), a log entry is written and the timestamp is updated.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/568\n   - Removing an active timestamp was broken.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/568\n\n* [2020-11-20 Fri]\n** Fixed\n   - organice understands =:PROPERTIES:= drawers and smartly parses the values in case one of the values is a timestamp.\n     - However, parsing all the values and saving the parsed result in any case will lead to wrong results. Most values of properties are just plain text and non-interactive things in Org mode.\n     - For example, a value like =something_with_underscores= would have been treated as 'underlined text' which doesn't make sense for a property drawer. When saving the value back, organice would have squashed the underlines.\n     - Now, the values are used and preserved as they are. Timestamps still work, of course.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/578\n* [2020-11-15 Sun]\n** Fixed\n   - When repeating a task, an active date timestamp was logged instead of an inactive datetime timestamp.\n\n* [2020-11-14 Sat]\n** Fixed\n   - The task list was not scrollable on Android.\n      - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/561][PR]] \ud83d\ude4f\n\n* [2020-11-08 Sun]\n** Changed\n   - Safeguard against selecting text by accident.\n      - Before this change, it was possible to select text when doing a 'swipe'.\n      - Now, selecting/copying text is only possible in 'edit mode', effectively safeguarding against accidentally selecting text.\n      - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/557][PR]] \ud83d\ude4f\n\n\n* [2020-11-06 Fri]\n** Added\n   - Additional themes. You now can choose between:\n     - Solarized\n     - One\n     - Gruvbox\n     - Smyck\n     - Code\n   - All of these are themes work in light and dark mode!\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/540][PR]] \ud83d\ude4f\n\n* [2020-11-01 Sun]\n\n** Changed\n   - We have enabled some default settings by default, because they are reasonable for a new user:\n     - =shouldStoreSettingsInSyncBackend=, because it enables using organice on multiple clients.\n     - =shouldLiveSync=, because it reduces the chance to have a conflict in the open Org file.\n     - =shouldSyncOnBecomingVisibile=, because it reduces the chance to have a conflict in the open Org file.\n   - =bulletStyle= is set to \"Fancy\", because it looks more visually pleasing than an asterisk (*) and hence makes organice look better on a first test run.\n   - If you personally do not want them enabled, you can disable them separately in the [[/settings][settings]] any time.\n\n** Fixed\n   - organice has various settings that the user can configure. Before manual configuration, there organice loads sane defaults. Loading and persisting some of these defaults was buggy before.\n     - Loading and persisting of defaults works now.\n     - Previously saved wrong values are removed from =localStorage= to reduce future bug potential.\n     - Changing this is - strictly speaking - not visible to the end-user, so it wouldn't ordinarily show up in this changelog. However, since it makes changes to the already saved settings (in cleaning up old faulty values), it theoretically could introduce a bug in the settings. Hence, the change is added to the changelog.\n     - Related PRs:\n       - https://github.com/200ok-ch/organice/pull/552\n       - https://github.com/200ok-ch/organice/pull/553\n       - https://github.com/200ok-ch/organice/pull/554\n* [2020-10-25 Sun]\n** Changed\n   - The 'focus header' feature is renamed.\n     - /Narrowing/ means focusing on this header, making the rest temporarily inaccessible.\n     - Canceling the narrowing, which makes all headers once again accessible, is called /widening/.\n* [2020-10-23 Fri]\n** Added\n   - Add 'dark mode' next to 'light mode' as a setting.\n     - Both themes are based on the popular [[https://ethanschoonover.com/solarized/][Solarized]] color palette.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/527][PR]] \ud83d\ude4f\n   - Add 'recursive clock times in search'.\n     - The =clock:= search term now includes headers that have time logged on their children.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/524][PR]] \ud83d\ude4f\n\n* [2020-10-20 Tue]\n** Added\n   - Add 'time range' queries to search for planning items (SCHEDULED and DEADLINE), plain active timestamps or clocked work time.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/505][PR]] \ud83d\ude4f\n* [2020-10-19 Mon]\n** Added\n   - When a header is focused, and the user uses the 'search' or 'task list' feature, then the searched header list is automatically narrowed to only subheaders of the originally focused header.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/517][PR]] \ud83d\ude4f\n* [2020-10-10 Sat]\n** Added\n   - Display time summaries for clock entries in each subtree\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/497][PR]] \ud83d\ude4f\n\n** Changed\n\n   - Improve header stickiness\n     - The header bar was not always sticky for longer documents and the therefore some functionality was hard to reach (the user had to scroll to the top to reach it).\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/499][PR]] \ud83d\ude4f\n\n* [2020-10-07 Wed]\n** Added\n\n   - Added Documentation on [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]] to =sample.org= and to mouseovers for the relevant buttons.\n\n* [2020-09-20 Sun]\n** Added\n\n   - Recognize US and Swiss phone numbers and make them clickable\n   - Next to 'canonical' phone numbers like +49123456789, also recognize:\n     - US phone numbers:\n       - 123-456-7890\n       - (123) 456-7890\n       - 123 456 7890\n       - 123.456.7890\n       - +91 (123) 456-7890\n     - Swiss phone numbers:\n       - 0783268674\n       - 078 326 86 74\n       - 041783268675\n       - 0041783268674\n       - +41783268676\n       - +41783268677\n\n* [2020-09-07 Mon]\n** Added\n   - Added the capability to chose the start screen when installing organice to the homescreen.\n     - More information on how to install organice like this, see https://organice.200ok.ch/documentation.html#installation\n* [2020-09-05 Sat]\n\n** Fixed\n  - Search and Todo List modals could be moved off screen on iOS since [2020-08-30 Sun]. The fix is to disable =autoFocus= on iOS. The rationale for that documented here: https://github.com/200ok-ch/organice/pull/462\n\n* [2020-08-30 Sun]\n\n** Added\n   - Add note to header (=M-x org-add-note=)\n     - This adds a button for taking notes to tasks (org-add-note). They will be prepended to the header contents after :PROPERTIES: and before the :LOGBOOK:\n   - Auto-focus filter input fields (search and task-list)\n\n* [2020-08-29 Sat]\n** Fixed\n   - If a user folds a header, all its subheaders should collapse as well, so that when the user reopens it, they stay closed.\n     - The previous behavior is buggy in a way that it keeps the subheaders open as they were, restoring their openness when the header is unfolded.\n     - The previous behavior is useful, though. So this change introduces a user setting to toggle the behaviour.\n   - Thank you [[https://github.com/necto][necto]] for your [[https://github.com/200ok-ch/organice/pull/440][PR]] \ud83d\ude4f\n\n* [2020-08-25 Tue]\n** Fixed\n   - Updating table cell values and removing table rows or colums was\n     not undoable\n     - Thank you [[https://github.com/necto][necto]] for your [[https://github.com/200ok-ch/organice/pull/432][PR]] \ud83d\ude4f\n\n* [2020-07-28 Tue]\n** Fixed\n   1. Sync stuck when working in the background\n     - When the user put organice into the background during a sync and comes back, organice was stuck in sync mode, but doesn't actually sync anymore. This means that any new changes to the Org file will not be persisted. This is due to mobile browsers cutting off most resources to browser apps in the background, so organice cannot guarantee that a sync happens properly in the background.\n     - It's not trivial to find out if the job is stuck\n       - Time is not a good indicator as bigger files on slower connections will always take longer.\n       - There's no JS API to reliably find out if the browser just got back from the background or is put into the foreground. The [[https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API][=visibilitychange= API]] just triggers for both these events.\n     - Hence, the implementation is generic in nature: Whenever the user hits the 'sync' button, an actual 'sync' is forced - even if organice thinks there's currently a sync in progress or that it should be debounced. That makes sense, because manual actions by the user should always be obeyed.\n     - Closes issue https://github.com/200ok-ch/organice/issues/252\n   - 2. On iOS >13.1, when organice is used in SPA mode (as a bookmark on the homescreen), and the user navigates away from the original bookmark, a huge URL Bar would show up with a \"Done\" button. This is a regression in how iOS handles full-screen SPAs. These are the relevant APIs:\n     - https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html\n     - https://developer.mozilla.org/en-US/docs/Web/Manifest/display\n   - 3. Feature detection for =crypto.subtle= module\n     - This is used for change detection in the changelog. The module is only available in secure contexts. Hence, when used locally and on a private IP range, depending on the browser, it might not be available.\n\n* [2020-07-08 Wed]\n** Added\n   - Allow template-variables in the header-path in a capture template\n     - Thank you [[https://github.com/jayesh-bhoot][jayesh-bhoot]] for your [[https://github.com/200ok-ch/organice/pull/387/][PR]] \ud83d\ude4f\n* [2020-06-14 Sun]\n** Added\n   - Allow capture templates to insert at beginning or end of file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/324][PR]] \ud83d\ude4f\n* [2020-06-05 Fri]\n** Fixed\n   - =file:= links are sanity checked before opened\n     - =file:= links opened in iOS from the PWA view will not open Mobile Safari\n     - Open issue: Some links will be opened as directories when the\n       link is not really going towards a directory.\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/311][PR]] \ud83d\ude4f\n\n* [2020-06-03 Wed]\n** Added\n   - =TODO= keyword sets can now be anywhere in the file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/310][PR]] \ud83d\ude4f\n* [2020-05-30 Sat]\n\n** Added\n   - Make local =file:...= links navigate to the relevant file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/307][PR]] \ud83d\ude4f\n\n* [2020-05-06 Wed]\n\n** Fixed\n   - Planning items now respect the new hard-indent setting.\n\n* [2020-05-05 Tue]\n\n** Fixed\n   - Append new tags correctly to title.\n     - If a header didn't have tags before, the first tags were\n       erroneously appended without a space.\n\n* [2020-04-06 Mon]\n\n** Added\n   - Support org-adapt-indentation\n     - By default, the metadata body (including deadlines and drawers) of an exported org heading is indented according to its level. If instead you prefer to keep your body text flush-left, i.e.{' '}\n     - Thank you [[https://github.com/cpbotha][cpbotha]] for your [[https://github.com/200ok-ch/organice/pull/272][PR]] \ud83d\ude4f\n\n* [2020-04-05 Sun]\n** Added\n   - Support for org-log-into-drawer TODO state logging\n     - Thank you [[https://github.com/cpbotha][cpbotha]] for your [[https://github.com/200ok-ch/organice/pull/271][PR]] \ud83d\ude4f\n** Fixed\n   - Settings screen has proper title and \"back\" button\n\n* [2020-03-27 Fri]\n** Fixed\n   - Help texts for widen/narrow were reversed\n     - Thank you [[https://github.com/obar][@obar]] for the [[https://github.com/200ok-ch/organice/pull/270][PR]] \ud83d\ude4f\n\n* [2020-02-29 Sat]\n\n** Fixed\n   - As a user, when I visit Search, Task List or Agenda whilst having\n     a dirty file, I'm not getting a pop up a dialogue notifying me\n     about unpushed changes\n\n* [2020-02-17 Mon]\n\n** Added\n   - *Headers with active timestamps in the header or description appear in agenda*\n\n** Fixed\n   - 'Insert timestamp' for headers and descriptions\n\n* [2020-02-09 Sun]\n\n** Added\n   - Comprehensive documentation: https://organice.200ok.ch/documentation.html\n     - You can find the link from the 'settings' screen or on top of\n       the readme.\n\n* [2020-01-27 Mon]\n\n** Fixed\n   - When editing a =:LOGBOOK:= drawer within a headers description,\n     the relevant logbook entries are updated (which might entail them\n     being deleted).\n\n* [2020-01-20 Mon]\n\n** Fixed\n   - When refiling a header, don't show subheaders in the refile drawer\n   - When doing a 'Search' or 'Refile', the action is reflected in the\n     name of the opening drawer.\n   - In the agenda view, fix relative time distance for future dates\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/240][PR]] \ud83d\ude4f\n\n* [2020-01-15 Wed]\n\n** Fixed\n   - Put Floating Action Button \"Move a header\" into the middle of the\n     screen, so that it has enough space to render all arrows on\n     mobile devices.\n\n* [2020-01-14 Tue]\n\n** Added\n   - Notify on changes for changelog\n     - This is done with a similar UX than other productivity apps\n       (like Slack) do it. The user will see a 'gift' icon whenever\n       there's a change to the changelog she has not seen, yet.\n\n* [2020-01-13 Mon]\n\n** Added\n   - \"Show Org filename in Header\" is configurable in settings and\n     off by default\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/229][PR]] \ud83d\ude4f\n\n** Fixed\n   - Show error message when using a capture template with a badly\n     configured header path\n\n* [2020-01-12 Sun]\n\n** Added\n   - Make HeaderBar sticky\n     - Making undo/redo, file browser and help always available\n       (before it was required to scroll all the way to the top)\n   - Deselect headline by clicking into the title (or empty space) in\n     the HeaderBar\n   - Show Org filename in Header\n\n** Fixed\n   - *Major synchronization improvements*\n     1. After undo/redo, synchronize Org file\n     2. Debounce Sync\n        1. When a user changes things quickly (which happens easily\n           when having 'live sync' enabled and using undo/redo for\n           example), multiple syncs ran in parallel. The back-ends\n           will either get confused or fail with errors (429 too many\n           write operations). In any case, likely the last written\n           state would not have been the state of the Org file in\n           organice.\n     3. Safeguard against concurrent sync requests to the back-end\n     4. In case of synchronization error, show the error to the user\n        and retry synchronization\n     5. Don't actually sync a whole Org file for an empty header.\n        When the user adds some data and triggers\n        UPDATE_HEADER_TITLE, then it makes sense to save it.\n\n* [2020-01-11 Sat]\n\n** Added\n   - All HeaderActionItems are undoable and redoable\n\n** Fixed\n   - Parsing planning items followed by a checkbox\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/222/files][PR]] \ud83d\ude4f\n* [2020-01-07 Tue]\n\n** Added\n   - *Refile*\n     - When reviewing the captured data, you may want to refile or to\n       copy some of the entries into a different list, for example\n       into a project.\n   - Add button in HeaderActionBar to open property editor\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/195][PR]] \ud83d\ude4f\n\n** Changed\n   - All HeaderActionDrawer actions have icons. The icons are\n     documented in sample.org and have a mouseover title.\n\n* [2020-01-04 Sat]\n\n** Added\n   - Ability to search headlines\n     - It has the same syntax as the search field in the Task List\n       feature\n\n** Fixed\n   - Sort order in Task List\n     - Tasks were only ordered by their planning item dates. This\n       implied that tasks that were long DONE would be shown first.\n     - Now, tasks in the Task list are sorted by state and then date.\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/207][PR]] \ud83d\ude4f\n\n\n* [2020-01-02 Thu]\n\n** Added\n   - Place cursor after the TODO keyword when creating a new header\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/193][PR]] \ud83d\ude4f\n   - Highlight verbatim markup\n\n** Changes\n   - Highlight cookies and cookie percentages according to Solarized\n     color scheme\n\n** Fixed\n   - Don't update search results when using an invalid search filter\n   - On mobile: Styling of Search / Task List drawer when searching all\n     headlines\n   - On mobile: Ability to scroll Search / Task List\n   - Teach #+TODO parser to understand (..) suffix\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/202][PR]] \ud83d\ude4f\n\n* [2020-01-01 Wed]\n\n** Added\n   - Support single- and double-quoted strings in the search filter\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/176][PR]] \ud83d\ude4f\n   - Trim whitespace for entered or updated headlines\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/177][PR]] \ud83d\ude4f\n\n** Fixed\n   - Capture templates in iOS 13.3 are positioned properly\n     - iOS 13 introduced a styling regression when setting focus\n       without user interaction. iOS 13.3 reverts to the way other\n       browsers do it.\n\n** Changed\n   - Revert \"Move HeaderActionDrawer before headline\"\n     - As per #188, the changes introduced in #100 didn't fare well\n       with the community. Hence, as a first step to improve UX,\n       we're reverting to the previous state.\n\n* [2019-12-31 Tue]\n\n** Added\n   - *Searching of headlines/todos with a composable query language*\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/154][PR]] \ud83d\ude4f\n   - Routing for Settings (/settings) and Sample (/sample)\n   - Routing for Agenda and TaskList\n\n** Changes\n   - The action for capture templates now uses a more idiomatic\n     'plus' icon instead of a 'list' icon\n\n* [2019-12-28 Sat]\n\n** Added\n   - Proper coloring of DONE todoKeywords from custom todo sequences\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/165][PR]]!\n   - Place TODO keyword of previous header in the new header\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/164][PR]]!\n\n** Changed\n   - Refactor current Org parser and regex\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/161][PR]]!\n\n* [2019-12-26 Thu]\n\n** Added\n\n   - \"Share\" button for headlines (sharing via email)\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/145][PR]]!\n   - Automatically render links for URLs with www prefix, but without\n     protocol\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/159][PR]]!\n\n* [2019-12-25 Wed]\n\n** Added\n\n   - Suggestion list for inputs in property editor\n     - To minimize typing and typos, add smart completion for property\n       names and values in the PropertyListEditorModal.\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/144][PR]]!\n\n* [2019-12-24 Tue]\n** Added\n\n   - *Automatically render links for URLs, e-mail addresses and phone\n     numbers*\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/147][PR]]!\n\n   - Suggestion list for inputs in tag editor\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/149][PR]]!\n\n* [2019-12-17 Tue]\n** Changed\n   - Improve webdav url input\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/139][PR]]!\n** Fixed\n   - Make \"privacy policy\" sticky to the bottom of the landing page\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/140][PR]]!\n\n* [2019-12-15 Sun]\n\n** Changed\n   - UX: Move Org header actions before selected headline\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/136][PR]]!\n\n** Fixed\n   - Android PWA implementation was broken (issue [[https://github.com/200ok-ch/organice/issues/134][#134]])\n     - It required two more icon sizes\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/135][PR]]!\n\n* [2019-12-10 Tue]\n\n** Added\n\n   - *Docker Support*\n   - The CI/CD workflow now also builds a Docker container which is\n     then published to\n     https://hub.docker.com/repository/docker/twohundredok/organice\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/133][PR]]!\n\n* [2019-12-08 Sun]\n\n** Added\n\n   - As a user, when I'm on a headline with a planning item (schedule\n     or deadline), I want to be able to remove it.\n\n* [2019-11-29 Fri]\n\n** Fixed\n\n   - Clicking the Timestamp in a TODO within the agenda toggles from\n     the date to a human readable timespan\n\n* [2019-11-27 Wed]\n\n** Added\n\n   - Instructions on configuring Nextcloud+haproxy to allow WebDAV\n   - Documentation on how to share from Nextcloud using WebDAV\n   - Thank you [[https://github.com/runejuhl][runejuhl]] for your [[https://github.com/200ok-ch/organice/pull/122][PR]]!\n\n* [2019-11-25 Mon]\n\n** Added\n   - Honor the 'nologrepeat' option\n     - It can be set via =#+STARTUP:= or as a property\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/119][PR]]!\n\n* [2019-11-22 Fri]\n\n** Fixed\n\n   - Handle non-clock entries in =:LOGBOOK:= drawers\n     - Fixes [[https://github.com/200ok-ch/organice/issues/111][issue #111]], [[https://github.com/200ok-ch/organice/issues/108][issue #108]] and [[https://github.com/200ok-ch/organice/issues/110][issue #110]]\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/112][PR]]!\n\n* [2019-11-21 Thu]\n\n** Fixed\n\n   - Safeguard against potential Dropbox SDK Bug\n     - More information in [[https://github.com/200ok-ch/organice/issues/108][issue #108]]\n\n* [2019-11-19 Tue]\n\n** Changed\n\n   - Don't put newlines after headers with no content, add newline at EOF\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/106][PR]]!\n\n* [2019-11-14 Thu]\n\n** Added\n\n   - *Clocking work time*\n     - Org mode allows you to clock the time you spend on specific\n       tasks in a project:\n       https://orgmode.org/manual/Clocking-Work-Time.html#Clocking-Work-Time\n     - organice is compatible with logbook clocking, now\n     - You can 'clock in' and 'clock out' to a header\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/103][PR]]!\n\n* [2019-10-31 Thu]\n\n** Fixed\n   - Keep all in-file settings and content lines from top of file\n     - Thank you [[https://github.com/andersjohansson][@andersjohansson]] for your [[https://github.com/200ok-ch/organice/pull/90][PR]]!\n\n* [2019-10-29 Tue]\n\n** Added\n   - Show login options as clickable links with cursor pointer\n   - Also improve wording with regards to login options\n     - Thank you [[https://github.com/rodrigomaia17][@rodrigomaia17]] for your [[https://github.com/200ok-ch/organice/pull/88][PR]]!\n\n\n* [2019-10-26 Sat]\n\n** Added\n   - *WebDAV as a sync backend!*\n     - Thank you [[https://github.com/TristanCacqueray][@TristanCacqueray]] for your [[https://github.com/200ok-ch/organice/pull/82][PR]]!\n\n   - As a user, when I swipe a header, I want the icon to contrast\n     the background, so that better see the action taken\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/78][PR]]!\n\n   - As a user, when I hover a clickable element, I want my cursor to\n   change, so that I can see that it is clickable.\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/79][PR]]!\n\n** Fixed\n   - Do not throw an error when clearing a planning item\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/81][PR]]!\n\n* [2019-10-02 Wed]\n\n** Fixed\n\n- On iOS 13, fix the regression which made capture input fields hide\n  under the keyboard\n  - More information and screenshots in the ticket: https://github.com/200ok-ch/organice/issues/46\n  - Turns out this issue is non trivial to fix and requires specific\n    rules for every size of iPhone. I tested against the Xs and 6s. If\n    you have a different form factor and the capture template input\n    screen looks off to you, please send me a screenshot of what it\n    looks like and I'll add the dimensions for your form factor right\n    away!\n\n* [2019-09-28 Sat]\n\n** Added\n\n- Implemented a =redo= Button next to the =undo= button\n\n* [2019-09-21 Sat]\n\n** Fixed\n\n- Parser bug which would interpret *bold* statements in the beginning\n  of a line as a header.\n- Parser bug which would delete newlines between headers and items\n\n** Changed\n\n- @MTrost [[https://github.com/200ok-ch/organice/pull/45][introduced]] a new testing library called [[https://testing-library.com/docs/intro][React Testing\n  Library]] which greatly simplified writing interaction tests.\n\n* [2019-09-19 Thu]\n\n** Changed\n\n- Constraining to a max width and centering for tablets and bigger\n\n* [2019-09-15 Sun]\n\n** Fixed\n\n- The 'Sync on application becoming visible' feature works on iOS and\n  Safari\n  - If enabled, the current org file is pulled from the sync backend\n    when the browser tab becomes visible. This prevents you from\n    having a stale file before starting to make changes to it.\n\n* [2019-09-08 Sun]\n** Added\n\n- Documented how to use organice from a bookmarklet using the capture\n  template feature\n\n* [2019-09-06 Fri]\n** Fixed\n\n- Removed Google Analytics tracking, because it has no place here\n\n* [2019-09-02 Mon]\n\n** Added\n\n- Configure Google Drive for the free community version of organice at\n  https://organice.200ok.ch\n- Documented SPA routing for self-hosting\n- Wrote and publicized a Privacy Policy\n\n* [2019-08-27 Tue]\n\n** Changed\n\n- Color scheme has been ported to the popular [[https://ethanschoonover.com/solarized/][Solarized]] (light mode)\n  - Whilst doing so, CSS variables have been introduced, so that\n    there's not a whole lot of repetition of magic rgb values going on\n  - The logo has been adapted, too\n- The landing page and settings screens have been de-cluttered\n\n* [2019-08-26 Mon]\n\n** Added\n\n- Continuous deployment: Merging to =master= triggers a build on CI\n  and when successful, it triggers a deploy to https://org.200ok.ch\n- Add a new temporary\u2122 logo: [[file:public/organice.png][organice.png]]\n\n* [2019-08-25 Sun]\n\n** Added\n\n- Since we want organice to be a community driven project, we have added:\n  - [[file:CODE_OF_CONDUCT.org][Code of conduct]]\n  - [[file:CONTRIBUTING.org][Contributing guidelines]]\n\n- Add [[https://circleci.com/][CircleCI]] to run the tests on every commit\n  - They are also integrated as a check for PRs with the benefit that\n    contributors get automated feedback by running the regression test\n    suite.\n\n- Add [[https://greenkeeper.io][Greenkeeper]] for automated dependency management\n\n- Add [[https://codeclimate.com][Codeclimate]] for automated maintainability analysis\n\n** Changed\n\n- Upgraded to Node 12.9\n\n* [2019-08-12 Mon]\n\n** Changed\n\n- The default keybindings (when used from a desktop browser) are now\n  more in line with the defaults in Emacs itself\n\n** Fixed\n\n- The keybindings work on non-macOS operating systems\n\n* [2019-08-10 Sat]\n\n** Added\n\n- As a user, when in a directory listing, I want the folders and files\n  to be sorted alphabetically. Furthermore, I only want to see files\n  that organice can open (that is org and org archive files).\n- Note: This is only implemented for the Dropbox back-end at this time.\n\n** Changed\n\n- Filters files from a directory listing down to org files.\n- Sorts folders atop of files.\n- Sorts both folders and files alphabetically.\n\n\n* [2019-08-05 Mon]\n\n** Added\n\n- When the browser tab becomes visible, pull the latest version of the\n  Org file\n  - This is rather helpful when the app is used in production. Since\n    the production build supports loading the complete application and\n    org-file from cache, it can be open for a very long time. When the\n    org-file hasn't been pulled in a \"very long time\"\u2122, then chances\n    are non-nil that the file has been changed by another client in\n    the meantime.\n  - Without this change, when the user opens the app after a while,\n    makes changes to the file and wants to sync to the back-end, there\n    might be the message \"Since you last pulled, a newer version of\n    the file has been pushed to the server.\". Now the user has two\n    conflicting versions of the same file and can only chose to keep\n    one (Which in itself is great UX and great error handling for\n    cases in which we do encounter a merge conflict, of course!).\n  - This situation is mitigated with this change. Now the user has the\n    option to enable \"Sync on application becoming visible\" which acts\n    similarly to \"Live Sync\". When the user opts to use this feature,\n    whenever the application gets pulled from the background or\n    started through the service worker, the first thing that happens\n    it that a new version of the org-file is pulled from the server.\n    It's therefore much harder for the user to create conflicts.\n\n* [2019-08-04 Sun]\n\n** Fixed\n\n- Parser doesn't break indentation of existing files in fewer places\n- Planning Items are formatted as in Emacs Org mode\n- Properties are formatted as in Emacs Org mode\n- Tags are formatted as in Emacs Org mode\n\n\n* [2019-08-03 Sat]\n\n** Added\n\n- Documented deployment options\n  - People have been asking for tighter access restrictions.\n  - Imo the best answer to that request is to make it as easy as\n    possible to host organice.\n  - There's myriads of good options, of course. I picked to document\n    two that will (potentially) be cost-free to the users and which\n    are very easy and quick to set up: Ftp and Heroku.\n\n** Fixed\n\n- Tests on =master= were red\n  - Partly due to obsolete tests\n  - Partly because tests weren't updated according to changes in the code\n".split("").map(e=>e.charCodeAt(0)),new Promise((e,t)=>{crypto.subtle?crypto.subtle.digest({name:"SHA-256"},new Uint8Array(n)).then(t=>{e(E.a.values(new Uint8Array(t)).join(""))}):(console.warn("crypto.subtle module is not available, returning an empty bogus hash."),e(""))})).then(t=>{e(t)})}),ee=(e,t)=>{const n=te(e,t);return{headerIndex:n,header:e.get(n)}},te=(e,t)=>e.findIndex(e=>e.get("id")===t),ne=(e,t)=>e.get(te(e,t)),ae=(e,t)=>{const n=e.get(t),a=e.slice(t+1).findIndex(e=>e.get("nestingLevel")<=n.get("nestingLevel"));return-1===a?[t+1,e.size]:[t+1,t+1+a]},re=(e,t)=>{const n=te(e,t);return ae(e,n)},se=(e,t)=>{let n=ae(e,t),a=Object(g.a)(n,2),r=a[0],s=a[1];return e.slice(r,s)},ie=(e,t)=>{let n=re(e,t),a=Object(g.a)(n,2),r=a[0],s=a[1];return e.slice(r,s)},oe=(e,t)=>ie(e,t).size,le=(e,t)=>{const n=ee(e,t),a=n.header;for(let r=n.headerIndex-1;r>=0;--r){const t=e.get(r);if(t.get("nestingLevel")===a.get("nestingLevel")-1)return t;if(t.get("nestingLevel")<a.get("nestingLevel"))return null}return null},ce=(e,t)=>{const n=ee(e,t),a=n.header,r=n.headerIndex,s=e.slice(0,r).findLast(e=>e.get("nestingLevel")<a.get("nestingLevel"));return s?s.get("id"):null},de=(e,t,n)=>{const a=e.getIn([t,"propertyListItems"]).find(e=>e.get("property")===n);if(a)return a.get("value");const r=ce(e,e.getIn([t,"id"]));if(r){const t=te(e,r);return de(e,t,n)}return null},he=(e,t)=>{const n=ce(e,t);if(!n)return!0;const a=ne(e,n);return a.get("opened")&&he(e,a.get("id"))},ue=(e,t)=>{const n=((e,t)=>{const n=le(e,t);return n?n.get("id"):null})(e.get("headers"),t);if(null!==n){const t=te(e.get("headers"),n);e=e.setIn(["headers",t,"opened"],!0)}return e},pe=e=>{let t=[];for(let n=0;n<e.size;++n){const a=e.get(n);if(!a.get("opened"))continue;const r=a.getIn(["titleLine","rawTitle"]),s=ie(e,a.get("id")),i=pe(s);i.length>0?i.forEach(e=>{t.push([r].concat(e))}):t.push([r]),n+=s.size}return t},ge=(e,t)=>{if(0===t.size)return null;const n=e.find(n=>null===ce(e,n.get("id"))&&n.getIn(["titleLine","rawTitle"]).trim()===Z(t.first())[0].trim());if(!n)return null;if(1===t.size)return n;const a=ie(e,n.get("id"));return ge(a,t.rest())},me=(e,t,n=1)=>{if(0===t.size)return e;const a=t.first(),r=e.findIndex(e=>{const t=e.getIn(["titleLine","rawTitle"]),r=e.get("nestingLevel");return t===a&&r<=n});if(-1===r)return e;e=e.update(r,e=>e.set("opened",!0));let s=ie(e,e.getIn([r,"id"]));return s=me(s,t.rest(),n+1),e=e.take(r+1).concat(s).concat(e.takeLast(e.size-(r+1+s.size)))},fe=(e,t)=>e.get("contents").some(e=>e.get("contents").some(e=>e.get("id")===t)),be=(e,t)=>e.filter(e=>["table","list"].includes(e.get("type"))).some(e=>"table"===e.get("type")?fe(e,t):e.get("items").some(e=>be(e.get("contents"),t))),ye=(e,t)=>e.find(e=>be(e.get("description"),t)),Ee=(e,t)=>e.map((e,n)=>"timestamp"===e.get("type")&&e.get("id")===t?{path:[n],timestampPart:e}:"list"===e.get("type")?e.get("items").map((e,a)=>{let r=Ee(e.get("contents"),t);if(r){const e=r.path,t=r.timestampPart;return{path:[n,"items",a,"contents"].concat(e),timestampPart:t}}{let r=Ee(e.get("titleLine"),t);if(r){const e=r.path,t=r.timestampPart;return{path:[n,"items",a,"titleLine"].concat(e),timestampPart:t}}return null}}).filter(e=>e).first():"table"===e.get("type")?e.get("contents").map((e,a)=>e.get("contents").map((e,r)=>{const s=Ee(e.get("contents"),t);if(s){const e=s.path,t=s.timestampPart;return{path:[n,"contents",a,"contents",r,"contents"].concat(e),timestampPart:t}}return null}).filter(e=>e).first()).filter(e=>e).first():null).filter(e=>e).first(),we=(e,t)=>e.map((e,n)=>"list"===e.get("type")?e.get("items").map((e,a)=>{if(e.get("id")===t)return{path:[n,"items",a],listItemPart:e};{const r=we(e.get("contents"),t);if(r){const e=r.path,t=r.listItemPart;return{path:[n,"items",a,"contents"].concat(e),listItemPart:t}}return null}}).filter(e=>e).first():null).filter(e=>e).first(),Te=(e,t)=>e.map((e,n)=>"table"===e.get("type")?fe(e,t)?{path:[n],tablePart:e}:null:"list"===e.get("type")?e.get("items").map((e,a)=>{const r=Te(e.get("contents"),t);if(r){const e=r.path,t=r.tablePart;return{path:[n,"items",a,"contents"].concat(e),tablePart:t}}return null}).filter(e=>e).first():null).filter(e=>e).first(),ve=(e,t)=>{const n=(e,t,n)=>({path:[e,...n].concat(t.path),timestampPart:t.timestampPart});return e.map((e,a)=>{let r=["titleLine","title"],s=Ee(e.getIn(r),t);return s?n(a,s,r):(r=["description"],s=Ee(e.getIn(r),t),s?n(a,s,r):(r=["logNotes"],s=Ee(e.getIn(r),t),s?n(a,s,r):(s=e.get("propertyListItems").map((e,s)=>{if(!e.get("value"))return null;const i=Ee(e.get("value"),t);return r=["propertyListItems",s,"value"],i?n(a,i,r):null}).filter(e=>e).first(),s||null)))}).filter(e=>e).first()},ke=(e,t,n)=>{const a=((e,t)=>e.map((e,n)=>{const a=Te(e.get("description"),t);if(!a)return null;const r=a.path,s=a.tablePart;return{path:[n,"description"].concat(r),tablePart:s}}).filter(e=>e).first())(e,t),r=a.path,s=a.tablePart,i=s.get("contents").findIndex(e=>e.get("contents").some(e=>e.get("id")===t)),o=s.getIn(["contents",i,"contents"]).findIndex(e=>e.get("id")===t);return e.updateIn(r.concat(["contents"]),n(i,o))},_e=(e,t)=>{if(!e)return null;const n=Ee(e,t);return n?n.timestampPart:null},Se=e=>Object(T.a)(e,{addSuffix:!0}),Ie=(e,t)=>e.find(e=>e.get("keywords").contains(t))||e.first(),Oe=e=>e.flatMap(e=>e.getIn(["titleLine","tags"])).toSet().sort(),De=e=>e.map(e=>e.get("propertyListItems").map(e=>{const t=e.get("property"),n=e.get("value");return[t,J(n)]})).filter(e=>!e.isEmpty()).flatten(),Ce=e=>e.map(([e])=>e).toSet().sort(),Ae=(e,t)=>e.filter(([e])=>e.toLowerCase()===t.toLowerCase()).map(([e,t])=>t).toSet().sort(),Ne=e=>e.get("rawDescription")||!e.get("planningItems").isEmpty()||!e.get("propertyListItems").isEmpty()||!e.get("logNotes").isEmpty()||!e.get("logBookEntries").isEmpty(),Pe=e=>t=>e.some(e=>e.get("completedKeywords").includes(t)),Re=e=>!e.get("type").startsWith("TIMESTAMP_"),Le=e=>Re(e)?e.get("type"):"TIMESTAMP",xe=/\.org(_archive)?$/,Me=(e,t,n)=>{const a=le(e,n);return a?(t.unshift(a.get("titleLine").get("rawTitle")),Me(e,t,a.get("id"))):t},Fe=(e,t)=>{const n=e.get(t);let a;return a=t.startsWith("organice_internal_")?t.substring("organice_internal_".length):t.endsWith(".org")?t.substring(t.lastIndexOf("/")+1,t.lastIndexOf(".")):t.substring(t.lastIndexOf("/")+1),e=>{let t=(r=n,s=e.get("id"),Me(r,[],s));var r,s;t.unshift(a);const i=Math.max(3,Math.floor((80-3*t.length)/t.length));return t=t.map(e=>e.length>i?e.substr(0,i-2)+"..":e),t.join(" > ")}},He=e=>({type:"SET_LOADING_MESSAGE",loadingMessage:e}),je=()=>({type:"HIDE_LOADING_MESSAGE"}),Be=(e,t)=>({type:"SET_IS_LOADING",isLoading:e,path:t}),We=e=>({type:"SET_IS_ONLINE",online:e}),Ue=(e,t)=>n=>{n(He(e)),setTimeout(()=>n(je()),t)},Ve=e=>({type:"SET_LAST_VIEWED_FILE",lastViewedPath:e}),Ge=(e,t)=>n=>{n(Ve(t));n(tr("organice_internal_"+e,{changelog:"# organice will not reflow if there's hard-wrapped content\n# -*- eval: (auto-fill-mode 0) -*-\n\n* General\n\nAll user visible changes to organice will be documented in this file.\n\nWhen there are updates to the changelog, you will be notified and see a 'gift' icon appear on the top right corner.\n\n* [2021-05-16 Sun]\n** Added\n   - Parse and preserve habit timestamp ranges\n     - A timestamp may have minimum and maximum ranges specified by using the syntax =.+2d/3d=, which says that you want to do the task at least every three days, but at most every two days.\n     - Upstream documentation:\n       https://orgmode.org/manual/Tracking-your-habits.html\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/674\n     - Thank you [[https://github.com/tomonacci][tomonacci]] for the PR\ud83d\ude4f\n\n* [2021-05-13 Thu]\n\n** Changed\n   - Agenda starts on Monday by default (as it does in Emacs Org mode)\n\n** Added\n   - Ability to set the \"Start of week for weekly agenda\" in the Settings\n     - Akin to the Emacs org mode variable =org-agenda-start-on-weekday=\n   - Relevant PRs:\n     - https://github.com/200ok-ch/organice/pull/676\n       - Thank you [[https://github.com/tomonacci][tomonacci]] for the PR\ud83d\ude4f\n     - https://github.com/200ok-ch/organice/pull/677\n\n* [2020-12-29 Tue]\n** Added\n   - *EPIC*: Multiple file support\n     - Agenda, Search, Task List, Refile and Capture Templates have the ability to work on multiple files.\n     - You can adjust the behavior for these on a file per file basis by creating \"file settings\" in the settings menu.\n\n   - *EPIC*: Offline file support\n     - Every file opened in organice will automatically be cached on your device.\n     - When visiting the file, again, it will immediately be loaded from the local storage and then loaded from the remote back-end.\n     - That makes loading and switching between files instant _and_ gives you the ability to work on multiple files when being offline.\n\n   - Relevant PRs:\n     - https://github.com/200ok-ch/organice/pull/550\n     - https://github.com/200ok-ch/organice/pull/560\n     - https://github.com/200ok-ch/organice/pull/565\n     - https://github.com/200ok-ch/organice/pull/574\n     - https://github.com/200ok-ch/organice/pull/575\n     - https://github.com/200ok-ch/organice/pull/570\n     - https://github.com/200ok-ch/organice/pull/607\n\n* [2020-11-21 Sat]\n\n** Added\n   - When going to the Agenda view, the selected tab is persisted - meaning it will be pre-selected when you go to the Agenda next time.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/562\n\n** Fixed\n   - Having an active timestamp with a repeater was broken.\n     - When the TODO state changes for a header that has a repeater (either as SCHEDULED, DEADLINE or active timestamp), a log entry is written and the timestamp is updated.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/568\n   - Removing an active timestamp was broken.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/568\n\n* [2020-11-20 Fri]\n** Fixed\n   - organice understands =:PROPERTIES:= drawers and smartly parses the values in case one of the values is a timestamp.\n     - However, parsing all the values and saving the parsed result in any case will lead to wrong results. Most values of properties are just plain text and non-interactive things in Org mode.\n     - For example, a value like =something_with_underscores= would have been treated as 'underlined text' which doesn't make sense for a property drawer. When saving the value back, organice would have squashed the underlines.\n     - Now, the values are used and preserved as they are. Timestamps still work, of course.\n     - Relevant PR: https://github.com/200ok-ch/organice/pull/578\n* [2020-11-15 Sun]\n** Fixed\n   - When repeating a task, an active date timestamp was logged instead of an inactive datetime timestamp.\n\n* [2020-11-14 Sat]\n** Fixed\n   - The task list was not scrollable on Android.\n      - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/561][PR]] \ud83d\ude4f\n\n* [2020-11-08 Sun]\n** Changed\n   - Safeguard against selecting text by accident.\n      - Before this change, it was possible to select text when doing a 'swipe'.\n      - Now, selecting/copying text is only possible in 'edit mode', effectively safeguarding against accidentally selecting text.\n      - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/557][PR]] \ud83d\ude4f\n\n\n* [2020-11-06 Fri]\n** Added\n   - Additional themes. You now can choose between:\n     - Solarized\n     - One\n     - Gruvbox\n     - Smyck\n     - Code\n   - All of these are themes work in light and dark mode!\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/540][PR]] \ud83d\ude4f\n\n* [2020-11-01 Sun]\n\n** Changed\n   - We have enabled some default settings by default, because they are reasonable for a new user:\n     - =shouldStoreSettingsInSyncBackend=, because it enables using organice on multiple clients.\n     - =shouldLiveSync=, because it reduces the chance to have a conflict in the open Org file.\n     - =shouldSyncOnBecomingVisibile=, because it reduces the chance to have a conflict in the open Org file.\n   - =bulletStyle= is set to \"Fancy\", because it looks more visually pleasing than an asterisk (*) and hence makes organice look better on a first test run.\n   - If you personally do not want them enabled, you can disable them separately in the [[/settings][settings]] any time.\n\n** Fixed\n   - organice has various settings that the user can configure. Before manual configuration, there organice loads sane defaults. Loading and persisting some of these defaults was buggy before.\n     - Loading and persisting of defaults works now.\n     - Previously saved wrong values are removed from =localStorage= to reduce future bug potential.\n     - Changing this is - strictly speaking - not visible to the end-user, so it wouldn't ordinarily show up in this changelog. However, since it makes changes to the already saved settings (in cleaning up old faulty values), it theoretically could introduce a bug in the settings. Hence, the change is added to the changelog.\n     - Related PRs:\n       - https://github.com/200ok-ch/organice/pull/552\n       - https://github.com/200ok-ch/organice/pull/553\n       - https://github.com/200ok-ch/organice/pull/554\n* [2020-10-25 Sun]\n** Changed\n   - The 'focus header' feature is renamed.\n     - /Narrowing/ means focusing on this header, making the rest temporarily inaccessible.\n     - Canceling the narrowing, which makes all headers once again accessible, is called /widening/.\n* [2020-10-23 Fri]\n** Added\n   - Add 'dark mode' next to 'light mode' as a setting.\n     - Both themes are based on the popular [[https://ethanschoonover.com/solarized/][Solarized]] color palette.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/527][PR]] \ud83d\ude4f\n   - Add 'recursive clock times in search'.\n     - The =clock:= search term now includes headers that have time logged on their children.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/524][PR]] \ud83d\ude4f\n\n* [2020-10-20 Tue]\n** Added\n   - Add 'time range' queries to search for planning items (SCHEDULED and DEADLINE), plain active timestamps or clocked work time.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/505][PR]] \ud83d\ude4f\n* [2020-10-19 Mon]\n** Added\n   - When a header is focused, and the user uses the 'search' or 'task list' feature, then the searched header list is automatically narrowed to only subheaders of the originally focused header.\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/517][PR]] \ud83d\ude4f\n* [2020-10-10 Sat]\n** Added\n   - Display time summaries for clock entries in each subtree\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/497][PR]] \ud83d\ude4f\n\n** Changed\n\n   - Improve header stickiness\n     - The header bar was not always sticky for longer documents and the therefore some functionality was hard to reach (the user had to scroll to the top to reach it).\n     - Thank you [[https://github.com/tarnung][tarnung]] for your [[https://github.com/200ok-ch/organice/pull/499][PR]] \ud83d\ude4f\n\n* [2020-10-07 Wed]\n** Added\n\n   - Added Documentation on [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]] to =sample.org= and to mouseovers for the relevant buttons.\n\n* [2020-09-20 Sun]\n** Added\n\n   - Recognize US and Swiss phone numbers and make them clickable\n   - Next to 'canonical' phone numbers like +49123456789, also recognize:\n     - US phone numbers:\n       - 123-456-7890\n       - (123) 456-7890\n       - 123 456 7890\n       - 123.456.7890\n       - +91 (123) 456-7890\n     - Swiss phone numbers:\n       - 0783268674\n       - 078 326 86 74\n       - 041783268675\n       - 0041783268674\n       - +41783268676\n       - +41783268677\n\n* [2020-09-07 Mon]\n** Added\n   - Added the capability to chose the start screen when installing organice to the homescreen.\n     - More information on how to install organice like this, see https://organice.200ok.ch/documentation.html#installation\n* [2020-09-05 Sat]\n\n** Fixed\n  - Search and Todo List modals could be moved off screen on iOS since [2020-08-30 Sun]. The fix is to disable =autoFocus= on iOS. The rationale for that documented here: https://github.com/200ok-ch/organice/pull/462\n\n* [2020-08-30 Sun]\n\n** Added\n   - Add note to header (=M-x org-add-note=)\n     - This adds a button for taking notes to tasks (org-add-note). They will be prepended to the header contents after :PROPERTIES: and before the :LOGBOOK:\n   - Auto-focus filter input fields (search and task-list)\n\n* [2020-08-29 Sat]\n** Fixed\n   - If a user folds a header, all its subheaders should collapse as well, so that when the user reopens it, they stay closed.\n     - The previous behavior is buggy in a way that it keeps the subheaders open as they were, restoring their openness when the header is unfolded.\n     - The previous behavior is useful, though. So this change introduces a user setting to toggle the behaviour.\n   - Thank you [[https://github.com/necto][necto]] for your [[https://github.com/200ok-ch/organice/pull/440][PR]] \ud83d\ude4f\n\n* [2020-08-25 Tue]\n** Fixed\n   - Updating table cell values and removing table rows or colums was\n     not undoable\n     - Thank you [[https://github.com/necto][necto]] for your [[https://github.com/200ok-ch/organice/pull/432][PR]] \ud83d\ude4f\n\n* [2020-07-28 Tue]\n** Fixed\n   1. Sync stuck when working in the background\n     - When the user put organice into the background during a sync and comes back, organice was stuck in sync mode, but doesn't actually sync anymore. This means that any new changes to the Org file will not be persisted. This is due to mobile browsers cutting off most resources to browser apps in the background, so organice cannot guarantee that a sync happens properly in the background.\n     - It's not trivial to find out if the job is stuck\n       - Time is not a good indicator as bigger files on slower connections will always take longer.\n       - There's no JS API to reliably find out if the browser just got back from the background or is put into the foreground. The [[https://developer.mozilla.org/en-US/docs/Web/API/Page_Visibility_API][=visibilitychange= API]] just triggers for both these events.\n     - Hence, the implementation is generic in nature: Whenever the user hits the 'sync' button, an actual 'sync' is forced - even if organice thinks there's currently a sync in progress or that it should be debounced. That makes sense, because manual actions by the user should always be obeyed.\n     - Closes issue https://github.com/200ok-ch/organice/issues/252\n   - 2. On iOS >13.1, when organice is used in SPA mode (as a bookmark on the homescreen), and the user navigates away from the original bookmark, a huge URL Bar would show up with a \"Done\" button. This is a regression in how iOS handles full-screen SPAs. These are the relevant APIs:\n     - https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html\n     - https://developer.mozilla.org/en-US/docs/Web/Manifest/display\n   - 3. Feature detection for =crypto.subtle= module\n     - This is used for change detection in the changelog. The module is only available in secure contexts. Hence, when used locally and on a private IP range, depending on the browser, it might not be available.\n\n* [2020-07-08 Wed]\n** Added\n   - Allow template-variables in the header-path in a capture template\n     - Thank you [[https://github.com/jayesh-bhoot][jayesh-bhoot]] for your [[https://github.com/200ok-ch/organice/pull/387/][PR]] \ud83d\ude4f\n* [2020-06-14 Sun]\n** Added\n   - Allow capture templates to insert at beginning or end of file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/324][PR]] \ud83d\ude4f\n* [2020-06-05 Fri]\n** Fixed\n   - =file:= links are sanity checked before opened\n     - =file:= links opened in iOS from the PWA view will not open Mobile Safari\n     - Open issue: Some links will be opened as directories when the\n       link is not really going towards a directory.\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/311][PR]] \ud83d\ude4f\n\n* [2020-06-03 Wed]\n** Added\n   - =TODO= keyword sets can now be anywhere in the file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/310][PR]] \ud83d\ude4f\n* [2020-05-30 Sat]\n\n** Added\n   - Make local =file:...= links navigate to the relevant file\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/307][PR]] \ud83d\ude4f\n\n* [2020-05-06 Wed]\n\n** Fixed\n   - Planning items now respect the new hard-indent setting.\n\n* [2020-05-05 Tue]\n\n** Fixed\n   - Append new tags correctly to title.\n     - If a header didn't have tags before, the first tags were\n       erroneously appended without a space.\n\n* [2020-04-06 Mon]\n\n** Added\n   - Support org-adapt-indentation\n     - By default, the metadata body (including deadlines and drawers) of an exported org heading is indented according to its level. If instead you prefer to keep your body text flush-left, i.e.{' '}\n     - Thank you [[https://github.com/cpbotha][cpbotha]] for your [[https://github.com/200ok-ch/organice/pull/272][PR]] \ud83d\ude4f\n\n* [2020-04-05 Sun]\n** Added\n   - Support for org-log-into-drawer TODO state logging\n     - Thank you [[https://github.com/cpbotha][cpbotha]] for your [[https://github.com/200ok-ch/organice/pull/271][PR]] \ud83d\ude4f\n** Fixed\n   - Settings screen has proper title and \"back\" button\n\n* [2020-03-27 Fri]\n** Fixed\n   - Help texts for widen/narrow were reversed\n     - Thank you [[https://github.com/obar][@obar]] for the [[https://github.com/200ok-ch/organice/pull/270][PR]] \ud83d\ude4f\n\n* [2020-02-29 Sat]\n\n** Fixed\n   - As a user, when I visit Search, Task List or Agenda whilst having\n     a dirty file, I'm not getting a pop up a dialogue notifying me\n     about unpushed changes\n\n* [2020-02-17 Mon]\n\n** Added\n   - *Headers with active timestamps in the header or description appear in agenda*\n\n** Fixed\n   - 'Insert timestamp' for headers and descriptions\n\n* [2020-02-09 Sun]\n\n** Added\n   - Comprehensive documentation: https://organice.200ok.ch/documentation.html\n     - You can find the link from the 'settings' screen or on top of\n       the readme.\n\n* [2020-01-27 Mon]\n\n** Fixed\n   - When editing a =:LOGBOOK:= drawer within a headers description,\n     the relevant logbook entries are updated (which might entail them\n     being deleted).\n\n* [2020-01-20 Mon]\n\n** Fixed\n   - When refiling a header, don't show subheaders in the refile drawer\n   - When doing a 'Search' or 'Refile', the action is reflected in the\n     name of the opening drawer.\n   - In the agenda view, fix relative time distance for future dates\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/240][PR]] \ud83d\ude4f\n\n* [2020-01-15 Wed]\n\n** Fixed\n   - Put Floating Action Button \"Move a header\" into the middle of the\n     screen, so that it has enough space to render all arrows on\n     mobile devices.\n\n* [2020-01-14 Tue]\n\n** Added\n   - Notify on changes for changelog\n     - This is done with a similar UX than other productivity apps\n       (like Slack) do it. The user will see a 'gift' icon whenever\n       there's a change to the changelog she has not seen, yet.\n\n* [2020-01-13 Mon]\n\n** Added\n   - \"Show Org filename in Header\" is configurable in settings and\n     off by default\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/229][PR]] \ud83d\ude4f\n\n** Fixed\n   - Show error message when using a capture template with a badly\n     configured header path\n\n* [2020-01-12 Sun]\n\n** Added\n   - Make HeaderBar sticky\n     - Making undo/redo, file browser and help always available\n       (before it was required to scroll all the way to the top)\n   - Deselect headline by clicking into the title (or empty space) in\n     the HeaderBar\n   - Show Org filename in Header\n\n** Fixed\n   - *Major synchronization improvements*\n     1. After undo/redo, synchronize Org file\n     2. Debounce Sync\n        1. When a user changes things quickly (which happens easily\n           when having 'live sync' enabled and using undo/redo for\n           example), multiple syncs ran in parallel. The back-ends\n           will either get confused or fail with errors (429 too many\n           write operations). In any case, likely the last written\n           state would not have been the state of the Org file in\n           organice.\n     3. Safeguard against concurrent sync requests to the back-end\n     4. In case of synchronization error, show the error to the user\n        and retry synchronization\n     5. Don't actually sync a whole Org file for an empty header.\n        When the user adds some data and triggers\n        UPDATE_HEADER_TITLE, then it makes sense to save it.\n\n* [2020-01-11 Sat]\n\n** Added\n   - All HeaderActionItems are undoable and redoable\n\n** Fixed\n   - Parsing planning items followed by a checkbox\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/222/files][PR]] \ud83d\ude4f\n* [2020-01-07 Tue]\n\n** Added\n   - *Refile*\n     - When reviewing the captured data, you may want to refile or to\n       copy some of the entries into a different list, for example\n       into a project.\n   - Add button in HeaderActionBar to open property editor\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/195][PR]] \ud83d\ude4f\n\n** Changed\n   - All HeaderActionDrawer actions have icons. The icons are\n     documented in sample.org and have a mouseover title.\n\n* [2020-01-04 Sat]\n\n** Added\n   - Ability to search headlines\n     - It has the same syntax as the search field in the Task List\n       feature\n\n** Fixed\n   - Sort order in Task List\n     - Tasks were only ordered by their planning item dates. This\n       implied that tasks that were long DONE would be shown first.\n     - Now, tasks in the Task list are sorted by state and then date.\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/207][PR]] \ud83d\ude4f\n\n\n* [2020-01-02 Thu]\n\n** Added\n   - Place cursor after the TODO keyword when creating a new header\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/193][PR]] \ud83d\ude4f\n   - Highlight verbatim markup\n\n** Changes\n   - Highlight cookies and cookie percentages according to Solarized\n     color scheme\n\n** Fixed\n   - Don't update search results when using an invalid search filter\n   - On mobile: Styling of Search / Task List drawer when searching all\n     headlines\n   - On mobile: Ability to scroll Search / Task List\n   - Teach #+TODO parser to understand (..) suffix\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/202][PR]] \ud83d\ude4f\n\n* [2020-01-01 Wed]\n\n** Added\n   - Support single- and double-quoted strings in the search filter\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/176][PR]] \ud83d\ude4f\n   - Trim whitespace for entered or updated headlines\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/177][PR]] \ud83d\ude4f\n\n** Fixed\n   - Capture templates in iOS 13.3 are positioned properly\n     - iOS 13 introduced a styling regression when setting focus\n       without user interaction. iOS 13.3 reverts to the way other\n       browsers do it.\n\n** Changed\n   - Revert \"Move HeaderActionDrawer before headline\"\n     - As per #188, the changes introduced in #100 didn't fare well\n       with the community. Hence, as a first step to improve UX,\n       we're reverting to the previous state.\n\n* [2019-12-31 Tue]\n\n** Added\n   - *Searching of headlines/todos with a composable query language*\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/154][PR]] \ud83d\ude4f\n   - Routing for Settings (/settings) and Sample (/sample)\n   - Routing for Agenda and TaskList\n\n** Changes\n   - The action for capture templates now uses a more idiomatic\n     'plus' icon instead of a 'list' icon\n\n* [2019-12-28 Sat]\n\n** Added\n   - Proper coloring of DONE todoKeywords from custom todo sequences\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/165][PR]]!\n   - Place TODO keyword of previous header in the new header\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/164][PR]]!\n\n** Changed\n   - Refactor current Org parser and regex\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/161][PR]]!\n\n* [2019-12-26 Thu]\n\n** Added\n\n   - \"Share\" button for headlines (sharing via email)\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/145][PR]]!\n   - Automatically render links for URLs with www prefix, but without\n     protocol\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/159][PR]]!\n\n* [2019-12-25 Wed]\n\n** Added\n\n   - Suggestion list for inputs in property editor\n     - To minimize typing and typos, add smart completion for property\n       names and values in the PropertyListEditorModal.\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/144][PR]]!\n\n* [2019-12-24 Tue]\n** Added\n\n   - *Automatically render links for URLs, e-mail addresses and phone\n     numbers*\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/147][PR]]!\n\n   - Suggestion list for inputs in tag editor\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/149][PR]]!\n\n* [2019-12-17 Tue]\n** Changed\n   - Improve webdav url input\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/139][PR]]!\n** Fixed\n   - Make \"privacy policy\" sticky to the bottom of the landing page\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/140][PR]]!\n\n* [2019-12-15 Sun]\n\n** Changed\n   - UX: Move Org header actions before selected headline\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/136][PR]]!\n\n** Fixed\n   - Android PWA implementation was broken (issue [[https://github.com/200ok-ch/organice/issues/134][#134]])\n     - It required two more icon sizes\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/135][PR]]!\n\n* [2019-12-10 Tue]\n\n** Added\n\n   - *Docker Support*\n   - The CI/CD workflow now also builds a Docker container which is\n     then published to\n     https://hub.docker.com/repository/docker/twohundredok/organice\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/133][PR]]!\n\n* [2019-12-08 Sun]\n\n** Added\n\n   - As a user, when I'm on a headline with a planning item (schedule\n     or deadline), I want to be able to remove it.\n\n* [2019-11-29 Fri]\n\n** Fixed\n\n   - Clicking the Timestamp in a TODO within the agenda toggles from\n     the date to a human readable timespan\n\n* [2019-11-27 Wed]\n\n** Added\n\n   - Instructions on configuring Nextcloud+haproxy to allow WebDAV\n   - Documentation on how to share from Nextcloud using WebDAV\n   - Thank you [[https://github.com/runejuhl][runejuhl]] for your [[https://github.com/200ok-ch/organice/pull/122][PR]]!\n\n* [2019-11-25 Mon]\n\n** Added\n   - Honor the 'nologrepeat' option\n     - It can be set via =#+STARTUP:= or as a property\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/119][PR]]!\n\n* [2019-11-22 Fri]\n\n** Fixed\n\n   - Handle non-clock entries in =:LOGBOOK:= drawers\n     - Fixes [[https://github.com/200ok-ch/organice/issues/111][issue #111]], [[https://github.com/200ok-ch/organice/issues/108][issue #108]] and [[https://github.com/200ok-ch/organice/issues/110][issue #110]]\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/112][PR]]!\n\n* [2019-11-21 Thu]\n\n** Fixed\n\n   - Safeguard against potential Dropbox SDK Bug\n     - More information in [[https://github.com/200ok-ch/organice/issues/108][issue #108]]\n\n* [2019-11-19 Tue]\n\n** Changed\n\n   - Don't put newlines after headers with no content, add newline at EOF\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/106][PR]]!\n\n* [2019-11-14 Thu]\n\n** Added\n\n   - *Clocking work time*\n     - Org mode allows you to clock the time you spend on specific\n       tasks in a project:\n       https://orgmode.org/manual/Clocking-Work-Time.html#Clocking-Work-Time\n     - organice is compatible with logbook clocking, now\n     - You can 'clock in' and 'clock out' to a header\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/103][PR]]!\n\n* [2019-10-31 Thu]\n\n** Fixed\n   - Keep all in-file settings and content lines from top of file\n     - Thank you [[https://github.com/andersjohansson][@andersjohansson]] for your [[https://github.com/200ok-ch/organice/pull/90][PR]]!\n\n* [2019-10-29 Tue]\n\n** Added\n   - Show login options as clickable links with cursor pointer\n   - Also improve wording with regards to login options\n     - Thank you [[https://github.com/rodrigomaia17][@rodrigomaia17]] for your [[https://github.com/200ok-ch/organice/pull/88][PR]]!\n\n\n* [2019-10-26 Sat]\n\n** Added\n   - *WebDAV as a sync backend!*\n     - Thank you [[https://github.com/TristanCacqueray][@TristanCacqueray]] for your [[https://github.com/200ok-ch/organice/pull/82][PR]]!\n\n   - As a user, when I swipe a header, I want the icon to contrast\n     the background, so that better see the action taken\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/78][PR]]!\n\n   - As a user, when I hover a clickable element, I want my cursor to\n   change, so that I can see that it is clickable.\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/79][PR]]!\n\n** Fixed\n   - Do not throw an error when clearing a planning item\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/81][PR]]!\n\n* [2019-10-02 Wed]\n\n** Fixed\n\n- On iOS 13, fix the regression which made capture input fields hide\n  under the keyboard\n  - More information and screenshots in the ticket: https://github.com/200ok-ch/organice/issues/46\n  - Turns out this issue is non trivial to fix and requires specific\n    rules for every size of iPhone. I tested against the Xs and 6s. If\n    you have a different form factor and the capture template input\n    screen looks off to you, please send me a screenshot of what it\n    looks like and I'll add the dimensions for your form factor right\n    away!\n\n* [2019-09-28 Sat]\n\n** Added\n\n- Implemented a =redo= Button next to the =undo= button\n\n* [2019-09-21 Sat]\n\n** Fixed\n\n- Parser bug which would interpret *bold* statements in the beginning\n  of a line as a header.\n- Parser bug which would delete newlines between headers and items\n\n** Changed\n\n- @MTrost [[https://github.com/200ok-ch/organice/pull/45][introduced]] a new testing library called [[https://testing-library.com/docs/intro][React Testing\n  Library]] which greatly simplified writing interaction tests.\n\n* [2019-09-19 Thu]\n\n** Changed\n\n- Constraining to a max width and centering for tablets and bigger\n\n* [2019-09-15 Sun]\n\n** Fixed\n\n- The 'Sync on application becoming visible' feature works on iOS and\n  Safari\n  - If enabled, the current org file is pulled from the sync backend\n    when the browser tab becomes visible. This prevents you from\n    having a stale file before starting to make changes to it.\n\n* [2019-09-08 Sun]\n** Added\n\n- Documented how to use organice from a bookmarklet using the capture\n  template feature\n\n* [2019-09-06 Fri]\n** Fixed\n\n- Removed Google Analytics tracking, because it has no place here\n\n* [2019-09-02 Mon]\n\n** Added\n\n- Configure Google Drive for the free community version of organice at\n  https://organice.200ok.ch\n- Documented SPA routing for self-hosting\n- Wrote and publicized a Privacy Policy\n\n* [2019-08-27 Tue]\n\n** Changed\n\n- Color scheme has been ported to the popular [[https://ethanschoonover.com/solarized/][Solarized]] (light mode)\n  - Whilst doing so, CSS variables have been introduced, so that\n    there's not a whole lot of repetition of magic rgb values going on\n  - The logo has been adapted, too\n- The landing page and settings screens have been de-cluttered\n\n* [2019-08-26 Mon]\n\n** Added\n\n- Continuous deployment: Merging to =master= triggers a build on CI\n  and when successful, it triggers a deploy to https://org.200ok.ch\n- Add a new temporary\u2122 logo: [[file:public/organice.png][organice.png]]\n\n* [2019-08-25 Sun]\n\n** Added\n\n- Since we want organice to be a community driven project, we have added:\n  - [[file:CODE_OF_CONDUCT.org][Code of conduct]]\n  - [[file:CONTRIBUTING.org][Contributing guidelines]]\n\n- Add [[https://circleci.com/][CircleCI]] to run the tests on every commit\n  - They are also integrated as a check for PRs with the benefit that\n    contributors get automated feedback by running the regression test\n    suite.\n\n- Add [[https://greenkeeper.io][Greenkeeper]] for automated dependency management\n\n- Add [[https://codeclimate.com][Codeclimate]] for automated maintainability analysis\n\n** Changed\n\n- Upgraded to Node 12.9\n\n* [2019-08-12 Mon]\n\n** Changed\n\n- The default keybindings (when used from a desktop browser) are now\n  more in line with the defaults in Emacs itself\n\n** Fixed\n\n- The keybindings work on non-macOS operating systems\n\n* [2019-08-10 Sat]\n\n** Added\n\n- As a user, when in a directory listing, I want the folders and files\n  to be sorted alphabetically. Furthermore, I only want to see files\n  that organice can open (that is org and org archive files).\n- Note: This is only implemented for the Dropbox back-end at this time.\n\n** Changed\n\n- Filters files from a directory listing down to org files.\n- Sorts folders atop of files.\n- Sorts both folders and files alphabetically.\n\n\n* [2019-08-05 Mon]\n\n** Added\n\n- When the browser tab becomes visible, pull the latest version of the\n  Org file\n  - This is rather helpful when the app is used in production. Since\n    the production build supports loading the complete application and\n    org-file from cache, it can be open for a very long time. When the\n    org-file hasn't been pulled in a \"very long time\"\u2122, then chances\n    are non-nil that the file has been changed by another client in\n    the meantime.\n  - Without this change, when the user opens the app after a while,\n    makes changes to the file and wants to sync to the back-end, there\n    might be the message \"Since you last pulled, a newer version of\n    the file has been pushed to the server.\". Now the user has two\n    conflicting versions of the same file and can only chose to keep\n    one (Which in itself is great UX and great error handling for\n    cases in which we do encounter a merge conflict, of course!).\n  - This situation is mitigated with this change. Now the user has the\n    option to enable \"Sync on application becoming visible\" which acts\n    similarly to \"Live Sync\". When the user opts to use this feature,\n    whenever the application gets pulled from the background or\n    started through the service worker, the first thing that happens\n    it that a new version of the org-file is pulled from the server.\n    It's therefore much harder for the user to create conflicts.\n\n* [2019-08-04 Sun]\n\n** Fixed\n\n- Parser doesn't break indentation of existing files in fewer places\n- Planning Items are formatted as in Emacs Org mode\n- Properties are formatted as in Emacs Org mode\n- Tags are formatted as in Emacs Org mode\n\n\n* [2019-08-03 Sat]\n\n** Added\n\n- Documented deployment options\n  - People have been asking for tighter access restrictions.\n  - Imo the best answer to that request is to make it as easy as\n    possible to host organice.\n  - There's myriads of good options, of course. I picked to document\n    two that will (potentially) be cost-free to the users and which\n    are very easy and quick to set up: Ftp and Heroku.\n\n** Fixed\n\n- Tests on =master= were red\n  - Partly due to obsolete tests\n  - Partly because tests weren't updated according to changes in the code\n",sample:"# organice will not reflow if there's hard-wrapped content\n# -*- eval: (auto-fill-mode 0) -*-\n#+TODO: TODO | DONE\n#+TODO: START INPROGRESS STALLED | FINISHED\n\n* This is an actual org file - feel free to play around with it! (Don't worry about messing it up - your changes won't be saved, so just refresh the page to reset it)\n* For starters, tap on the next header to open it\nThis header has some description text and a couple subheaders. Look through the next few top level headers to learn more about organice.\n** This is a subheader\n** This is a subheader too!\n* Actions\n** Editing headers\nWhen you select a header the \"header action drawer\" appears. The first two icons in this drawer edit the header and description respectively. Try editing this header.\n\nIf you want the \"header action drawer\" to disappear or to deselect the current header, tap into the title (or empty space) in the headerbar.\n\n** All icons in the header action bar\n\n1. Pen: Edit header title\n2. Pen in square: Edit header description\n3. Tags: [[https://orgmode.org/manual/Tags.html][Modify tags]]\n4. Properties: [[https://orgmode.org/manual/Properties-and-columns.html][Modify properties]]\n5. Expand: [[https://orgmode.org/manual/Structure-editing.html][Narrow to subtree]] (/Narrowing/ means focusing on this header, making the rest temporarily inaccessible.)\n6. Plus: Create new header below\n7. Mail: Share this header via email\n8. Calendar 1: [[https://orgmode.org/manual/Deadlines-and-scheduling.html][Set deadline datetime]]\n9. Calendar 2: [[https://orgmode.org/manual/Deadlines-and-scheduling.html][Set scheduled datetime]]\n10. Hourglass: [[https://orgmode.org/manual/Clocking-commands.html][Clock in and out (Start and stop the clock)]]\n11. File Export: [[https://orgmode.org/manual/Refile-and-copy.html][Refile this header to another header]]\n12. Add a note: Add a time-stamped note to the current header (=org-add-note=).\n\n** Todos [1/4] [25%]\nThis header has a few TODO items as subheaders.\n*** TODO Learn how to use TODOs in organice\nTo advance the todo state of a header, swipe right on it until the background turns green.\n\nTry advancing the todo state of this header a few times!\n**** There's also a setting once you're signed in to enable tapping on the TODO label itself to advance the todo state. Its off by default because I thought the behavior would be confusing unless explained, but I recommend turning it on!\n*** DONE Check out organice\n*** START Investigate custom TODO states\norganice also supports [[http://orgmode.org/manual/Workflow-states.html#Workflow-states][custom todo states]] (if declared at the top of the file). Swipe right on this header a few times.\n\nNote that when the cycle restarts, it defaults to the first set of todo states. Manually edit the header to get back to a different todo state cycle (more on editing headers below!)\n*** FINISHED See that custom TODO states are colored correctly\nCustom =org-todo-keywords= keyword sequences can have finish states. They are colored appropriately. You can see that TODO and START headlines are colored red whereas DONE and FINISHED headlines are colored green.\n** Tags\nThe next button in the header action drawer will bring up the tag editor.\n\nThis editor lets you add, modify, and reorder tags, as well as giving you easy access to all tags in the file.\n\nTry it out on these headers:\n*** Dogs\n**** Eloise                                        :cute:middleaged:tiny:dog:\n**** Clooney                                            :cute:young:tiny:dog:\n**** Murphy                                            :cute:young:small:dog:\n**** Starla                                             :cute:old:medium:dog:\n**** Rex                                                :cute:old:medium:dog:\n**** Maz                                          :cute:middleaged:large:dog:\n** Narrowing\nThe next button in the header action drawer \"narrows\" to a header, hiding all others and promoting it to the top level. Press the button again to \"widen\".\n\nNarrowing can make it easier to concentrate on a single heading or topic by eliminating clutter. It can also be used to limit the range of operation of a search command.\n\nThis is purely visual - your Org file isn't affected under the hood.\n\nExample: You can narrow on the \"Groceries\" list when you go to the grocery store. Give it a shot on this grocery list:\n*** Groceries\n- [ ] Mangoes\n- [ ] Dark chocolate\n- [ ] Carrots\n** Adding and removing headers\nTo add a new header, press the + button in the header action drawer\n\nTo remove a header, swipe left on the header until the background turns red.\n** Moving headers\nTo move a header, click on the four-way arrows button at the bottom of the screen with a header selected. 6 buttons will appear for moving headers.\n\nThe center 4 move the header up, down, left, and right. The 2 outermost buttons move the header and its entire nested subtree.\n\nGive them a try on these nested headers to get a feel for how they operate:\n*** A few of my favorite things:\n**** Food\n***** Chocolate\n****** Dark chocolate\n****** Milk chocolate\n****** Crispy chocolate\n***** Mangoes\n**** Text editors\n***** Emacs\n**** Mountain bikes\n***** Santa Cruz\n***** Trek\n***** Giant\n***** Specialized\n**** Dogs\n***** Eloise\n***** Maz\n***** Starla\n***** Rex\n***** Clooney\n** Syncing\nThe \"cloud\" button in the lower left hand corner syncs changes to your\nchosen sync service (Dropbox, Google Drive or WebDAV).\n\nIf there's a newer version on the server and no local changes, it'll pull.\n\nIf there's no newer version on the server and there are local changes, it'll push.\n\nOtherwise, it'll ask what you want to do.\n\nThis button isn't enabled in this demo :)\n\nIf you'd like to automatically push changes as you make them, you can enable \"Live sync\" in settings.\n** Undo / Redo\n   When you're signed in, you'll have =undo= and =redo= buttons in the\n   headerbar.\n* Tables\norganice has native support for viewing and editing tables.\n\nTry playing around with this one by first clicking on a cell:\n\n| Dog name | Age | Weight (in lbs) | Parent   | Score (1-10) |\n|----------+-----+-----------------+----------+--------------|\n| Eloise   |   3 |             5.1 | Erin     |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Starla   |  15 |              40 | Sarah S  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Rex      |  15 |              45 | Sarah S  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Maz      |   1 |              55 | Brittany |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Clooney  | 0.1 |             4.8 | Sarah R  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Murphy   | 0.5 |              25 | Jordan   |           15 |\n\n** New action drawer items\nWhen a table cell is selected, a table-specific action drawer appears.\n\nThe leftmost icon allows you to edit a cell.\n\nOn the right side, the top two icons let you add and remove rows. The bottom two icons let you add and remove columns.\n\n** Moving rows and columns\nWhen a table cell is selected, the four-way arrow button at the bottom of the screen changes to manipulate tables.\n\nPress up and down to move rows, and left and right to move columns.\n* Lists and checkboxes\norganice has native support for displaying plain lists and checkboxes\n\nPlain:\n\n- plain list item 1\n- plain list item 2\n  - sub item 1\n- plain list item 3\n\nOrdered:\n\n1. Item 1\n2. Item 2\n20. [@20] Item 20\n21. Item 21\n\nCheckboxes:\n\n- [-] 1 [1/2]\n  - [ ] 1.1 [0%]\n    - [ ] 1.1.1\n  - [X] 1. 2\n- [X] 2\n\nCurrently, plain lists are mostly display only (except that you can check/uncheck checkboxes). If native support for manipulating plain lists is important to you, please let me know by upvoting [[https://github.com/200ok-ch/organice/issues/26][the issue]] on Github\n* Timestamps\norganice has native support for displaying and editing [[https://orgmode.org/manual/Timestamps.html#Timestamps][timestamps]].\n\nTry tapping on the timestamps below to get a feel for the editor:\n\n<2018-09-17 Sun>\n\n[2018-09-17 Sun]\n\n[2018-09-17 Sun +1d]\n\n[2018-09-17 Sun 10:00-11:30]\n\n<2018-09-17 Sun>--<2018-09-25 Tue>\n\n** Habit tracking\n\nOrg has the ability to track the consistency of a special category of TODO, called \"habits.\" From the [[https://orgmode.org/manual/Tracking-your-habits.html][upstream doc]]: A timestamp may have minimum and maximum ranges specified by using the syntax =.+2d/3d=, which says that you want to do the task at least every three days, but at most every two days.\n\nExample timestamp: <2009-10-17 Sat .+2d/4d>\n\norganice supports parsing and preserving the minimum/maximum range timestamps. Alas, only the minimum range is handled as a [[https://orgmode.org/manual/Repeated-tasks.html][repeated task]]. There's no UI for the maximum range, it can be edited as raw text. Also, there is no UI to show how well a habit has been exercised.\n\n* Automatic/Implicit links\n\norganice recognizes various types of hyperlinks automatically which Emacs Org mode would not necessarily do. That makes sense, because mobile devices, or browsers, enable a different feature set.\n\nFor example, when you read this in organice, then the text https://organice.200ok.ch will implicitly be rendered as a clickable link (as it would be in Emacs Org mode). The same also works for other web links like www.200ok.ch, email addresses like info@200ok.ch, and different kinds of phone numbers. For these, Emacs Org mode doesn't create an explicit link, but organice can and does.\n\nInternational/US phone numbers:\n\n  - 123-456-7890\n  - (123) 456-7890\n  - 123 456 7890\n  - 123.456.7890\n  - +91 (123) 456-7890\n\nSwiss phone numbers:\n\n - 0783268674\n - 078 326 86 74\n - 041783268675\n - 0041783268674\n - +41783268676\n - +41783268677\n\n* Property lists\norganice has native support for viewing and editing [[https://orgmode.org/guide/Properties.html][property lists]]. To bring up an editor, expand the ~PROPERTIES~ drawer below and tap on any of the properties.\n** Example\n:PROPERTIES:\n:callsign: Maverick\n:eyewear: Aviators\n:launch-date: [1986-05-16 Fri]\n:END:\n* Planning\norganice has native support for adding and editing DEADLINE and SCHEDULED items. It also supports [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]]. Check out these examples:\n\n=DEADLINE= means that the task - most likely a TODO item, though not necessarily\u2014is supposed to be finished on that date.\n\n=SCHEDULED= means that you are planning to start working on that task on the given date.\n\nScheduling an item should not be understood in the same way that we understand scheduling a meeting. Setting a date for a meeting is just a simple appointment, you can mark this entry with a simple plain timestamp, to get this item shown on the date where it applies.\n\n** An item with a deadline\n   DEADLINE: <2018-10-03 Wed>\n\nDeadlines and scheduled items produce entries in the agenda when they are over-due, so it is important to be able to mark such an entry as done once you have done so. When you mark a \u2018DEADLINE\u2019 or a \u2018SCHEDULED\u2019 with the TODO keyword \u2018DONE\u2019, it no longer produces entries in the agenda.\n** An item that is scheduled\n   SCHEDULED: <2018-10-18 Thu>\n** Doctors appointment <2020-10-07 Wed>\n\nFor simple appointments, it is enough to mark the entry with a simple plain timestamp. This will still show up in the agenda.\n\n** An item with both\n   DEADLINE: <2018-10-05 Fri> SCHEDULED: <2018-10-04 Thu>\n** TODO An item with a repeater - try swiping right to advance to the DONE state\n   DEADLINE: <2019-01-10 Thu +1w>\n   :PROPERTIES:\n   :LAST_REPEAT: [2019-01-03 Thu 15:35]\n   :END:\n\n   - State \"DONE\"       from \"TODO\"       [2019-01-03 Thu 15:35]\n\nThe =+1w= is a repeater; the intended interpretation is that the task has a deadline on '2019-01-10' and repeats itself every (one) week starting from that time. You can use yearly, monthly, weekly, daily and hourly repeat cookies by using the 'y', 'w', 'm', 'd' and 'h' letters.\n\nWith the =+1w= cookie, the date shift is always exactly one week. So if you completed the TODO for three months, marking this entry DONE still keeps it as an overdue deadline. Depending on the task, this may not be the best way to handle it. For example, if you forgot to call your father for 3 weeks, it does not make sense to call him 3 times in a single day to make up for it. Finally, there are tasks, like changing batteries, which should always repeat a certain time after the last time you did it. For these tasks, Org mode has special repeaters =++= and =.+=. For example:\n\n*** TODO Call kitchen trash\n    DEADLINE: <2019-02-11 Mon ++1w>\n    Marking this DONE shifts the date by at least one week, but also by as many weeks as it takes to get this date into the future. However, it stays on a Sunday, even if you called and marked it done on Saturday.\n\n*** TODO Check the batteries in the smoke detectors\n    DEADLINE: <2019-11-01 Fri .+1m>\n    Marking this DONE shifts the date to one month after today.\n** TODO An item with deadline and different lead time\n   DEADLINE: <2020-10-07 Wed>\n\nOn the deadline date, the task is listed in the agenda. In addition, the agenda for today carries a warning about the approaching or missed deadline, starting a defined time period before the due date (see settings \"Default DEADLINE warning period\"), and continuing until the entry is marked as done.\n\nYou can specify a different lead time for warnings for a specific deadlines using the following syntax. Here is an example with a warning period of 5 days 'DEADLINE: <2004-02-29 Sun -5d>'.\n\nIn case the task contains a repeater, the delay is considered to affect all occurrences; if you want the delay to only affect the first scheduled occurrence of the task, use '--5d' instead.\n\n* Capture\norganice supports something like [[https://orgmode.org/manual/Capture.html][Org capture]] in the form of customizable, quickly accessible buttons for creating new headers.\n\nClick the button in the bottom right corner of the screen to see some examples. The first button, the lemon, will create a new entry in the \"Groceries\" list below this. The second button adds an entry to a more deeply nested header.\n\nOnce signed in, you can set up capture templates that specify header paths (and various other configurations). If the list is empty, the content will be inserted at the end of the file, or the beginning if the prepend option is selected. These capture templates will sync between your devices if you enable settings sync.\n** Groceries\n** Deeply\n*** Nested\n**** Headers\n***** Work\n****** Too!\n\n* Search / Task List\n\nBelow, there is a button to open up a generic search and a task list.\n\nTap a header in the view to jump to it.\n\nUsing the filter input, you can search for headlines. Specifically, you can search for headline text, TODO keywords, tags, and [[https://orgmode.org/guide/Properties.html][orgmode properties]]. It also supports alternatives, and you can exclude headlines by negating a filter.\n\nWhen a header is narrowed, and the user uses the 'search' or 'task list' feature, then the searched header list is automatically narrowed to only subheaders of the originally narrowed header.\n\n** Differences Search and Task List\n\n- In the task list, you can tap on the date to switch to a more readable relative date format.\n- The task list shows only tasks - i.e. headlines with a TODO keyword are displayed.\n  - The tasks will be sorted by state and then date.\n\n** Examples for the search syntax\n\nYou can simply search for\n\n=TODO check out organice|orgmode=\n\nto filter for tasks containing these words. The pipe symbol (|) is a logical /OR/. The filter is a smart-case search:\n\n- Lower-case words mean that the filter ignores the case.\n- If a word contains upper-case letters, the filter is case-sensitive.\n\nThe following example searches for headlines containing *START* or *FINISHED* keywords and the string \"states are\". You can also use single-quotes.\n\n=START|FINISHED \"states are\"=\n\nThe next example excludes *DONE* headlines but requires the tag *fun*.\n\n=-DONE  :fun=\n\nYou can exclude text strings, tags, and properties as well by prepending the minus sign (-).\n\nYou can search for headlines with defined properties:\n\n=TODO :blocked_by:  :assignee:nobody|none=\n\nThis filters headlines having a property *blocked_by* (with any value) and a property *assignee* with a value containing =nobody= or =none=.\n\nYou can also negate filters by prefixing them with =-=. For example, if you want to search for all headers that are not DONE:\n\n=-DONE=\n\nYou can also search time ranges on headers with planning items (SCHEDULED and DEADLINE), plain active timestamps or clocked work time.\n\nThe time related filters are:\n\n- =scheduled= (shorthand =sched=)\n- =deadline= (shorthand =dead=)\n- =clock=\n- =date=\n\n=date= is a shorthand to search for planning items (SCHEDULED and DEADLINE) and plain active timestamps at the same time.\n\nThese time related filters work on time ranges indicated by =START..END= where =START= and =END= support the following units:\n\n- =h=: Hours\n- =d=: Days\n- =w=: Weeks\n- =m=: Months\n- =y=: Years\n\n=START= and =END= can both be omitted to search for an infinite timespan into the past or future. Both can be used with digits to quantify the amount (i.e. =2w= for two weeks). For both, the digit can be omitted to refer to the calendar unit instead of a time duration (i.e. =w= is the current week using the [[https://en.wikipedia.org/wiki/Week#The_ISO_week_date_system][Western Traditional]] system [from Sunday to Saturday]).\n\nThere are two special units that need no quantification:\n\n- =today=: Current date\n- =now=: Current time\n\nNext to units, =START= and =END= can also be expressed in dates like. Dates can be expressed by:\n\n- =YYYY= (i.e. 2020)\n- =YYYY-MM= (i.e. 2020-11)\n- =YYYY/MM= (i.e. 2020/11)\n- =YYYY.MM= (i.e. 2020.11)\n- =YYYYMM= (i.e. 202011)\n- =YYYY-MM-DD= (i.e. 2020-11-17)\n- =YYYY/MM/DD= (i.e. 2020/11/17)\n- =YYYY.MM.DD= (i.e. 2020.11.17)\n- =YYYYMMDD= (i.e. 20201117)\n\nSome examples on how to use time ranges:\n\n- =clock:..= searches for all items with time clocked. This includes headers that have time logged on their children.\n- =sched:w= searches for all scheduled items in the current week (same for other units).\n- =dead:..w= searches for all deadlines between now and the end of the week.\n- =date:today= searches for all planning items (scheduled and deadline items) as well as items with active timestamps.\n- =date:1w= (equivalent to =date:..1w=) searches from now to one week in the future.\n- =sched:2m..w= if both ends of the range are relative, they refer back to the current moment. So this searches for all scheduled items between two months before now to the end of the current week.\n\nNote that negating time ranges is not implemented.\n\n\n** Auto-completion for filters\n\nYou probably noticed that organice provides suggestions for your filter. After space, =-=, =:=, and =|= you can tap on the completion \u2013 no need to type the tag, property, etc.\n\n** TODO Example with properties\t\t\t\t\t\t\t:fun:\n:PROPERTIES:\n:assignee: nobody\n:blocked_by: the others\n:END:\n\n* Agenda\norganice has a basic agenda view that you can access by tapping the calendar button at the bottom of the page.\n\nTap a header in this view to jump to it, and tap on the date to switch to a more readable relative date format.\n\nDue and overdue items with deadlines and a schedule show up on today's entry. Entries with just an active timestamp are shown only on exactly the day of the timestamp. Hence, a 'meeting' or an 'appointment' should get an active timestamp whereas a TODO often will be scheduled or even has a deadline.\n\nMore information on that in the [[https://orgmode.org/manual/Deadlines-and-Scheduling.html][org manual]].\n\nExamples:\n\n** TODO Check out the organice agenda view\nDEADLINE: <2018-09-10 Mon>\n** TODO Install organice to the homescreen on my mobile phone\nSCHEDULED: <2018-09-17 Mon>\n** This entry shows only exactly on <2020-02-17 Mon> in the agenda\n** This entry also only shows on exactly one day\n   <2020-02-17 Mon>\n* Syncing\norganice pulls down your org files from Dropbox, Google Drive or WebDAV. Click the \"Sign in\" button in the upper right hand corner to sign in with either of them and authenticate organice.\n\n** Backups\nThe first time you push changes from organice back up to your chosen sync service, organice will make a backup of the original file first. It'll be named {your-file-name}.organice-bak. Dropbox and Google Drive also both keep a full version history of your files for you, but this is an additional precaution in case something goes wrong pushing the file back up.\n\nGenerally, when working with distributed Org files, we're recommending to put them under version control and to check for bugs and racing conditions between clients.\n\n* Multiple files\norganice supports using multiple files.\n\nDefault behaviour:\n\n- When you first open a file it is loaded from the backend. At this point the file is persisted to local storage. It will be loaded from there on future application starts. To ensure consistency whenever a file is opened it will be synced with the backend.\n- Agenda, Refile, Search and Task List by default show results from the currently viewed file.\n\nYou can adjust these defaults on a file per file basis by creating file settings in the [[/settings][settings menu]].\n\n* organice operates completely client side\nYou don't log in to organice directly because organice doesn't have a back end - it operates completely client side using Dropbox, Google Drive or WebDAV as back-ends.\n* Capture URL params and Siri support\norganice supports a flexible mechanism for capturing using URL parameters. This mechanism integrates very nicely with the new [[https://support.apple.com/guide/shortcuts/welcome/ios][Siri Shortcuts]] feature in iOS 12, allowing you to use Siri to execute capture templates.\n\nYou can use [[https://www.icloud.com/shortcuts/14f91f8cf8f547a183a0734396240984][this sample Shortcut]] to get started with this right away in iOS 12. Open the link on your iOS device and click \"Get Shortcut\". Then open up the Shortcuts app and edit the template by following the directions in the comments. Then record a Siri trigger and you're good to go!\n\nAlternatively, you can take advantage of the URL parameters yourself to build your own custom capture mechanism. You can find more details about this in [[https://github.com/200ok-ch/organice/#capture-params-and-siri-support][the README file]].\n"}[e]))},Ke=()=>(e,t)=>{e(ar());const n=t().base.get("lastViewedPath");n&&e(hr(n))},ze=e=>({type:"SET_FONT_SIZE",newFontSize:e}),Ye=e=>({type:"SET_BULLET_STYLE",newBulletStyle:e}),Je=e=>({type:"SET_SHOULD_TAP_TODO_TO_ADVANCE",newShouldTapTodoToAdvance:e}),qe=e=>({type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT",newAgendaDefaultDeadlineDelayUnit:e}),Xe=e=>({type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE",newAgendaDefaultDeadlineDelayValue:e}),$e=e=>({type:"SET_AGENDA_START_ON_WEEKDAY",newAgendaStartOnWeekday:e}),Ze=e=>({type:"SET_SHOULD_LIVE_SYNC",shouldLiveSync:e}),Qe=e=>({type:"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE",shouldSyncOnBecomingVisibile:e}),et=e=>({type:"SET_SHOULD_SHOW_TITLE_IN_ORG_FILE",shouldShowTitleInOrgFile:e}),tt=e=>({type:"SET_SHOULD_LOG_INTO_DRAWER",shouldLogIntoDrawer:e}),nt=e=>({type:"SET_CLOSE_SUBHEADERS_RECURSIVELY",closeSubheadersRecursively:e}),at=e=>({type:"SET_SHOULD_NOT_INDENT_ON_EXPORT",shouldNotIndentOnExport:e}),rt=e=>(t,n)=>{if(t({type:"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND",newShouldStoreSettingsInSyncBackend:e}),!e){const e=n().syncBackend.get("client");switch(e.type){case"Dropbox":case"WebDAV":e.deleteFile("/.organice-config.json").catch((e,t)=>e?null:alert("There was an error trying to delete the .organice-config.json file: ".concat(t)));break;case"Google Drive":e.deleteFileByNameAndParent(".organice-config.json","root")}window.previousSettingsFileContents=null}},st=e=>({type:"SET_COLOR_SCHEME",colorScheme:e}),it=e=>({type:"SET_THEME",theme:e}),ot=e=>({type:"SET_HAS_UNSEEN_CHANGELOG",newHasUnseenChangelog:e}),lt=e=>({type:"SET_LAST_SEEN_CHANGELOG_HEADER",newLastSeenChangelogHash:e}),ct=(e,t)=>({type:"SET_CUSTOM_KEYBINDING",keybindingName:e,keybinding:t}),dt=e=>({type:"RESTORE_BASE_SETTINGS",newSettings:e}),ht=e=>({type:"PUSH_MODAL_PAGE",modalPage:e}),ut=()=>({type:"POP_MODAL_PAGE"}),pt=()=>({type:"CLEAR_MODAL_STACK"}),gt=(e,t)=>({type:"ACTIVATE_POPUP",popupType:e,data:t}),mt=()=>({type:"CLOSE_POPUP"}),ft=e=>t=>t({type:"SET_AGENDA_TIMEFRAME",agendaTimeframe:e});var bt=Object(w.fromJS)([{description:"Groceries",headerPaths:["Capture","Groceries"],iconName:"lemon",id:v(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!1,template:"* TODO %?",isSample:!0},{description:"Deeply nested header",headerPaths:["Capture","Deeply","Nested","Headers","Work","Too!"],iconName:"fighter-jet",id:v(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!0,template:"* You can insert timestamps too! %T %?",isSample:!0}]),yt=n(403),Et=n(401),wt=n(402);const Tt=()=>({type:"ADD_NEW_EMPTY_CAPTURE_TEMPLATE"}),vt=(e,t,n)=>({type:"UPDATE_TEMPLATE_FIELD_PATH_VALUE",templateId:e,fieldPath:t,newValue:n}),kt=e=>({type:"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e}),_t=(e,t)=>({type:"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e,orgFileAvailabilityIndex:t}),St=e=>({type:"ADD_NEW_TEMPLATE_HEADER_PATH",templateId:e}),It=(e,t)=>({type:"REMOVE_TEMPLATE_HEADER_PATH",templateId:e,headerPathIndex:t}),Ot=e=>({type:"DELETE_TEMPLATE",templateId:e}),Dt=e=>({type:"RESTORE_CAPTURE_SETTINGS",newSettings:e}),Ct=(e,t)=>({type:"REORDER_CAPTURE_TEMPLATE",fromIndex:e,toIndex:t}),At=(()=>{try{localStorage.setItem("test","test");const e="test"===localStorage.getItem("test");return localStorage.removeItem("test"),e&&localStorage}catch(e){return!1}})(),Nt=E.a.debounce((e,t)=>{switch(e.type){case"Dropbox":case"WebDAV":e.createFile("/.organice-config.json",t).catch(e=>alert("There was an error trying to push settings to your sync backend: ".concat(e)));break;case"Google Drive":e.createFile(".organice-config.json","root",t).catch(e=>alert("There was an error trying to push settings to your sync backend: ".concat(e)))}},1e3,{maxWait:3e3}),Pt=[{category:"base",name:"fontSize",type:"nullable"},{category:"base",name:"bulletStyle",type:"nullable",default:"Fancy"},{category:"base",name:"shouldTapTodoToAdvance",type:"boolean"},{category:"base",name:"agendaDefaultDeadlineDelayUnit",type:"nullable"},{category:"base",name:"agendaDefaultDeadlineDelayValue",type:"nullable"},{category:"base",name:"agendaStartOnWeekday",type:"nullable",default:1},{category:"base",name:"shouldStoreSettingsInSyncBackend",type:"boolean",default:!0},{category:"base",name:"lastSeenChangelogHash",type:"nullable"},{category:"base",name:"customKeybindings",type:"json"},{category:"base",name:"shouldLiveSync",type:"boolean",default:!0},{category:"base",name:"shouldSyncOnBecomingVisibile",type:"boolean",default:!0},{category:"base",name:"shouldShowTitleInOrgFile",type:"boolean"},{category:"base",name:"shouldLogIntoDrawer",type:"boolean"},{category:"base",name:"closeSubheadersRecursively",type:"boolean"},{category:"base",name:"shouldNotIndentOnExport",type:"boolean"},{category:"org",name:"showClockDisplay",type:"boolean"},{category:"base",name:"colorScheme",type:"string",default:"Light"},{category:"base",name:"theme",type:"string",default:"Solarized"},{category:"capture",name:"captureTemplates",type:"json",default:Object(w.List)()},{category:"org",name:"fileSettings",type:"json",default:Object(w.List)()},{category:"base",name:"agendaTimeframe",type:"string",default:"Week"}],Rt=()=>{const e=localStorage.getItem("headerOpenness");return e?JSON.parse(e):null},Lt=(e,t)=>t.filter(e=>!e.depreacted).filter(e=>"org"===e.category).map(t=>"json"===t.type?[t.name,JSON.stringify(e.org.present.get(t.name)||t.default||{})]:[t.name,e.org.present.get(t.name)]).concat(Pt.filter(e=>"org"!==e.category).map(t=>"json"===t.type?[t.name,JSON.stringify(e[t.category].get(t.name)||t.default||{})]:[t.name,e[t.category].get(t.name)||t.default])),xt=e=>JSON.stringify(E.a.fromPairs(e),null,2),Mt=()=>{let e=(()=>{let e={syncBackend:Object(w.Map)(),org:{past:[],present:Object(w.Map)({files:Object(w.Map)(),fileSettings:[],opennessState:Object(w.Map)(),search:Object(w.Map)({searchFilter:"",searchFilterExpr:[]})}),future:[]},base:Object(w.Map)({isLoading:Object(w.Set)()}),capture:Object(w.Map)()};return Pt.forEach(t=>{const n=t.default;"org"===t.category?e[t.category].present=e[t.category].present.set(t.name,n):e[t.category]=e[t.category].set(t.name,n)}),e})();return At?(e=>{Pt.forEach(t=>{let n=localStorage.getItem(t.name);"nullable"===t.type?"null"===n&&(n=null):"boolean"===t.type?n="true"===n:"json"===t.type&&(n=n?Object(w.fromJS)(JSON.parse(n)):t.default||Object(w.Map)()),n=n||t.default,"org"===t.category?e[t.category].present=e[t.category].present.set(t.name,n):e[t.category]=e[t.category].set(t.name,n)}),e.capture.get("captureTemplates")&&(e.capture=e.capture.update("captureTemplates",e=>e.map(e=>e.set("id",v())))),e.org.present.get("fileSettings")&&(e.org.present=e.org.present.update("fileSettings",e=>e.map(e=>e.set("id",v()))));const t=Rt();return t&&(e.org.present=e.org.present.set("opennessState",Object(w.fromJS)(t))),window.previousSettingsFileContents=xt(Lt(e,Pt)),er(e)})(e):e},Ft=(e,t)=>{At&&localStorage.setItem(e,t)},Ht=(e,t=!1)=>{if(At){const n=localStorage.getItem(e);return t&&"null"===n?null:n}return null};var jt=n(169),Bt=n.n(jt),Wt=n(392),Ut=n(393),Vt=n(104),Gt=n(394),Kt=n(395),zt=n(396),Yt=n(397),Jt=n(398),qt=n(399),Xt=n(400);const $t=(e,t)=>{const n=new Date(e);switch(t){case"h":return Object(Yt.a)(n);case"d":return Object(Vt.a)(n);case"w":return Object(Jt.a)(n);case"m":return Object(Ut.a)(n);case"y":return Object(Wt.a)(n);default:throw Error("unknown `unit` for timerange search")}},Zt=(e,t)=>{const n=new Date(e);switch(t){case"h":return Object(qt.a)(n);case"d":return Object(zt.a)(n);case"w":return Object(Xt.a)(n);case"m":return Object(Kt.a)(n);case"y":return Object(Gt.a)(n);default:throw Error("unknown `unit` for timerange search")}},Qt=e=>null===e?new Date:"timestamp"===e.type?(e=>{const t=new Date;return t.setFullYear(e.year),null===e.month?Object(Wt.a)(t):null===e.day?(t.setMonth(e.month-1),Object(Ut.a)(t)):(t.setMonth(e.month-1),t.setDate(e.day),Object(Vt.a)(t))})(e):"special"===e.type?(e=>{const t=new Date;return"now"===e.value?t:"today"===e.value?Object(Vt.a)(t):void 0})(e):"offset"===e.type?V(new Date,e.value,e.unit):"unit"===e.type?$t(new Date,e.unit):void 0,en=e=>null===e?new Date:"timestamp"===e.type?(e=>{const t=new Date;return t.setFullYear(e.year),null===e.month?Object(Gt.a)(t):null===e.day?(t.setMonth(e.month-1),Object(Kt.a)(t)):(t.setMonth(e.month-1),t.setDate(e.day),Object(zt.a)(t))})(e):"special"===e.type?(e=>{const t=new Date;return"now"===e.value?t:"today"===e.value?Object(zt.a)(t):void 0})(e):"offset"===e.type?U(new Date,e.value,e.unit):"unit"===e.type?Zt(new Date,e.unit):void 0,tn=e=>"offset"===e.type||"unit"===e.type,nn=e=>{const t=e.field.timerange;let n,a;if("point"===t.type){const e=t.point;return"offset"===e.type?(n=new Date,a=U(new Date(n))):(n=Qt(e),a=en(e)),e=>n<=W(e)&&W(e)<=a}if("range"===t.type){const e=t.from?t.from:{type:"special",value:"now"},n=t.to?t.to:{type:"special",value:"now"};let a,r;if(tn(e)===tn(n))a=Qt(e),r=en(n);else if("offset"===e.type)r=en(n),a=V(new Date(r),e.value,e.unit);else if("offset"===n.type)a=Qt(e),r=U(new Date(a),n.value,n.unit);else if("unit"===e.type)r=en(n),a=$t(r,e.unit);else{if("unit"!==n.type)throw Error("unable to construct timerangefilter");a=Qt(e),r=Zt(a,n.unit)}return e=>a<=W(e)&&W(e)<=r}if("all"===t.type)return e=>!0;throw Error("unable to construct timefilter")},an=e=>t=>t.some(t=>e.includes(t)),rn=e=>t=>0!==e.size&&e.some(e=>t(e)),sn=(e,t,n)=>(a,r,s)=>((e,t,n)=>(a,r,s)=>{const i=[].concat(t,Ce(Object(w.fromJS)(n)).toJS().map(e=>e+":")),o=a?ln(a,r,s):null,l=r.charAt(s-1),c=s>1?r.charAt(s-2):"";if(null===o);else{if(o===on)return e;if("case-sensitive"===o.type){if(l.match(/[A-Z]/)){const t=l,n=e.filter(e=>e.startsWith(t)).map(e=>e.substring(t.length));if([" ","","|","-"].includes(c))return n}}else{if("ignore-case"===o.type)return"-"===l&&[" ",""].includes(c)?e:[];if("tag"===o.type){if(":"===l)return i}else if("property"===o.type&&":"===l){if(" "===c||""===c)return i;{const e=r.substring(0,s-1).lastIndexOf(":"),t=r.substring(e+1,s-1),a=e=>{if(e.match(/ /)){if(!e.match(/"/))return['"'.concat(e,'"')];if(!e.match(/'/))return["'".concat(e,"'")];return[e.match(/^[^ ]*/)[0]]}return[e]};if(e>=0&&t.match(/^[^ ]+$/))return Ae(Object(w.fromJS)(n),t).flatMap(a).toJS()}}}}if(":"===l){if([" ","","-"].includes(c))return i}else if("|"===l){const n=r.substring(0,s).lastIndexOf(":"),a=r.substring(n+1,s-1);return n>-1&&!a.match(/ /)?t:e}return[]})(e,t,n)(a,r,s).map(e=>r.substring(0,s)+e+r.substring(s)),on=" ",ln=(e,t,n)=>{if(0===e.length)return on;const a=(e,t)=>({value:e,elem:t}),r=e.reduce(({value:e,elem:t},r)=>null===t?a(e,null):n>=r.offset&&n<=r.endOffset?a(r,null):n>t.endOffset&&n<r.offset?a(on,null):a(null,r),{value:null,elem:{offset:-1,endOffset:-1}}).value;return n>e[e.length-1].endOffset?on:r},cn=(e,t)=>t.get("logBookEntries",[]).map(e=>[e.get("start"),e.get("end")]).filter(([e,t])=>e&&t).filter(t=>t.some(t=>e.every(e=>e(t)))).map(([e,t])=>W(t)-W(e)).reduce((e,t)=>e+t,0),dn=e=>{if(!e)return e;const t=e.map(e=>e.set("totalTimeLogged",(e=>e.get("logBookEntries",[]).map(e=>e.get("start")&&e.get("end")?W(e.get("end"))-W(e.get("start")):0).reduce((e,t)=>e+t,0))(e)));return t.map((e,n)=>{const a=se(t,n).reduce((e,t)=>e+t.get("totalTimeLogged"),e.get("totalTimeLogged"));return e.set("totalTimeLoggedRecursive",a)})},hn=/(?: (\+|\+\+|\.\+|-|--)(\d+)([hdwmy])(?:\/(\d+)([hdwmy]))?)?/,un=new RegExp([/([<[])/,/(\d{4})-(\d{2})-(\d{2})/,/(?: ([^0-9\s]{1,9}))?/,/(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?/,hn,hn,/[>\]]/].map(e=>e.source).join("")),pn=new RegExp([/(\[\[([^\]]*)\]\]|\[\[([^\]]*)\]\[([^\]]*)\]\])|(\[((\d*%)|(\d*\/\d*))\])|(([\s({'"]?)([*/~=_+])([^\s,'](.*)[^\s,'])\11([\s\-.,:;!?'")}]?))/.source,"(".concat(un.source,"(?:--").concat(un.source,")?)"),/(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*))/.source,/([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)/.source,/((\+|00)\d{8,30})/.source,/((\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4})/.source,/(0[1-9]{2}\s[0-9]{3}\s[0-9]{2}\s[0-9]{2})/.source,/(0[0-9]{9,11})/.source,/(www(\.[-_a-zA-Z0-9]+){2,}(\/[-_a-zA-Z0-9]+)*)/.source].join("|"),"g"),gn=(e,t)=>{const n=t.map(t=>e[t]),a=Object(g.a)(n,17),r=a[0],s=a[1],i=a[2],o=a[3],l=a[4],c=a[5],d=a[6],h=a[7],u=a[8],p=a[9],m=a[10],f=a[11],b=a[12],y=a[13],E=a[14],w=a[15],T=a[16];if(!s)return null;const v=c?c.split(":"):[],k=Object(g.a)(v,2),_=k[0],S=k[1],I=d?d.split(":"):[],O=Object(g.a)(I,2),D=O[0],C=O[1];let A,N,P,R,L,x,M,F;return["+","++",".+"].includes(h)?(A=h,N=u,P=p,R=m,L=f):["-","--"].includes(h)&&(x=h,M=u,F=p),["+","++",".+"].includes(b)?(A=b,N=y,P=E,R=w,L=T):["-","--"].includes(b)&&(x=b,M=y,F=E),{isActive:"<"===r,year:s,month:i,day:o,dayName:l,startHour:_,startMinute:S,endHour:D,endMinute:C,repeaterType:A,repeaterValue:N,repeaterUnit:P,delayType:x,delayValue:M,delayUnit:F,repeaterDeadlineValue:R,repeaterDeadlineUnit:L}},mn=(e,{shouldAppendNewline:t=!1}={})=>{const n=[];let a=pn.exec(e);for(;a;){if(a[2])n.push({type:"link",rawText:a[0],uri:a[2],index:a.index});else if(a[3]&&a[4])n.push({type:"link",rawText:a[0],uri:a[3],title:a[4],index:a.index});else if(a[7]){const e=a[7].match(/(\d*)%/);n.push({type:"percentage-cookie",rawText:a[0],percentage:e[1],index:a.index})}else if(a[8]){const e=a[8].match(/(\d*)\/(\d*)/);n.push({type:"fraction-cookie",rawText:a[0],fraction:[e[1],e[2]],index:a.index})}else if(a[11]){const e={"~":"inline-code","*":"bold","/":"italic","+":"strikethrough",_:"underline","=":"verbatim"}[a[11]],t=a[10].length;n.push({type:"inline-markup",rawText:a[0].substring(t,a[12].length+2+t),index:a.index+t,content:a[12],markupType:e})}else if(a[15]){const e=gn(a,E.a.range(16,33)),t=gn(a,E.a.range(33,50));n.push({type:"timestamp",rawText:a[0],index:a.index,firstTimestamp:e,secondTimestamp:t})}else a[50]?n.push({type:"url",rawText:a[0],index:a.index}):a[53]?n.push({type:"e-mail",rawText:a[0],index:a.index}):a[54]||a[56]||a[58]||a[59]?n.push({type:"phone-number",rawText:a[0],index:a.index}):a[60]&&n.push({type:"www-url",rawText:a[0],index:a.index});a=pn.exec(e)}const r=[];let s=0;if(n.forEach(t=>{let n=t.index;if(n!==s){const t=e.substring(s,n);r.push({type:"text",contents:t})}const a=fn(e,t);r.push(a),s=t.index+t.rawText.length}),s!==e.length||t){const n=e.substring(s,e.length)+(t?"\n":"");r.push({type:"text",contents:n})}return r},fn=(e,t)=>{switch(t.type){case"link":const e={id:v(),type:"link",contents:{uri:t.uri}};return t.title&&(e.contents.title=t.title),e;case"percentage-cookie":return{id:v(),type:"percentage-cookie",percentage:t.percentage};case"fraction-cookie":return{id:v(),type:"fraction-cookie",fraction:t.fraction};case"inline-markup":return{id:v(),type:"inline-markup",content:t.content,markupType:t.markupType};case"timestamp":return{id:v(),type:"timestamp",firstTimestamp:t.firstTimestamp,secondTimestamp:t.secondTimestamp};case"url":case"www-url":case"e-mail":case"phone-number":return{id:v(),type:t.type,content:t.rawText};default:throw Error("The regex parser parsed something but it is not converted to proper data structure.")}},bn=e=>{const t={id:v(),type:"table",contents:[[]],columnProperties:[]};e.map(e=>e.trim()).forEach(e=>{if(e.startsWith("|-"))t.contents.push([]);else{const n=E.a.last(t.contents),a=e.substr(1,e.length-2).split("|");0===n.length?a.forEach(e=>n.push(e)):a.forEach((e,t)=>{n[t]+="\n".concat(e)})}}),t.contents=t.contents.map(e=>({id:v(),contents:e.map(e=>({id:v(),contents:mn(e,{excludeCookies:!0}),rawContents:e}))})),0===E.a.last(t.contents).contents.length&&(t.contents=t.contents.slice(0,t.contents.length-1));const n=Math.max(...t.contents.map(e=>e.contents.length));return t.contents.forEach(e=>{e.contents.length<n&&E.a.times(n-e.contents.length,()=>{e.contents.push({id:v(),contents:[],rawContents:""})})}),t},yn=(e,{excludeContentElements:t=!1}={})=>{const n=e.split("\n"),a=/^\s*([-+*]|(\d+(\.|\)))) (.*)/;let r=null;const s=E.a.flatten(n.map((e,s)=>{const i=e.match(/^( *)/)[0].length;return null!==r&&(i>r||!e.trim())?[{type:"raw-list-content",line:e}]:(r=null,e.match(a)&&!t?(r=i,[{type:"raw-list-header",line:e}]):e.trim().startsWith("|")&&!t?[{type:"raw-table",line:e}]:mn(e,{shouldAppendNewline:s!==n.length-1,excludeCookies:!0}))})),i=[];for(let o=0;o<s.length;++o){const e=s[o];if("raw-table"===e.type){const e=E.a.takeWhile(s.slice(o),e=>"raw-table"===e.type).map(e=>e.line);i.push(bn(e)),o+=e.length-1}else if("raw-list-header"===e.type){const t=e.line.match(/^( *)/)[0].length,n=E.a.takeWhile(s.slice(o+1),e=>"raw-list-content"===e.type).map(e=>e.line).map(e=>e.startsWith(" ".repeat(t+2))?e.substr(t+2):e.substr(t+1));""===n[n.length-1]&&(n[n.length-1]=" ");const r=yn(n.join("\n")).toJS();o+=n.length;const l=!!e.line.match(/^\s*\d+[.)]/);let c=e.line.match(a)[4],d=null;c.match(/^\s*\[@\d+\]/)&&(d=c.match(/^\s*\[@(\d+)\]/)[1],c=c.replace(/^\s*\[@\d+\]\s*/,""));let h=null;const u=!!c.match(/^\s*\[[ X-]\]/);if(u){h={" ":"unchecked",X:"checked","-":"partial"}[c.match(/^\s*\[([ X-])\]/)[1]],c=c.replace(/^\s*\[[ X-]\]\s*/,"")}const p={id:v(),titleLine:mn(c),contents:r,forceNumber:d,isCheckbox:u,checkboxState:h},g=i.length-1;g>=0&&"list"===i[g].type?i[g].items.push(p):i.push({type:"list",id:v(),items:[p],bulletCharacter:e.line.trim()[0],numberTerminatorCharacter:l?e.line.match(/\s*\d+([.)])/)[1]:null,isOrdered:l})}else i.push(e)}return Object(w.fromJS)(i)},En=({type:e,timestamp:t,id:n})=>Object(w.fromJS)({type:e,timestamp:t,id:n||v()}),wn=e=>{const t=(e=>{const t=RegExp("((DEADLINE|SCHEDULED|CLOSED):\\s*".concat(In(un),")?")),n=Sn(/^\s*/,t,/[ \t]*/,t,/[ \t]*/,t,/[ \t]*\n?/),a=e.match(n),r=Object(w.fromJS)([2,21,40].map(e=>{const t=a[e];if(!t)return null;const n=gn(a,E.a.range(e+1,e+1+17));return En({type:t,timestamp:n})}).filter(e=>!!e));if(0===r.size)return{planningItems:Object(w.fromJS)([]),strippedDescription:e};return{planningItems:r,strippedDescription:e.replace(n,"")}})(e),n=t.planningItems,a=(e=>{const t=e.split("\n"),n=t.findIndex(e=>":PROPERTIES:"===e.trim()),a=t.findIndex(e=>":END:"===e.trim());if(-1===n||-1===a||!e.trim().startsWith(":PROPERTIES:"))return{propertyListItems:Object(w.List)(),strippedDescription:e};return{propertyListItems:Object(w.fromJS)(t.slice(n+1,a).map(e=>{const t=e.match(/:([^\s]*):(?: (.*))?/);if(!t)return null;let n=t[2]?mn(t[2]):null;return n&&"timestamp"!==n[0].type&&(n=[{contents:t[2],type:"text"}]),{property:t[1],value:n,id:v()}}).filter(e=>!!e)),strippedDescription:t.slice(a+1).join("\n")}})(t.strippedDescription),r=(e=>{const t=e.split("\n"),n=t.findIndex(e=>":LOGBOOK:"===e.trim());return-1!==n?Ln(t.slice(0,n),t.slice(n)):Ln([],[e])})(a.strippedDescription),s=(e=>{const t=e.split("\n"),n=t.findIndex(e=>":LOGBOOK:"===e.trim()),a=t.findIndex(e=>":END:"===e.trim());if(-1===n||-1===a||!e.trim().startsWith(":LOGBOOK:"))return{logBookEntries:Object(w.List)(),strippedDescription:e};const r=Sn(/^CLOCK: /,un,/$/),s=Sn(/^CLOCK: /,un,"/--/",un,/\s*=>\s*\S+$/);return{logBookEntries:Object(w.fromJS)(t.slice(n+1,a).map(e=>{const t=e.trim().match(s);if(t)return{start:gn(t,E.a.range(1,18)),end:gn(t,E.a.range(18,39)),id:v()};const n=e.trim().match(r);return n?{start:gn(n,E.a.range(1,18)),end:null,id:v()}:{raw:e.trimLeft(),id:v()}})),strippedDescription:t.slice(a+1).join("\n")}})(r.strippedDescription);return{planningItems:n,propertyListItems:a.propertyListItems,logNotes:r.logNotes,logBookEntries:s.logBookEntries,strippedDescription:s.strippedDescription}},Tn=(e,t)=>{const n=wn(t),a=n.planningItems,r=n.propertyListItems,s=n.logNotes,i=n.logBookEntries,o=n.strippedDescription,l=yn(o),c=e.getIn(["titleLine","title"]),d=Cn(a,Dn("TIMESTAMP_TITLE",c),Dn("TIMESTAMP_DESCRIPTION",l),Dn("TIMESTAMP_LOG_NOTES",s));return e.set("rawDescription",o).set("description",l).set("planningItems",d).set("propertyListItems",r).set("logNotes",s).set("logBookEntries",i)},vn=Object(w.fromJS)([{keywords:["TODO","DONE"],completedKeywords:["DONE"],default:!0}]),kn=(e,t)=>{const n=t.flatMap(e=>e.get("keywords")).filter(t=>e.startsWith(t+" ")).first();let a=e;n&&(a=a.substr(n.length+1));let r=[];if(a.trimRight().endsWith(":")){const e=a.trimRight().split(" "),t=e[e.length-1];/^:[^\s]+:$/.test(t)&&(a=a.substr(0,a.length-t.length),r=t.split(":").filter(e=>""!==e))}const s=mn(a);return Object(w.fromJS)({title:s,rawTitle:a,todoKeyword:n,tags:r})},_n=(e,t,n)=>{0===n.size&&(n=vn);const a=kn(e,n);return Object(w.fromJS)({titleLine:a,rawDescription:"",description:[],opened:!1,id:v(),nestingLevel:t,planningItems:[],propertyListItems:[],logNotes:[],logBookEntries:[]})},Sn=(...e)=>e.reduce((e,t)=>RegExp(In(e)+In(t))),In=e=>{const t=e.toString();return t.substring(1,t.length-1)},On=e=>{let t=Object(w.List)(),n=Object(w.List)();return e.forEach(e=>{const a=(e=>{if(!(e=>e.startsWith("#+TODO: ")||e.startsWith("#+TYP_TODO: ")||e.startsWith("#+SEQ_TODO: "))(e))return null;const t=e.substr(e.indexOf(":")+2).split(/\s/),n=t.filter(e=>"|"!==e).map(e=>e.replace(/\(.[!@]?(\/[!@])?\)$/,"")),a=t.indexOf("|"),r=a>=0?n.slice(a):[];return Object(w.fromJS)({keywords:n,completedKeywords:r,configLine:e,default:!1})})(e);a?t=t.push(a):e.startsWith("#+")&&(n=n.push(e))}),0===t.size&&(t=vn),{todoKeywordSets:t,fileConfigLines:n}},Dn=(e,t)=>t.filter(e=>"timestamp"===e.get("type")&&e.getIn(["firstTimestamp","isActive"])).map(t=>En({type:e,timestamp:t.get("firstTimestamp"),id:t.get("id")})),Cn=(...e)=>e[0].concat(...e.slice(1)),An=(e,t,n)=>e.filter(e=>e.get("type")!==t).merge(Dn(t,n)),Nn=e=>{let t=e.get("planningItems");return t=An(t,"TIMESTAMP_TITLE",e.getIn(["titleLine","title"])),t=An(t,"TIMESTAMP_DESCRIPTION",e.get("description")),t=An(t,"TIMESTAMP_LOG_NOTES",e.get("logNotes")),t},Pn=e=>{const t=e.indexOf(" ");return-1===t?e.trimRight().length:t},Rn=e=>{const t=e.split("\n");return t.length>0&&""!==t[t.length-1]?t:t.slice(0,t.length-1)},Ln=(e,t)=>{const n=e.join("\n");return{rawLogNotes:n,logNotes:yn(n),strippedDescription:t.join("\n")}},xn=(e,t)=>{const n=t.path,a=(e=>{let t=Object(w.List)();const n=Rn(e);let a=Object(w.List)();const r=On(n),s=r.todoKeywordSets,i=r.fileConfigLines;return n.forEach(e=>{if(e.match(/^\*+ /)){const n=Pn(e),a=e.substr(n+1);t=t.push(_n(a,n,s))}else 0===t.size?a=a.push(e):t=t.updateIn([t.size-1,"rawDescription"],t=>(t=t||"")+(e+"\n"))}),t=t.map(e=>{const t=e.get("rawDescription");return Tn(e,t)}),t=dn(t),Object(w.fromJS)({headers:t,todoKeywordSets:s,fileConfigLines:i,linesBeforeHeadings:a})})(t.contents);return e.setIn(["files",n,"headers"],a.get("headers")).setIn(["files",n,"todoKeywordSets"],a.get("todoKeywordSets")).setIn(["files",n,"fileConfigLines"],a.get("fileConfigLines")).setIn(["files",n,"linesBeforeHeadings"],a.get("linesBeforeHeadings"))},Mn=(e,t)=>{const n=e.get("headers"),a=te(n,t.headerId);return e.setIn(["headers",a,"opened"],!0)},Fn=(e,t)=>{const n=e.get("headers"),a=ee(n,t.headerId),r=a.header,s=a.headerIndex,i=r.get("opened");if(i&&e.get("narrowedHeaderId")===t.headerId)return e;if(i&&t.closeSubheadersRecursively){((e,t)=>{let n=re(e,t),a=Object(g.a)(n,2),r=a[0],s=a[1];return E.a.range(r,s)})(n,t.headerId).forEach(t=>{e=e.setIn(["headers",t,"opened"],!1)})}return e.setIn(["headers",s,"opened"],!i)},Hn=(e,t)=>e.set("selectedHeaderId",t.headerId),jn=(e,t)=>{let n=e.get("headers");const a=t.headerId;let r=ce(n,a);for(;r;){const e=te(n,r);n=n.setIn([e,"opened"],!0),r=ce(n,r)}return e.set("headers",n)},Bn=(e,t)=>{const n=t.filter(e=>e).length,a=t.length;return e.map(e=>{switch(e.get("type")){case"fraction-cookie":return e.set("fraction",Object(w.List)([n,a]));case"percentage-cookie":return e.set("percentage",Math.floor(n/a*100));default:return e}})},Wn=(e,t)=>{const n=e.get("headers"),a=te(n,t),r=ie(n,t),s=[];for(let o=0;o<r.size;++o){const e=r.get(o);s.push(e);o+=ie(n,e.get("id")).size}let i=s.map(e=>e.getIn(["titleLine","todoKeyword"])).filter(e=>!!e).map(t=>Ie(e.get("todoKeywordSets"),t).get("completedKeywords").contains(t));return 0===i.length&&(i=n.get(a).get("description").filter(e=>"list"===e.get("type")).flatMap(e=>e.get("items")).filter(e=>e.get("isCheckbox")).map(e=>"checked"===e.get("checkboxState")).toJS()),e.updateIn(["headers",a,"titleLine","title"],e=>Bn(e,i)).updateIn(["headers",a,"titleLine"],e=>e.set("rawTitle",J(e.get("title"))))},Un=(e,t)=>{const n=ce(e.get("headers"),t);return n?Wn(e,n):e},Vn=(e,t)=>{const n=t.headerId,a=t.logIntoDrawer,r=t.timestamp,s=n||e.get("selectedHeaderId");if(!s)return e;const i=e.get("headers"),o=ee(i,s),l=o.header,c=o.headerIndex,d=l.getIn(["titleLine","todoKeyword"]),h=Ie(e.get("todoKeywordSets"),d),u=h.get("keywords").indexOf(d)+1,p=h.get("keywords").get(u)||"";return e=function({currentTodoSet:e,newTodoState:t,indexedPlanningItemsWithRepeaters:n,state:a,headerIndex:r,currentTodoState:s,logIntoDrawer:i,timestamp:o}){return e.get("completedKeywords").includes(t)&&n.size>0?function({indexedPlanningItemsWithRepeaters:e,state:t,headerIndex:n,currentTodoSet:a,newTodoState:r,currentTodoState:s,logIntoDrawer:i,timestamp:o}){if(e.forEach(([e,a])=>{const r=((e,t)=>{if(!e.get("repeaterType"))return e;let n=null;switch(e.get("repeaterType")){case"+":n=U(W(e),e.get("repeaterValue"),e.get("repeaterUnit"));break;case"++":for(n=U(W(e),e.get("repeaterValue"),e.get("repeaterUnit"));Object(x.a)(n,t);)n=U(n,e.get("repeaterValue"),e.get("repeaterUnit"));break;case".+":n=U(t,e.get("repeaterValue"),e.get("repeaterUnit"));break;default:return console.error("Unrecognized timestamp repeater type: ".concat(e.get("repeaterType"))),e}return void 0!==(e=e.set("day",Object(k.a)(n,"dd")).set("dayName",Object(k.a)(n,"eee")).set("month",Object(k.a)(n,"MM")).set("year",Object(k.a)(n,"yyyy"))).get("startHour")&&null!==e.get("startHour")&&(e=e.set("startHour",Object(k.a)(n,"HH")).set("startMinute",Object(k.a)(n,"mm"))),e})(e.get("timestamp"),o);switch(t=t.setIn(["headers",n,"planningItems",a,"timestamp"],r),e.get("type")){case"TIMESTAMP_TITLE":const a=t.getIn(["headers",n,"titleLine","title"]).findIndex(t=>e.get("id")===t.get("id"));t=(t=t.setIn(["headers",n,"titleLine","title",a,"firstTimestamp"],r)).setIn(["headers",n,"titleLine","rawTitle"],J(t.getIn(["headers",n,"titleLine","title"])));break;case"TIMESTAMP_DESCRIPTION":const s=t.getIn(["headers",n,"description"]).findIndex(t=>e.get("id")===t.get("id"));t=(t=t.setIn(["headers",n,"description",s,"firstTimestamp"],r)).setIn(["headers",n,"rawDescription"],J(t.getIn(["headers",n,"description"])))}}),!function({state:e,headerIndex:t}){const n=e.get("fileConfigLines").some(e=>e.match(/^#\+STARTUP:.*nologrepeat.*/)),a=de(e.get("headers"),t,"LOGGING");return!!(n||a&&a.some(e=>"text"===e.get("type")&&e.get("contents").match(/\s*nologrepeat\s*/)))}({state:t=t.setIn(["headers",n,"titleLine","todoKeyword"],a.get("keywords").first()),headerIndex:n})){const e=H(o,{isActive:!1,withStartTime:!0}),a=[{type:"timestamp",id:v(),firstTimestamp:e,secondTimestamp:null}];t=function(e,t,n,a,r,s){const i=B(s,{isActive:!1,withStartTime:!0}),o='- State "'.concat(n,'"       from "').concat(a,'"       ').concat(i);if(r){const n=Object(w.fromJS)({id:v(),raw:o});return e.updateIn(["headers",t,"logBookEntries"],e=>e.unshift(n))}return oa(e,{noteText:o})}(t=t.updateIn(["headers",n,"propertyListItems"],e=>e.some(e=>"LAST_REPEAT"===e.get("property"))?e.map(e=>"LAST_REPEAT"===e.get("property")?e.set("value",Object(w.fromJS)(a)):e):e.push(Object(w.fromJS)({property:"LAST_REPEAT",value:a,id:v()}))),n,r,s,i,o)}return t}({indexedPlanningItemsWithRepeaters:n,state:a,headerIndex:r,currentTodoSet:e,newTodoState:t,currentTodoState:s,logIntoDrawer:i,timestamp:o}):a.setIn(["headers",r,"titleLine","todoKeyword"],t)}({currentTodoSet:h,newTodoState:p,indexedPlanningItemsWithRepeaters:l.get("planningItems").map((e,t)=>[e,t]).filter(([e])=>!!e.getIn(["timestamp","repeaterType"])),state:e,headerIndex:c,currentTodoState:d,logIntoDrawer:a,timestamp:r}),e=Un(e,s)},Gn=(e,t)=>e.set("editMode",t.editModeType),Kn=e=>e.set("editMode",null),zn=(e,t)=>{const n=e.get("headers"),a=te(n,t.headerId),r=e.get("todoKeywordSets"),s=kn(t.newRawTitle.trim(),r);return e=(e=e.setIn(["headers",a,"titleLine"],s)).updateIn(["headers",a,"planningItems"],e=>An(e,"TIMESTAMP_TITLE",s.get("title"))),Un(e,t.headerId)},Yn=(e,t)=>{const n=e.get("headers"),a=te(n,t.headerId);return e.updateIn(["headers",a],e=>Tn(e,t.newRawDescription))},Jn=(e,t)=>{const n=e.get("headers"),a=ee(n,t.headerId),r=a.header,s=a.headerIndex,i=ie(n,t.headerId),o=r.getIn(["titleLine","todoKeyword"]),l=_n(o?o+" ":"",r.get("nestingLevel"),e.get("todoKeywordSets"));return t.headerId===e.get("narrowedHeaderId")&&(e=e.set("narrowedHeaderId",null)),e.update("headers",e=>e.insert(s+i.size+1,l))},qn=(e,t)=>{const n=e.get("headers"),a=ee(n,t.headerId),r=a.header,s=a.headerIndex,i=ie(n,t.headerId),o=n.get(s+i.size+1);return o&&o.get("nestingLevel")===r.get("nestingLevel")?e.set("selectedHeaderId",o.get("id")):e},Xn=e=>{const t=e.get("headers");if(void 0===e.get("selectedHeaderId"))return e.set("selectedHeaderId",t.getIn([0,"id"]));const n=((e,t)=>e.slice(t+1).find(t=>he(e,t.get("id"))))(t,te(t,e.get("selectedHeaderId")));return n?e.set("selectedHeaderId",n.get("id")):e},$n=e=>{const t=e.get("headers"),n=((e,t)=>e.slice(0,t).reverse().find(t=>he(e,t.get("id"))))(t,te(t,e.get("selectedHeaderId")));return n?e.set("selectedHeaderId",n.get("id")):e},Zn=(e,t)=>{let n=e.get("headers");const a=te(n,t.headerId),r=1+ie(n,t.headerId).size,s=ce(n,t.headerId);return E.a.times(r).forEach(()=>{n=n.delete(a)}),t.headerId===e.get("narrowedHeaderId")&&(e=e.set("narrowedHeaderId",null)),e=e.set("headers",n),s&&(e=Wn(e,s)),e},Qn=(e,t)=>{let n=e.get("headers");const a=te(n,t.headerId),r=((e,t)=>{const n=e.getIn([t,"nestingLevel"]);for(let a=t-1;a>=0;--a){const t=e.get(a);if(t.get("nestingLevel")<n)return null;if(t.get("nestingLevel")===n)return a}return null})(n,a);if(null===r)return e;const s=ie(n,t.headerId);return E.a.times(1+s.size).forEach(()=>{n=n.insert(r,n.get(a+s.size)),n=n.delete(a+s.size+1)}),e.set("headers",n)},ea=(e,t)=>{let n=e.get("headers");const a=ee(n,t.headerId),r=a.header,s=a.headerIndex,i=ie(n,t.headerId),o=s+i.size+1,l=n.get(o);if(!l||l.get("nestingLevel")<r.get("nestingLevel"))return e;const c=ie(n,l.get("id"));return E.a.times(1+c.size).forEach(()=>{n=n.insert(s,n.get(o+c.size)),n=n.delete(o+c.size+1)}),e.set("headers",n)},ta=(e,t)=>{const n=e.get("headers"),a=te(n,t.headerId),r=ce(n,t.headerId);return e=Ja(e=qa({state:e,headerIndex:a},"-"),r,t)},na=(e,t)=>{const n=e.get("headers"),a=te(n,t.headerId),r=ce(n,t.headerId);return e=qa({state:e,headerIndex:a},"+"),e=Ja(e=ue(e,t.headerId),r,t)},aa=(e,t)=>{const n=e.get("headers"),a=ee(n,t.headerId),r=a.header,s=a.headerIndex,i=ce(n,t.headerId);if(1===r.get("nestingLevel"))return e;return e=Ja(e=qa({state:e,headerIndex:s,subheaders:ie(n,t.headerId)},"-"),i,t)},ra=(e,t)=>{const n=e.get("headers"),a=te(n,t.headerId),r=ce(n,t.headerId);return e=Ja(e=qa({state:e,headerIndex:a,subheaders:ie(n,t.headerId)},"+"),r,t),ue(e,t.headerId)},sa=({fromList:e,fromIndex:t,toIndex:n,item:a})=>{const r=e.get(n),s=(e=e.delete(t)).indexOf(r);return[e=e.insert(s+1,a),e]},ia=({fromList:e,fromIndex:t,toList:n,toIndex:a,item:r})=>{const s=n.get(a);e=e.delete(t);const i=n.indexOf(s);return[e,n=n.insert(i+1,r)]},oa=(e,t)=>{const n=t.noteText,a=e.get("selectedHeaderId"),r=e.get("headers"),s=te(r,a);return e.updateIn(["headers",s],e=>{const t=e.update("logNotes",e=>yn(n+(e.isEmpty()?"\n":"")).concat(e));return t.set("planningItems",Nn(t))})},la=(e,t)=>{const n=t.inputText,a=t.currentDate,r=((e,t)=>{const n=e.replace(/[\r\n]+/g," ").split(" ");let a=0;return n.reduce((e,n)=>a+n.length>=t?(a=n.length,e+"\n".concat(n)):(a+=n.length+(e?1:0),e?e+" ".concat(n):"".concat(n)),"")})(n,70).replace(/\n(.)/,"\n  $1"),s=B(a,{isActive:!1,withStartTime:!0}),i="- Note taken on ".concat(s," \\\\\n  ").concat(r);return oa(e,{noteText:i})},ca=(e,t)=>e.set("narrowedHeaderId",t.headerId),da=e=>e.set("narrowedHeaderId",null),ha=(e,t)=>e.set("isDirty",t.isDirty),ua=(e,t)=>e.set("selectedTableCellId",t.cellId),pa=(e,t,n=null)=>{const a=e.get("headers");n||(n=ye(a,t));const r=te(a,n.get("id"));return e.updateIn(["headers",r],e=>e.set("rawDescription",J(e.get("description"))))},ga=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",e=>ke(e,t,e=>t=>t.insert(e+1,(e=>e.get(0).set("id",v()).update("contents",e=>e.map(e=>e.set("id",v()).set("contents",Object(w.List)()).set("rawContents",""))))(t)))),pa(e,t)):e},ma=e=>{const t=e.get("selectedTableCellId");if(!t)return e;const n=ye(e.get("headers"),t);return e=(e=e.update("headers",e=>ke(e,t,e=>t=>t.delete(e)))).set("selectedTableCellId",null),pa(e,t,n)},fa=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",e=>ke(e,t,(e,t)=>e=>e.map(e=>e.update("contents",e=>e.insert(t+1,Object(w.fromJS)({id:v(),contents:[],rawContents:""})))))),pa(e,t)):e},ba=e=>{const t=e.get("selectedTableCellId");if(!t)return e;const n=ye(e.get("headers"),t);return e=(e=e.update("headers",e=>ke(e,t,(e,t)=>e=>e.map(e=>e.update("contents",e=>e.delete(t)))))).set("selectedTableCellId",null),pa(e,t,n)},ya=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",e=>ke(e,t,e=>t=>e+1===t.size?t:t.insert(e,t.get(e+1)).delete(e+2))),pa(e,t)):e},Ea=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",e=>ke(e,t,e=>t=>0===e?t:t.insert(e-1,t.get(e)).delete(e+1))),pa(e,t)):e},wa=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",e=>ke(e,t,(e,t)=>e=>0===t?e:e.map(e=>e.update("contents",e=>0===e.size?e:e.insert(t-1,e.get(t)).delete(t+1))))),pa(e,t)):e},Ta=e=>{const t=e.get("selectedTableCellId");return t?(e=e.update("headers",e=>ke(e,t,(e,t)=>e=>t+1>=e.getIn([0,"contents"]).size?e:e.map(e=>e.update("contents",e=>0===e.size?e:e.insert(t,e.get(t+1)).delete(t+2))))),pa(e,t)):e},va=(e,t)=>(e=e.update("headers",e=>ke(e,t.cellId,(e,n)=>a=>a.updateIn([e,"contents",n],e=>e.set("rawContents",t.newValue).set("contents",Object(w.fromJS)(mn(t.newValue,{excludeCookies:!0})))))),pa(e,t.cellId)),ka=(e,t)=>{const n=e.get("headers"),a=t.template,r=t.content,s=t.shouldPrepend,i=_a(a,n,s),o=i.newIndex,l=i.nestingLevel,c=i.parentHeader;if(void 0===o)return e;const d=((e,t)=>{const n=e.split("\n")[0].replace(/^\**\s*|\s*$/g,""),a=e.split("\n").slice(1).join("\n"),r=_n(n,1,t);return Tn(r,a)})(r,e.get("todoKeywordSets")).set("nestingLevel",l);return e=e.update("headers",e=>e.insert(o,d)),void 0!==c&&(e=Wn(e,c.get("id"))),e},_a=(e,t,n)=>{const a=e.get("headerPaths");if(0===a.size)return n?{newIndex:0,nestingLevel:1}:{newIndex:t.size+1,nestingLevel:1};const r=ge(t,a);if(null==r)return{};const s=te(t,r.get("id")),i=oe(t,r.get("id"));return{newIndex:s+1+(n?0:i),nestingLevel:r.get("nestingLevel")+1,parentHeader:r}},Sa=(e,t)=>{const n=t.slice(0,t.length-4),a=e.getIn(n);if(!a.get("isCheckbox"))return e;const r=a.get("contents").filter(e=>"list"===e.get("type")).flatMap(e=>e.get("items").filter(e=>e.get("isCheckbox")).map(e=>e.get("checkboxState")));e=r.every(e=>"checked"===e)?e.setIn(n.concat(["checkboxState"]),"checked"):r.every(e=>"unchecked"===e)?e.setIn(n.concat(["checkboxState"]),"unchecked"):e.setIn(n.concat(["checkboxState"]),"partial");const s=r.map(e=>{switch(e){case"checked":return!0;case"unchecked":case"partial":default:return!1}}).toJS();return e=e.updateIn(n.concat("titleLine"),e=>Bn(e,s)),Sa(e,n)},Ia=(e,t)=>{const n=(a=e.get("headers"),r=t.listItemId,a.map((e,t)=>{const n=we(e.get("description"),r);if(!n)return null;const a=n.path,s=n.listItemPart;return{path:[t,"description"].concat(a),listItemPart:s}}).filter(e=>e).first());var a,r;const s=n.path,i=n.listItemPart;if(i.get("contents").filter(e=>"list"===e.get("type")).some(e=>e.get("items").some(e=>e.get("isCheckbox"))))return e;const o={checked:"unchecked",unchecked:"checked",partial:"unchecked"}[i.get("checkboxState")];e=e.setIn(["headers"].concat(s).concat(["checkboxState"]),o),e=Sa(e,["headers"].concat(s));const l=s[0];return e=(e=Wn(e,e.getIn(["headers",l,"id"]))).updateIn(["headers",l],e=>e.set("rawDescription",J(e.get("description"))))},Oa=(e,t)=>e.set("lastSyncAt",t.lastSyncAt),Da=(e,t)=>{const n=e.get("headers"),a=te(n,t.headerId);return-1===a?e:e.setIn(["headers",a,"titleLine","tags"],t.tags)},Ca=(e,t)=>{const n=e.get("selectedHeaderId");if(!n)return e;const a=te(e.get("headers"),n);return e.updateIn(["headers",a,"titleLine","tags"],e=>e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex)))},Aa=(e,t)=>{const n=t.headerId;if(!n)return e;const a=te(e.get("headers"),n);return e.updateIn(["headers",a,"propertyListItems"],e=>e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex)))},Na=(e,t)=>{const n=ve(e.get("headers"),t.timestampId);if(!n)return e;const a=n.path,r=a[0];return e.setIn(["headers"].concat(a),t.newTimestamp).updateIn(["headers",r],e=>{const t=e.get("description"),n=e.getIn(["titleLine","title"]);return e.setIn(["titleLine","rawTitle"],J(n)).set("rawDescription",J(t)).set("planningItems",Nn(e))})},Pa=(e,t)=>{const n=t.headerId,a=t.planningItemIndex,r=t.newTimestamp,s=te(e.get("headers"),n);return e.setIn(["headers",s,"planningItems",a,"timestamp"],r)},Ra=(e,t)=>{const n=te(e.get("headers"),t.headerId),a=Object(w.fromJS)({id:v(),type:t.planningType,timestamp:H(t.timestamp)});return e.updateIn(["headers",n,"planningItems"],e=>e?e.push(a):Object(w.List)([a]))},La=(e,t)=>{const n=te(e.get("headers"),t.headerId),a=t.planningItemIndex;return e.removeIn(["headers",n,"planningItems",a])},xa=(e,t)=>{const n=ve(e.get("headers"),t.timestampId).path;return e=(e=(e=(e=e.removeIn(["headers",...n])).updateIn(["headers",n[0],"planningItems"],e=>e.filter(e=>e.get("id")!==t.timestampId))).setIn(["headers",n[0],"titleLine","rawTitle"],J(e.getIn(["headers",n[0],"titleLine","title"])))).setIn(["headers",n[0],"rawDescription"],J(e.getIn(["headers",n[0],"description"])))},Ma=(e,t)=>{const n=te(e.get("headers"),t.headerId);return e.setIn(["headers",n,"propertyListItems"],t.newPropertyListItems)},Fa=(e,t)=>{const n=t.headerId,a=t.entryId,r=t.time,s=te(e.get("headers"),n),i=e.getIn(["headers",s,"logBookEntries"]).findIndex(e=>e.get("id")===a);return e.setIn(["headers",s,"logBookEntries",i,"end"],Object(w.fromJS)(r))},Ha=(e,t)=>{const n=t.headerId,a=t.time,r=te(e.get("headers"),n),s=Object(w.fromJS)({id:v(),start:a,end:null});return e.updateIn(["headers",r,"logBookEntries"],e=>e?e.unshift(s):Object(w.List)([s]))},ja=(e,t)=>{const n=t.headerId,a=t.entryIndex,r=t.entryType,s=t.newTime,i=te(e.get("headers"),n);return e.setIn(["headers",i,"logBookEntries",a,r],Object(w.fromJS)(s))},Ba=(e,t,n,a,r)=>e.mapEntries(([e,s])=>[e,s.update("headers",s=>{const i=t.find(t=>e===t.get("path"));return n===e?s:i?i.get(a)?s:Object(w.List)():e.startsWith("organice_internal_")?Object(w.List)():r?s:Object(w.List)()})]),Wa=({searchFilterExpr:e=[],headersToSearch:t,path:n})=>{let a,r=200;const s=(e=>{const t=(e,t)=>n=>n.type===e&&n.exclude===t,n=e=>e.words,a=e=>e.words.map(e=>e.toLowerCase()),r=e.filter(t("tag",!1)).map(n),s=e.filter(t("case-sensitive",!1)).map(n),i=e.filter(t("ignore-case",!1)).map(a),o=e.filter(t("property",!1)).map(e=>[e.property,e.words]),l=e.filter(t("field",!1)),c=l.filter(e=>"date"===e.field.type).map(nn),d=l.filter(e=>"scheduled"===e.field.type).map(nn),h=l.filter(e=>"deadline"===e.field.type).map(nn),u=e.filter(t("tag",!0)).map(n),p=e.filter(t("case-sensitive",!0)).map(n),g=e.filter(t("ignore-case",!0)).map(a),m=e.filter(t("property",!0)).map(e=>[e.property,e.words]);return e=>{const t=e.get("titleLine"),n=t.get("tags"),a=t.get("todoKeyword"),l=t.get("rawTitle"),f=a?"".concat(a," ").concat(l):l,b=e.get("propertyListItems").map(e=>[e.get("property"),J(e.get("value"))]),y=e.get("planningItems").filter(e=>!0===e.get("timestamp").get("isActive")),E=y.map(e=>e.get("timestamp")),w=y.filter(e=>"SCHEDULED"===e.get("type")).map(e=>e.get("timestamp")),T=y.filter(e=>"DEADLINE"===e.get("type")).map(e=>e.get("timestamp")),v=([e,t])=>!b.filter(([n,a])=>{const r=n.toLowerCase()===e.toLowerCase(),s=t.some(e=>a.includes(e));return r&&s}).isEmpty();return r.every(an(n))&&s.every(an(f))&&i.every(an(f.toLowerCase()))&&o.every(v)&&c.every(rn(E))&&d.every(rn(w))&&h.every(rn(T))&&!u.some(an(n))&&!p.some(an(f))&&!g.some(an(f.toLowerCase()))&&!m.some(v)}})(e),i=t.get(n).filter(s).take(r);r-=i.count(),a=Object(w.Map)().set(n,i);return t.keySeq().filter(e=>e!==n).forEach(e=>{if(r>0){const n=t.get(e).filter(s).take(r);r-=n.count(),a=a.set(e,n)}}),a},Ua=(e,t)=>{const n=t.searchFilter,a=t.cursorPosition,r=t.context;let s=e.get("files");e=e.asMutable();let i,o=!0;try{i=Bt.a.parse(n),e.setIn(["search","searchFilterExpr"],i)}catch(u){o=!1}const l=e.get("path"),c=e.get("fileSettings");if("agenda"===r?s=Ba(s,c,l,"includeInAgenda",!1):"search"===r?s=Ba(s,c,l,"includeInSearch",!1):"task-list"===r?s=Ba(s,c,l,"includeInTasklist",!1):"refile"===r&&(s=Ba(s,c,l,"includeInRefile",!1)),e.setIn(["search","searchFilterValid"],o),o){const t=s.map(e=>e.get("headers")),n=i.filter(e=>"field"===e.type).filter(e=>"clock"===e.field.type),a=n.map(nn),o=0!==n.length;e.setIn(["search","showClockedTimes"],o);const c=e.getIn(["files",l,"narrowedHeaderId"]);let d;d=c&&"refile"!==r?Object(w.Map)().set(l,ie(t.get(l),c)):t,o&&(d=d.map(e=>e.map(e=>e.set("totalFilteredTimeLogged",cn(a,e)))),d=d.map(e=>((e,t)=>{if(!t)return t;const n=t.map(t=>t.set("totalFilteredTimeLogged",cn(e,t)));return n.map((e,t)=>{const a=se(n,t).reduce((e,t)=>e+t.get("totalFilteredTimeLogged"),e.get("totalFilteredTimeLogged"));return e.set("totalFilteredTimeLoggedRecursive",a)})})(a,e).filter(e=>0!==e.get("totalFilteredTimeLoggedRecursive"))));let h=Wa({searchFilterExpr:i,headersToSearch:d,path:l});if(o){const t=h.map(e=>e.reduce((e,t)=>e+t.get("totalFilteredTimeLogged"),0)).toList().reduce((e,t)=>e+t,0);e.setIn(["search","clockedTime"],t)}if("refile"===r){const n=e.getIn(["files",l,"selectedHeaderId"]);let a=ie(t.get(l),n).map(e=>e.get("id")).toJS();a.push(n),h=h.update(l,e=>e.filter(e=>!a.includes(e.get("id"))))}e.setIn(["search","filteredHeaders"],h)}e.setIn(["search","searchFilter"],n);const d=["TODO organice","-organice :medium","-DONE doc|man :assignee:none"];let h=[];if(E.a.isEmpty(n))h=d;else{const e=s.get(l),t=e.get("headers"),r=(e=>e.get("todoKeywordSets").flatMap(e=>e.get("keywords")).toSet().toJS())(e),o=Oe(t).toJS(),c=De(t).toJS();h=sn(r,o,c)(i,n,a)}return e.setIn(["search","searchFilterSuggestions"],h),e.asImmutable()},Va=(e,t)=>e.findIndex(e=>e.get("id")===t),Ga=(e,t)=>t.newSettings?((e,t)=>{const n=Object(w.fromJS)(JSON.parse(t.fileSettings)).map(e=>e.set("id",v()));return e.set("fileSettings",n)})(e,t.newSettings):e,Ka=(e,t,n)=>(a,...r)=>e.updateIn(["files",n],e=>a(e||Object(w.Map)(),t,...r)),za=(e,t)=>{const n=e.get("path"),a=Ka(e,t,n);switch(t.type){case"PARSE_FILE":return xn(e,t);case"CLEAR_SEARCH":return(e=>e.setIn(["search","filteredHeaders"],null))(e);case"TOGGLE_HEADER_OPENED":return a(Fn);case"OPEN_HEADER":return a(Mn);case"SELECT_HEADER":return a(Hn);case"OPEN_PARENTS_OF_HEADER":return a(jn);case"ADVANCE_TODO_STATE":return a(Vn);case"ENTER_EDIT_MODE":return a(Gn);case"EXIT_EDIT_MODE":return a(Kn);case"UPDATE_HEADER_TITLE":return a(zn);case"UPDATE_HEADER_DESCRIPTION":return a(Yn);case"ADD_HEADER":return a(Jn);case"SELECT_NEXT_SIBLING_HEADER":return a(qn);case"SELECT_NEXT_VISIBLE_HEADER":return a(Xn);case"SELECT_PREVIOUS_VISIBLE_HEADER":return a($n);case"REMOVE_HEADER":return a(Zn);case"MOVE_HEADER_UP":return a(Qn);case"MOVE_HEADER_DOWN":return a(ea);case"MOVE_HEADER_LEFT":return a(ta);case"MOVE_HEADER_RIGHT":return a(na);case"MOVE_SUBTREE_LEFT":return a(aa);case"MOVE_SUBTREE_RIGHT":return a(ra);case"REFILE_SUBTREE":return((e,t)=>{const n=t.sourcePath,a=t.sourceHeaderId,r=t.targetPath,s=t.targetHeaderId,i=n===r?sa:ia;let o=e.getIn(["files",n,"headers"]),l=e.getIn(["files",r,"headers"]),c=ee(o,a),d=c.header,h=c.headerIndex,u=te(l,s),p=ie(o,a);const m=o.getIn([h,"nestingLevel"]),f=l.getIn([u,"nestingLevel"]);d=d.set("nestingLevel",f+1);var b=i({fromList:o,fromIndex:h,toList:l,toIndex:u,item:d}),y=Object(g.a)(b,2);return o=y[0],l=y[1],p.forEach((e,t)=>{e=e.set("nestingLevel",e.get("nestingLevel")-m+f+1);const n=te(o,e.get("id"));u=te(l,s);var a=i({fromList:o,fromIndex:n,toList:l,toIndex:u+t+1,item:e}),r=Object(g.a)(a,2);o=r[0],l=r[1]}),e=(e=(e=(e=e.setIn(["files",n,"headers"],o)).setIn(["files",r,"headers"],l)).updateIn(["files",n],e=>Ja(e,a,t))).updateIn(["files",r],e=>Ja(e,s,t))})(e,t);case"HEADER_ADD_NOTE":return a(la);case"APPLY_OPENNESS_STATE":return((e,t)=>{const n=t.path,a=e.get("opennessState");if(!a)return e;const r=a.get(n);if(!r||0===r.size)return e;let s=e.getIn(["files",n,"headers"]);return r.forEach(e=>{s=me(s,e)}),e.setIn(["files",n,"headers"],s)})(e,t);case"SET_OPENNESS_STATE":return((e,t)=>{const n=t.path,a=t.opennessState;return e.setIn(["opennessState",n],Object(w.fromJS)(a))})(e,t);case"SET_DIRTY":return t.path?Ka(e,t,t.path)(ha):a(ha);case"NARROW_HEADER":return a(ca);case"WIDEN_HEADER":return a(da);case"SET_SELECTED_TABLE_CELL_ID":return a(ua);case"ADD_NEW_TABLE_ROW":return a(ga);case"REMOVE_TABLE_ROW":return a(ma);case"ADD_NEW_TABLE_COLUMN":return a(fa);case"REMOVE_TABLE_COLUMN":return a(ba);case"MOVE_TABLE_ROW_DOWN":return a(ya);case"MOVE_TABLE_ROW_UP":return a(Ea);case"MOVE_TABLE_COLUMN_LEFT":return a(wa);case"MOVE_TABLE_COLUMN_RIGHT":return a(Ta);case"UPDATE_TABLE_CELL_VALUE":return a(va);case"INSERT_CAPTURE":return t.template.get("file")?Ka(e,t,t.template.get("file"))(ka):a(ka);case"CLEAR_PENDING_CAPTURE":return(e=>e.set("pendingCapture",null))(e);case"ADVANCE_CHECKBOX_STATE":return a(Ia);case"SET_LAST_SYNC_AT":return t.path?Ka(e,t,t.path)(Oa):a(Oa);case"SET_HEADER_TAGS":return a(Da);case"REORDER_TAGS":return a(Ca);case"REORDER_PROPERTY_LIST":return a(Aa);case"UPDATE_TIMESTAMP_WITH_ID":return a(Na);case"UPDATE_PLANNING_ITEM_TIMESTAMP":return a(Pa);case"ADD_NEW_PLANNING_ITEM":return a(Ra);case"REMOVE_PLANNING_ITEM":return a(La);case"REMOVE_TIMESTAMP":return a(xa);case"UPDATE_PROPERTY_LIST_ITEMS":return a(Ma);case"SET_ORG_FILE_ERROR_MESSAGE":return((e,t)=>e.set("orgFileErrorMessage",t.message))(e,t);case"SET_LOG_ENTRY_STOP":return a(Fa);case"CREATE_LOG_ENTRY_START":return a(Ha);case"UPDATE_LOG_ENTRY_TIME":return a(ja);case"SET_SEARCH_FILTER_INFORMATION":return Ua(e,t);case"SET_PATH":return((e,t)=>e.set("path",t.path))(e,t);case"TOGGLE_CLOCK_DISPLAY":return((e,t)=>(t.showClockDisplay&&(e=e.update("headers",dn)),e.set("showClockDisplay",t.showClockDisplay)))(e,t);case"UPDATE_FILE_SETTING_FIELD_PATH_VALUE":return((e,t)=>{const n=Va(e.get("fileSettings"),t.settingId);return e.setIn(["fileSettings",n].concat(t.fieldPath),t.newValue)})(e,t);case"REORDER_FILE_SETTING":return((e,t)=>e.update("fileSettings",e=>e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))))(e,t);case"DELETE_FILE_SETTING":return((e,t)=>{const n=Va(e.get("fileSettings"),t.settingId);return e.update("fileSettings",e=>e.delete(n))})(e,t);case"ADD_NEW_EMPTY_FILE_SETTING":return(e=>e.update("fileSettings",e=>e.push(Object(w.fromJS)({id:v(),path:"",loadOnStartup:!1,includeInAgenda:!1,includeInSearch:!1,includeInRefile:!1,includeInTasklist:!1}))))(e);case"RESTORE_FILE_SETTINGS":return Ga(e,t);default:return e}};const Ya=(e,t)=>{if(t.dirtying){if("REFILE_SUBTREE"===t.type)return[t.sourcePath,t.targetPath];if("INSERT_CAPTURE"===t.type){const n=t.template.get("file");return n?[n]:[e.get("path")]}return[e.get("path")]}return[]};function Ja(e,t,n){return e=Wn(e,t),e=Un(e,n.headerId)}function qa({state:e,headerIndex:t,subheaders:n=[]},a="-"){return e=e.updateIn(["headers",t,"nestingLevel"],r()),n.forEach((n,a)=>{e=e.updateIn(["headers",t+a+1,"nestingLevel"],r())}),e;function r(){return e=>"-"===a?Math.max(e-1,1):e+1}}const Xa=(e,t)=>{if(At){const n=JSON.parse(localStorage.getItem("isDirty"))||{};n[t]=e,localStorage.setItem("isDirty",JSON.stringify(n))}},$a=(e,t)=>{if(At&&!t.startsWith("organice_internal_")){const n=JSON.parse(localStorage.getItem("persistedFiles"))||{},a=X({headers:e.org.present.getIn(["files",t,"headers"]),linesBeforeHeadings:e.org.present.getIn(["files",t,"linesBeforeHeadings"]),dontIndent:e.base.get("shouldNotIndentOnExport")});localStorage.setItem("files__"+t,a),n[t]=e.org.present.getIn(["files",t,"lastSyncAt"]),localStorage.setItem("persistedFiles",JSON.stringify(n))}},Za={},Qa=(e,t)=>{let n=Za[t];n||(Za[t]=Object(y.debounce)($a,3e3,{leading:!0,trailing:!0}),n=Za[t]),n(e,t)},er=e=>{if(At){const t=JSON.parse(localStorage.getItem("persistedFiles"))||{},n=JSON.parse(localStorage.getItem("isDirty"))||{};Object.entries(t).forEach(([t,a])=>{const r=localStorage.getItem("files__"+t);r&&(e.org.present=e.org.present.update(e=>xn(e,{path:t,contents:r})),e.org.present=e.org.present.setIn(["files",t,"lastSyncAt"],Object(wt.a)(a)),e.org.present=e.org.present.setIn(["files",t,"isDirty"],n[t]))})}return e},tr=(e,t)=>n=>{if(At&&!e.startsWith("organice_internal_")){((e,t)=>{if(At&&!e.startsWith("organice_internal_")){let n=JSON.parse(localStorage.getItem("persistedFiles"));n=n||{},localStorage.setItem("files__"+e,t),n[e]=Object(Et.a)(new Date,5),localStorage.setItem("persistedFiles",JSON.stringify(n))}})(e,t);const a=Rt();a&&n(Lr(e,a[e]))}n({type:"PARSE_FILE",path:e,contents:t}),n(xr(e))},nr=(e,t)=>({type:"SET_LAST_SYNC_AT",path:t,lastSyncAt:e}),ar=()=>e=>{e(Rr()),e(mt()),e({type:"CLEAR_SEARCH"}),e(hr(null)),e(f.ActionCreators.clearHistory())},rr={},sr=(e,t,n)=>{let a=[];if(n.path)a=[n.path];else{const e=t().org.present.get("files");a=e.keySeq().filter(t=>e.getIn([t,"isDirty"]))}a.forEach(t=>{let a=rr[t];a||(rr[t]=Object(y.debounce)((e,t)=>e(or(t)),3e3,{leading:!0,trailing:!0}),a=rr[t]),a(e,n)})},ir=e=>(t,n)=>{if(n().base.get("online"))if("manual"===e.forceAction){console.log("forcing sync");n().org.present.get("files").keySeq().forEach(n=>t(or(Object(m.a)({},e,{path:n}))))}else sr(t,n,e)},or=({forceAction:e=null,successMessage:t="Changes pushed",shouldSuppressMessages:n=!1,path:a}={})=>(r,s)=>{const i=s().syncBackend.get("client"),o=s().org.present.get("path");(a=a||o)&&!a.startsWith("organice_internal_")&&(s().base.get("isLoading").includes(a)&&"manual"!==e?r(ir({forceAction:"push"})):(n||r(He("Syncing ...")),r(Be(!0,a)),r(os(null)),i.getFileContentsAndMetadata(a).then(({contents:o,lastModifiedAt:l})=>{const c=s().org.present.getIn(["files",a,"isDirty"]),d=Object(wt.a)(l),h=s().org.present.getIn(["files",a,"lastSyncAt"]);if(Object(yt.a)(h,d)||"push"===e)if(c){const e=localStorage.getItem("files__"+a)||X({headers:s().org.present.getIn(["files",a,"headers"]),linesBeforeHeadings:s().org.present.getIn(["files",a,"linesBeforeHeadings"]),dontIndent:s().base.get("shouldNotIndentOnExport")});i.updateFile(a,e).then(()=>{n?setTimeout(()=>r(je()),2e3):r(Ue(t,2e3)),r(Be(!1,a)),r(Fr(!1,a)),r(nr(Object(Et.a)(new Date,5),a))}).catch(e=>{const t="There was an error pushing the file ".concat(a,": ").concat(e.toString());console.error(t),r(Ue(t,5e3)),r(je()),r(Be(!1,a)),r(ir({path:a}))})}else n?setTimeout(()=>r(je()),2e3):r(Ue("Nothing to sync",2e3)),r(Be(!1,a));else c&&"pull"!==e?(r(je()),r(Be(!1,a)),r(gt("sync-confirmation",{lastServerModifiedAt:d,lastSyncAt:h,path:a}))):(r(tr(a,o)),r(Fr(!1,a)),r(nr(Object(Et.a)(new Date,5),a)),n?setTimeout(()=>r(je()),2e3):r(Ue("Latest version pulled: ".concat(a),2e3)),r(Be(!1,a)))}).catch(()=>{r(je()),r(Be(!1,a)),r(os("File ".concat(a," not found")))})))},lr=e=>({type:"OPEN_HEADER",headerId:e}),cr=(e,t)=>({type:"TOGGLE_HEADER_OPENED",headerId:e,closeSubheadersRecursively:t}),dr=e=>t=>{t({type:"SELECT_HEADER",headerId:e}),e&&t(Hr(null))},hr=e=>t=>{t({type:"SET_PATH",path:e}),t({type:f.ActionTypes.CLEAR_HISTORY})},ur=(e,t)=>n=>{n(hr(e)),n({type:"OPEN_PARENTS_OF_HEADER",headerId:t}),setTimeout(()=>n(dr(t)),0)},pr=(e,t)=>({type:"ADVANCE_TODO_STATE",headerId:e,logIntoDrawer:t,dirtying:!0,timestamp:new Date}),gr=e=>({type:"ENTER_EDIT_MODE",editModeType:e}),mr=()=>({type:"EXIT_EDIT_MODE"}),fr=(e,t)=>({type:"UPDATE_HEADER_TITLE",headerId:e,newRawTitle:t,dirtying:!0}),br=(e,t)=>({type:"UPDATE_HEADER_DESCRIPTION",headerId:e,newRawDescription:t,dirtying:!0}),yr=e=>({type:"ADD_HEADER",headerId:e,dirtying:!1}),Er=e=>({type:"SELECT_NEXT_SIBLING_HEADER",headerId:e}),wr=e=>t=>{t(yr(e)),t(Er(e)),t(gr("title"))},Tr=e=>({type:"SELECT_NEXT_VISIBLE_HEADER",headerId:e}),vr=e=>({type:"SELECT_PREVIOUS_VISIBLE_HEADER",headerId:e}),kr=e=>({type:"REMOVE_HEADER",headerId:e,dirtying:!0}),_r=e=>({type:"MOVE_HEADER_UP",headerId:e,dirtying:!0}),Sr=e=>({type:"MOVE_HEADER_DOWN",headerId:e,dirtying:!0}),Ir=e=>({type:"MOVE_HEADER_LEFT",headerId:e,dirtying:!0}),Or=e=>({type:"MOVE_HEADER_RIGHT",headerId:e,dirtying:!0}),Dr=e=>({type:"MOVE_SUBTREE_LEFT",headerId:e,dirtying:!0}),Cr=e=>({type:"MOVE_SUBTREE_RIGHT",headerId:e,dirtying:!0}),Ar=(e,t,n,a)=>({type:"REFILE_SUBTREE",sourcePath:e,sourceHeaderId:t,targetPath:n,targetHeaderId:a,dirtying:!0}),Nr=(e,t)=>({type:"HEADER_ADD_NOTE",inputText:e,currentDate:t,dirtying:!0}),Pr=e=>({type:"NARROW_HEADER",headerId:e}),Rr=()=>({type:"WIDEN_HEADER"}),Lr=(e,t)=>({type:"SET_OPENNESS_STATE",path:e,opennessState:t}),xr=e=>({type:"APPLY_OPENNESS_STATE",path:e}),Mr=(e,t)=>({type:"SET_DIRTY",isDirty:e,path:t}),Fr=(e,t)=>n=>{Xa(e,t),n(Mr(e,t))},Hr=e=>t=>{t({type:"SET_SELECTED_TABLE_CELL_ID",cellId:e}),e&&t(dr(null))},jr=()=>({type:"ADD_NEW_TABLE_ROW",dirtying:!0}),Br=()=>({type:"REMOVE_TABLE_ROW",dirtying:!0}),Wr=()=>({type:"ADD_NEW_TABLE_COLUMN",dirtying:!0}),Ur=()=>({type:"REMOVE_TABLE_COLUMN",dirtying:!0}),Vr=()=>({type:"MOVE_TABLE_ROW_DOWN",dirtying:!0}),Gr=()=>({type:"MOVE_TABLE_ROW_UP",dirtying:!0}),Kr=()=>({type:"MOVE_TABLE_COLUMN_LEFT",dirtying:!0}),zr=()=>({type:"MOVE_TABLE_COLUMN_RIGHT",dirtying:!0}),Yr=(e,t)=>({type:"UPDATE_TABLE_CELL_VALUE",cellId:e,newValue:t,dirtying:!0}),Jr=(e,t,n)=>(a,r)=>{a(mt());a({type:"INSERT_CAPTURE",template:r().capture.get("captureTemplates").concat(bt).find(t=>t.get("id")===e),content:t,shouldPrepend:n,dirtying:!0})},qr=()=>({type:"CLEAR_PENDING_CAPTURE"}),Xr=()=>(e,t)=>{const n=t().org.present.get("path"),a=t().org.present.get("pendingCapture"),r=a.get("captureTemplateName"),s=a.get("captureContent"),i=a.get("customCaptureVariables");e(qr()),window.history.pushState({},"",window.location.pathname);const o=t().capture.get("captureTemplates").filter(e=>e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").includes(t().org.present.get("path"))).find(e=>e.get("description").trim()===r.trim());if(!o)return void e(Ue('Capture failed: "'.concat(r,'" template not found or not available in this file'),8e3));if(!ge(t().org.present.getIn(["files",n,"headers"]),o.get("headerPaths")))return void e(Ue('Capture failed: "'.concat(o.get("description"),'" header path invalid in this file'),8e3));const l=Z(o.get("template"),i),c=Object(g.a)(l,2),d=c[0],h=c[1],u=h?"".concat(d.substring(0,h)).concat(s).concat(d.substring(h)):"".concat(d).concat(s);e(Jr(o.get("id"),u,o.get("shouldPrepend"))),e(ir({successMessage:"Item captured"}))},$r=e=>({type:"ADVANCE_CHECKBOX_STATE",listItemId:e,dirtying:!0}),Zr=(e,t)=>({type:"SET_HEADER_TAGS",headerId:e,tags:t,dirtying:!0}),Qr=(e,t)=>({type:"REORDER_TAGS",fromIndex:e,toIndex:t,dirtying:!0}),es=(e,t)=>(n,a)=>n({type:"REORDER_PROPERTY_LIST",fromIndex:e,toIndex:t,headerId:a().base.getIn(["activePopup","data","headerId"]),dirtying:!0}),ts=(e,t)=>({type:"UPDATE_TIMESTAMP_WITH_ID",timestampId:e,newTimestamp:t,dirtying:!0}),ns=(e,t,n)=>({type:"UPDATE_PLANNING_ITEM_TIMESTAMP",headerId:e,planningItemIndex:t,newTimestamp:n,dirtying:!0}),as=(e,t)=>({type:"ADD_NEW_PLANNING_ITEM",headerId:e,planningType:t,dirtying:!0,timestamp:new Date}),rs=(e,t)=>({type:"REMOVE_PLANNING_ITEM",headerId:e,planningItemIndex:t,dirtying:!0}),ss=(e,t)=>({type:"REMOVE_TIMESTAMP",headerId:e,timestampId:t,dirtying:!0}),is=(e,t)=>({type:"UPDATE_PROPERTY_LIST_ITEMS",headerId:e,newPropertyListItems:t,dirtying:!0}),os=e=>({type:"SET_ORG_FILE_ERROR_MESSAGE",message:e}),ls=(e,t,n)=>({type:"SET_LOG_ENTRY_STOP",headerId:e,entryId:t,time:n,dirtying:!0}),cs=(e,t)=>({type:"CREATE_LOG_ENTRY_START",headerId:e,time:t,dirtying:!0}),ds=(e,t,n,a)=>({type:"UPDATE_LOG_ENTRY_TIME",headerId:e,entryIndex:t,entryType:n,newTime:a,dirtying:!0}),hs=(e,t,n)=>({type:"SET_SEARCH_FILTER_INFORMATION",searchFilter:e,cursorPosition:t,context:n}),us=e=>({type:"TOGGLE_CLOCK_DISPLAY",showClockDisplay:e}),ps=(e,t,n)=>({type:"UPDATE_FILE_SETTING_FIELD_PATH_VALUE",settingId:e,fieldPath:t,newValue:n}),gs=(e,t)=>({type:"REORDER_FILE_SETTING",fromIndex:e,toIndex:t}),ms=e=>({type:"DELETE_FILE_SETTING",settingId:e}),fs=()=>e=>e({type:"ADD_NEW_EMPTY_FILE_SETTING"}),bs=e=>({type:"RESTORE_FILE_SETTINGS",newSettings:e});var ys=e=>t=>n=>(setTimeout(()=>{let t=Ya(e.getState().org.present,n);t.forEach(t=>Qa(e.getState(),t)),t.forEach(e=>Xa(!0,e)),e.getState().base.get("shouldLiveSync")&&t.forEach(t=>e.dispatch(ir({shouldSuppressMessages:!0,path:t})))},0),t(n)),Es=e=>t=>n=>{const a=window.matchMedia("(prefers-color-scheme: dark)");return"addEventListener"in a&&a.addEventListener("change",t=>{const n=t.matches?"Dark":"Light";e.dispatch(st(n))}),t(n)};const ws=(e,t)=>t.newSettings?((e,t,n)=>(Pt.filter(e=>e.category===n).forEach(n=>{e="json"===n.type?e.set(n.name,Object(w.fromJS)(JSON.parse(t[n.name]))):e.set(n.name,t[n.name])}),e))(e,t.newSettings,"base"):e;const Ts=(e,t)=>e.findIndex(e=>e.get("id")===t),vs=(e,t)=>t.newSettings?((e,t)=>{const n=Object(w.fromJS)(JSON.parse(t.captureTemplates)).map(e=>e.set("id",v()));return e.set("captureTemplates",n)})(e,t.newSettings):e;f.ActionCreators.undo=function(){return e=>{e({type:f.ActionTypes.UNDO}),e(Fr(!0)),e(ir({forceAction:"push"}))}},f.ActionCreators.redo=function(){return e=>{e({type:f.ActionTypes.REDO}),e(Fr(!0)),e(ir({forceAction:"push"}))}};var ks=Object(u.c)({base:(e=Object(w.Map)(),t)=>{switch(t.type){case"SET_LOADING_MESSAGE":return((e,t)=>e.set("loadingMessage",t.loadingMessage))(e,t);case"HIDE_LOADING_MESSAGE":return(e=>e.set("loadingMessage",null))(e);case"SET_FONT_SIZE":return((e,t)=>e.set("fontSize",t.newFontSize))(e,t);case"SET_BULLET_STYLE":return((e,t)=>e.set("bulletStyle",t.newBulletStyle))(e,t);case"SET_SHOULD_TAP_TODO_TO_ADVANCE":return((e,t)=>e.set("shouldTapTodoToAdvance",t.newShouldTapTodoToAdvance))(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT":return((e,t)=>e.set("agendaDefaultDeadlineDelayUnit",t.newAgendaDefaultDeadlineDelayUnit))(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE":return((e,t)=>e.set("agendaDefaultDeadlineDelayValue",t.newAgendaDefaultDeadlineDelayValue))(e,t);case"SET_AGENDA_START_ON_WEEKDAY":return((e,t)=>e.set("agendaStartOnWeekday",t.newAgendaStartOnWeekday))(e,t);case"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND":return((e,t)=>e.set("shouldStoreSettingsInSyncBackend",t.newShouldStoreSettingsInSyncBackend))(e,t);case"SET_COLOR_SCHEME":return((e,t)=>e.set("colorScheme",t.colorScheme))(e,t);case"SET_THEME":return((e,t)=>e.set("theme",t.theme))(e,t);case"SET_SHOULD_LIVE_SYNC":return((e,t)=>e.set("shouldLiveSync",t.shouldLiveSync))(e,t);case"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE":return((e,t)=>e.set("shouldSyncOnBecomingVisibile",t.shouldSyncOnBecomingVisibile))(e,t);case"SET_SHOULD_SHOW_TITLE_IN_ORG_FILE":return((e,t)=>e.set("shouldShowTitleInOrgFile",t.shouldShowTitleInOrgFile))(e,t);case"SET_SHOULD_LOG_INTO_DRAWER":return((e,t)=>e.set("shouldLogIntoDrawer",t.shouldLogIntoDrawer))(e,t);case"SET_CLOSE_SUBHEADERS_RECURSIVELY":return((e,t)=>e.set("closeSubheadersRecursively",t.closeSubheadersRecursively))(e,t);case"SET_SHOULD_NOT_INDENT_ON_EXPORT":return((e,t)=>e.set("shouldNotIndentOnExport",t.shouldNotIndentOnExport))(e,t);case"SET_HAS_UNSEEN_CHANGELOG":return((e,t)=>e.set("hasUnseenChangelog",t.newHasUnseenChangelog))(e,t);case"SET_LAST_SEEN_CHANGELOG_HEADER":return((e,t)=>e.set("lastSeenChangelogHash",t.newLastSeenChangelogHash))(e,t);case"SET_LAST_VIEWED_FILE":return((e,t)=>e.set("lastViewedPath",t.lastViewedPath))(e,t);case"SET_CUSTOM_KEYBINDING":return((e,t)=>(e.get("customKeybindings")||(e=e.set("customKeybindings",Object(w.Map)())),e.setIn(["customKeybindings",t.keybindingName],t.keybinding)))(e,t);case"RESTORE_BASE_SETTINGS":return ws(e,t);case"PUSH_MODAL_PAGE":return((e,t)=>e.update("modalPageStack",e=>e?e.push(t.modalPage):Object(w.List)([t.modalPage])))(e,t);case"POP_MODAL_PAGE":return(e=>e.update("modalPageStack",e=>e?e.pop():e))(e);case"CLEAR_MODAL_STACK":return(e=>e.set("modalPageStack",Object(w.List)()))(e);case"ACTIVATE_POPUP":return((e,t)=>{const n=t.data,a=t.popupType;return["search","task-list","agenda"].includes(a)&&window.history.replaceState({},"","".concat(window.location.pathname,"#").concat(a)),e.set("activePopup",Object(w.fromJS)({type:a,data:n}))})(e,t);case"CLOSE_POPUP":return(e=>(window.history.replaceState("",document.title,window.location.pathname+window.location.search),e.set("activePopup",null)))(e);case"SET_IS_LOADING":return((e,t)=>t.isLoading?e.update("isLoading",e=>e.add(t.path)):e.update("isLoading",e=>e.delete(t.path)))(e,t);case"SET_IS_ONLINE":return((e,t)=>e.set("online",t.online))(e,t);case"SET_AGENDA_TIMEFRAME":return((e,t)=>e.set("agendaTimeframe",t.agendaTimeframe))(e,t);default:return e}},syncBackend:(e=Object(w.Map)(),t)=>{switch(t.type){case"SIGN_OUT":return(e=>e.set("isAuthenticated",!1).set("client",null))(e);case"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING":return((e,t)=>e.set("currentFileBrowserDirectoryListing",Object(w.Map)({listing:t.directoryListing,hasMore:t.hasMore,additionalSyncBackendState:t.additionalSyncBackendState})))(e,t);case"SET_IS_LOADING_MORE_DIRECTORY_LISTING":return((e,t)=>e.update("currentFileBrowserDirectoryListing",e=>e||Object(w.Map)()).setIn(["currentFileBrowserDirectoryListing","isLoadingMore"],t.isLoadingMore))(e,t);default:return e}},org:b()((e=Object(w.Map)(),t)=>{const n=Ya(e,t);return n.forEach(t=>{e=e.setIn(["files",t,"isDirty"],!0)}),e=za(e,t),t.dirtying&&e.get("showClockDisplay")&&n.forEach(t=>{e=e.updateIn(["files",t,"headers"],dn)}),e},{filter:Object(f.includeAction)(["ADD_HEADER","REMOVE_HEADER","MOVE_HEADER_UP","MOVE_HEADER_DOWN","MOVE_HEADER_LEFT","MOVE_HEADER_RIGHT","MOVE_SUBTREE_LEFT","MOVE_SUBTREE_RIGHT","ADVANCE_TODO_STATE","UPDATE_HEADER_TITLE","UPDATE_HEADER_DESCRIPTION","ADD_NEW_TABLE_ROW","ADD_NEW_TABLE_COLUMN","REMOVE_TABLE_ROW","REMOVE_TABLE_COLUMN","UPDATE_TABLE_CELL_VALUE","MOVE_TABLE_ROW_DOWN","MOVE_TABLE_ROW_UP","MOVE_TABLE_COLUMN_LEFT","MOVE_TABLE_COLUMN_RIGHT","INSERT_CAPTURE","REFILE_SUBTREE","HEADER_ADD_NOTE","SET_HEADER_TAGS","UPDATE_PROPERTY_LIST_ITEMS","ADD_NEW_PLANNING_ITEM","REMOVE_PLANNING_ITEM","CREATE_LOG_ENTRY_START","SET_LOG_ENTRY_STOP"])}),capture:(e=Object(w.Map)(),t)=>{switch(t.type){case"ADD_NEW_EMPTY_CAPTURE_TEMPLATE":return(e=>(e.get("captureTemplates")||(e=e.set("captureTemplates",Object(w.List)())),e.update("captureTemplates",e=>e.push(Object(w.fromJS)({id:v(),description:"",letter:"",iconName:"",isAvailableInAllOrgFiles:!0,file:"",orgFilesWhereAvailable:[""],headerPaths:[""],shouldPrepend:!1,template:""})))))(e);case"UPDATE_TEMPLATE_FIELD_PATH_VALUE":return((e,t)=>{const n=Ts(e.get("captureTemplates"),t.templateId);return e.setIn(["captureTemplates",n].concat(t.fieldPath),t.newValue)})(e,t);case"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY":return((e,t)=>{const n=Ts(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],e=>e.push(""))})(e,t);case"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY":return((e,t)=>{const n=Ts(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],e=>e.delete(t.orgFileAvailabilityIndex))})(e,t);case"ADD_NEW_TEMPLATE_HEADER_PATH":return((e,t)=>{const n=Ts(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],e=>e.push(""))})(e,t);case"REMOVE_TEMPLATE_HEADER_PATH":return((e,t)=>{const n=Ts(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],e=>e.delete(t.headerPathIndex))})(e,t);case"DELETE_TEMPLATE":return((e,t)=>{const n=Ts(e.get("captureTemplates"),t.templateId);return e.update("captureTemplates",e=>e.delete(n))})(e,t);case"RESTORE_CAPTURE_SETTINGS":return vs(e,t);case"REORDER_CAPTURE_TEMPLATE":return((e,t)=>e.update("captureTemplates",e=>e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))))(e,t);default:return e}}});const _s=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.d;var Ss=()=>{(()=>{if(!At)return;const e=localStorage.getItem("accessToken");e&&(localStorage.setItem("dropboxAccessToken",e),localStorage.removeItem("accessToken"))})(),(()=>{if(!At)return;const e=localStorage.getItem("shouldStoreSettingsInDropbox");e&&(localStorage.setItem("shouldStoreSettingsInSyncBackend",e),localStorage.removeItem("shouldStoreSettingsInDropbox"))})(),At&&Object.entries(localStorage).forEach(([e,t],n)=>{["null","undefined"].includes(t)&&(console.warn("localStorage contains a bogus entry: '".concat(e,"': '").concat(t,"'")),console.warn("Deleting the bogus entry."),localStorage.removeItem(e))})};var Is=e=>{var t=Object.create(null);return"string"!==typeof e?t:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var n=e.replace(/\+/g," ").split("="),a=n.shift(),r=n.length>0?n.join("="):void 0;a=decodeURIComponent(a),r=void 0===r?null:decodeURIComponent(r),void 0===t[a]?t[a]=r:Array.isArray(t[a])?t[a].push(r):t[a]=[t[a],r]})),t):t},Os=n(15),Ds=n(21);const Cs=()=>(e,t)=>{switch(t().syncBackend.get("client",{}).type){case"WebDAV":["Endpoint","Username","Password"].forEach(e=>{Ft("webdav"+e,null)});break;case"Dropbox":Ft("dropboxAccessToken",null);break;case"Google Drive":gapi.auth2.getAuthInstance().signOut()}Ft("authenticatedSyncService",null),e({type:"SIGN_OUT"}),e(pt()),e(je()),At&&localStorage.clear()},As=(e,t,n)=>({type:"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING",directoryListing:e,hasMore:t,additionalSyncBackendState:n}),Ns=e=>({type:"SET_IS_LOADING_MORE_DIRECTORY_LISTING",isLoadingMore:e}),Ps=e=>(t,n)=>{t(He("Getting listing..."));n().syncBackend.get("client").getDirectoryListing(e).then(({listing:e,hasMore:n,additionalSyncBackendState:a})=>{t(As(e,n,a)),t(je())}).catch(e=>{alert("There was an error retrieving files!"),console.error(e),t(je())})},Rs=()=>(e,t)=>{e(Ns(!0));const n=t().syncBackend.get("client"),a=t().syncBackend.get("currentFileBrowserDirectoryListing");n.getMoreDirectoryListing(a.get("additionalSyncBackendState")).then(({listing:t,hasMore:n,additionalSyncBackendState:r})=>{const s=a.get("listing").concat(t);e(As(s,n,r)),e(Ns(!1))})},Ls=(e,t)=>(n,a)=>{const r=a().syncBackend.get("client");switch(r.type){case"Dropbox":case"WebDAV":r.createFile("".concat(e,".organice-bak"),t);break;case"Google Drive":e=e.startsWith("/")?e.substr(1):e,r.duplicateFile(e,e=>"".concat(e,".organice-bak"))}},xs=e=>(t,n)=>{t(He("Downloading file ...")),n().syncBackend.get("client").getFileContents(e).then(n=>{t(je()),t(Ls(e,n)),t(tr(e,n)),t(nr(Object(Et.a)(new Date,5),e)),t(Fr(!1,e)),t(f.ActionCreators.clearHistory())}).catch(()=>{t(je()),t(Be(!1,e)),t(os("File ".concat(e," not found")))})};var Ms=n(76);var Fs=e=>{const t=new Ms.Dropbox({accessToken:e,fetch:fetch.bind(window)}),n=e=>{const t=(e=>e.filter(e=>"folder"===e[".tag"]||e.name.match(xe)).sort((e,t)=>"folder"===e[".tag"]&&"file"===t[".tag"]?-1:e.name>t.name?1:-1))(e);return Object(w.fromJS)(t.map(e=>({id:e.id,name:e.name,isDirectory:"folder"===e[".tag"],path:e.path_display})))},a=(e,n)=>new Promise((a,r)=>t.filesUpload({path:e,contents:n,mode:{".tag":"overwrite"},autorename:!0}).then(a).catch(r)),r=e=>new Promise((n,a)=>t.filesDownload({path:e}).then(e=>{const t=new FileReader;t.addEventListener("loadend",()=>n({contents:t.result,lastModifiedAt:e.result.server_modified})),t.readAsText(e.result.fileBlob)}).catch(e=>{const t=function(){try{return"not_found"===JSON.parse(e.error).error.path[".tag"]}catch(t){return!1}}();("string"===typeof e&&e.match(/missing required field 'path'/)||t)&&a()}));return{type:"Dropbox",isSignedIn:()=>new Promise(e=>e(!0)),getDirectoryListing:e=>new Promise((a,r)=>{t.filesListFolder({path:e}).then(e=>{a({listing:n(e.result.entries),hasMore:e.result.has_more,additionalSyncBackendState:Object(w.Map)({cursor:e.result.cursor})})}).catch(r)}),getMoreDirectoryListing:e=>{const a=e.get("cursor");return new Promise((e,r)=>t.filesListFolderContinue({cursor:a}).then(t=>e({listing:n(t.result.entries),hasMore:t.result.has_more,additionalSyncBackendState:Object(w.Map)({cursor:t.result.cursor})})))},updateFile:a,createFile:a,getFileContentsAndMetadata:r,getFileContents:e=>Object(y.isEmpty)(e)?Promise.reject("No path given"):new Promise((t,n)=>r(e).then(({contents:e})=>t(e)).catch(n)),deleteFile:e=>new Promise((n,a)=>t.filesDelete({path:e}).then(n).catch(e=>a("path_lookup"===e.error.error[".tag"],e)))}},Hs=()=>{const e=(()=>{let e=!1,t=!1;const n=[];return()=>new Promise((a,r)=>{e?a(window.gapi):window.gapi&&!t?(t=!0,new Promise((e,t)=>window.gapi.load("client:auth2",()=>{window.location.hash=window.initialHash,window.gapi.client.init({client_id:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DROPBOX_CLIENT_ID:"fj1bxjp9nkh15l5"}).REACT_APP_GOOGLE_DRIVE_CLIENT_ID,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:"https://www.googleapis.com/auth/drive.file"}).then(e)})).then(()=>{e=!0,n.forEach(e=>e(window.gapi)),a(window.gapi)})):n.push(a)})})();window.gapi?e():window.handleGoogleDriveClientLoad=e;const t=(t,n=null)=>{const a=new Promise((a,r)=>{e().then(e=>{e.client.drive.files.list({pageSize:30,fields:"nextPageToken, files(id, name, mimeType, parents)",q:"'".concat(""===t?"root":t,"' in parents and trashed = false"),pageToken:n}).then(e=>{var n;a({listing:(n=e.result.files,Object(w.fromJS)(n.map(e=>({id:e.id,name:e.name,isDirectory:"application/vnd.google-apps.folder"===e.mimeType,path:"/".concat(e.id)})))),hasMore:!!e.result.nextPageToken,additionalSyncBackendState:Object(w.Map)({currentDirectoryId:t,nextPageToken:e.result.nextPageToken})})}).catch(r)})}),r=new Promise((n,a)=>{""===t?n(null):e().then(e=>e.client.drive.files.get({fileId:t,fields:"parents"})).then(e=>{e.result.parents?n(e.result.parents[0]):n(null)}).catch(a)}),s=new Promise((t,n)=>{window.rootFolderId?t(window.rootFolderId):e().then(e=>e.client.drive.files.get({fileId:"root",fields:"id"})).then(e=>{window.rootFolderId=e.result.id,t(e.result.id)}).catch(n)});return new Promise((e,t)=>{Promise.all([a,r,s]).then(([t,n,a])=>{const r=n===a?"":n;t.additionalSyncBackendState=t.additionalSyncBackendState.set("parentId",r),e(t)})})},n=(t,n)=>new Promise((a,r)=>{e().then(e=>e.client.drive.files.list({pageSize:1,fields:"files(id)",q:"'".concat(n,"' in parents and trashed = false and name = '").concat(t,"'")})).then(e=>a(e.result.files.length>0?e.result.files[0].id:null)).catch(r)}),a=(t,n)=>(t=t.startsWith("/")?t.substr(1):t,e().then(e=>{fetch("https://www.googleapis.com/upload/drive/v3/files/".concat(t,"?uploadType=media"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e.auth.getToken().access_token)},body:n})})),r=t=>new Promise((n,a)=>{if(!t)return a();e().then(e=>{t=t.startsWith("/")?t.substr(1):t;const r=new Promise(n=>{e.client.drive.files.get({fileId:t,alt:"media"}).then(e=>n(decodeURIComponent(escape(e.body)))).catch(e=>{e.body&&"notFound"===JSON.parse(e.body).error.errors[0].reason&&a()})}),s=new Promise(n=>{e.client.drive.files.get({fileId:t,fields:"modifiedTime"}).then(e=>{n(e.result.modifiedTime)}).catch(e=>{e.body&&"notFound"===JSON.parse(e.body).error.errors[0].reason&&a()})});Promise.all([r,s]).then(([e,t])=>{n({contents:e,lastModifiedAt:t})})})}),s=e=>new Promise((t,n)=>r(e).then(({contents:e})=>t(e)).catch(n));return{type:"Google Drive",isSignedIn:()=>new Promise((t,n)=>e().then(e=>t(e.auth2.getAuthInstance().isSignedIn.get()))),getDirectoryListing:e=>t(e.startsWith("/")?e.substr(1):e),getMoreDirectoryListing:e=>{const n=e.get("currentDirectoryId"),a=e.get("nextPageToken");return t(n,a)},updateFile:a,createFile:(t,r,s)=>new Promise((i,o)=>{n(t,r).then(n=>n?a(n,s).then(i).catch(o):e().then(e=>{e.client.drive.files.create({name:t,parents:r}).then(e=>a(e.result.id,s)).then(i).catch(o)})).catch(o)}),duplicateFile:(t,a)=>new Promise((r,s)=>{e().then(e=>{e.client.drive.files.get({fileId:t,fields:"name, parents"}).then(i=>{if(i.result.name){const o=a(i.result.name),l=i.result.parents[0];n(o,l).then(n=>{const a=()=>{e.client.drive.files.copy({fileId:t,parents:l,name:o}).then(()=>{r()}).catch(s)};n?e.client.drive.files.delete({fileId:n}).then(a).catch(s):a()})}else s()})})}),getFileContentsAndMetadata:r,getFileContents:s,getFileContentsByNameAndParent:(e,t)=>new Promise((a,r)=>n(e,t).then(e=>{e?s(e).then(a):r()})),deleteFileByNameAndParent:(t,n)=>new Promise((a,r)=>{e().then(e=>e.client.drive.files.list({pageSize:1,fields:"files(id)",q:"'".concat(n,"' in parents and trashed = false and name = '").concat(t,"'")}).then(t=>{t.result.files.length>0?e.client.drive.files.delete({fileId:t.result.files[0].id}).then(a).catch(r):a()}))})}},js=n(170);n(327);var Bs=n(16),Ws=(n(328),n(9)),Us=n.n(Ws),Vs=(n(329),({href:e,children:t})=>l.a.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},t||e));var Gs=()=>l.a.createElement("div",{className:"privacy-policy-container"},l.a.createElement("h1",null,"organice privacy policy"),l.a.createElement("p",null,"Last updated: May 9th, 2020"),l.a.createElement("p",null,l.a.createElement(Vs,{href:"https://200ok.ch/"},"200ok llc")," operates the"," ",l.a.createElement(Vs,{href:"https://organice.200ok.ch"})," website and mobile apps."),l.a.createElement("p",null,"This page is used to inform website visitors regarding our policies with the collection, use, and disclosure of Personal Information if anyone decided to use our Service."),l.a.createElement("p",null,"If you choose to use our Service, then you agree to the collection and use of information in relation with this policy. The Personal Information that we collect are used for providing and improving the Service. We will not use or share your information with anyone except as described in this Privacy Policy."),l.a.createElement("p",null,l.a.createElement("strong",null,"Information Collection and Use")),l.a.createElement("p",null,"For a better experience while using our Service, we may require you to provide us with certain personally identifiable information, including but not limited to your name, phone number, and postal address. The information that we collect will be used to contact or identify you."),l.a.createElement("p",null,l.a.createElement("strong",null,"Log Data")),l.a.createElement("p",null,"We want to inform you that whenever you visit our Service, we collect information that your browser sends to us that is called Log Data. This Log Data may include information such as your computer\u2019s Internet Protocol (\u201cIP\u201d) address, browser version, pages of our Service that you visit, the time and date of your visit, the time spent on those pages, and other statistics."),l.a.createElement("p",null,l.a.createElement("strong",null,"User data")),l.a.createElement("p",null,"No user data, including user data from third-party services such as Dropbox or Google, will be stored or monitored by our Service. All access to user data is done through the proper APIs of the respective services, and all data is only processed by the browser. No data will be shared with any other service."),l.a.createElement("p",null,l.a.createElement("strong",null,"Cookies")),l.a.createElement("p",null,"Cookies are files with small amount of data that is commonly used an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your computer\u2019s hard drive."),l.a.createElement("p",null,"Our website uses these \u201ccookies\u201d to collection information and to improve our Service. You have the option to either accept or refuse these cookies, and know when a cookie is being sent to your computer. If you choose to refuse our cookies, you may not be able to use some portions of our Service."),l.a.createElement("p",null,l.a.createElement("strong",null,"Service Providers")),l.a.createElement("p",null,"We may employ third-party companies and individuals due to the following reasons:"),l.a.createElement("ul",null,l.a.createElement("li",null,"To facilitate our Service;"),l.a.createElement("li",null,"To provide the Service on our behalf;"),l.a.createElement("li",null,"To perform Service-related services; or"),l.a.createElement("li",null,"To assist us in analyzing how our Service is used.")),l.a.createElement("p",null,"We want to inform our Service users that these third parties have access to your Personal Information. The reason is to perform the tasks assigned to them on our behalf. However, they are obligated not to disclose or use the information for any other purpose."),l.a.createElement("p",null,l.a.createElement("strong",null,"Security")),l.a.createElement("p",null,"We value your trust in providing us your Personal Information, thus we are striving to use commercially acceptable means of protecting it. But remember that no method of transmission over the internet, or method of electronic storage is 100% secure and reliable, and we cannot guarantee its absolute security."),l.a.createElement("p",null,l.a.createElement("strong",null,"Links to Other Sites")),l.a.createElement("p",null,"Our Service may contain links to other sites. If you click on a third-party link, you will be directed to that site. Note that these external sites are not operated by us. Therefore, we strongly advise you to review the Privacy Policy of these websites. We have no control over, and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services."),l.a.createElement("p",null,l.a.createElement("strong",null,"Children\u2019s Privacy")),l.a.createElement("p",null,"Our Services do not address anyone under the age of 13. We do not knowingly collect personal identifiable information from children under 13. In the case we discover that a child under 13 has provided us with personal information, we immediately delete this from our servers. If you are a parent or guardian and you are aware that your child has provided us with personal information, please contact us so that we will be able to do necessary actions."),l.a.createElement("p",null,l.a.createElement("strong",null,"Changes to This Privacy Policy")),l.a.createElement("p",null,"We may update our Privacy Policy from time to time. Thus, we advise you to review this page periodically for any changes. We will notify you of any changes by posting the new Privacy Policy on this page. These changes are effective immediately, after they are posted on this page."),l.a.createElement("p",null,l.a.createElement("strong",null,"Contact us")),l.a.createElement("p",null,"If you have any questions about this Privacy Policy, please"," ",l.a.createElement("a",{href:"mailto:info@200ok.ch"},"contact us"),".")),Ks=n(77),zs=n.n(Ks);n(330);class Ys extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleChangelogClick","handleModalPageDoneClick","handleHeaderBarTitleClick","handleBackClick","handleUndoClick","handleRedoClick","handleHelpClick","handleSettingsClick"])}getPathRoot(){return this.props.location.pathname.split("/")[1]}getFilename(){const e=this.props.location.pathname;return e.includes(".org")?e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")):""}renderFileBrowserBackButton(){let e="Back";const t=window.location.href.split("/").map(e=>decodeURIComponent(e));return E.a.includes(t,"files")&&(e=E.a.last(t)),l.a.createElement("div",{onClick:()=>{window.history.back()},className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},e))}renderOrgFileBackButton(){let e=this.props.location.pathname.substr("/file".length);e.endsWith("/")&&(e=e.substring(0,e.length-1));const t=e.split("/"),n=t.slice(0,t.length-1).join("/");return l.a.createElement(Os.b,{to:"/files".concat(n),onClick:this.handleBackClick,className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"File browser"))}renderLogo(){return l.a.createElement("div",{className:"header-bar__logo-container"},l.a.createElement("img",{className:"header-bar__logo",src:zs.a,alt:"Logo",width:"30",height:"30"}),l.a.createElement("h2",{className:"header-bar__app-name"},"organice"))}renderHomeFileBackButton(){return l.a.createElement(Os.b,{to:"/",className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}renderSignInBackButton(){return l.a.createElement(Os.b,{to:"/",className:"header-bar__back-button"},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}handleBackClick(){this.props.base.popModalPage()}renderSettingsSubPageBackButton(){return l.a.createElement("div",{className:"header-bar__back-button",onClick:this.handleBackClick},l.a.createElement("i",{className:"fas fa-chevron-left"}),l.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Settings"))}renderBackButton(){switch(this.props.activeModalPage){case"changelog":case"keyboard_shortcuts_editor":case"capture_templates_editor":case"file_settings_editor":return this.renderSettingsSubPageBackButton();case"sample":return this.renderOrgFileBackButton()}switch(this.getPathRoot()){case"":return this.renderLogo();case"files":return this.renderFileBrowserBackButton();case"file":return this.renderOrgFileBackButton();case"sample":return this.renderHomeFileBackButton();case"sign_in":return this.renderSignInBackButton();case"settings":return this.renderFileBrowserBackButton();default:return l.a.createElement("div",null)}}renderTitle(){const e=e=>l.a.createElement("div",{className:"header-bar__title",onClick:this.handleHeaderBarTitleClick},e);switch(this.props.activeModalPage){case"changelog":return e("Changelog");case"settings":return e("Settings");case"keyboard_shortcuts_editor":return e("Shortcuts");case"capture_templates_editor":return e("Capture");case"file_settings_editor":return e("Files");case"sample":return e("Sample")}switch(this.getPathRoot()){case"sample":return e("Sample");case"sign_in":return e("Sign in");case"settings":return e("Settings")}return e(this.props.shouldShowTitleInOrgFile?this.getFilename():"")}handleChangelogClick(){this.props.base.restoreStaticFile("changelog"),this.props.base.pushModalPage("changelog")}handleModalPageDoneClick(){this.props.base.clearModalStack()}handleHeaderBarTitleClick(){this.props.org.selectHeader(null)}handleUndoClick(){this.props.isUndoEnabled&&this.props.undo.undo()}handleRedoClick(){this.props.isRedoEnabled&&this.props.undo.redo()}handleHelpClick(){this.props.base.restoreStaticFile("sample"),this.props.base.pushModalPage("sample")}handleSettingsClick(){this.props.base.setLastViewedFile(this.props.path)}renderActions(){const e=this.props,t=e.isAuthenticated,n=e.hasUnseenChangelog,a=e.activeModalPage,r=e.path,s=e.isUndoEnabled,i=e.isRedoEnabled;if(a)return l.a.createElement("div",{className:"header-bar__actions",onClick:this.handleModalPageDoneClick},"Done");if("settings"!==this.getPathRoot()){const e=Us()("fas fa-undo header-bar__actions__item",{"header-bar__actions__item--disabled":!s}),c=Us()("fas fa-redo header-bar__actions__item",{"header-bar__actions__item--disabled":!i}),d=Us()("fas fa-cogs header-bar__actions__item");return l.a.createElement("div",{className:"header-bar__actions"},!t&&"sign_in"!==this.getPathRoot()&&l.a.createElement(Os.b,{to:"/sign_in"},l.a.createElement("div",{className:"header-bar__actions__item",title:"Sign in"},"Sign in")),!t&&l.a.createElement(Vs,{href:"https://github.com/200ok-ch/organice"},l.a.createElement("i",{className:"fab fa-github header-bar__actions__item"})),t&&!a&&!!r&&l.a.createElement(o.Fragment,null,l.a.createElement("i",{className:e,onClick:this.handleUndoClick,title:"Undo"}),l.a.createElement("i",{className:c,onClick:this.handleRedoClick,title:"Redo"}),l.a.createElement("i",{className:"fas fa-question-circle header-bar__actions__item",onClick:this.handleHelpClick,title:"Help"})),t&&l.a.createElement("div",null,n&&l.a.createElement("i",{className:"changelog-icon--has-unseen-changelog header-bar__actions__item fas fa-gift",onClick:this.handleChangelogClick}),l.a.createElement(Os.b,{to:"/settings",onClick:this.handleSettingsClick},l.a.createElement("i",{className:d,title:"Settings"}))))}}render(){const e=Us()("header-bar",{"header-bar--with-logo":""===this.getPathRoot()});return l.a.createElement("div",{className:e},this.renderBackButton(),this.renderTitle(),this.renderActions())}}var Js=Object(Bs.h)(Object(h.b)(e=>({isAuthenticated:e.syncBackend.get("isAuthenticated"),hasUnseenChangelog:e.base.get("hasUnseenChangelog"),activeModalPage:e.base.get("modalPageStack",Object(w.List)()).last(),shouldShowTitleInOrgFile:e.base.get("shouldShowTitleInOrgFile"),path:e.org.present.get("path"),isUndoEnabled:e.org.past.length>0,isRedoEnabled:e.org.future.length>0,syncBackendType:e.syncBackend.get("client")&&e.syncBackend.get("client").type}),e=>({base:Object(u.b)(a,e),org:Object(u.b)(s,e),undo:Object(u.b)(f.ActionCreators,e)}))(Ys)),qs=(n(332),()=>l.a.createElement("main",{className:"landing-container-wrapper"},l.a.createElement("div",{className:"landing-container"},l.a.createElement("h1",{className:"landing-app-name"},"organice"),l.a.createElement("img",{className:"landing-logo",src:zs.a,alt:"Logo"}),l.a.createElement("h2",{className:"landing-tagline"},"organice organizes Org files nicely!"),l.a.createElement("h2",{className:"landing-tagline"},"Syncs with Dropbox,",l.a.createElement("br",null)," Google Drive and WebDAV."),l.a.createElement("p",{className:"landing-description"},"organice allows you to view and edit Org files from cloud storage directly on your device! No Org file or other user-data will be stored on our servers; the entire app is browser-based."),l.a.createElement(Os.b,{to:"/sign_in"},l.a.createElement("div",{className:"btn landing-button"},"Sign in")),l.a.createElement(Os.b,{to:"/sample"},l.a.createElement("div",{className:"btn landing-button doc-button"},"View sample")),l.a.createElement(Vs,{href:"https://organice.200ok.ch/documentation.html"},l.a.createElement("div",{className:"btn landing-button doc-button"},"Documentation"))),l.a.createElement("footer",null,l.a.createElement(Os.b,{to:"/privacy-policy"},"Privacy Policy"))));n(333);var Xs=Object(h.b)(e=>{const t=e.syncBackend.get("currentFileBrowserDirectoryListing");return{syncBackendType:e.syncBackend.get("client").type,listing:t?t.get("listing"):null,hasMore:!!t&&t.get("hasMore"),isLoadingMore:!!t&&t.get("isLoadingMore"),additionalSyncBackendState:!!t&&t.get("additionalSyncBackendState")}},e=>({syncBackend:Object(u.b)(i,e)}))(({path:e,listing:t,hasMore:n,isLoadingMore:a,syncBackendType:r,syncBackend:s,additionalSyncBackendState:i})=>{Object(o.useEffect)(()=>s.getDirectoryListing(e),[s,e]);const c=""===e;return l.a.createElement("div",{className:"file-browser-container"},"Dropbox"===r&&l.a.createElement("h3",{className:"file-browser__header"},"Directory: ",c?"/":e),l.a.createElement("ul",{className:"file-browser__file-list"},!c&&l.a.createElement(Os.b,{to:"/files".concat((()=>{switch(r){case"Dropbox":case"WebDAV":const t=e.split("/");return t.slice(0,t.length-1).join("/");case"Google Drive":return i.get("parentId")?"/"+i.get("parentId"):null;default:return null}})())},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:"fas fa-folder file-browser__file-list__icon--directory"})," ..")),(t||[]).map(e=>{const t=e.get("isDirectory"),n=e.get("name").endsWith(".organice-bak"),a=e.get("name").endsWith(".org"),r=".organice-config.json"===e.get("name"),s=Us()("file-browser__file-list__icon fas",{"fa-folder":t,"file-browser__file-list__icon--directory":t,"fa-file":!t&&!n&&!r,"file-browser__file-list__icon--not-org":!a,"fa-copy":n,"fa-cogs":r});return e.get("isDirectory")?l.a.createElement(Os.b,{to:"/files".concat(e.get("path")),key:e.get("id")},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:s})," ",e.get("name"),"/")):l.a.createElement(Os.b,{to:"/file".concat(e.get("path")),key:e.get("id")},l.a.createElement("li",{className:"file-browser__file-list__element"},l.a.createElement("i",{className:s})," ",e.get("name")))}),n&&(a?l.a.createElement("li",{className:"file-browser__file-list__loading-more-container"},l.a.createElement("i",{className:"fas fa-spinner fa-lg fa-spin"})):l.a.createElement("li",{className:"file-browser__file-list__element file-browser__file-list__element--load-more-row",onClick:()=>s.loadMoreDirectoryListing()},"Load more..."))))}),$s=n(14),Zs=(n(341),({message:e})=>{const t=Object(o.useState)(!0),n=Object(g.a)(t,2),a=n[0],r=n[1],s=Object(o.useState)(e),i=Object(g.a)(s,2),c=i[0],d=i[1];Object(o.useEffect)(()=>{e&&(d(e),r(!0))},[e]);const h=()=>r(!1);if(!a)return null;const u={opacity:Object($s.spring)(e?.9:0,{stiffness:300})};return l.a.createElement($s.Motion,{style:u,onRest:()=>{e||(r(!1),d(null))}},e=>l.a.createElement("div",{className:"loading-indicator",style:e,onClick:h},c))}),Qs=n(171),ei=(n(343),n(344),n(175)),ti=n(40),ni=(n(346),n(347),n(348),n(349),n(350),({subPartDataAndHandlers:{onEnterTableEditMode:e,onAddNewTableRow:t,onRemoveTableRow:n,onAddNewTableColumn:a,onRemoveTableColumn:r}})=>l.a.createElement("div",{className:"table-action-drawer-container"},l.a.createElement("div",{className:" table-action-drawer__edit-icon-container",onClick:e},l.a.createElement("i",{className:"fas fa-pencil-alt fa-lg"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:t},l.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:n},l.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:a},l.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"})),l.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:r},l.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),l.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"}))));class ai extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleCellSelect","handleTextareaBlur","handleCellChange","handleInsertTimestamp","handleTextareaRef"]),this.state={rawCellValues:this.generateCellValueMap(e.table),shouldIgnoreBlur:!1}}componentDidUpdate(e){const t=this.props.subPartDataAndHandlers,n=t.onTableCellValueUpdate,a=t.selectedTableCellId,r=t.inTableEditMode,s=this.state.rawCellValues;e.subPartDataAndHandlers.inTableEditMode&&!r&&s.has(a)&&n(a,s.get(a)),this.props.table!==e.table&&this.setState({rawCellValues:this.generateCellValueMap(this.props.table)})}generateCellValueMap(e){return Object(w.Map)(e.get("contents").map(e=>e.get("contents").map(e=>[e.get("id"),e.get("rawContents")])).flatten())}handleCellSelect(e){return()=>this.props.subPartDataAndHandlers.onTableCellSelect(e)}handleTextareaBlur(){setTimeout(()=>{this.state.shouldIgnoreBlur?this.setState({shouldIgnoreBlur:!1}):this.props.subPartDataAndHandlers.onExitTableEditMode()},0)}handleCellChange(e){const t=this.state.rawCellValues,n=this.props.subPartDataAndHandlers.selectedTableCellId;this.setState({rawCellValues:t.set(n,e.target.value)})}handleInsertTimestamp(){this.setState({shouldIgnoreBlur:!0});const e=this.state.rawCellValues,t=this.props.subPartDataAndHandlers.selectedTableCellId,n=e.get(t),a=this.textarea.selectionStart;this.setState({rawCellValues:e.set(t,n.substring(0,a)+j()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}handleTextareaRef(e){this.textarea=e}render(){const e=this.props,t=e.table,n=e.subPartDataAndHandlers,a=n.selectedTableCellId,r=n.inTableEditMode,s=n.shouldDisableActions,i=this.state.rawCellValues,c=t.get("contents").some(e=>e.get("contents").some(e=>e.get("id")===a));return l.a.createElement(o.Fragment,null,l.a.createElement("table",{className:"table-part"},l.a.createElement("tbody",null,t.get("contents").map(e=>l.a.createElement("tr",{key:e.get("id")},e.get("contents").map(e=>{const t=e.get("id")===a,n=Us()("table-part__cell",{"table-part__cell--selected":t});return l.a.createElement("td",{className:n,key:e.get("id"),onClick:this.handleCellSelect(e.get("id"))},t&&r?l.a.createElement("div",{className:"table-cell__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"3",value:i.get(e.get("id")),onBlur:this.handleTextareaBlur,onChange:this.handleCellChange,ref:this.handleTextareaRef}),l.a.createElement("div",{className:"table-cell__insert-timestamp-button",onClick:this.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):e.get("contents").size>0?l.a.createElement(ui,{parts:e.get("contents"),subPartDataAndHandlers:this.props.subPartDataAndHandlers}):"   ")}))))),l.a.createElement(ti.UnmountClosed,{isOpened:c&&!s},l.a.createElement(ni,{subPartDataAndHandlers:this.props.subPartDataAndHandlers})))}}n(351);const ri=(e,t,n)=>({r:parseInt((t.r-e.r)*n+e.r,10),g:parseInt((t.g-e.g)*n+e.g,10),b:parseInt((t.b-e.b)*n+e.b,10),a:(t.a-e.a)*n+e.a}),si=(e,t,n,a)=>({r:e,g:t,b:n,a:a}),ii=e=>"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")"),oi=e=>{const t=getComputedStyle(document.documentElement).getPropertyValue(e);if("#"===t.charAt(0)){const e=t.substring(1,7);return si(parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16),1)}{const e=[...t.matchAll(/[0-9.]+/g)].map(e=>+e[0]);return 3===e.length?si(...e,0):4===e.length?si(...e):si(0,0,0,0)}},li={Solarized:{Light:{"--base3":"#fdf6e3","--base2":"#eee8d5","--base1":"#93a1a1","--base0":"#839496","--base00":"#657b83","--base01":"#586e75","--base02":"#073642","--base03":"#002b36","--base0-soft":"rgba(131, 148, 150, 0.75)","--base1-soft":"rgba(147, 161, 161, 0.4)","--blue":"#268bd2","--green":"#859900","--cyan":"#2aa198","--yellow":"#b58900","--orange":"#cb4b16","--red":"#dc322f","--magenta":"#d33682","--violet":"#6c71c4","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base3":"#002b36","--base2":"#073642","--base1":"#586e75","--base0":"#657b83","--base03":"#fdf6e3","--base02":"#eee8d5","--base01":"#93a1a1","--base00":"#839496","--base0-soft":"rgba(0, 21, 27, 0.75)","--base1-soft":"rgba(0, 21, 27, 0.4)","--blue":"#268bd2","--green":"#859900","--cyan":"#2aa198","--yellow":"#b58900","--orange":"#cb4b16","--red":"#dc322f","--magenta":"#6c71c4","--violet":"#d33682","--green-soft:":"rgba(133, 153, 0, 0.28)"}},Gruvbox:{Light:{"--base3":"#fbf1c7","--base2":"#d5c4a1","--base1":"#bdae93","--base0":"#a89984","--base00":"#7c6f64","--base01":"#665c54","--base02":"#504945","--base03":"#282828","--base0-soft":"rgba(168, 153, 132, 0.75)","--base1-soft":"rgba(189, 174, 147, 0.4)","--blue":"#076678","--green":"#79740e","--cyan":"#427b58","--yellow":"#b57614","--orange":"#af3a03","--red":"#9d0006","--magenta":"#8f3f71","--violet":"#b16286","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base3":"#282828","--base2":"#504945","--base1":"#665c54","--base0":"#7c6f64","--base00":"#a89984","--base01":"#bdae93","--base02":"#d5c4a1","--base03":"#fbf1c7","--base0-soft":"rgba(20, 20, 20, 0.75)","--base1-soft":"rgba(20, 20, 20, 0.4)","--blue":"#458588","--green":"#98971a","--cyan":"#689d6a","--yellow":"#d79921","--orange":"#d65d0e","--red":"#cc241d","--magenta":"#b16286","--violet":"#d3869b","--green-soft":"rgba(133, 153, 0, 0.28)"}},One:{Light:{"--base03":"#383A42","--base02":"#585A5F","--base01":"#79797C","--base00":"#999999","--base0":"#A0A1A7","--base1":"#C0C0C4","--base2":"#DFE0E2","--base3":"#FFFFFF","--base0-soft":"rgba(160, 161, 167, 0.75)","--base1-soft":"rgba(192, 192, 196, 0.4)","--blue":"#1492ff","--green":"#2db448","--cyan":"#D831B0","--yellow":"#d5880b","--orange":"#f42a2a","--red":"#f42a2a","--magenta":"hsl(208, 100%, 56%)","--violet":"#D831B0","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base03":"#abb2bf","--base02":"#9198A5","--base01":"#767D8A","--base00":"#5c6370","--base0":"#4c5263","--base1":"#404553","--base2":"#343944","--base3":"#282c34","--base0-soft":"rgba(20, 22, 26, 0.75)","--base1-soft":"rgba(20, 22, 26, 0.4)","--blue":"rgb(100, 148, 237)","--green":"rgb(115, 201, 144)","--cyan":"rgb(204, 133, 51)","--yellow":"rgb(226, 192, 141)","--orange":"rgb(255, 99, 71)","--red":"#D831B0","--magenta":"rgb(0, 136, 255)","--violet":"#d33682","--green-soft":"rgba(133, 153, 0, 0.28)"}},Smyck:{Light:{"--base3":"#F7F7F7","--base2":"#DFDFDF","--base1":"#C8C8C8","--base0":"#B0B0B0","--base00":"#5D5D5D","--base01":"#3E3E3E","--base02":"#1F1F1F","--base03":"#000000","--base0-soft":"rgba(176, 176, 176, 0.75)","--base1-soft":"rgba(200, 200, 200, 0.4)","--blue":"#72B3CC","--green":"#8EB33B","--cyan":"#218693","--yellow":"#D0B03C","--orange":"#C75646","--red":"#E09690","--magenta":"#77DFD8","--violet":"#FBB1F9","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base3":"#000000","--base2":"#1F1F1F","--base1":"#3E3E3E","--base0":"#5D5D5D","--base00":"#B0B0B0","--base01":"#C8C8C8","--base02":"#DFDFDF","--base03":"#F7F7F7","--base0-soft":"rgba(31, 31, 31, 0.75)","--base1-soft":"rgba(31, 31, 31, 0.4)","--blue":"#72B3CC","--green":"#8EB33B","--cyan":"#218693","--yellow":"#D0B03C","--orange":"#C75646","--red":"#E09690","--magenta":"#77DFD8","--violet":"#FBB1F9","--green-soft":"rgba(133, 153, 0, 0.28)"}},Code:{Light:{"--base3":"#FFFFFF","--base2":"#DBDBDB","--base1":"#B6B6B6","--base0":"#929292","--base00":"#6D6D6D","--base01":"#494949","--base02":"#242424","--base03":"#000000","--base0-soft":"rgba(146, 146, 146, 0.75)","--base1-soft":"rgba(172, 172, 172, 0.4)","--blue":"#0000ff","--green":"#098658","--cyan":"#267f99","--yellow":"#795e26","--orange":"#ee0000","--red":"#a31515","--magenta":"#0070c1","--violet":"#811f3f","--green-soft":"rgba(133, 153, 0, 0.28)"},Dark:{"--base3":"#1E1E1E","--base2":"#2C2C32","--base1":"#303036","--base0":"#34343a","--base00":"#C8C8C8","--base01":"#cccccc","--base02":"#D0D0D0","--base03":"#D4D4D4","--base0-soft":"rgba(15, 15, 15, 0.75)","--base1-soft":"rgba(15, 15, 15, 0.4)","--blue":"rgb(79,193,255)","--green":"rgb(106, 153, 85)","--cyan":"#ce9178","--yellow":"#d7ba7d","--orange":"#d16969","--red":"#d16969","--magenta":"#569cd6","--violet":"#C586C0","--green-soft":"rgba(133, 153, 0, 0.28)"}}};n(352);var ci=({state:e,onClick:t})=>{const n=si(255,255,255,1),a=si(238,232,213,1),r={colorFactor:Object($s.spring)({checked:1,partial:1,unchecked:0}[e],{stiffness:300})};return l.a.createElement($s.Motion,{style:r},r=>{const s=ii(ri(n,a,r.colorFactor));return l.a.createElement("div",{className:"checkbox",onClick:t,style:{backgroundColor:s}},l.a.createElement("div",{className:"checkbox__inner-container"},"checked"===e&&l.a.createElement("i",{className:"fas fa-check"}),"partial"===e&&l.a.createElement("i",{className:"fas fa-minus"})))})},di=({part:e,subPartDataAndHandlers:t})=>{const n=()=>e.get("items").map(e=>{const n=Us()({"list-part__checkbox-container":e.get("isCheckbox")});return l.a.createElement("li",{key:e.get("id"),value:e.get("forceNumber")},l.a.createElement("span",{className:n,onClick:e.get("isCheckbox")?(a=e.get("id"),()=>t.onCheckboxClick(a)):null},e.get("isCheckbox")&&l.a.createElement(ci,{state:e.get("checkboxState")}),l.a.createElement(ui,{parts:e.get("titleLine"),subPartDataAndHandlers:t})),l.a.createElement("br",null),l.a.createElement(ui,{parts:e.get("contents"),subPartDataAndHandlers:t}));var a});return e.get("isOrdered")?l.a.createElement("ol",{className:"attributed-string__list-part attributed-string__list-part--ordered"},n()):l.a.createElement("ul",{className:"attributed-string__list-part"},n())},hi=(n(353),({part:e,subPartDataAndHandlers:{onTimestampClick:t,shouldDisableActions:n}})=>{const a=e.get("firstTimestamp"),r=e.get("secondTimestamp");return l.a.createElement("span",{className:"attributed-string__timestamp-part",onClick:()=>n?void 0:t(e.get("id"))},!!a&&F(a),!!r&&l.a.createElement(o.Fragment,null,"--",F(r)))});var ui=Object(h.b)(null,e=>({org:Object(u.b)(s,e)}))(({org:e,parts:t,subPartDataAndHandlers:n})=>{let a,r=Object(Bs.g)();const s=e=>{let t=r.pathname.match(/(.*)\//)[1],n=e;for(;n.startsWith("../");){if(!t.match(/^\/file\/.+/))return e;n=n.substr(3),t=t.match(/(.*)\//)[1]}return t+"/"+n};return l.a.createElement("span",null,t.map(t=>{switch(t.get("type")){case"text":return t.get("contents");case"link":return(t=>{const n=t.get("id"),a=t.getIn(["contents","uri"]),r=t.getIn(["contents","title"])||a;let i=a;if(a.startsWith("file:")){i=a.substr(5);return i.startsWith("/")||i.startsWith("~")||(i=s(i),i.includes("/../")||a.match(xe))?(i=i.replace(/^\/file\//,"/"),l.a.createElement("span",{key:n,style:{textDecoration:"underline"},"data-target":i,onClick:()=>e.setPath(i)},r)):(i=i.replace(/^\/file\//,"/files/"),l.a.createElement(Os.b,{key:n,to:i},r))}return l.a.createElement(Vs,{key:n,href:i},r)})(t);case"percentage-cookie":return a=Us()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":100===parseInt(t.get("percentage"),10)}),l.a.createElement("span",{key:t.get("id"),className:a},"[",t.get("percentage"),"%]");case"fraction-cookie":return a=Us()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":""!==t.getIn(["fraction",0])&&t.getIn(["fraction",0])===t.getIn(["fraction",1])}),l.a.createElement("span",{key:t.get("id"),className:a},"[",t.getIn(["fraction",0]),"/",t.getIn(["fraction",1]),"]");case"table":return l.a.createElement(ai,{key:t.get("id"),table:t,subPartDataAndHandlers:n});case"list":return l.a.createElement(di,{key:t.get("id"),part:t,subPartDataAndHandlers:n});case"inline-markup":return a=Us()("attributed-string__inline-markup","attributed-string__inline-markup--".concat(t.get("markupType"))),l.a.createElement("span",{key:t.get("id"),className:a},t.get("content"));case"timestamp":return l.a.createElement(hi,{key:t.get("id"),part:t,subPartDataAndHandlers:n});case"url":return l.a.createElement(Vs,{href:t.get("content"),key:t.get("id")},t.get("content"));case"www-url":return l.a.createElement(Vs,{href:"https://".concat(t.get("content")),key:t.get("id")},t.get("content"));case"e-mail":return l.a.createElement("a",{href:"mailto:".concat(t.get("content")),key:t.get("id")},t.get("content"));case"phone-number":return l.a.createElement("a",{href:"tel:".concat(t.get("content")),key:t.get("id")},t.get("content"));default:return console.error("Unrecognized attributed string part type! ".concat(t.get("type"))),""}}))});class pi extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleRef","handleTitleSpanRef","handleTextareaRef","handleTitleClick","handleTextareaBlur","handleTextareaFocus","handleTitleChange","handleTitleFieldClick","handleTodoClick","handleTimestampClick","handleInsertTimestamp"]),this.state={titleValue:this.calculateRawTitle(e.header),containerWidth:null,shouldIgnoreBlur:!1}}storeContainerWidth(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}componentDidMount(){this.storeContainerWidth()}componentDidUpdate(e){const t=this.props.header;e.inEditMode&&!this.props.inEditMode&&this.props.org.updateHeaderTitle(t.get("id"),this.state.titleValue),e.header!==this.props.header&&this.setState({titleValue:this.calculateRawTitle(this.props.header)},()=>this.storeContainerWidth())}handleRef(e){this.containerDiv=e}handleTitleSpanRef(e){this.titleSpan=e}handleTextareaRef(e){this.textarea=e}calculateRawTitle(e){return q(e.toJS(),!1)}handleTitleClick(){const e=this.props,t=e.header,n=e.hasContent,a=e.isSelected,r=e.onClick,s=e.closeSubheadersRecursively;r?r():(!n||t.get("opened")&&!a||this.props.org.toggleHeaderOpened(t.get("id"),s),this.props.org.selectHeader(t.get("id")))}handleTodoClick(e){const t=this.props,n=t.header,a=t.shouldTapTodoToAdvance,r=t.setShouldLogIntoDrawer,s=t.onClick;s?(s(),e.stopPropagation()):(this.props.org.selectHeader(n.get("id")),a&&this.props.org.advanceTodoState(null,r))}handleTextareaBlur(){setTimeout(()=>{this.state.shouldIgnoreBlur?this.setState({shouldIgnoreBlur:!1}):this.props.org.exitEditMode()},200)}handleTextareaFocus(e){if(""===this.props.header.getIn(["titleLine","rawTitle"])){const t=e.target.value;e.target.selectionStart=t.length,e.target.selectionEnd=t.length}}handleTitleChange(e){const t=e.target.value,n=t[t.length-1];this.state.titleValue!==t.substring(0,t.length-1)||"\n"!==n?this.setState({titleValue:t}):this.props.org.exitEditMode()}handleTitleFieldClick(e){e.stopPropagation()}handleTimestampClick(e){this.props.base.activatePopup("timestamp-editor",{headerId:this.props.header.get("id"),timestampId:e})}handleInsertTimestamp(e){this.setState({shouldIgnoreBlur:!0});const t=this.state.titleValue,n=this.textarea.selectionStart;this.setState({titleValue:t.substring(0,n)+j()+t.substring(this.textarea.selectionEnd||n)}),this.textarea.focus(),e.stopPropagation()}render(){const e=this.props,t=e.header,n=e.color,a=e.hasContent,r=e.inEditMode,s=e.shouldDisableActions,i=e.shouldDisableExplicitWidth,o=e.todoKeywordSets,c=e.addition,d=this.state.containerWidth,h=Pe(o),u=t.getIn(["titleLine","todoKeyword"]),p={color:n,wordBreak:"break-word"},g={color:n,minWidth:"5em",textAlign:"right",marginRight:"5px"};return l.a.createElement("div",{className:"title-line",onClick:this.handleTitleClick,ref:this.handleRef,style:{width:i?"":d}},!r&&u?l.a.createElement("span",{className:Us()("todo-keyword",h(u)?"todo-keyword--done-state":null),onClick:this.handleTodoClick},u):"",r?l.a.createElement("div",{className:"title-line__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea","data-testid":"titleLineInput",rows:"3",ref:this.handleTextareaRef,value:this.state.titleValue,onBlur:this.handleTextareaBlur,onFocus:this.handleTextareaFocus,onChange:this.handleTitleChange,onClick:this.handleTitleFieldClick}),l.a.createElement("div",{className:"title-line__insert-timestamp-button",onClick:this.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):l.a.createElement("div",{style:{width:"100%"}},l.a.createElement("div",{className:"title-line-text"},l.a.createElement("span",{style:p,ref:this.handleTitleSpanRef},l.a.createElement(ui,{parts:t.getIn(["titleLine","title"]),subPartDataAndHandlers:{onTimestampClick:this.handleTimestampClick,shouldDisableActions:s}}),!t.get("opened")&&a?"...":""),c?l.a.createElement("span",{style:g},c):null),t.getIn(["titleLine","tags"]).size>0&&l.a.createElement("div",null,t.getIn(["titleLine","tags"]).toSet().toList().filter(e=>!!e).map(e=>l.a.createElement("div",{className:"header-tag",key:e},e)))))}}var gi=Object(h.b)((e,t)=>{const n=e.org.present.get("path"),a=e.org.present.getIn(["files",n]);return{inEditMode:"title"===a.get("editMode")&&a.get("selectedHeaderId")===t.header.get("id"),setShouldLogIntoDrawer:e.base.get("shouldLogIntoDrawer"),shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),closeSubheadersRecursively:e.base.get("closeSubheadersRecursively"),isSelected:a.get("selectedHeaderId")===t.header.get("id"),todoKeywordSets:a.get("todoKeywordSets")}},e=>({org:Object(u.b)(s,e),base:Object(u.b)(a,e)}))(pi);n(354),n(355);class mi extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleTimestampClick"])}handleTimestampClick(e){return()=>this.props.onClick(e)}render(){const e=this.props.planningItems.filter(e=>Re(e));return e.isEmpty()?null:l.a.createElement("div",null,e.map((e,t)=>l.a.createElement("div",{key:e.get("id"),className:"planning-items__item-container"},l.a.createElement("div",{className:"planning-item__type"},e.get("type"),": "),l.a.createElement("div",{className:"planning-item__timestamp",onClick:this.handleTimestampClick(t)},F(e.get("timestamp"))))))}}n(356);var fi=({propertyListItems:e,shouldDisableActions:t,onTimestampClick:n,onEdit:a})=>{const r=Object(o.useState)(!0),s=Object(g.a)(r,2),i=s[0],c=s[1];return 0===e.size?null:l.a.createElement("div",{className:"property-list-container"},l.a.createElement("div",{className:"property-list__property",onClick:()=>c(!i)},":PROPERTIES:",i?"...":""),!i&&l.a.createElement(o.Fragment,null,e.map(e=>l.a.createElement("div",{className:"property-list__item-container",key:e.get("id")},l.a.createElement("div",{className:"property-list__property",onClick:t?null:a},":",e.get("property"),":"),l.a.createElement("div",{className:"property-list__value"},l.a.createElement(ui,{parts:e.get("value")||[],subPartDataAndHandlers:{onTimestampClick:n,shouldDisableActions:t}})))),l.a.createElement("div",{className:"property-list__property",onClick:a},":END:")))},bi=(n(357),({logBookEntries:e,onTimestampClick:t,shouldDisableActions:n})=>{const a=Object(o.useState)(!0),r=Object(g.a)(a,2),s=r[0],i=r[1],c=(e,a)=>()=>n?void 0:t(e,a);return 0===e.size?null:l.a.createElement("div",{className:"logbook-entries-container"},l.a.createElement("div",{className:"logbook-entries__logbook",onClick:()=>i(!s)},":LOGBOOK:",s?"...":""),!s&&l.a.createElement(o.Fragment,null,e.map((e,t)=>void 0!==e.get("raw")?l.a.createElement("div",{className:"logbook-entries__item-container",key:e.get("id")},e.get("raw")||" "):l.a.createElement("div",{className:"logbook-entries__item-container",key:e.get("id")},l.a.createElement("span",{className:"logbook-entries__item-clock"},"CLOCK:"),l.a.createElement("span",{className:"logbook-entries__item-start",onClick:c(t,"start")},F(e.get("start"))),null===e.get("end")?"":l.a.createElement(o.Fragment,null,"--",l.a.createElement("span",{className:"logbook-entries__item-end",onClick:c(t,"end")},F(e.get("end"))),l.a.createElement("span",{className:"logbook-entries__item-duration"},"=> ",G(e.get("start"),e.get("end")))))),l.a.createElement("div",{className:"logbook-entries__logbook"},":END:")))});class yi extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleRef","handleTextareaRef","handleDescriptionChange","handleTextareaBlur","handleTableCellSelect","handleExitTableEditMode","handleTableCellValueUpdate","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleCheckboxClick","handleTimestampClick","handleLogEntryTimestampClick","handleInsertTimestamp","handlePlanningItemTimestampClick","handlePropertyListEdit"]),this.state={descriptionValue:this.calculateRawDescription(e.header),containerWidth:null,shouldIgnoreBlur:!1}}storeContainerWidth(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}componentDidMount(){this.storeContainerWidth()}componentDidUpdate(e){const t=this.props.header;e.inEditMode&&!this.props.inEditMode&&this.props.org.updateHeaderDescription(t.get("id"),this.state.descriptionValue),e.header!==this.props.header&&this.setState({descriptionValue:this.calculateRawDescription(this.props.header)},()=>this.storeContainerWidth())}calculateRawDescription(e){const t=this.props.dontIndent;return $(e,!1,t)}handleTextareaRef(e){this.textarea=e}handleRef(e){this.containerDiv=e}handleDescriptionChange(e){this.setState({descriptionValue:e.target.value})}handleTextareaBlur(){setTimeout(()=>{this.state.shouldIgnoreBlur?this.setState({shouldIgnoreBlur:!1}):this.props.org.exitEditMode()},200)}handleTableCellSelect(e){this.props.org.setSelectedTableCellId(e)}handleExitTableEditMode(){this.props.org.exitEditMode()}handleTableCellValueUpdate(e,t){this.props.org.updateTableCellValue(e,t)}handleEnterTableEditMode(){this.props.org.enterEditMode("table")}handleAddNewTableRow(){this.props.org.addNewTableRow()}handleRemoveTableRow(){this.props.org.removeTableRow()}handleAddNewTableColumn(){this.props.org.addNewTableColumn()}handleRemoveTableColumn(){this.props.org.removeTableColumn()}handleCheckboxClick(e){this.props.org.advanceCheckboxState(e)}handleTimestampClick(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e,headerId:this.props.header.get("id")})}handleLogEntryTimestampClick(e){return(t,n)=>this.props.base.activatePopup("timestamp-editor",{headerId:e,logEntryIndex:t,entryType:n})}handleInsertTimestamp(){this.setState({shouldIgnoreBlur:!0});const e=this.state.descriptionValue,t=this.textarea.selectionStart;this.setState({descriptionValue:e.substring(0,t)+j()+e.substring(this.textarea.selectionEnd||t)}),this.textarea.focus()}handlePlanningItemTimestampClick(e){return t=>this.props.base.activatePopup("timestamp-editor",{headerId:e,planningItemIndex:t})}handlePropertyListEdit(){const e=this.props.header;this.props.base.activatePopup("property-list-editor",{headerId:e.get("id")})}render(){const e=this.props,t=e.header,n=e.inEditMode,a=e.selectedTableCellId,r=e.inTableEditMode,s=e.shouldDisableActions,i=this.state.containerWidth;return t.get("opened")?l.a.createElement("div",{className:"header-content-container nice-scroll",ref:this.handleRef,style:{width:i}},n?l.a.createElement("div",{className:"header-content__edit-container"},l.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"8",ref:this.handleTextareaRef,value:this.state.descriptionValue,onBlur:this.handleTextareaBlur,onChange:this.handleDescriptionChange}),l.a.createElement("div",{className:"header-content__insert-timestamp-button",onClick:this.handleInsertTimestamp},l.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):l.a.createElement(o.Fragment,null,l.a.createElement(mi,{planningItems:t.get("planningItems"),onClick:this.handlePlanningItemTimestampClick(t.get("id"))}),l.a.createElement(fi,{propertyListItems:t.get("propertyListItems"),onTimestampClick:this.handleTimestampClick,shouldDisableActions:s,onEdit:this.handlePropertyListEdit}),l.a.createElement(ui,{parts:t.get("logNotes"),subPartDataAndHandlers:{onTimestampClick:this.handleTimestampClick,shouldDisableActions:s}}),l.a.createElement(bi,{logBookEntries:t.get("logBookEntries"),onTimestampClick:this.handleLogEntryTimestampClick(t.get("id")),shouldDisableActions:s}),l.a.createElement(ui,{parts:t.get("description"),subPartDataAndHandlers:{onTableCellSelect:this.handleTableCellSelect,selectedTableCellId:a,inTableEditMode:r,onExitTableEditMode:this.handleExitTableEditMode,onTableCellValueUpdate:this.handleTableCellValueUpdate,onEnterTableEditMode:this.handleEnterTableEditMode,onAddNewTableRow:this.handleAddNewTableRow,onRemoveTableRow:this.handleRemoveTableRow,onAddNewTableColumn:this.handleAddNewTableColumn,onRemoveTableColumn:this.handleRemoveTableColumn,onCheckboxClick:this.handleCheckboxClick,onTimestampClick:this.handleTimestampClick,shouldDisableActions:s}}))):l.a.createElement("div",null)}}var Ei=Object(h.b)((e,t)=>{const n=e.org.present.get("path"),a=e.org.present.getIn(["files",n]);return{inEditMode:"description"===a.get("editMode")&&a.get("selectedHeaderId")===t.header.get("id"),isSelected:a.get("selectedHeaderId")===t.header.get("id"),selectedTableCellId:a.get("selectedTableCellId"),inTableEditMode:"table"===a.get("editMode"),dontIndent:e.base.get("shouldNotIndentOnExport")}},e=>({org:Object(u.b)(s,e),base:Object(u.b)(a,e)}))(yi);n(358);class wi extends o.PureComponent{iconWithFFClickCatcher({className:e,onClick:t,title:n,testId:a=""}){return l.a.createElement("div",{title:n,onClick:t,className:"header-action-drawer__ff-click-catcher-container"},l.a.createElement("div",{className:"header-action-drawer__ff-click-catcher"}),l.a.createElement("i",{className:e,"data-testid":a}))}render(){const e=this.props,t=e.onEnterTitleEditMode,n=e.onEnterDescriptionEditMode,a=e.onTagsClick,r=e.onPropertiesClick,s=e.isNarrowed,i=e.onNarrow,o=e.onWiden,c=e.onAddNewHeader,d=e.onDeadlineClick,h=e.onClockInOutClick,u=e.onScheduledClick,p=e.hasActiveClock,g=e.onShareHeader,m=e.onRefileHeader,f=e.onAddNote;return l.a.createElement("div",{className:"header-action-drawer-container"},l.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher({className:"fas fa-pencil-alt fa-lg",onClick:t,title:"Edit header title"}),this.iconWithFFClickCatcher({className:"fas fa-edit fa-lg",onClick:n,title:"Edit header description",testId:"edit-header-title"}),this.iconWithFFClickCatcher({className:"fas fa-tags fa-lg",onClick:a,title:"Modify tags"}),this.iconWithFFClickCatcher({className:"fas fa-list fa-lg",onClick:r,title:"Modify properties"}),s?this.iconWithFFClickCatcher({className:"fas fa-expand fa-lg",onClick:o,title:"Widen (Cancelling the narrowing.)"}):this.iconWithFFClickCatcher({className:"fas fa-compress fa-lg",onClick:i,testId:"header-action-narrow",title:"Narrow to subtree (focusing in on some portion of the buffer, making the rest temporarily inaccessible.)"}),this.iconWithFFClickCatcher({className:"fas fa-plus fa-lg",onClick:c,testId:"header-action-plus",title:"Create new header below"})),l.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher({className:"fas fa-envelope fa-lg",onClick:g,testId:"share",title:"Share this header via email"}),this.iconWithFFClickCatcher({className:"fas fa-calendar-check fa-lg",onClick:d,title:"Set deadline datetime"}),this.iconWithFFClickCatcher({className:"far fa-calendar-check fa-lg",onClick:u,title:"Set scheduled datetime"}),p?this.iconWithFFClickCatcher({className:"fas fa-hourglass-end fa-lg",onClick:h,testId:"org-clock-out",title:"Clock out (Stop the clock)"}):this.iconWithFFClickCatcher({className:"fas fa-hourglass-start fa-lg",onClick:h,testId:"org-clock-in",title:"Clock in (Start the clock)"}),this.iconWithFFClickCatcher({className:"fas fa-file-export fa-lg",onClick:m,testId:"org-refile",title:"Refile this header to another header"}),this.iconWithFFClickCatcher({className:"far fa-sticky-note fa-lg",onClick:f,title:"Add a note"})))}}class Ti extends o.PureComponent{constructor(e){super(e),this.SWIPE_ACTION_ACTIVATION_DISTANCE=80,this.FREE_DRAG_ACTIVATION_DISTANCE=10,E.a.bindAll(this,["handleRef","handleMouseDown","handleMouseMove","handleMouseUp","handleMouseOut","handleTouchMove","handleTouchStart","handleTouchEnd","handleTouchCancel","handleHeaderClick","handleEnterTitleEditMode","handleEnterDescriptionEditMode","handleShowTagsModal","handleShowPropertyListEditorModal","handleNarrow","handleWiden","handleAddNewHeader","handleRest","handleDeadlineClick","handleClockInOutClick","handleScheduledClick","handleShareHeaderClick","handleRefileHeaderRequest","handleAddNoteClick"]),this.state={isDraggingFreely:!1,dragStartX:null,dragStartY:null,currentDragX:null,containerWidth:null,isPlayingRemoveAnimation:!1,heightBeforeRemove:null,disabledBackgroundColor:oi("--base3")}}componentDidMount(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}handleRef(e){this.containerDiv=e,this.props.onRef(e)}handleDragStart(e,t,n){this.props.shouldDisableActions||this.props.inEditMode||e.target.closest(".table-part")||this.setState({dragStartX:t,dragStartY:n})}handleDragMove(e,t){const n=this.state,a=n.dragStartX,r=n.dragStartY;null!==a&&(this.state.isDraggingFreely||Math.abs(e-a)>=this.FREE_DRAG_ACTIVATION_DISTANCE&&this.setState({isDraggingFreely:!0}),Math.abs(t-r)>=this.SWIPE_ACTION_ACTIVATION_DISTANCE/2?this.setState({dragStartX:null}):this.setState({currentDragX:e}))}handleDragEnd(){const e=this.state,t=e.dragStartX,n=e.currentDragX;if(t&&n){const e=n-t;e>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.props.org.advanceTodoState(this.props.header.get("id"),this.props.shouldLogIntoDrawer),-1*e>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.setState({isPlayingRemoveAnimation:!0,heightBeforeRemove:this.containerDiv.offsetHeight})}this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}handleDragCancel(){this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}handleMouseDown(e){this.handleDragStart(e,e.clientX,e.clientY)}handleMouseMove(e){this.handleDragMove(e.clientX,e.clientY)}handleMouseUp(){this.handleDragEnd()}handleMouseOut(){this.handleDragCancel()}handleTouchStart(e){this.handleDragStart(e,e.changedTouches[0].clientX,e.changedTouches[0].clientY)}handleTouchMove(e){this.handleDragMove(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}handleTouchEnd(){this.handleDragEnd()}handleTouchCancel(){this.handleDragCancel()}handleHeaderClick(e){const t=e.target.classList;if(t.contains("header")||t.contains("header__bullet")){const e=this.props,t=e.header,n=e.hasContent,a=e.isSelected,r=e.closeSubheadersRecursively;!n||t.get("opened")&&!a||this.props.org.toggleHeaderOpened(t.get("id"),r),this.props.org.selectHeader(t.get("id"))}}handleEnterTitleEditMode(){this.props.org.enterEditMode("title")}handleEnterDescriptionEditMode(){this.props.org.openHeader(this.props.header.get("id")),this.props.org.enterEditMode("description")}handleShowTagsModal(){this.props.base.activatePopup("tags-editor")}handleShowPropertyListEditorModal(){this.props.base.activatePopup("property-list-editor")}handleNarrow(){this.props.org.narrowHeader(this.props.header.get("id"))}handleWiden(){this.props.org.widenHeader()}handleAddNewHeader(){this.props.org.addHeaderAndEdit(this.props.header.get("id"))}handleRest(){this.state.isPlayingRemoveAnimation&&this.props.org.removeHeader(this.props.header.get("id"))}handleDeadlineAndScheduledClick(e){const t=this.props.header,n=t.get("planningItems",[]).findIndex(t=>t.get("type")===e);-1===n?(this.props.org.addNewPlanningItem(t.get("id"),e),this.props.base.activatePopup("timestamp-editor",{headerId:t.get("id"),planningItemIndex:t.get("planningItems").size})):this.props.base.activatePopup("timestamp-editor",{headerId:t.get("id"),planningItemIndex:n}),this.props.org.openHeader(t.get("id"))}handleDeadlineClick(){this.handleDeadlineAndScheduledClick("DEADLINE")}handleClockInOutClick(){const e=this.props.header,t=e.get("logBookEntries",[]),n=t.findIndex(e=>null===e.get("end")),a=(({isActive:e=!0,withStartTime:t=!1}={})=>H(new Date,{isActive:e,withStartTime:t}))({isActive:!1,withStartTime:!0});-1!==n?this.props.org.setLogEntryStop(e.get("id"),t.getIn([n,"id"]),a):this.props.org.createLogEntryStart(e.get("id"),a)}handleScheduledClick(){this.handleDeadlineAndScheduledClick("SCHEDULED")}handleShareHeaderClick(){const e=this.props.header,t=e.get("titleLine"),n=t.get("todoKeyword"),a=t.get("tags"),r=t.get("rawTitle").trim(),s=n?"".concat(n," ").concat(r):r,i="\n".concat(a.isEmpty()?"":"Tags: ".concat(a.join(" "),"\n"),"\n").concat(e.get("rawDescription")),o="mailto:?subject=".concat(encodeURIComponent(s),"&body=").concat(encodeURIComponent(i));window.open(o)}handleAddNoteClick(){let e=prompt("Enter a note to add to the header:");null!==e&&(e=e.trim()),e&&this.props.org.addNote(e,new Date)}handlePopupClose(){this.props.base.closePopup()}handleRefileHeaderRequest(){this.props.base.activatePopup("refile")}render(){const e=this.props,t=e.header,n=e.color,a=e.hasContent,r=e.isSelected,s=e.bulletStyle,i=e.narrowedHeader,o=e.isNarrowed,c=e.shouldDisableActions,d=e.showClockDisplay,h=i?t.get("nestingLevel")-i.get("nestingLevel")+1:t.get("nestingLevel"),u=this.state,p=u.dragStartX,g=u.currentDragX,m=u.isDraggingFreely,f=u.isPlayingRemoveAnimation,b=u.containerWidth,y={paddingLeft:20*h,marginLeft:p&&g&&m?g-p:f?Object($s.spring)(-1*b,{stiffness:300}):Object($s.spring)(0,{stiffness:300}),heightFactor:f?Object($s.spring)(0,{stiffness:300}):1},E=Us()("header",{"header--selected":r,"header--removing":f}),w=t.get("logBookEntries").filter(e=>void 0===e.get("raw")),T=0!==w.size&&0!==w.filter(e=>!e.get("end")).size;return l.a.createElement($s.Motion,{style:y,onRest:this.handleRest},e=>{const i=e.marginLeft,h=i>=this.SWIPE_ACTION_ACTIVATION_DISTANCE,u=-1*i>=this.SWIPE_ACTION_ACTIVATION_DISTANCE,p=si(0,128,0,1),g=si(255,0,0,1),m=si(0,0,0,1),b=si(255,255,255,1),y={width:e.marginLeft,backgroundColorFactor:Object($s.spring)(h?1:0,{stiffness:300})},w={width:-1*e.marginLeft,backgroundColorFactor:Object($s.spring)(u?1:0,{stiffness:300})},v=e.heightFactor,k=Object(ei.a)(e,["heightFactor"]);return f&&(k.height=this.state.heightBeforeRemove*v),l.a.createElement("div",{className:E,style:k,ref:this.handleRef,onClick:this.handleHeaderClick,onMouseDown:this.handleMouseDown,onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp,onMouseOut:this.handleMouseOut,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd,onTouchCancel:this.handleTouchCancel},l.a.createElement($s.Motion,{style:y},e=>{const t={width:e.width,backgroundColor:ii(ri(this.state.disabledBackgroundColor,p,e.backgroundColorFactor))},n={display:i>30?"":"none",color:ii(ri(m,b,e.backgroundColorFactor))};return l.a.createElement("div",{className:"left-swipe-action-container",style:t},l.a.createElement("i",{className:"fas fa-check swipe-action-container__icon swipe-action-container__icon--left",style:n}))}),l.a.createElement($s.Motion,{style:w},e=>{const t={width:e.width,backgroundColor:ii(ri(this.state.disabledBackgroundColor,g,e.backgroundColorFactor))},n={display:-1*i>30?"":"none",color:ii(ri(m,b,e.backgroundColorFactor))};return l.a.createElement("div",{className:"right-swipe-action-container",style:t},l.a.createElement("i",{className:"fas fa-times swipe-action-container__icon swipe-action-container__icon--right",style:n}))}),l.a.createElement("div",{style:{marginLeft:-16,color:n},className:"header__bullet"},"Fancy"===s?"\u25cf":"*"),l.a.createElement(gi,{header:t,color:n,hasContent:a,isSelected:r,shouldDisableExplicitWidth:0===i,shouldDisableActions:c,addition:d&&0!==t.get("totalTimeLoggedRecursive")?z(t.get("totalTimeLoggedRecursive")):""}),l.a.createElement(ti.UnmountClosed,{isOpened:r&&!c,springConfig:{stiffness:300},style:{marginRight:w.width}},l.a.createElement(wi,{onEnterTitleEditMode:this.handleEnterTitleEditMode,onEnterDescriptionEditMode:this.handleEnterDescriptionEditMode,isNarrowed:o,onTagsClick:this.handleShowTagsModal,onPropertiesClick:this.handleShowPropertyListEditorModal,onNarrow:this.handleNarrow,onWiden:this.handleWiden,onAddNewHeader:this.handleAddNewHeader,onDeadlineClick:this.handleDeadlineClick,onClockInOutClick:this.handleClockInOutClick,onScheduledClick:this.handleScheduledClick,hasActiveClock:T,onShareHeader:this.handleShareHeaderClick,onRefileHeader:this.handleRefileHeaderRequest,onAddNote:this.handleAddNoteClick})),l.a.createElement(Ei,{header:t,shouldDisableActions:c}))})}}var vi=Object(h.b)((e,t)=>{const n=e.org.present.get("path"),a=e.org.present.getIn(["files",n],Object(w.Map)()),r=a.get("narrowedHeaderId")?ne(a.get("headers"),a.get("narrowedHeaderId")):null;return{bulletStyle:e.base.get("bulletStyle"),shouldLogIntoDrawer:e.base.get("shouldLogIntoDrawer"),closeSubheadersRecursively:e.base.get("closeSubheadersRecursively"),narrowedHeader:r,isNarrowed:!!r&&r.get("id")===t.header.get("id"),inEditMode:!!a.get("editMode"),showClockDisplay:e.org.present.get("showClockDisplay")}},e=>({org:Object(u.b)(s,e),base:Object(u.b)(a,e)}))(Ti);class ki extends o.PureComponent{constructor(e){super(e),this.headerRefs={},E.a.bindAll(this,["handleHeaderRef"])}componentDidUpdate(e){if(e.selectedHeaderId!==this.props.selectedHeaderId){const e=this.headerRefs[this.props.selectedHeaderId];if(e){const t=e.getBoundingClientRect(),n=document.documentElement.clientHeight;(t.top>.9*n||t.bottom<0)&&e.scrollIntoView()}}}handleHeaderRef(e){return t=>this.headerRefs[e]=t}render(){const e=this.props,t=e.headers,n=e.selectedHeaderId,a=e.narrowedHeaderId,r=e.shouldDisableActions,s=t.map(e=>({header:e,displayed:!1,hasContent:Ne(e)})).toArray();if(s.forEach((e,t)=>{const n=e.header.get("nestingLevel");s.slice(0,t).every(e=>e.header.get("nestingLevel")>=n)&&(e.displayed=!0);const a=s.slice(t+1);for(let r=0;r<a.length;++r){const t=a[r];if(t.header.get("nestingLevel")<=n)break;e.hasContent=!0,t.displayed=e.header.get("opened")&&e.displayed}}),a){const e=s.findIndex(e=>e.header.get("id")===a);s.slice(0,e).forEach(e=>e.displayed=!1);const n=oe(t,a);s.slice(e+n+1).forEach(e=>e.displayed=!1)}const i=["var(--blue)","var(--green)","var(--cyan)","var(--yellow)","var(--blue)","var(--green)","var(--cyan)","var(--yellow)"],o=s.filter(e=>e.displayed),c=Us()("header-list-container",{"header-list-container--narrowed":!!a});return l.a.createElement("div",{className:c},o.map(e=>{const t=e.header,a=i[(t.get("nestingLevel")-1)%i.length];return l.a.createElement(vi,{key:t.get("id"),header:t,color:a,hasContent:e.hasContent,isSelected:t.get("id")===n,onRef:this.handleHeaderRef(t.get("id")),shouldDisableActions:r})}))}}var _i=Object(h.b)(e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t],Object(w.Map)());return{headers:n.get("headers",Object(w.List)()),selectedHeaderId:n.get("selectedHeaderId"),narrowedHeaderId:n.get("narrowedHeaderId")}})(ki);n(359),n(360);class Si extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleClick"])}handleClick(){const e=this.props,t=e.onClick;e.isDisabled||t()}render(){const e=this.props,t=e.iconName,n=e.subIconName,a=e.isDisabled,r=e.shouldRotateSubIcon,s=e.letter,i=e.additionalClassName,o=e.style,c=e.tooltip,d=e.shouldSpinSubIcon,h=e.onRef,u=Us()("btn","btn--circle","action-drawer__btn",i||"",{fas:!s,"fa-lg":!s,["fa-".concat(t)]:!s,"action-drawer__btn--with-sub-icon":!!n,"btn--disabled":a,"action-drawer__btn--letter":!!s}),p=Us()("fas","fa-xs","fa-".concat(n),"action-drawer__btn__sub-icon",{"action-drawer__btn__sub-icon--rotated":r,"fa-spin":d});return l.a.createElement("button",{className:u,onClick:this.handleClick,style:o,title:c,ref:h},!!s&&s,!!n&&l.a.createElement("i",{className:p}))}}var Ii=Object(h.b)(e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t],Object(w.Map)());return{inEditMode:!!n.get("editMode"),selectedHeaderId:n.get("selectedHeaderId"),isDirty:n.get("isDirty"),isNarrowedHeaderActive:!!n.get("narrowedHeaderId"),selectedTableCellId:n.get("selectedTableCellId"),captureTemplates:e.capture.get("captureTemplates",Object(w.List)()),path:t,isLoading:!e.base.get("isLoading").isEmpty(),online:e.base.get("online")}},e=>({org:Object(u.b)(s,e),capture:Object(u.b)(r,e),base:Object(u.b)(a,e)}))(({org:e,selectedHeaderId:t,base:n,staticFile:a,captureTemplates:r,path:s,selectedTableCellId:i,inEditMode:c,isLoading:d,online:h,shouldDisableSyncButtons:u})=>{const p=Object(o.useState)(!1),f=Object(g.a)(p,2),b=f[0],y=f[1],E=Object(o.useState)(!1),w=Object(g.a)(E,2),T=w[0],v=w[1],k=Object(o.useState)(!1),_=Object(g.a)(k,2),S=_[0],I=_[1],O=Object(o.useRef)(null),D=Object(o.useMemo)(()=>O.current?O.current.getBoundingClientRect():null,[O]),C=()=>t?e.moveHeaderUp(t):e.moveTableRowUp(),A=()=>t?e.moveHeaderDown(t):e.moveTableRowDown(),N=()=>t?e.moveHeaderLeft(t):e.moveTableColumnLeft(),P=()=>t?e.moveHeaderRight(t):e.moveTableColumnRight(),R=()=>e.moveSubtreeLeft(t),L=()=>e.moveSubtreeRight(t),x=()=>"sample"===a?bt:r.filter(e=>e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").map(e=>e.trim().startsWith("/")?e.trim():"/"+e.trim()).includes((s||"").trim())),M=()=>y(!b),F=()=>{I(!S)},H=()=>{T||0!==x().size?v(!T):alert("You don't have any capture templates set up for this file! Add some in Settings > Capture Templates")},j=()=>{I(!1),n.activatePopup("task-list")},B=()=>{I(!1),n.activatePopup("search")};return l.a.createElement("div",{className:"action-drawer-container nice-scroll"},c?l.a.createElement("button",{className:"btn action-drawer__done-btn",onClick:()=>e.exitEditMode()},"Done"):l.a.createElement(o.Fragment,null,l.a.createElement(Si,{iconName:"cloud",subIconName:"sync-alt",shouldSpinSubIcon:d,isDisabled:u||!h,onClick:()=>e.sync({forceAction:"manual"}),style:{opacity:b||T||S?0:1},tooltip:"Sync changes"}),l.a.createElement(Si,{iconName:"calendar-alt",isDisabled:!1,onClick:()=>n.activatePopup("agenda"),style:{opacity:b||T||S?0:1},tooltip:"Show agenda"}),(()=>{const e={opacity:T||S?0:1};b||(e.boxShadow="none");let t=0;D&&(t=window.screen.width/2-(D.x+D.width/2));const n={centerXOffset:Object($s.spring)(b?t:0,{stiffness:300}),topRowYOffset:Object($s.spring)(b?150:0,{stiffness:300}),bottomRowYOffset:Object($s.spring)(b?80:0,{stiffness:300}),firstColumnXOffset:Object($s.spring)(b?70:0,{stiffness:300}),secondColumnXOffset:Object($s.spring)(b?140:0,{stiffness:300})};return l.a.createElement($s.Motion,{style:n},t=>l.a.createElement("div",{className:"action-drawer__arrow-buttons-container",style:{left:t.centerXOffset}},l.a.createElement(Si,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-up",subIconName:i?"table":null,isDisabled:!1,onClick:C,style:Object(m.a)({},e,{bottom:t.topRowYOffset}),tooltip:i?"Move row up":"Move header up"}),l.a.createElement(Si,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-down",subIconName:i?"table":null,isDisabled:!1,onClick:A,style:Object(m.a)({},e,{bottom:t.bottomRowYOffset}),tooltip:i?"Move row down":"Move header down"}),l.a.createElement(Si,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-left",subIconName:i?"table":null,isDisabled:!1,onClick:N,style:Object(m.a)({},e,{bottom:t.bottomRowYOffset,right:t.firstColumnXOffset}),tooltip:i?"Move column left":"Move header left"}),l.a.createElement(Si,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-right",subIconName:i?"table":null,isDisabled:!1,onClick:P,style:Object(m.a)({},e,{bottom:t.bottomRowYOffset,left:t.firstColumnXOffset}),tooltip:i?"Move column right":"Move header right"}),!i&&l.a.createElement(o.Fragment,null,l.a.createElement(Si,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-left",isDisabled:!1,onClick:R,style:Object(m.a)({},e,{bottom:t.bottomRowYOffset,right:t.secondColumnXOffset}),tooltip:"Move entire subtree left"}),l.a.createElement(Si,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-right",isDisabled:!1,onClick:L,style:Object(m.a)({},e,{bottom:t.bottomRowYOffset,left:t.secondColumnXOffset}),tooltip:"Move entire subtree right"})),l.a.createElement(Si,{iconName:b?"times":"arrows-alt",subIconName:i?"table":null,additionalClassName:"action-drawer__main-arrow-button",isDisabled:!1,onClick:M,style:{opacity:T||S?0:1},tooltip:b?"Hide movement buttons":"Show movement buttons",onRef:O})))})(),(()=>{const e={position:"absolute",zIndex:0,left:0,opacity:b||T?0:1};S||(e.boxShadow="none");const t={opacity:b||T?0:1,position:"relative",zIndex:1},n={bottom:Object($s.spring)(S?70:0,{stiffness:300})};return l.a.createElement($s.Motion,{style:n},n=>l.a.createElement("div",{className:"action-drawer__capture-buttons-container"},l.a.createElement(Si,{iconName:S?"times":"search",isDisabled:!1,onClick:F,style:t,tooltip:S?"Hide Search / Task List":"Show Search / Task List"}),l.a.createElement(Si,{iconName:"search",isDisabled:!1,onClick:B,style:Object(m.a)({},e,{bottom:1*n.bottom}),tooltip:"Show search"}),l.a.createElement(Si,{iconName:"tasks",isDisabled:!1,onClick:j,style:Object(m.a)({},e,{bottom:2*n.bottom}),tooltip:"Show task list"})))})(),(()=>{const e=x(),t={position:"absolute",zIndex:0,left:0,opacity:b||S?0:1};T||(t.boxShadow="none");const a={opacity:b||S?0:1,position:"relative",zIndex:1},r={bottom:Object($s.spring)(T?70:0,{stiffness:300})};return l.a.createElement($s.Motion,{style:r},r=>l.a.createElement("div",{className:"action-drawer__capture-buttons-container"},l.a.createElement(Si,{iconName:T?"times":"plus",isDisabled:!1,onClick:H,style:a,tooltip:T?"Hide capture templates":"Show capture templates"}),e.map((e,a)=>{return l.a.createElement(Si,{key:e.get("id"),letter:e.get("letter"),iconName:e.get("iconName"),isDisabled:!1,onClick:(s=e.get("id"),()=>{v(!1),n.activatePopup("capture",{templateId:s})}),style:Object(m.a)({},t,{bottom:r.bottom*(a+1)}),tooltip:'Activate "'.concat(e.get("description"),'" capture template')});var s})))})()))}),Oi=n(172);const Di=n.n(Oi).a.getParser(window.navigator.userAgent),Ci=Di.satisfies({mobile:{safari:">=13"}})&&Di.satisfies({mobile:{safari:"<13.0.4"}}),Ai="desktop"!==Di.getPlatformType(),Ni=()=>"iOS"===Di.getOS().name,Pi=!!window.matchMedia&&window.matchMedia("(max-device-width: 812px) and (-webkit-device-pixel-ratio : 3)").matches,Ri=!!window.matchMedia&&window.matchMedia("(min-device-width: 375px) and (-webkit-device-pixel-ratio : 2)").matches,Li="standalone"in window.navigator&&window.navigator.standalone;function xi(){return[90,-90].includes(window.orientation)}n(361),n(362);var Mi=({isEnabled:e,onToggle:t})=>{const n=si(255,255,255,1),a=si(238,232,213,1),r={colorFactor:Object($s.spring)(e?1:0,{stiffness:300})},s={marginLeft:Object($s.spring)(e?42:0,{stiffness:300})};return l.a.createElement($s.Motion,{style:r},e=>{const r=ii(ri(n,a,e.colorFactor));return l.a.createElement("div",{className:"switch",style:{backgroundColor:r},onClick:t},l.a.createElement($s.Motion,{style:s},e=>l.a.createElement("div",{className:"switch__grabber",style:e})))})},Fi=(n(363),({children:e,shouldIncludeCloseButton:t,onClose:n,maxSize:a=!1})=>{const r=Object(o.useState)(!1),s=Object(g.a)(r,2),i=s[0],c=s[1],d=Object(o.useState)(null),h=Object(g.a)(d,2),u=h[0],p=h[1];Object(o.useLayoutEffect)(()=>{c(!0)},[]);const m=Object(o.useRef)(),f=Object(o.useRef)(),b=Object(o.useRef)();Object(o.useLayoutEffect)(()=>{b.current=f.current.offsetHeight});const y=e=>e.stopPropagation(),E=()=>c(!1),w=e=>m.current=e.targetTouches[0].clientY,T=e=>{if(e.target.classList.contains("drag-handle"))return;const t=m.current>e.targetTouches[0].clientY;t&&f.current.scrollHeight-f.current.scrollTop<=f.current.clientHeight?e.preventDefault():t||0!==f.current.scrollTop||(e.preventDefault(),p(e.targetTouches[0].clientY-m.current))};Object(o.useEffect)(()=>{const e=()=>(c(u<=.3*b.current),void p(null));if(f.current){f.current.addEventListener("touchstart",w),f.current.addEventListener("touchmove",T),f.current.addEventListener("touchend",e),f.current.addEventListener("touchcancel",e);const t=f.current;return()=>{t.removeEventListener("touchstart",w),t.removeEventListener("touchmove",T),t.removeEventListener("touchend",e),t.removeEventListener("touchcancel",e)}}return null},[f,u]);const v=Us()("drawer-outer-container",{"drawer-outer-container--visible":i}),k={offsetY:u||Object($s.spring)(i?0:b.current||window.innerHeight,{stiffness:300})};return l.a.createElement($s.Motion,{style:k,onRest:()=>!i&&n?n():void 0},r=>{const s={transform:"translateY(".concat(r.offsetY,"px)")};return a&&(s.height="92%",s.overflow="none"),l.a.createElement("div",{className:v,onClick:n?E:null},l.a.createElement("div",{onClick:y,className:"drawer-inner-container nice-scroll","data-testid":"drawer",ref:f,style:s},l.a.createElement("div",{className:"drawer__grabber"}),t&&l.a.createElement("button",{className:"fas fa-times fa-lg drawer__close-button",onClick:E}),e))})}),Hi=({template:e,onCapture:t,headers:n,onClose:a})=>{const r=Object(o.useMemo)(()=>Z(e.get("template")),[e]),s=Object(g.a)(r,2),i=s[0],c=s[1],d=Object(o.useMemo)(()=>0===e.get("headerPaths").size?"FILE":ge(n,e.get("headerPaths")),[n,e]),h=Object(o.useState)(i),u=Object(g.a)(h,2),p=u[0],m=u[1],f=Object(o.useState)(e.get("shouldPrepend")),b=Object(g.a)(f,2),y=b[0],E=b[1],w=Object(o.useRef)(null);Object(o.useEffect)(()=>{w.current&&(w.current.focus(),w.current.setSelectionRange(c,c))},[w,c]);return l.a.createElement(Fi,{onClose:a},l.a.createElement("div",{className:"capture-modal-header"},l.a.createElement(Si,{letter:e.get("letter"),iconName:e.get("iconName"),isDisabled:!1,onClick:()=>{},style:{marginRight:20}}),l.a.createElement("span",null,e.get("description"))),l.a.createElement("div",{className:"capture-modal-header-path"},e.get("headerPaths").map(e=>Z(e)[0]).join(" > ")),d?l.a.createElement(o.Fragment,null,l.a.createElement("textarea",{className:"textarea capture-modal-textarea",rows:"4",value:p,onChange:e=>m(e.target.value),autoFocus:!0,ref:w}),l.a.createElement("div",{className:"capture-modal-button-container"},l.a.createElement("div",{className:"capture-modal-prepend-container"},l.a.createElement("span",{className:"capture-modal-prepend-label"},"Prepend:"),l.a.createElement(Mi,{isEnabled:y,onToggle:()=>E(!y)})),l.a.createElement("button",{className:"btn capture-modal-button",onClick:()=>t(e.get("id"),p,y)},"Capture")),Ci&&l.a.createElement("div",{style:{minHeight:Ci?Li?xi()?"9em":Pi?"23em":Ri?"19em":"auto":xi()?"9em":Pi||Ri?"18em":"auto":"auto"}})):l.a.createElement("div",{className:"capture-modal-error-message"},"The specified header path doesn't exist in this org file!"),l.a.createElement("br",null))},ji=(n(364),({lastServerModifiedAt:e,lastSyncAt:t,path:n,onPull:a,onPush:r,onCancel:s})=>l.a.createElement(Fi,null,l.a.createElement("h2",{className:"sync-confirmation-modal__header"},"Sync conflict"),"Since you last pulled ",n,", a newer version of the file has been pushed to the server. The newer version is from:",l.a.createElement("br",null),"\xa0",l.a.createElement("br",null),l.a.createElement("div",{className:"sync-confirmation-modal__last-sync-time"},Object(k.a)(e,"MMMM do, yyyy [at] h:mm:ss a"),l.a.createElement("br",null),"(",Se(e),")"),l.a.createElement("br",null),"\xa0",l.a.createElement("br",null),"While your version is from:",l.a.createElement("br",null),"\xa0",l.a.createElement("br",null),l.a.createElement("div",{className:"sync-confirmation-modal__last-sync-time"},Object(k.a)(t,"MMMM do, yyyy [at] h:mm:ss a"),l.a.createElement("br",null),"(",Se(t),")"),l.a.createElement("div",{className:"sync-confirmation-modal__buttons-container"},l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:a},"Pull latest version from server"),l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:r},"Overwrite server version"),l.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:s},"Cancel sync")),l.a.createElement("br",null)));n(365);class Bi extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleRemoveTag","handleAddNewTag","handleTagChange"]),this.state={allTags:e.allTags}}componentDidUpdate(e){const t=e.header.getIn(["titleLine","tags"]),n=this.props.header.getIn(["titleLine","tags"]);t.size===n.size-1&&""===n.last()&&this.lastTextfield&&this.lastTextfield.focus()}handleTagChange(e){return t=>{const n=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(n.set(e,t.target.value.replace(/(\s+|:)/g,"")))}}handleRemoveTag(e){return()=>{const t=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(t.delete(e))}}handleAddNewTag(){const e=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(e.push(""))}handleExistingTagClick(e){return()=>{const t=this.props.header.getIn(["titleLine","tags"]);t.includes(e)?this.props.onChange(t.filter(t=>t!==e)):this.props.onChange(t.push(e))}}render(){const e=this.props,t=e.header,n=e.onClose,a=this.state.allTags,r=t.getIn(["titleLine","tags"]);return l.a.createElement(Fi,{onClose:n},l.a.createElement("h2",{className:"drawer-modal__title"},"Edit tags"),l.a.createElement("datalist",{id:"drawer-modal__datalist-tag-names"},a.map((e,t)=>l.a.createElement("option",{key:t,value:e}))),0===r.size?l.a.createElement("div",{className:"no-tags-message"},"This header doesn't have any tags.",l.a.createElement("br",null),l.a.createElement("br",null),"Click the ",l.a.createElement("i",{className:"fas fa-plus"})," button to add a new one, or choose from the list of all of your tags below."):l.a.createElement(Ds.c,{droppableId:"tags-editor-droppable",type:"TAG"},(e,t)=>l.a.createElement("div",Object.assign({className:"tags-container",ref:e.innerRef},e.droppableProps),l.a.createElement(o.Fragment,null,r.map((e,t)=>l.a.createElement(Ds.b,{draggableId:"tag--".concat(t),index:t,key:t},(n,a)=>l.a.createElement("div",Object.assign({className:Us()("tag-container",{"tag-container--dragging":a.isDragging}),ref:n.innerRef},n.draggableProps),l.a.createElement("input",{type:"text",className:"textfield tag-container__textfield",value:e,onChange:this.handleTagChange(t),ref:e=>this.lastTextfield=e,list:"drawer-modal__datalist-tag-names"}),l.a.createElement("div",{className:"tag-container__actions-container"},l.a.createElement("i",{className:"fas fa-times fa-lg",onClick:this.handleRemoveTag(t)}),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg tag-container__drag-handle drag-handle"},n.dragHandleProps)))))),e.placeholder))),l.a.createElement("div",{className:"tags-editor__add-new-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewTag})),l.a.createElement("hr",{className:"tags-editor__separator"}),l.a.createElement("h2",{className:"tags-editor__title"},"All tags"),l.a.createElement("div",{className:"all-tags-container"},a.filter(e=>!!e).map(e=>{const t=Us()("all-tags__tag",{"all-tags__tag--in-use":r.includes(e)});return l.a.createElement("div",{className:t,key:e,onClick:this.handleExistingTagClick(e)},e)})))}}n(366),n(367),n(368);var Wi=({buttons:e,titles:t,values:n,selectedButton:a,useEqualWidthTabs:r,onSelect:s})=>{const i=e=>()=>s(e),o=Us()("tab-buttons",{"tab-buttons--equal-width-tabs":r}),c={gridTemplateColumns:r?"repeat(".concat(e.length,", 1fr)"):null};return l.a.createElement("div",{className:o,style:c},e.map((e,r)=>{const s=n?n[r]:e,o=Us()("tab-buttons__btn",{"tab-buttons__btn--selected":s===a});let c="";return t&&(c=t[r]),l.a.createElement("div",{key:e+r,title:c,className:o,onClick:i(s)},e)}))};class Ui extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleActiveToggle","handleDateChange","handleAddRepeater","handleRemoveRepeater","handleRepeaterTypeChange","handleRepeaterValueChange","handleRepeaterUnitChange","handleAddDelay","handleRemoveDelay","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange"])}handleActiveToggle(){this.props.onChange(this.props.timestamp.update("isActive",e=>!e))}handleDateChange(e,t,n){if(E.a.isEmpty(e.target.value))E.a.isNumber(t)?this.props.org.removePlanningItem(this.props.headerId,t):E.a.isNumber(n)&&this.props.org.removeTimestamp(this.props.headerId,n),this.props.onClose();else{const t=this.props,n=t.onChange,a=t.timestamp,r=Object(k.a)(Object(wt.a)(e.target.value),"yyyy MM dd eee").split(" "),s=Object(g.a)(r,4),i=s[0],o=s[1],l=s[2],c=s[3];n(a.set("year",i).set("month",o).set("day",l).set("dayName",c))}}handleAddTime(e){return()=>{const t=this.props,n=t.onChange,a=t.timestamp,r="start"===e?["startHour","startMinute"]:["endHour","endMinute"],s=Object(g.a)(r,2),i=s[0],o=s[1],l=Object(k.a)(new Date,"HH:mm").split(":"),c=Object(g.a)(l,2),d=c[0],h=c[1];n(a.set(i,d).set(o,h))}}handleRemoveTime(e){return()=>{const t=this.props,n=t.onChange,a=t.timestamp,r="start"===e?["startHour","startMinute"]:["endHour","endMinute"],s=Object(g.a)(r,2),i=s[0],o=s[1];n(a.set(i,null).set(o,null))}}handleTimeChange(e){return t=>{const n=this.props,a=n.onChange,r=n.timestamp,s="start"===e?["startHour","startMinute"]:["endHour","endMinute"],i=Object(g.a)(s,2),o=i[0],l=i[1];let c=t.target.value.split(":"),d=Object(g.a)(c,2),h=d[0],u=d[1];h=h.startsWith("0")?h.substring(1):h,a(r.set(o,h).set(l,u))}}handleAddRepeater(){const e=this.props;(0,e.onChange)(e.timestamp.set("repeaterType","+").set("repeaterValue",1).set("repeaterUnit","h"))}handleRemoveRepeater(){const e=this.props;(0,e.onChange)(e.timestamp.set("repeaterType",null).set("repeaterValue",null).set("repeaterUnit",null))}handleRepeaterTypeChange(e){const t=this.props;(0,t.onChange)(t.timestamp.set("repeaterType",e))}handleRepeaterValueChange(e){const t=this.props;(0,t.onChange)(t.timestamp.set("repeaterValue",e.target.value))}handleRepeaterUnitChange(e){const t=this.props;(0,t.onChange)(t.timestamp.set("repeaterUnit",e))}handleAddDelay(){const e=this.props;(0,e.onChange)(e.timestamp.set("delayType","-").set("delayValue",1).set("delayUnit","h"))}handleRemoveDelay(){const e=this.props;(0,e.onChange)(e.timestamp.set("delayType",null).set("delayValue",null).set("delayUnit",null))}handleDelayTypeChange(e){const t=this.props;(0,t.onChange)(t.timestamp.set("delayType",e))}handleDelayValueChange(e){const t=this.props;(0,t.onChange)(t.timestamp.set("delayValue",e.target.value))}handleDelayUnitChange(e){const t=this.props;(0,t.onChange)(t.timestamp.set("delayUnit",e))}renderTimeField(e,t,n,a,r=!0){return l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},e),l.a.createElement("div",{className:"timestamp-editor__field"},n?l.a.createElement(o.Fragment,null,l.a.createElement("input",{type:"time",className:"timestamp-editor__time-input",value:"".concat(n.padStart(2,"0"),":").concat(a.padStart(2,"0")),onChange:this.handleTimeChange(t)}),r&&l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveTime(t)})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddTime(t)})))}renderRepeater(){const e=this.props.timestamp.toJS(),t=e.repeaterType,n=e.repeaterValue,a=e.repeaterUnit;return l.a.createElement("div",{className:"timestamp-editor__field-container"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Repeater"),l.a.createElement("div",{className:"timestamp-editor__field timestamp-editor__field--delay-repeater"},t?l.a.createElement(o.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},l.a.createElement(Wi,{buttons:["+","++",".+"],titles:["Shift exactly the amount of time in the repeater (i.e. one month for +1m).","Shift the date by as many intervals of the amount of time in the repeater (i.e. one or many months for for ++1m) as it takes to get this date into the future.","Shift the date exactly the amount of time of the repeater relative to the time of the state change."],selectedButton:t||"+",onSelect:this.handleRepeaterTypeChange})),l.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:n||1,onChange:this.handleRepeaterValueChange}),l.a.createElement("div",null,l.a.createElement(Wi,{buttons:["h","d","w","m","y"],titles:["hours","days","weeks","months","years"],selectedButton:a||"h",onSelect:this.handleRepeaterUnitChange})),l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveRepeater})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddRepeater})))}renderDelay(){const e=this.props.timestamp.toJS(),t=e.delayType,n=e.delayValue,a=e.delayUnit;return l.a.createElement("div",{className:"timestamp-editor__field-container"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Delay"),l.a.createElement("div",{className:"timestamp-editor__field"},t?l.a.createElement(o.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},l.a.createElement(Wi,{buttons:["-","--"],titles:["Set a different lead time before the entry is put into the agenda.","In case the task contains a repeater, the delay is considered to affect all occurrences; if you want the delay to only affect the first scheduled occurrence of the task, use '--' instead."],selectedButton:t||"-",onSelect:this.handleDelayTypeChange})),l.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:n||1,onChange:this.handleDelayValueChange}),l.a.createElement("div",null,l.a.createElement(Wi,{buttons:["h","d","w","m","y"],titles:["hours","days","weeks","months","years"],selectedButton:a||"h",onSelect:this.handleDelayUnitChange})),l.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveDelay})):l.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddDelay})))}render(){const e=this.props,t=e.timestamp,n=e.timestampId,a=e.planningItemIndex,r=t.toJS(),s=r.isActive,i=r.year,o=r.month,c=r.day,d=r.startHour,h=r.startMinute,u=r.endHour,p=r.endMinute;return l.a.createElement("div",null,l.a.createElement("div",{className:"timestamp-editor__render"},F(t)),l.a.createElement("div",{className:"timestamp-editor__date-time-fields-container"},l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Active"),l.a.createElement("div",{className:"timestamp-editor__field"},l.a.createElement(Mi,{isEnabled:s,onToggle:this.handleActiveToggle}))),l.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},l.a.createElement("div",{className:"timestamp-editor__field-title"},"Date"),l.a.createElement("div",{className:"timestamp-editor__field"},l.a.createElement("input",{"data-testid":"timestamp-selector",type:"date",className:"timestamp-editor__date-input",onChange:e=>this.handleDateChange(e,a,n),onFocus:e=>e.nativeEvent.target.defaultValue="",value:"".concat(i,"-").concat(o,"-").concat(c)}))),this.renderTimeField("Start time","start",d,h,!u),!!d&&this.renderTimeField("End time","end",u,p)),this.renderRepeater(),this.renderDelay())}}var Vi=Object(h.b)(null,e=>({org:Object(u.b)(s,e)}))(Ui);class Gi extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleAddEndTimestamp","handleRemoveEndTimestamp"])}handleChange(e){return t=>this.props.onChange(this.props.timestamp.set(e,t))}handleAddEndTimestamp(){const e=this.props.timestamp,t=Object(k.a)(new Date,"yyyy MM dd eee").split(" "),n=Object(g.a)(t,4),a=n[0],r=n[1],s=n[2],i=n[3];this.props.onChange(e.set("secondTimestamp",Object(w.Map)({year:a,month:r,day:s,dayName:i,isActive:e.getIn(["firstTimestamp","isActive"])})))}handleRemoveEndTimestamp(){this.props.onChange(this.props.timestamp.set("secondTimestamp",null))}render(){const e=this.props,t=e.headerId,n=e.timestamp,a=e.timestampId,r=e.onClose,s=e.singleTimestampOnly,i=e.planningItemIndex;return l.a.createElement(Fi,{onClose:r},l.a.createElement("h2",{className:"timestamp-editor__title"},"Edit timestamp"),l.a.createElement(Vi,{headerId:t,timestamp:n.get("firstTimestamp"),timestampId:a,planningItemIndex:i,onClose:r,onChange:this.handleChange("firstTimestamp")}),!s&&(n.get("secondTimestamp")?l.a.createElement(o.Fragment,null,l.a.createElement("div",{className:"timestamp-editor__separator"},l.a.createElement("div",{className:"timestamp-editor__separator__margin-line"}),"to",l.a.createElement("div",{className:"timestamp-editor__separator__margin-line"})),l.a.createElement(Vi,{headerId:t,timestamp:n.get("secondTimestamp"),timestampId:a,onChange:this.handleChange("secondTimestamp")}),l.a.createElement("div",{className:"timestamp-editor__button-container"},l.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleRemoveEndTimestamp},"Remove end timestamp"))):l.a.createElement("div",{className:"timestamp-editor__button-container"},l.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleAddEndTimestamp},"Add end timestamp"))),l.a.createElement("br",null))}}n(369);class Ki extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleAddNewItem"])}componentDidUpdate(e){const t=e.propertyListItems,n=this.props.propertyListItems;t.size===n.size-1&&""===n.last().get("property")&&this.lastTextfield&&this.lastTextfield.focus()}handlePropertyChange(e){return t=>{const n=this.props.propertyListItems.findIndex(t=>t.get("id")===e);this.props.onChange(this.props.propertyListItems.setIn([n,"property"],t.target.value))}}handleValueChange(e){return t=>{const n=this.props,a=n.propertyListItems,r=n.onChange,s=a.findIndex(t=>t.get("id")===e);r(a.setIn([s,"value"],Object(w.fromJS)(mn(t.target.value))))}}handleRemoveItem(e){return()=>this.props.onChange(this.props.propertyListItems.filter(t=>t.get("id")!==e))}handleAddNewItem(){this.props.onChange(this.props.propertyListItems.push(Object(w.fromJS)({property:"",value:"",id:v()})))}render(){const e=this.props,t=e.onClose,n=e.propertyListItems,a=e.allOrgProperties,r=Ce(a),s=n.map(e=>{const t=e.get("property");return[e,Ae(a,t)]});return l.a.createElement(Fi,{onClose:t},l.a.createElement("h2",{className:"drawer-modal__title"},"Edit property list"),l.a.createElement("datalist",{id:"drawer-modal__datalist-property-names"},r.map((e,t)=>l.a.createElement("option",{key:t,value:e}))),0===n.size?l.a.createElement("div",{className:"no-items-message"},"There are no items in this property list.",l.a.createElement("br",null),l.a.createElement("br",null),"Click the ",l.a.createElement("i",{className:"fas fa-plus"})," button to add a new one."):l.a.createElement(Ds.c,{droppableId:"property-list-editor-droppable",type:"PROPERTY-LIST"},e=>l.a.createElement("div",Object.assign({className:"property-list-editor__items-container",ref:e.innerRef},e.droppableProps),l.a.createElement(o.Fragment,null,s.map(([e,t],n)=>l.a.createElement(Ds.b,{draggableId:"property-list-item--".concat(n),index:n,key:e.get("id")},(a,r)=>l.a.createElement("div",Object.assign({className:Us()("property-list-editor__item-container",{"property-list-editor__item-container--dragging":r.isDragging}),ref:a.innerRef},a.draggableProps),l.a.createElement("div",{className:"item__textfields-container"},l.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:e.get("property"),onChange:this.handlePropertyChange(e.get("id")),ref:e=>this.lastTextfield=e,list:"drawer-modal__datalist-property-names"}),l.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:J(e.get("value")),onChange:this.handleValueChange(e.get("id")),list:"drawer-modal__datalist-property-".concat(n,"-values")}),l.a.createElement("datalist",{id:"drawer-modal__datalist-property-".concat(n,"-values")},t.map((e,t)=>l.a.createElement("option",{key:t,value:e})))),l.a.createElement("div",{className:"item-container__actions-container"},l.a.createElement("i",{className:"fas fa-times fa-lg",onClick:this.handleRemoveItem(e.get("id"))}),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg item-container__drag-handle drag-handle"},a.dragHandleProps)))))),e.placeholder))),l.a.createElement("div",{className:"property-list-editor__add-new-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewItem})))}}n(370),n(371);var zi=n(411),Yi=n(404),Ji=n(405),qi=n(406);class Xi extends o.PureComponent{handleHeaderClick(e,t){return()=>this.props.onHeaderClick(e,t)}render(){const e=this.props,t=e.date,n=e.files,a=e.dateDisplayType,r=e.onToggleDateDisplayType,s=e.agendaDefaultDeadlineDelayValue,i=e.agendaDefaultDeadlineDelayUnit,c=Object(Vt.a)(t),d=Object(zt.a)(t),h=this.getPlanningItemsAndHeaders({files:n,date:t,agendaDefaultDeadlineDelayValue:s,agendaDefaultDeadlineDelayUnit:i,dateStart:c,dateEnd:d});return l.a.createElement("div",{className:"agenda-day__container"},l.a.createElement("div",{className:"agenda-day__title"},Object(zi.a)(t)&&l.a.createElement("div",{className:"agenda-day__today-indicator"}),l.a.createElement("div",{className:"agenda-day__title__day-name"},Object(k.a)(t,"eeee")),l.a.createElement("div",{className:"agenda-day__title__date"},Object(k.a)(t,"MMMM do, yyyy"))),l.a.createElement("div",{className:"agenda-day__headers-container"},l.a.createElement("div",null,h.map(([e,t])=>{const n=W(e.get("timestamp")),s=!!t.getIn(["titleLine","todoKeyword"]),i=Us()("agenda-day__header-planning-date",{"agenda-day__header-planning-date--overdue":s&&Object(Yi.a)(n)});return l.a.createElement("div",{key:e.get("id"),className:"agenda-day__header-container"},l.a.createElement("div",{className:"agenda-day__header__planning-item-container"},l.a.createElement("div",{className:"agenda-day__header-planning-type"},Le(e)),l.a.createElement("div",{className:i,onClick:r},"absolute"===a?Object(k.a)(n,"MM/dd"):Se(n),e.getIn(["timestamp","startHour"])&&l.a.createElement(o.Fragment,null,l.a.createElement("br",null),Object(k.a)(n,"h:mma")))),l.a.createElement("div",{className:"agenda-day__header__header-container"},l.a.createElement(gi,{header:t,color:"var(--base03)",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:this.handleHeaderClick(t.get("path"),t.get("id"))})))}))))}getPlanningItemsAndHeaders({files:e,date:t,agendaDefaultDeadlineDelayValue:n,agendaDefaultDeadlineDelayUnit:a,dateStart:r,dateEnd:s}){const i=Object(w.List)().concat(...e.mapEntries(([e,t])=>[e,t.get("headers").map(t=>t.set("path",e))]).valueSeq()),o=e.map(e=>e.get("todoKeywordSets"));return i.flatMap(e=>e.get("planningItems").filter(i=>{const l=i.get("timestamp");if(!l.get("isActive"))return!1;const c=W(l),d=e.getIn(["titleLine","todoKeyword"]);if(d&&((e,t)=>Ie(e,t).get("completedKeywords").includes(t))(o.get(e.get("path")),d))return!1;switch(i.get("type")){case"DEADLINE":if(Object(zi.a)(t)){if(Object(x.a)(c,new Date))return!0;const e=l.get("delayType")?[l.get("delayValue"),l.get("delayUnit")]:[n,a],r=Object(g.a)(e,2),s=r[0],i=r[1],o=V(c,s,i);return Object(yt.a)(t,o)||Object(Ji.a)(t,o)}return Object(qi.a)(c,{start:r,end:s});case"SCHEDULED":let i=c;if(l.get("delayType")){const t=e.get("propertyListItems").some(e=>"LAST_REPEAT"===e.get("property"));"--"!==l.get("delayType")||t||(i=U(c,l.get("delayValue"),l.get("delayUnit")))}return!(!Object(zi.a)(t)||!Object(yt.a)(t,i))||Object(qi.a)(i,{start:r,end:s});default:return Object(qi.a)(c,{start:r,end:s})}}).map(t=>[t,e])).sortBy(([e])=>{const t=e.get("timestamp").toJS(),n=t.startHour;return[n?0:1,n,t.startMinute,t.endHour,t.endMinute,t.month,t.day]})}}var $i=n(407),Zi=n(408);var Qi=Object(h.b)(e=>{const t=e.org.present.get("path"),n=e.org.present.getIn(["files",t]),a=e.org.present.get("files"),r=e.org.present.get("fileSettings"),s=e.base.get("agendaStartOnWeekday");return{files:Ba(a,r,t,"includeInAgenda",!1),todoKeywordSets:n.get("todoKeywordSets"),agendaTimeframe:e.base.get("agendaTimeframe"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d",agendaStartOnWeekday:null==s?1:+s}},e=>({org:Object(u.b)(s,e),base:Object(u.b)(a,e)}))((function(e){const t=e.files,n=e.onClose,a=e.todoKeywordSets,r=e.agendaTimeframe,s=e.agendaDefaultDeadlineDelayValue,i=e.agendaDefaultDeadlineDelayUnit,c=e.agendaStartOnWeekday,d=Object(o.useState)(new Date),h=Object(g.a)(d,2),u=h[0],p=h[1],m=Object(o.useState)("absolute"),f=Object(g.a)(m,2),b=f[0],y=f[1],w=c<0?Object($i.a)(u):c;function T(t,n){e.onClose(),e.org.selectHeaderAndOpenParents(t,n)}function v(){y("absolute"===b?"relative":"absolute")}let _=[];switch(r){case"Day":_=[u];break;case"Week":const e=Object(Jt.a)(u,{weekStartsOn:w});_=E.a.range(7).map(t=>Object(I.a)(e,t));break;case"Month":const t=Object(Ut.a)(u);_=E.a.range(Object(Zi.a)(u)).map(e=>Object(I.a)(t,e))}return l.a.createElement(Fi,{onClose:n,maxSize:!0},l.a.createElement("h2",{className:"agenda__title"},"Agenda"),l.a.createElement("div",{className:"agenda__tab-container"},l.a.createElement(Wi,{buttons:["Day","Week","Month"],selectedButton:r,onSelect:function(t){e.base.setAgendaTimeframe(t)},useEqualWidthTabs:!0})),l.a.createElement("div",{className:"agenda__timeframe-header-container"},l.a.createElement("i",{className:"fas fa-chevron-left fa-lg",onClick:function(){switch(r){case"Day":p(Object(N.a)(u,1));break;case"Week":p(Object(P.a)(u,1));break;case"Month":p(Object(R.a)(u,1));break;default:return""}}}),l.a.createElement("div",{className:"agenda__timeframe-header"},function(){switch(r){case"Day":return Object(k.a)(u,"MMMM do");case"Week":const e=Object(Jt.a)(u,{weekStartsOn:w}),t=Object(O.a)(e,1);return"".concat(Object(k.a)(e,"MMM do")," - ").concat(Object(k.a)(t,"MMM do")," (W").concat(Object(k.a)(e,"w"),")");case"Month":return Object(k.a)(u,"MMMM");default:return""}}()),l.a.createElement("i",{className:"fas fa-chevron-right fa-lg",onClick:function(){switch(r){case"Day":p(Object(I.a)(u,1));break;case"Week":p(Object(O.a)(u,1));break;case"Month":p(Object(D.a)(u,1));break;default:return""}}})),l.a.createElement("div",{className:"agenda__days-container",style:Ai?void 0:{overflow:"auto"}},_.map(e=>l.a.createElement(Xi,{key:Object(k.a)(e,"yyyy MM dd"),date:e,files:t,onHeaderClick:T,todoKeywordSets:a,dateDisplayType:b,onToggleDateDisplayType:v,agendaDefaultDeadlineDelayValue:s,agendaDefaultDeadlineDelayUnit:i}))),l.a.createElement("br",null))}));n(372),n(373);const eo=e=>W(e.get("timestamp")).getTime();var to=Object(h.b)(e=>{const t=e.org.present.get("files");return{headersForFiles:e.org.present.getIn(["search","filteredHeaders"])||Object(w.Map)(),todoKeywordSetsForFiles:t.map(e=>e.get("todoKeywordSets"))}},e=>({org:Object(u.b)(s,e)}))((function(e){const t=e.dateDisplayType,n=e.onToggleDateDisplayType,a=e.headersForFiles,r=e.todoKeywordSetsForFiles;Object(o.useEffect)(()=>{e.org.setSearchFilterInformation("",0,"task-list")},[e.org]);const s=function({headersForFiles:e,todoKeywordSetsForFiles:t}){const n=Object(w.List)().concat(...e.mapEntries(([e,t])=>[e,t.map(t=>t.set("path",e))]).valueSeq()),a=t.map(e=>Pe(e));return n.filter(e=>e.getIn(["titleLine","todoKeyword"])).map(e=>[e.get("planningItems").sortBy(eo).first(),e]).sortBy(([e,t])=>[a.get(t.get("path"))(t.getIn(["titleLine","todoKeyword"])),e?eo(e):Number.MAX_SAFE_INTEGER,t.getIn(["titleLine","rawTitle"])])}({headersForFiles:a,todoKeywordSetsForFiles:r});return l.a.createElement("div",{className:"agenda-day__container"},l.a.createElement("div",{className:"agenda-day__headers-container"},s.map(([a,r])=>{const s=a?W(a.get("timestamp")):null,i=!!r.getIn(["titleLine","todoKeyword"]),c=Us()("task-list__header-planning-date",{"task-list__header-planning-date--overdue":i&&a&&Object(Yi.a)(s)});let d=l.a.createElement("div",null);return s&&(d=l.a.createElement("div",{className:"agenda-day__header__planning-item-container"},l.a.createElement("div",{className:"task-list__header-planning-type"},Le(a)),l.a.createElement("div",{className:c,onClick:n},"absolute"===t?Object(k.a)(s,"MM/dd"):Se(s),!!a.getIn(["timestamp","startHour"])&&l.a.createElement(o.Fragment,null,l.a.createElement("br",null),Object(k.a)(s,"h:mma"))))),l.a.createElement("div",{key:r.get("id"),className:"agenda-day__header-container"},l.a.createElement("div",{className:"agenda-day__header__header-container"},l.a.createElement(gi,{header:r,color:"var(--base03)",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:(h=r.get("path"),u=r.get("id"),()=>e.onHeaderClick(h,u))}),d));var h,u})))}));var no=Object(h.b)(e=>({searchFilter:e.org.present.getIn(["search","searchFilter"])||"",searchFilterValid:e.org.present.getIn(["search","searchFilterValid"]),searchFilterSuggestions:e.org.present.getIn(["search","searchFilterSuggestions"])||[]}),e=>({org:Object(u.b)(s,e)}))((function(e){const t=Object(o.useState)("absolute"),n=Object(g.a)(t,2),a=n[0],r=n[1],s=e.onClose,i=e.searchFilter,c=e.searchFilterValid,d=e.searchFilterSuggestions;return l.a.createElement(Fi,{onClose:s,maxSize:!0},l.a.createElement("h2",{className:"agenda__title"},"Task list"),l.a.createElement("datalist",{id:"task-list__datalist-filter"},d.map((e,t)=>l.a.createElement("option",{key:t,value:e}))),l.a.createElement("div",{className:"task-list__input-container"},l.a.createElement("input",{type:"text",value:i,autoFocus:!Ni(),className:Us()("textfield","task-list__filter-input",{"task-list__filter-input--invalid":!!i&&!c}),placeholder:"e.g. -DONE doc|man :simple|easy :assignee:nobody|none",list:"task-list__datalist-filter",onChange:function(t){e.org.setSearchFilterInformation(t.target.value,t.target.selectionStart,"task-list")}})),l.a.createElement("div",{className:"task-list__headers-container",style:Ai?void 0:{overflow:"auto"}},l.a.createElement(to,{onHeaderClick:function(t,n){e.onClose(),e.org.selectHeaderAndOpenParents(t,n)},dateDisplayType:a,onToggleDateDisplayType:function(){r("absolute"===a?"relative":"absolute")}})),l.a.createElement("br",null))}));n(374),n(375);var ao=Object(h.b)(e=>({allHeaders:e.org.present.get("files").map(e=>e.get("headers")),headers:e.org.present.getIn(["search","filteredHeaders"])||Object(w.Map)(),showClockedTimes:e.org.present.getIn(["search","showClockedTimes"])}),e=>({org:Object(u.b)(s,e)}))((function(e){const t=e.context;function n(t,n){return()=>e.onHeaderClick(t,n)}Object(o.useEffect)(()=>{e.org.setSearchFilterInformation("",0,t)},[t,e.org]);const a=e.headers,r=e.allHeaders,s=e.showClockedTimes;return l.a.createElement("div",{className:"agenda-day__container"},l.a.createElement("div",{className:"agenda-day__headers-container"},Array.from(a.entries(),([e,t])=>{const a=Fe(r,e);return t.map(t=>l.a.createElement("div",{key:t.get("id"),className:"agenda-day__header-container"},l.a.createElement("div",{className:"search__breadcrumbs"},a(t)),l.a.createElement("div",{className:"agenda-day__header__header-container"},l.a.createElement(gi,{header:t,color:"var(--base03)",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:n(e,t.get("id")),addition:s&&0!==t.get("totalFilteredTimeLoggedRecursive")?z(t.get("totalFilteredTimeLoggedRecursive")):null}))))})))}));var ro=Object(h.b)(e=>({path:e.org.present.get("path"),searchFilter:e.org.present.getIn(["search","searchFilter"])||"",searchFilterValid:e.org.present.getIn(["search","searchFilterValid"]),searchFilterSuggestions:e.org.present.getIn(["search","searchFilterSuggestions"])||[],showClockedTimes:e.org.present.getIn(["search","showClockedTimes"]),clockedTime:e.org.present.getIn(["search","clockedTime"])}),e=>({org:Object(u.b)(s,e)}))((function(e){const t=Object(o.useState)("absolute"),n=Object(g.a)(t,2),a=n[0],r=n[1],s=e.onClose,i=e.searchFilter,c=e.searchFilterValid,d=e.searchFilterSuggestions,h=e.context,u=e.showClockedTimes,p=e.clockedTime;return l.a.createElement(Fi,{onClose:s,maxSize:!0},l.a.createElement("div",{className:"task-list__modal-title"},l.a.createElement("h2",{className:"agenda__title"},Object(y.capitalize)(h)),u?l.a.createElement("span",{title:"Sum of time logged on all search results directly (not including time logged on their children)"},z(p)):null),l.a.createElement("datalist",{id:"task-list__datalist-filter"},d.map((e,t)=>l.a.createElement("option",{key:t,value:e}))),l.a.createElement("div",{className:"task-list__input-container"},l.a.createElement("input",{type:"text",value:i,autoFocus:!Ni(),className:Us()("textfield","task-list__filter-input",{"task-list__filter-input--invalid":!!i&&!c}),placeholder:"e.g. -DONE doc|man :simple|easy :assignee:nobody|none",list:"task-list__datalist-filter",onChange:function(t){e.org.setSearchFilterInformation(t.target.value,t.target.selectionStart,h)}})),l.a.createElement("div",{className:"task-list__headers-container",style:Ai?void 0:{overflow:"auto"}},l.a.createElement(ao,{onHeaderClick:function(t,n){e.onClose(t,n)},dateDisplayType:a,onToggleDateDisplayType:function(){r("absolute"===a?"relative":"absolute")},context:h})),l.a.createElement("br",null))}));const so=[["Select next header","selectNextVisibleHeader","ctrl+down"],["Select previous header","selectPreviousVisibleHeader","ctrl+up"],["Toggle header opened","toggleHeaderOpened","tab"],["Advance todo state","advanceTodo","alt+t"],["Edit title","editTitle","ctrl+h"],["Edit description","editDescription","ctrl+d"],["Exit edit mode","exitEditMode","alt+enter"],["Add header","addHeader","ctrl+enter"],["Remove header","removeHeader","backspace"],["Move header up","moveHeaderUp","alt+up"],["Move header down","moveHeaderDown","alt+down"],["Move header left","moveHeaderLeft","alt+shift+left"],["Move header right","moveHeaderRight","alt+shift+right"],["Undo","undo","ctrl+/"]],io=e=>so.map(([t,n,a])=>[t,e.get(t,a)]);class oo extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","handleAdvanceTodoHotKey","handleEditTitleHotKey","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","handleContainerRef","handleCapture","handlePopupClose","handleSearchPopupClose","handleRefilePopupClose","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","handleTagsChange","handlePropertyListItemsChange"]),this.state={hasUncaughtError:!1}}componentDidMount(){const e=this.props,t=e.staticFile,n=e.path;t?(this.props.org.setPath("organice_internal_"+t),"changelog"===t&&(this.props.base.setHasUnseenChangelog(!1),Q().then(e=>{this.props.base.setLastSeenChangelogHeader(e)})),setTimeout(()=>document.querySelector("html").scrollTop=0,0)):E.a.isEmpty(n)||(this.props.fileIsLoaded(n)?this.props.org.sync({path:n,shouldSuppressMessages:!0}):this.props.syncBackend.downloadFile(n),this.props.org.setPath(n)),this.activatePopup()}activatePopup(){const e=window.location.hash.substr(1);E.a.isEmpty(e)||this.props.base.activatePopup(e)}componentWillUnmount(){this.props.staticFile?this.props.base.unloadStaticFile():this.props.org.resetFileDisplay()}componentDidUpdate(e){const t=this.props,n=t.headers;t.pendingCapture&&n&&n.size>0&&this.props.org.insertPendingCapture();const a=this.props.path;E.a.isEmpty(a)||a===e.path||(this.props.syncBackend.downloadFile(a),this.props.org.setPath(a))}componentDidCatch(){this.setState({hasUncaughtError:!0})}handleSelectNextVisibleHeaderHotKey(){this.props.org.selectNextVisibleHeader()}handleSelectPreviousVisibleHeaderHotKey(){this.props.org.selectPreviousVisibleHeader()}handleToggleHeaderOpenedHotKey(){const e=this.props,t=e.selectedHeaderId,n=e.closeSubheadersRecursively;t&&this.props.org.toggleHeaderOpened(t,n)}handleAdvanceTodoHotKey(){this.props.org.advanceTodoState(null,this.props.shouldLogIntoDrawer)}handleEditTitleHotKey(){this.props.org.enterEditMode("title")}handleEditDescriptionHotKey(){this.props.org.openHeader(this.props.selectedHeaderId),this.props.org.enterEditMode("description")}handleExitEditModeHotKey(){this.props.org.exitEditMode(),this.container.focus()}handleAddHeaderHotKey(){this.props.org.addHeaderAndEdit(this.props.selectedHeaderId)}handleRemoveHeaderHotKey(){const e=this.props.selectedHeaderId;this.props.org.selectNextSiblingHeader(e),this.props.org.removeHeader(e)}handleMoveHeaderUpHotKey(){this.props.org.moveHeaderUp(this.props.selectedHeaderId)}handleMoveHeaderDownHotKey(){this.props.org.moveHeaderDown(this.props.selectedHeaderId)}handleMoveHeaderLeftHotKey(){this.props.org.moveHeaderLeft(this.props.selectedHeaderId)}handleMoveHeaderRightHotKey(){this.props.org.moveHeaderRight(this.props.selectedHeaderId)}handleUndoHotKey(){this.props.undo.undo()}handleContainerRef(e){this.container=e,this.container&&this.container.focus()}handleCapture(e,t,n){this.props.org.insertCapture(e,t,n)}handlePopupClose(){this.props.base.closePopup()}handleSearchPopupClose(e,t){this.props.base.closePopup(),e&&t&&this.props.org.selectHeaderAndOpenParents(e,t)}handleRefilePopupClose(e,t){if(this.props.base.closePopup(),t){const n=this.props,a=n.loadedPath,r=n.selectedHeaderId;this.props.org.refileSubtree(a,r,e,t)}}handleSyncConfirmationPull(e){this.props.org.sync({path:e,forceAction:"pull"}),this.props.base.closePopup()}handleSyncConfirmationPush(e){this.props.org.sync({path:e,forceAction:"push"}),this.props.base.closePopup()}handleSyncConfirmationCancel(){this.props.base.closePopup()}handleTagsChange(e){this.props.org.setHeaderTags(this.props.selectedHeaderId,e)}handlePropertyListItemsChange(e){this.props.org.updatePropertyListItems(this.props.selectedHeaderId,e)}handleTimestampChange(e){return e.get("timestampId")?t=>this.props.org.updateTimestampWithId(e.get("timestampId"),t):void 0!==e.get("logEntryIndex")?t=>this.props.org.updateLogEntryTime(e.get("headerId"),e.get("logEntryIndex"),e.get("entryType"),t.get("firstTimestamp")):t=>this.props.org.updatePlanningItemTimestamp(e.get("headerId"),e.get("planningItemIndex"),t.get("firstTimestamp"))}renderActivePopup(){const e=this.props,t=e.activePopupType,n=e.activePopupData,a=e.captureTemplates,r=e.files,s=e.headers,i=e.selectedHeader;switch(t){case"sync-confirmation":return l.a.createElement(ji,{lastServerModifiedAt:n.get("lastServerModifiedAt"),lastSyncAt:n.get("lastSyncAt"),path:n.get("path"),onPull:()=>this.handleSyncConfirmationPull(n.get("path")),onPush:()=>this.handleSyncConfirmationPush(n.get("path")),onCancel:this.handleSyncConfirmationCancel});case"capture":const e=a.find(e=>e.get("id")===n.get("templateId")),t=e.get("file");let o=s;if(t){const e=r.get(t);o=e?e.get("headers"):Object(w.List)()}return l.a.createElement(Hi,{template:e,headers:o,onCapture:this.handleCapture,onClose:this.handlePopupClose});case"tags-editor":const c=Oe(s);return i?l.a.createElement(Bi,{header:i,allTags:c,onClose:this.handlePopupClose,onChange:this.handleTagsChange}):null;case"timestamp-editor":let d=null;return d=n.get("timestampId")?((e,t)=>e.map(e=>_e(e.getIn(["titleLine","title"]),t)||_e(e.get("description"),t)||_e(e.get("logNotes"),t)||e.get("propertyListItems").map(e=>_e(e.get("value"),t)).filter(e=>e).first()).find(e=>e))(s,n.get("timestampId")):void 0!==n.get("logEntryIndex")?Object(w.fromJS)({firstTimestamp:ne(s,n.get("headerId")).getIn(["logBookEntries",n.get("logEntryIndex"),n.get("entryType")])}):Object(w.fromJS)({firstTimestamp:ne(s,n.get("headerId")).getIn(["planningItems",n.get("planningItemIndex"),"timestamp"])}),l.a.createElement(Gi,{headerId:n.get("headerId"),timestamp:d,timestampId:n.get("timestampId"),planningItemIndex:n.get("planningItemIndex"),singleTimestampOnly:!n.get("timestampId"),onClose:this.handlePopupClose,onChange:this.handleTimestampChange(n)});case"property-list-editor":const h=De(s);return i?l.a.createElement(Ki,{onClose:this.handlePopupClose,onChange:this.handlePropertyListItemsChange,propertyListItems:i.get("propertyListItems"),allOrgProperties:h}):null;case"agenda":return l.a.createElement(Qi,{onClose:this.handlePopupClose});case"task-list":return l.a.createElement(no,{onClose:this.handlePopupClose});case"search":return l.a.createElement(ro,{onClose:this.handleSearchPopupClose,context:"search"});case"refile":return l.a.createElement(ro,{onClose:this.handleRefilePopupClose,context:"refile"});default:return null}}render(){const e=this.props,t=e.headers,n=e.shouldDisableDirtyIndicator,a=e.shouldDisableSyncButtons,r=e.shouldDisableActions,s=e.isDirty,i=e.parsingErrorMessage,c=e.path,d=e.staticFile,h=e.customKeybindings,u=e.inEditMode,p=e.orgFileErrorMessage;if(!c&&!d)return l.a.createElement(Bs.a,{to:"/files"});if(this.state.hasUncaughtError)return l.a.createElement("div",{className:"error-message-container"},"Uh oh, you ran into a bug!",l.a.createElement("br",null),l.a.createElement("br",null),"This was probably the result of an error in attempting to parse your org file. It'd be super helpful if you could"," ",l.a.createElement(Vs,{href:"https://github.com/200ok-ch/organice/issues/new"},"create an issue")," ","(and include the org file if possible!)");if(p)return l.a.createElement("div",{className:"error-message-container"},p);if(!t)return l.a.createElement("div",null);const g=E.a.fromPairs((e=>so.map(([t,n,a])=>[n,e.get(t,a)]))(h)),m=(e,t=!1)=>n=>{t&&u||t&&["TEXTAREA","INPUT"].includes(document.activeElement.nodeName)||(n.preventDefault(),e(n))},f={selectNextVisibleHeader:m(this.handleSelectNextVisibleHeaderHotKey),selectPreviousVisibleHeader:m(this.handleSelectPreviousVisibleHeaderHotKey),toggleHeaderOpened:m(this.handleToggleHeaderOpenedHotKey,!0),advanceTodo:m(this.handleAdvanceTodoHotKey),editTitle:m(this.handleEditTitleHotKey),editDescription:m(this.handleEditDescriptionHotKey),exitEditMode:m(this.handleExitEditModeHotKey),addHeader:m(this.handleAddHeaderHotKey),removeHeader:m(this.handleRemoveHeaderHotKey,!0),moveHeaderUp:m(this.handleMoveHeaderUpHotKey),moveHeaderDown:m(this.handleMoveHeaderDownHotKey),moveHeaderLeft:m(this.handleMoveHeaderLeftHotKey),moveHeaderRight:m(this.handleMoveHeaderRightHotKey),undo:m(this.handleUndoHotKey)};return l.a.createElement(Qs.HotKeys,{keyMap:g,handlers:f},l.a.createElement("div",{className:"org-file-container",tabIndex:"-1",ref:this.handleContainerRef},0===t.size?l.a.createElement("div",{className:"org-file__parsing-error-message"},l.a.createElement("h3",null,"Couldn't parse file"),i?l.a.createElement(o.Fragment,null,i):l.a.createElement(o.Fragment,null,"If you think this is a bug, please"," ",l.a.createElement(Vs,{href:"https://github.com/200ok-ch/organice/issues/new"},"create an issue")," ","and include the org file if possible!")):l.a.createElement(_i,{shouldDisableActions:r}),s&&!n&&l.a.createElement("div",{className:"dirty-indicator"},"Unpushed changes"),!r&&l.a.createElement(Ii,{shouldDisableSyncButtons:a,staticFile:d}),this.renderActivePopup()))}}var lo=Object(h.b)(e=>{const t=e.org.present.get("files"),n=e.org.present.get("path"),a=w.Set.fromKeys(t),r=e.org.present.getIn(["files",n],Object(w.Map)()),s=r.get("headers"),i=r.get("selectedHeaderId",null),o=e.base.get("activePopup",Object(w.Map)());return{loadedPath:n,files:t,headers:s,selectedHeaderId:i,isDirty:r.get("isDirty"),fileIsLoaded:e=>a.includes(e),selectedHeader:s&&s.find(e=>e.get("id")===i),customKeybindings:e.base.get("customKeybindings"),shouldLogIntoDrawer:e.base.get("shouldLogIntoDrawer"),shouldLiveSync:e.base.get("shouldLiveSync"),inEditMode:r.get("editMode"),activePopupType:o?o.get("type"):null,activePopupData:o?o.get("data"):null,captureTemplates:e.capture.get("captureTemplates").concat(bt),pendingCapture:e.org.present.get("pendingCapture"),closeSubheadersRecursively:e.base.get("closeSubheadersRecursively"),orgFileErrorMessage:e.org.present.get("orgFileErrorMessage")}},e=>({base:Object(u.b)(a,e),syncBackend:Object(u.b)(i,e),org:Object(u.b)(s,e),undo:Object(u.b)(f.ActionCreators,e),capture:Object(u.b)(r,e)}))(oo);n(376);var co=Object(Bs.h)(Object(h.b)(e=>{const t=e.base.get("agendaStartOnWeekday");return{fontSize:e.base.get("fontSize")||"Regular",bulletStyle:e.base.get("bulletStyle"),shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d",agendaStartOnWeekday:null==t?1:+t,shouldStoreSettingsInSyncBackend:e.base.get("shouldStoreSettingsInSyncBackend"),shouldLiveSync:e.base.get("shouldLiveSync"),shouldSyncOnBecomingVisibile:e.base.get("shouldSyncOnBecomingVisibile"),shouldShowTitleInOrgFile:e.base.get("shouldShowTitleInOrgFile"),shouldLogIntoDrawer:e.base.get("shouldLogIntoDrawer"),closeSubheadersRecursively:e.base.get("closeSubheadersRecursively"),shouldNotIndentOnExport:e.base.get("shouldNotIndentOnExport"),hasUnseenChangelog:e.base.get("hasUnseenChangelog"),showClockDisplay:e.org.present.get("showClockDisplay"),colorScheme:e.base.get("colorScheme"),theme:e.base.get("theme")}},e=>({syncBackend:Object(u.b)(i,e),base:Object(u.b)(a,e),org:Object(u.b)(s,e)}))(({fontSize:e,bulletStyle:t,shouldTapTodoToAdvance:n,shouldStoreSettingsInSyncBackend:a,shouldLiveSync:r,shouldSyncOnBecomingVisibile:s,shouldShowTitleInOrgFile:i,shouldLogIntoDrawer:o,closeSubheadersRecursively:c,shouldNotIndentOnExport:d,agendaDefaultDeadlineDelayValue:h,agendaDefaultDeadlineDelayUnit:u,agendaStartOnWeekday:p,hasUnseenChangelog:g,syncBackend:m,showClockDisplay:f,colorScheme:b,theme:y,base:E,org:w})=>{const T=window.location.origin.match(/staging.organice.200ok.ch/)?"https://staging.organice.200ok.ch":"https://organice.200ok.ch";return l.a.createElement("div",{className:"settings-container"},l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Font size"),l.a.createElement(Wi,{buttons:["Regular","Large"],selectedButton:e,onSelect:e=>E.setFontSize(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Color scheme"),l.a.createElement(Wi,{buttons:["Light","Dark"],selectedButton:b,onSelect:e=>E.setColorScheme(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Theme"),l.a.createElement(Wi,{buttons:["Solarized","One","Gruvbox","Smyck","Code"],selectedButton:y,onSelect:e=>E.setTheme(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Bullet style"),l.a.createElement(Wi,{buttons:["Classic","Fancy"],selectedButton:t,onSelect:e=>E.setBulletStyle(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Tap TODO to advance state"),l.a.createElement(Mi,{isEnabled:n,onToggle:()=>E.setShouldTapTodoToAdvance(!n)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Live sync",l.a.createElement("div",{className:"setting-label__description"},"If enabled, changes are automatically pushed to the sync backend as you make them.")),l.a.createElement(Mi,{isEnabled:r,onToggle:()=>E.setShouldLiveSync(!r)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Sync on application becoming visible",l.a.createElement("div",{className:"setting-label__description"},"If enabled, the current org file is pulled from the sync backend when the browser tab becomes visible. This prevents you from having a stale file before starting to make changes to it.")),l.a.createElement(Mi,{isEnabled:s,onToggle:()=>E.setShouldSyncOnBecomingVisibile(!s)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Show Org filename as Title",l.a.createElement("div",{className:"setting-label__description"},"When in an Org file view, it shows the filename in the HeaderBar.")),l.a.createElement(Mi,{isEnabled:i,onToggle:()=>E.setShouldShowTitleInOrgFile(!i)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Log into LOGBOOK drawer when item repeats",l.a.createElement("div",{className:"setting-label__description"},"Log TODO state changes (currently only for repeating items) into the LOGBOOK drawer instead of into the body of the heading (default). See the Orgmode documentation on"," ",l.a.createElement(Vs,{href:"https://www.gnu.org/software/emacs/manual/html_node/org/Tracking-TODO-state-changes.html"},l.a.createElement("code",null,"org-log-into-drawer"))," ","for more information.")),l.a.createElement(Mi,{isEnabled:o,onToggle:()=>E.setShouldLogIntoDrawer(!o)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"When folding a header, fold all subheaders too",l.a.createElement("div",{className:"setting-label__description"},"When folding a header, fold recursively all its subheaders, so that when the header is reopened all subheaders are folded, regardless of their state prior to folding. This is the default in Emacs Org mode. If this turned off, the fold-state of the subheaders is preserved when the header is unfolded.")),l.a.createElement(Mi,{isEnabled:c,onToggle:()=>E.setCloseSubheadersRecursively(!c)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Disable hard indent on Org export",l.a.createElement("div",{className:"setting-label__description"},"By default, the metadata body (including deadlines and drawers) of an exported org heading is indented according to its level. If instead you prefer to keep your body text flush-left, i.e."," ",l.a.createElement(Vs,{href:"https://orgmode.org/manual/Hard-indentation.html"},l.a.createElement("code",null,"(setq org-adapt-indentation nil)")),", then activate this setting. The raw content text is left unchanged.")),l.a.createElement(Mi,{isEnabled:d,onToggle:()=>E.setShouldNotIndentOnExport(!d)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Store settings in sync backend",l.a.createElement("div",{className:"setting-label__description"},"Store settings and keyboard shortcuts in a .organice-config.json file in your sync backend to sync between multiple devices.")),l.a.createElement(Mi,{isEnabled:a,onToggle:()=>E.setShouldStoreSettingsInSyncBackend(!a)})),l.a.createElement("div",{className:"setting-container setting-container--vertical"},l.a.createElement("div",{className:"setting-label"},"Default DEADLINE warning period"),l.a.createElement("div",{className:"default-deadline-warning-container"},l.a.createElement("input",{type:"number",min:"0",className:"textfield default-deadline-value-textfield",value:h,onChange:e=>E.setAgendaDefaultDeadlineDelayValue(e.target.value)}),l.a.createElement(Wi,{buttons:"hdwmy".split(""),selectedButton:u,onSelect:e=>E.setAgendaDefaultDeadlineDelayUnit(e)}))),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Start of week for weekly agenda",l.a.createElement("div",{className:"setting-label__description"},"Akin to"," ",l.a.createElement(Vs,{href:"https://orgmode.org/manual/Weekly_002fdaily-agenda.html"},l.a.createElement("code",null,"org-agenda-start-on-weekday")))),l.a.createElement(Wi,{buttons:["S","M","T","W","T","F","S","Today"],values:[0,1,2,3,4,5,6,-1],titles:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],selectedButton:p,onSelect:e=>E.setAgendaStartOnWeekday(e)})),l.a.createElement("div",{className:"setting-container"},l.a.createElement("div",{className:"setting-label"},"Display time summaries",l.a.createElement("div",{className:"setting-label__description"},"This puts overlays at the end of each headline, showing the total time recorded under that heading, including the time of any subheadings.")),l.a.createElement(Mi,{isEnabled:f,onToggle:()=>w.setShowClockDisplay(!f)})),l.a.createElement("div",{className:"settings-buttons-container"},l.a.createElement("button",{className:"btn settings-btn",onClick:()=>E.pushModalPage("capture_templates_editor")},"Capture templates"),l.a.createElement("button",{className:"btn settings-btn",onClick:()=>E.pushModalPage("keyboard_shortcuts_editor")},"Keyboard shortcuts"),l.a.createElement("button",{className:"btn settings-btn",onClick:()=>E.pushModalPage("file_settings_editor")},"File settings"),l.a.createElement("hr",{className:"settings-button-separator"}),l.a.createElement("button",{className:"btn settings-btn",onClick:()=>{E.restoreStaticFile("changelog"),E.pushModalPage("changelog")}},"Changelog",g&&l.a.createElement("div",{className:"changelog-badge-container"},l.a.createElement("i",{className:"fas fa-gift"}),"\xa0 What's New?")),l.a.createElement(Os.b,{to:"/sample",className:"btn settings-btn",onClick:()=>{E.restoreStaticFile("sample"),E.pushModalPage("sample")}},"Help"),l.a.createElement("button",{className:"btn settings-btn"},l.a.createElement(Vs,{href:"".concat(T,"/documentation.html")},"Documentation",l.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))," "),l.a.createElement("button",{className:"btn settings-btn"},l.a.createElement(Vs,{href:"https://github.com/200ok-ch/organice"},"Github repo",l.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))," "),l.a.createElement("hr",{className:"settings-button-separator"}),l.a.createElement("button",{className:"btn settings-btn",onClick:()=>window.confirm("Are you sure you want to sign out?")?m.signOut():void 0},"Sign out")))}));n(377);class ho extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleRebindClick","handleKeyPress"]),this.state={isEditMode:!1}}componentDidMount(){this.rebindArea.addEventListener("blur",()=>this.setState({isEditMode:!1}))}handleRebindClick(){this.setState({isEditMode:!0}),document.addEventListener("keypress",this.handleKeyPress)}handleKeyPress(e){this.setState({isEditMode:!1}),document.removeEventListener("keypress",this.handleKeyPress);let t=null;if(t=e.code.startsWith("Key")?e.code.substr(3).toLowerCase():e.code.startsWith("Digit")?e.code.substr(5):{Minus:"-",Equal:"=",Backspace:"backspace",Enter:"enter",Return:"return",Tab:"tab",BracketLeft:"[",BracketRight:"]",Semicolon:";",Quote:'"',Backslash:"\\",Comma:",",Period:".",Slash:"/"}[e.code],!t)return;const n=[["ctrlKey","ctrl"],["altKey","alt"],["metaKey","meta"],["shiftKey","shift"]].filter(([t,n])=>e[t]).map(([e,t])=>t).join("+"),a="".concat(n).concat(n?"+":"").concat(t);this.props.onBindingChange(this.props.name,a)}symbolizeKeybinding(e){if(!e)return"";return[["ctrl","^"],["alt","\u2325"],["option","\u2325"],["command","\u2318"],["meta","\u2318"],["shift","\u21e7"],["backspace","\u232b"],["return","\u23ce"],["enter","\u23ce"],["left","\u2190"],["right","\u2192"],["up","\u2191"],["down","\u2193"]].reduce((e,[t,n])=>e.replace(RegExp("".concat(t,"\\+?")),n),e)}render(){const e=this.props,t=e.name,n=e.binding,a=this.state.isEditMode,r=Us()("keyboard-shortcut-container__shortcut-key",{"keyboard-shortcut-container__shortcut-key--edit-mode":a});return l.a.createElement("div",{className:"keyboard-shortcut-container"},l.a.createElement("div",{className:"keyboard-shortcut-container__shortcut-name"},t),l.a.createElement("div",{className:r,onClick:this.handleRebindClick,tabIndex:"-1",ref:e=>this.rebindArea=e},a?"...":this.symbolizeKeybinding(n)))}}n(378);var uo=Object(Bs.h)(Object(h.b)(e=>({customKeybindings:e.base.get("customKeybindings")||Object(w.Map)()}),e=>({base:Object(u.b)(a,e)}))(({customKeybindings:e,base:t})=>{const n=(n,a)=>{const r=io(e).filter(([e,t])=>t===a)[0];r?alert('That binding is already in use for "'.concat(r[0],'"')):t.setCustomKeybinding(n,a)};return l.a.createElement("div",{className:"keyboard-shortcuts-editor-container"},io(e).map(([e,t])=>l.a.createElement(ho,{key:e,name:e,binding:t,onBindingChange:n})))})),po=(n(379),n(380),({template:e,index:t,onFieldPathUpdate:n,onAddNewTemplateOrgFileAvailability:a,onRemoveTemplateOrgFileAvailability:r,onAddNewTemplateHeaderPath:s,onRemoveTemplateHeaderPath:i,onDeleteTemplate:c,syncBackendType:d,loadedFilePaths:h})=>{const u=Object(o.useState)(!!e.get("description")),p=Object(g.a)(u,2),m=p[0],f=p[1],b=()=>f(!m),y=t=>a=>n(e.get("id"),[t],a.target.value),E=()=>n(e.get("id"),["isAvailableInAllOrgFiles"],!e.get("isAvailableInAllOrgFiles")),w=()=>n(e.get("id"),["shouldPrepend"],!e.get("shouldPrepend")),T=()=>{a(e.get("id"))},v=t=>()=>r(e.get("id"),t),k=t=>a=>n(e.get("id"),["orgFilesWhereAvailable",t],a.target.value),_=()=>s(e.get("id")),S=t=>()=>i(e.get("id"),t),I=t=>a=>n(e.get("id"),["headerPaths",t],a.target.value),O=()=>{window.confirm('Are you sure you want to delete the "'.concat(e.get("description"),'" template?'))&&c(e.get("id"))},D=Us()("fas fa-2x fa-caret-right capture-template-container__header__caret",{"capture-template-container__header__caret--rotated":!m});return l.a.createElement(Ds.b,{draggableId:"capture-template--".concat(e.get("id")),index:t},(t,n)=>l.a.createElement("div",Object.assign({className:Us()("capture-template-container",{"capture-template-container--dragging":n.isDragging}),ref:t.innerRef},t.draggableProps),l.a.createElement("div",{className:"capture-template-container__header",onClick:b},l.a.createElement("i",{className:D}),l.a.createElement(Si,{iconName:e.get("iconName"),letter:e.get("letter"),onClick:()=>{},style:{marginRight:20}}),l.a.createElement("span",{className:"capture-template-container__header__title"},e.get("description")),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg capture-template-container__header__drag-handle"},t.dragHandleProps))),l.a.createElement(ti.UnmountClosed,{isOpened:!m,springConfig:{stiffness:300}},l.a.createElement("div",{className:"capture-template-container__content"},(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Description:"),l.a.createElement("input",{type:"text",className:"textfield",value:e.get("description",""),onChange:y("description")}))))(e),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Letter:"),l.a.createElement("input",{type:"text",className:"textfield capture-template__letter-textfield",maxLength:"1",value:e.get("letter",""),onChange:y("letter"),autoCapitalize:"none"})),l.a.createElement("div",{className:"capture-template__field__or-container"},l.a.createElement("div",{className:"capture-template__field__or-line"}),l.a.createElement("div",{className:"capture-template__field__or"},"or"),l.a.createElement("div",{className:"capture-template__field__or-line"})),l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Icon name:"),l.a.createElement("input",{type:"text",className:"textfield",value:e.get("iconName"),onChange:y("iconName"),autoCapitalize:"none",autoCorrect:"none"})),l.a.createElement("div",{className:"capture-template__help-text"},"Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or calendar-plus) to use as the capture icon. You can search the available icons"," ",l.a.createElement(Vs,{href:"https://fontawesome.com/icons?d=gallery&s=solid&m=free"},"here"),".")))(e),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Available in all org files?"),l.a.createElement(Mi,{isEnabled:e.get("isAvailableInAllOrgFiles"),onToggle:E})),l.a.createElement("div",{className:"capture-template__help-text"},"You can make this capture template available in all org files, or just the ones you specify.","Dropbox"===d&&l.a.createElement(o.Fragment,null," ","Specify full paths starting from the root of your Dropbox, like"," ",l.a.createElement("code",null,"/org/todo.org")),"Google Drive"===d&&l.a.createElement(o.Fragment,null," ","Specify the file id of each file. You can find the file id in the URL of the file in organice (e.g.,"," ",l.a.createElement("code",null,"/file/","<file id>"),").")),l.a.createElement(ti.UnmountClosed,{isOpened:!e.get("isAvailableInAllOrgFiles"),springConfig:{stiffness:300}},l.a.createElement("div",{className:"multi-textfields-container"},e.get("orgFilesWhereAvailable").map((e,t)=>l.a.createElement("div",{key:"org-file-availability-".concat(t),className:"multi-textfield-container"},l.a.createElement("input",{type:"text",placeholder:"e.g., /org/todo.org",className:"textfield multi-textfield-field",value:e,onChange:k(t)}),l.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:v(t)})))),l.a.createElement("div",{className:"add-new-multi-textfield-button-container"},l.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:T})))))(e),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"File: "),l.a.createElement("select",{onChange:y("file"),style:{width:"90%"}},(0!==h.filter(t=>(t===e.get("file","")).length)?h:[e.get("file"),...h]).map(e=>l.a.createElement("option",{key:e,value:e},e)))),l.a.createElement("div",{className:"capture-template__help-text"},"By default the file opened when capturing is the capture target. Select a specific file if you want this template to always capture to that file. Make sure the file is loaded for it to be selectable here. You might also consider to set the file to load on startup in the file settings so it's always available.")))(e),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},l.a.createElement("div",null,"Header path")),l.a.createElement("div",{className:"capture-template__help-text"},"Specify the path to the header under which the new header should be filed. One header per textfield."),l.a.createElement("div",{className:"multi-textfields-container"},e.get("headerPaths").map((e,t)=>l.a.createElement("div",{key:"header-path-".concat(t),className:"multi-textfield-container"},l.a.createElement("input",{type:"text",placeholder:"e.g., Todos",className:"textfield multi-textfield-field",value:e,onChange:I(t)}),l.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:S(t)})))),l.a.createElement("div",{className:"add-new-multi-textfield-button-container"},l.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:_}))))(e),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field"},l.a.createElement("div",null,"Prepend?"),l.a.createElement(Mi,{isEnabled:e.get("shouldPrepend"),onToggle:w})),l.a.createElement("div",{className:"capture-template__help-text"},"By default, new captured headers are appended to the specified header path. Enable this setting to prepend them instead.")))(e),(e=>l.a.createElement("div",{className:"capture-template__field-container"},l.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},l.a.createElement("div",null,"Template")),l.a.createElement("textarea",{className:"textarea template-textarea",rows:"3",value:e.get("template"),onChange:y("template")}),l.a.createElement("div",{className:"capture-template__help-text"},"The template for creating the capture item. You can use the following template variables that will be expanded upon capture:",l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"%?")," - Place the cursor here."),l.a.createElement("li",null,l.a.createElement("code",null,"%t")," - Timestamp, date only."),l.a.createElement("li",null,l.a.createElement("code",null,"%T")," - Timestamp, with date and time."),l.a.createElement("li",null,l.a.createElement("code",null,"%u")," - Inactive timestamp, date only."),l.a.createElement("li",null,l.a.createElement("code",null,"%U")," - Inactive timestamp, with date and time."),l.a.createElement("li",null,l.a.createElement("code",null,"%","<custom variable>")," - A custom variable from a URL param capture. See"," ",l.a.createElement(Vs,{href:"https://organice.200ok.ch/documentation.html#capture_templates"},"the README file")," ","for more details.")),"You can also use ",l.a.createElement("code",null,"%u")," and ",l.a.createElement("code",null,"%t")," as part of the header path.")))(e),l.a.createElement("div",{className:"capture-template__field-container capture-template__delete-button-container"},l.a.createElement("button",{className:"btn settings-btn capture-template__delete-button",onClick:O},"Delete template"))))))});var go=Object(h.b)(e=>{const t=e.org.present.get("files",Object(w.List)()).keySeq().toJS().filter(e=>!e.startsWith("organice_internal_"));return t.unshift(""),{captureTemplates:e.capture.get("captureTemplates",Object(w.List)()),syncBackendType:e.syncBackend.get("client").type,loadedFilePaths:t}},e=>({capture:Object(u.b)(r,e)}))(({captureTemplates:e,syncBackendType:t,capture:n,loadedFilePaths:a})=>{const r=(e,t,a)=>n.updateTemplateFieldPathValue(e,t,a),s=e=>n.addNewTemplateOrgFileAvailability(e),i=(e,t)=>n.removeTemplateOrgFileAvailability(e,t),c=e=>n.addNewTemplateHeaderPath(e),d=(e,t)=>n.removeTemplateHeaderPath(e,t),h=e=>n.deleteTemplate(e),u=(e,t)=>n.reorderCaptureTemplate(e,t);return l.a.createElement("div",null,l.a.createElement(Ds.c,{droppableId:"capture-templates-editor-droppable",type:"CAPTURE-TEMPLATE"},n=>l.a.createElement("div",Object.assign({className:"capture-templates-container",ref:n.innerRef},n.droppableProps),0===e.size?l.a.createElement("div",{className:"no-capture-templates-message"},"You don't currently have any capture templates - add one by pressing the"," ",l.a.createElement("i",{className:"fas fa-plus"})," button.",l.a.createElement("br",null),l.a.createElement("br",null),"Capture templates show up in the action drawer and give you quick access to creating new headers (like org-capture)."):l.a.createElement(o.Fragment,null,e.map((e,n)=>l.a.createElement(po,{key:e.get("id"),index:n,template:e,syncBackendType:t,loadedFilePaths:a,onFieldPathUpdate:r,onAddNewTemplateOrgFileAvailability:s,onRemoveTemplateOrgFileAvailability:i,onAddNewTemplateHeaderPath:c,onRemoveTemplateHeaderPath:d,onDeleteTemplate:h,onReorder:u})),n.placeholder))),l.a.createElement("div",{className:"new-capture-template-button-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:()=>n.addNewEmptyCaptureTemplate()})))}),mo=(n(381),n(382),({setting:e,index:t,onFieldPathUpdate:n,onDeleteSetting:a,loadedFilepaths:r,path:s})=>{const i=Object(o.useState)(!0),c=Object(g.a)(i,2),d=c[0],h=c[1],u=()=>h(!d),p=t=>a=>n(e.get("id"),[t],a.target.value),m=()=>n(e.get("id"),["loadOnStartup"],!e.get("loadOnStartup")),f=()=>n(e.get("id"),["includeInAgenda"],!e.get("includeInAgenda")),b=()=>n(e.get("id"),["includeInSearch"],!e.get("includeInSearch")),y=()=>n(e.get("id"),["includeInTasklist"],!e.get("includeInTasklist")),E=()=>n(e.get("id"),["includeInRefile"],!e.get("includeInRefile")),w=()=>{window.confirm('Are you sure you want to delete the settings for "'.concat(e.get("path"),'"?'))&&a(e.get("id"))},T=Us()("fas fa-2x fa-caret-right file-setting-container__header__caret",{"file-setting-container__header__caret--rotated":!d});return l.a.createElement(Ds.b,{draggableId:"file-setting--".concat(e.get("path")),index:t},(t,n)=>l.a.createElement("div",Object.assign({className:Us()("file-setting-container",{"file-setting-container--dragging":n.isDragging}),ref:t.innerRef},t.draggableProps),l.a.createElement("div",{className:"file-setting-container__header",onClick:u},l.a.createElement("i",{className:T}),l.a.createElement("div",{className:"file-setting-icons"},l.a.createElement("div",{className:Us()("load-on-startup-icon",{"fas fa-sync-alt fa-lg file-setting-icon":e.get("loadOnStartup")})}),l.a.createElement("div",{className:Us()({"fas fa-calendar-alt fa-lg file-setting-icon":e.get("includeInAgenda")})}),l.a.createElement("div",{className:Us()({"fas fa-search fa-lg file-setting-icon":e.get("includeInSearch")})}),l.a.createElement("div",{className:Us()({"fas fa-tasks fa-lg file-setting-icon":e.get("includeInTasklist")})}),l.a.createElement("div",{className:Us()({"fas fa-file-export fa-lg file-setting-icon":e.get("includeInRefile")})})),l.a.createElement("span",{className:"file_setting-container__header__title"},e.get("path")),l.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg file-setting-container__header__drag-handle"},t.dragHandleProps))),l.a.createElement(ti.UnmountClosed,{isOpened:!d,springConfig:{stiffness:300}},l.a.createElement("div",{className:"file-setting-container__content"},(e=>(""===e.get("path")&&p("path")({target:{value:s||r[0]}}),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Path: "),l.a.createElement("select",{onChange:p("path"),style:{width:"90%"}},[e.get("path"),...r].map(e=>l.a.createElement("option",{key:e,value:e},e)))))))(e),(e=>l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Sync on startup?"),l.a.createElement(Mi,{isEnabled:e.get("loadOnStartup"),onToggle:m})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, files are loaded from localStorage when available and are only synced when visited or when a sync is manually triggered. Enable this setting to always sync this file when opening organice.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Include in Agenda?"),l.a.createElement(Mi,{isEnabled:e.get("includeInAgenda"),onToggle:f})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, only the currently opened file is included in the agenda. Enable this setting to always include this file. The currently viewed file is always included.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Include in Search?"),l.a.createElement(Mi,{isEnabled:e.get("includeInSearch"),onToggle:b})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, only the current viewed file is included in search. Enable this setting to always include this file. The currently loaded file is always included.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Include in Tasklist?"),l.a.createElement(Mi,{isEnabled:e.get("includeInTasklist"),onToggle:y})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, only the current viewed file is included in the tasklist. Enable this setting to always include this file. The currently loaded file is always included.")),l.a.createElement("div",{className:"file-setting__field-container"},l.a.createElement("div",{className:"file-setting__field"},l.a.createElement("div",null,"Include in Refile?"),l.a.createElement(Mi,{isEnabled:e.get("includeInRefile"),onToggle:E})),l.a.createElement("div",{className:"file-setting__help-text"},"By default, only the currently viewed file is available as a refile targets. Enable this setting to always include this file. The currently loaded file is always included."))))(e),l.a.createElement("div",{className:"file-setting__field-container file-setting__delete-button-container"},l.a.createElement("button",{className:"btn settings-btn file-setting__delete-button",onClick:w},"Delete setting"))))))});var fo=Object(h.b)(e=>{const t=e.base.get("lastViewedPath"),n=e.org.present.get("fileSettings",Object(w.List)()),a=n.map(e=>e.get("path")),r=e.org.present.get("files",Object(w.List)()).keySeq(),s=a.find(e=>e===t)?null:t;return{fileSettings:n,loadedFilepaths:r.filter(e=>!e.startsWith("organice_internal_")).filter(e=>!a.find(t=>t===e)).toJS(),currentPathIfWithoutFileSetting:s}},e=>({org:Object(u.b)(s,e)}))(({fileSettings:e,loadedFilepaths:t,currentPathIfWithoutFileSetting:n,org:a})=>{const r=(e,t,n)=>a.updateFileSettingFieldPathValue(e,t,n),s=e=>a.deleteFileSetting(e),i=(e,t)=>a.reorderFileSetting(e,t);return l.a.createElement("div",null,l.a.createElement(Ds.c,{droppableId:"file-setting-editor-droppable",type:"FILE-SETTING"},a=>l.a.createElement("div",Object.assign({className:"file-setting-container",ref:a.innerRef},a.droppableProps),0===e.size?l.a.createElement("div",{className:"no-file-setting-message"},"You don't currently have any file settings - add one by pressing the"," ",l.a.createElement("i",{className:"fas fa-plus"})," button.",l.a.createElement("br",null),l.a.createElement("br",null),"File settings allow you to configure how specific files are handeled when multiple files are loaded. Make sure a file is loaded to create a setting entry."):l.a.createElement(o.Fragment,null,e.map((e,a)=>l.a.createElement(mo,{key:e.get("id"),index:a,setting:e,path:n,loadedFilepaths:t,onFieldPathUpdate:r,onDeleteSetting:s,onReorder:i})),a.placeholder))),0!==t.length&&l.a.createElement("div",{className:"new-capture-template-button-container"},l.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:()=>a.addNewEmptyFileSetting()})))}),bo=(n(383),n(173)),yo=n.n(bo),Eo=n(174),wo=n.n(Eo);function To(){const e=Object(o.useState)(!1),t=Object(g.a)(e,2),n=t[0],a=t[1],r=Object(o.useState)(""),s=Object(g.a)(r,2),i=s[0],c=s[1],d=Object(o.useState)(""),h=Object(g.a)(d,2),u=h[0],p=h[1],m=Object(o.useState)(""),f=Object(g.a)(m,2),b=f[0],y=f[1];return n?l.a.createElement("div",{id:"webdavLogin"},l.a.createElement("h2",null,"WebDAV"),l.a.createElement("form",{onSubmit:e=>{e.preventDefault(),Ft("authenticatedSyncService","WebDAV"),Ft("webdavEndpoint",i),Ft("webdavUsername",u),Ft("webdavPassword",b),window.location=window.location.origin+"/"}},l.a.createElement("p",null,l.a.createElement("label",null,"URL:"),l.a.createElement("input",{name:"url",type:"url",value:i,className:"textfield",onChange:e=>{c(e.target.value)}})),l.a.createElement("p",null,l.a.createElement("label",null,"Username:"),l.a.createElement("input",{type:"text",className:"textfield",value:u,onChange:e=>{p(e.target.value)}})),l.a.createElement("p",null,l.a.createElement("label",null,"Password:"),l.a.createElement("input",{type:"password",className:"textfield",value:b,onChange:e=>{y(e.target.value)}})),l.a.createElement("input",{type:"submit",value:"Sign-in"}))):l.a.createElement("div",{id:"webdavLogin",onClick:()=>{a(!0)}},l.a.createElement("h2",null,"WebDAV"))}function vo(){const e=Object(o.useState)(!1),t=Object(g.a)(e,2),n=t[0],a=t[1];return n?l.a.createElement("div",{id:"googleDriveNote"},l.a.createElement("h2",null,"News regarding use of Google drive"),"We are waiting for Google to put"," ",l.a.createElement("a",{href:"https://github.com/200ok-ch/organice/issues/127"},"Google Drive for this instance into production mode"),". Until that has happend, only 100 users can use this instance of organice. If you cannot log in here, but want to use Google Drive,"," ",l.a.createElement("a",{href:"https://organice.200ok.ch/documentation.html#google_drive"},"here are the instructions")," ","on running your own instance of organice with Google Drive enabled.",l.a.createElement("p",null,"If you don't want to do that, you are welcome to use Dropbox or WebDAV as synchronisation back-ends.")):l.a.createElement("div",{id:"googleDriveNote",onClick:()=>{a(!0)}},l.a.createElement("h4",null,"Click to read news regarding use of Google drive"))}class ko extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["handleDropboxClick","handleGoogleDriveClick"])}handleDropboxClick(){Ft("authenticatedSyncService","Dropbox");new Ms.Dropbox({clientId:"fj1bxjp9nkh15l5",fetch:fetch.bind(window)}).auth.getAuthenticationUrl(window.location.origin+"/").then(e=>{window.location=e})}handleGoogleDriveClick(){try{gapi.load("client:auth2",()=>{gapi.client.init({apiKey:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DROPBOX_CLIENT_ID:"fj1bxjp9nkh15l5"}).REACT_APP_GOOGLE_DRIVE_API_KEY,clientId:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DROPBOX_CLIENT_ID:"fj1bxjp9nkh15l5"}).REACT_APP_GOOGLE_DRIVE_CLIENT_ID,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:"https://www.googleapis.com/auth/drive"}).then(()=>{Ft("authenticatedSyncService","Google Drive"),gapi.auth2.getAuthInstance().signIn({ux_mode:"redirect",redirect_uri:window.location.origin})})})}catch(e){return void alert("The Google Drive API client isn't available - you might be blocking it with an ad blocker")}}render(){return l.a.createElement("div",{className:"sync-service-sign-in-container"},l.a.createElement("p",{className:"sync-service-sign-in__help-text"},"organice syncs your files with Dropbox, Google Drive and WebDAV."),l.a.createElement("p",{className:"sync-service-sign-in__help-text"},"Click to sign in with:"),l.a.createElement("div",{className:"sync-service-container",onClick:this.handleDropboxClick},l.a.createElement("img",{src:yo.a,alt:"Dropbox logo",className:"dropbox-logo"})),l.a.createElement("div",{className:"sync-service-container"},l.a.createElement("img",{src:wo.a,onClick:this.handleGoogleDriveClick,alt:"Google Drive logo",className:"google-drive-logo"}),l.a.createElement(vo,null)),l.a.createElement("div",{className:"sync-service-container"},l.a.createElement(To,null)))}}class _o extends o.PureComponent{constructor(e){super(e),E.a.bindAll(this,["renderChangelogFile","renderSampleFile","renderFileBrowser","renderFile","setChangelogUnseenChanges"])}componentDidMount(){this.setChangelogUnseenChanges(),this.props.filesToLoad.forEach(e=>this.props.syncBackend.downloadFile(e)),this.props.filesToSync.forEach(e=>this.props.org.sync({path:e}))}setChangelogUnseenChanges(){const e=this.props,t=e.lastSeenChangelogHash,n=e.isAuthenticated;Q().then(e=>{const a=n&&t&&!E.a.isEqual(e,t);this.props.base.setHasUnseenChangelog(a)})}componentDidUpdate(){this.shouldPromptWhenLeaving()?window.onbeforeunload=()=>!0:window.onbeforeunload=void 0}componentWillUnmount(){window.onbeforeunload=void 0}renderChangelogFile(){return l.a.createElement(lo,{staticFile:"changelog",shouldDisableDirtyIndicator:!0,shouldDisableActions:!0,shouldDisableSyncButtons:!1,parsingErrorMessage:"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}renderSampleFile(){return l.a.createElement(lo,{staticFile:"sample",shouldDisableDirtyIndicator:!0,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!0,parsingErrorMessage:"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}renderFileBrowser({match:{params:{path:e=""}}}){return e&&(e="/"+e),l.a.createElement(Xs,{path:e})}renderFile({match:{params:{path:e}}}){return e&&(e="/"+e),this.props.path&&!this.props.path.startsWith("organice_internal_")&&this.props.path!==e?(this.props.org.sync({path:this.props.path}),l.a.createElement(Bs.a,{push:!0,to:"/file"+this.props.path})):l.a.createElement(lo,{path:e,shouldDisableDirtyIndicator:!1,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!1})}shouldPromptWhenLeaving(){return this.props.hasDirtyFiles}render(){const e=this.props,t=e.isAuthenticated,n=e.loadingMessage,a=e.fontSize,r=e.activeModalPage,s=e.pendingCapture,i=e.location.pathname,c=e.colorScheme;((e="Solarized",t="Light")=>{const n=document.documentElement.style;Object.entries(li[e][t]).forEach(([e,t])=>n.setProperty(e,t)),document.querySelector('meta[name="theme-color"]').setAttribute("content",li[e]["--base3"])})(e.theme,c);const d=!!s&&"/file".concat(s.get("capturePath")),h=d&&d!==i,u=Us()("entry-container",{"entry-container--large-font":"Large"===a});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Js,null),l.a.createElement("div",{className:u},l.a.createElement(Zs,{message:n}),"changelog"===r?this.renderChangelogFile():t?["keyboard_shortcuts_editor","settings","capture_templates_editor","file_settings_editor","sample"].includes(r)?l.a.createElement(o.Fragment,null,"keyboard_shortcuts_editor"===r&&l.a.createElement(uo,null),"capture_templates_editor"===r&&l.a.createElement(go,null),"file_settings_editor"===r&&l.a.createElement(fo,null),"sample"===r&&this.renderSampleFile()):l.a.createElement(Bs.d,null,h&&l.a.createElement(Bs.a,{to:d}),l.a.createElement(Bs.b,{path:"/privacy-policy",exact:!0,component:Gs}),l.a.createElement(Bs.b,{path:"/file/:path+",render:this.renderFile}),l.a.createElement(Bs.b,{path:"/files/:path*",render:this.renderFileBrowser}),l.a.createElement(Bs.b,{path:"/sample",exact:!0,render:this.renderSampleFile}),l.a.createElement(Bs.b,{path:"/settings",exact:!0},l.a.createElement(co,null)),l.a.createElement(Bs.a,{to:"/files"})):l.a.createElement(Bs.d,null,l.a.createElement(Bs.b,{path:"/privacy-policy",exact:!0,component:Gs}),l.a.createElement(Bs.b,{path:"/sample",exact:!0,render:this.renderSampleFile}),l.a.createElement(Bs.b,{path:"/sign_in",exact:!0,component:ko}),l.a.createElement(Bs.b,{path:"/",exact:!0,component:qs}),l.a.createElement(Bs.a,{to:"/"}))))}}var So=Object(Bs.h)(Object(h.b)(e=>{const t=e.org.present.get("files"),n=e.org.present.get("path"),a=e.org.present.get("fileSettings").filter(e=>e.get("loadOnStartup")).map(e=>e.get("path")),r=w.Set.fromKeys(t),s=e=>r.includes(e),i=a.filter(e=>!s(e)),o=a.filter(e=>s(e)),l=!!t.find(e=>e.get("isDirty"));return{path:n,filesToLoad:i,filesToSync:o,loadingMessage:e.base.get("loadingMessage"),isAuthenticated:e.syncBackend.get("isAuthenticated"),fontSize:e.base.get("fontSize"),lastSeenChangelogHash:e.base.get("lastSeenChangelogHash"),activeModalPage:e.base.get("modalPageStack",Object(w.List)()).last(),pendingCapture:e.org.present.get("pendingCapture"),hasDirtyFiles:l,colorScheme:e.base.get("colorScheme"),theme:e.base.get("theme")}},e=>({syncBackend:Object(u.b)(i,e),org:Object(u.b)(s,e),base:Object(u.b)(a,e)}))(_o));const Io=Object(y.debounce)(e=>{if(e.getState().syncBackend.get("client")&&e.getState().base.get("shouldSyncOnBecomingVisibile")){const t=e.getState().org.present.get("path");let n=e.getState().org.present.get("fileSettings").filter(e=>e.get("loadOnStartup")).map(e=>e.get("path"));!t||t.startsWith("organice_internal_")||n.find(e=>t===e)||(n=n.push(t)),n.forEach(t=>{ir({path:t,shouldSuppressMessages:!0})(e.dispatch,e.getState)})}},1e3);function Oo(e){let t=function(){const e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(let t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}();if(t){const n=t.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(n,()=>Io(e))}}class Do extends o.PureComponent{constructor(e){super(e),Ss();const t=Mt();window.initialHash=window.location.hash.substring(0);const n=Is(window.location.hash),a=Ht("authenticatedSyncService",!0);let r=null;if(a)switch(a){case"Dropbox":const e=n.access_token;if(e)r=Fs(e),t.syncBackend=Object(w.Map)({isAuthenticated:!0,client:r}),Ft("dropboxAccessToken",e),window.location.hash="";else{const e=Ht("dropboxAccessToken",!0);e&&(r=Fs(e),t.syncBackend=Object(w.Map)({isAuthenticated:!0,client:r}))}break;case"Google Drive":r=Hs(),t.syncBackend=Object(w.Map)({isAuthenticated:!0,client:r});break;case"WebDAV":r=((e,t,n)=>{const a=Object(js.createClient)(e,{username:t,password:n}),r=e=>{const t=(e=>e.filter(e=>"directory"===e.type||e.basename.match(/org$|org_archive$/)).sort((e,t)=>"directory"===e.type&&"directory"!==t.type?-1:e.basename>t.basename?1:-1))(e);return Object(w.fromJS)(t.map(e=>({id:e.filename,name:e.basename,isDirectory:"directory"===e.type,path:e.filename})))},s=e=>new Promise((t,n)=>{a.getDirectoryContents(e).then(e=>t({listing:r(e)})).catch(n)}),i=(e,t)=>new Promise((n,r)=>a.putFileContents(e,t,{overwrite:!0}).then(n).catch(r)),o=n=>new Promise((r,s)=>a.stat(n).then(e=>{a.getFileContents(n,{format:"text"}).then(t=>{r({contents:t,lastModifiedAt:new Date(Date.parse(e.lastmod)).toISOString()})}).catch(e=>{console.error(n,": get file failed",e),s()})}).catch(a=>{a&&a.response&&-1!==[401,403].indexOf(a.response.status)&&alert(t+"@"+e+": "+a.response.statusText),console.error(n,": get stat failed",a),s()}));return{type:"WebDAV",isSignedIn:()=>new Promise(e=>{s("/").then(()=>{e(!0)}).catch(t=>{console.error("Login didn't work, error: ",JSON.stringify(t)),e(!1)})}),getDirectoryListing:s,getMoreDirectoryListing:e=>new Promise((e,t)=>e()),updateFile:i,createFile:i,getFileContentsAndMetadata:o,getFileContents:e=>Object(y.isEmpty)(e)?Promise.reject("No path given"):new Promise((t,n)=>o(e).then(({contents:e})=>t(e)).catch(n)),deleteFile:e=>new Promise((t,n)=>a.deleteFile(e).then(t).catch(t=>{t&&t.response&&404===t.response.status||(console.error(e,": delete failed",t),n())}))}})(Ht("webdavEndpoint"),Ht("webdavUsername"),Ht("webdavPassword")),t.syncBackend=Object(w.Map)({isAuthenticated:!0,client:r})}const s=Is(window.location.search),i=s.captureFile,o=s.captureTemplateName,l=s.captureContent;if(i&&o){const e=i.startsWith("/")?i:"/".concat(i),n=Object(w.Map)(Object.entries(s).map(([e,t])=>e.startsWith("captureVariable_")?[e.substring("captureVariable_".length),t]:null).filter(e=>!!e));t.org.present=t.org.present.set("pendingCapture",Object(w.Map)({capturePath:e,captureTemplateName:o,captureContent:l,customCaptureVariables:n}))}var c;this.store=(e=>Object(u.e)(ks,e,_s(Object(u.a)(p.a,ys,Es))))(t),this.store.subscribe((c=this.store,At?()=>{const e=c.getState(),t=Lt(e,Pt);if(t.forEach(([e,t])=>{e&&t&&localStorage.setItem(e,t)}),e.base.get("shouldStoreSettingsInSyncBackend")){const n=xt(t);window.previousSettingsFileContents!==n&&Nt(e.syncBackend.get("client"),n),window.previousSettingsFileContents=n}const n=e.org.present.get("path"),a=e.org.present.getIn(["files",n,"headers"]);if(n&&a){const e=pe(a);let t={};const r=localStorage.getItem("headerOpenness");r&&(t=JSON.parse(r)),t[n]=e,localStorage.setItem("headerOpenness",JSON.stringify(t))}}:()=>{})),r?r.isSignedIn().then(e=>{e?((e,t)=>{const n=t().syncBackend.get("client");if(!n)return;let a=null;switch(n.type){case"Dropbox":case"WebDAV":a=n.getFileContents("/.organice-config.json");break;case"Google Drive":a=n.getFileContentsByNameAndParent(".organice-config.json","root")}a.then(t=>{try{const n=JSON.parse(t);e(dt(n)),e(Dt(n)),e(bs(n))}catch(n){}}).catch(()=>{})})(this.store.dispatch,this.store.getState):this.store.dispatch(Cs())}):this.store.getState().org.present.get("pendingCapture")&&this.store.dispatch(Ue("You need to sign in before you can use capture templates",5e3)),this.store.dispatch(Ge("sample")),function(e){const t=e.getState().org.present.get("path"),n=window.location.href.match(/.*file(\/.*)/);let a=t;n&&(a=n[1]),window.onpopstate=function(){t!==a&&e.dispatch(hr(t))}}(this.store),Oo(this.store),function(e){e.dispatch(We(navigator.onLine)),window.onoffline=function(){e.dispatch(We(!1))},window.ononline=function(){e.dispatch(We(!0)),setTimeout(()=>{ir({shouldSuppressMessages:!0,forceAction:"manual"})(e.dispatch,e.getState)},2e3)}}(this.store),E.a.bindAll(this,["handleDragEnd"])}handleDragEnd(e){e.destination&&("TAG"===e.type?this.store.dispatch(Qr(e.source.index,e.destination.index)):"PROPERTY-LIST"===e.type?this.store.dispatch(es(e.source.index,e.destination.index)):"CAPTURE-TEMPLATE"===e.type?this.store.dispatch(Ct(e.source.index,e.destination.index)):"FILE-SETTING"===e.type&&this.store.dispatch(gs(e.source.index,e.destination.index)))}render(){return l.a.createElement(Ds.a,{onDragEnd:this.handleDragEnd},l.a.createElement(Os.a,null,l.a.createElement(h.a,{store:this.store},l.a.createElement("div",{className:"App"},l.a.createElement(So,null)))))}}const Co=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ao(e){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(e=>{console.error("Error during service worker registration:",e)})}d.a.render(l.a.createElement(Do,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",()=>{const e="".concat("","/service-worker.js");Co?(!function(e){fetch(e).then(t=>{404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):Ao(e)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Ao(e)})}}()},77:function(e,t,n){e.exports=n.p+"static/media/organice.11553f69.svg"}},[[176,1,2]]]);
//# sourceMappingURL=main.002dafd9.chunk.js.map