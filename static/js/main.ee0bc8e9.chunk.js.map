{"version":3,"sources":["lib/headline_filter_parser.js","lib/id_generator.js","lib/timestamps.js","lib/export_org.js","lib/capture_template_substitution.js","lib/org_utils.js","actions/base.js","lib/sample_capture_templates.js","actions/capture.js","util/settings_persister.js","lib/headline_filter.js","lib/clocking.js","lib/parse_org.js","reducers/org.js","util/misc.js","util/file_persister.js","actions/org.js","middleware/live_sync.js","middleware/toggle_color_scheme.js","reducers/base.js","reducers/sync_backend.js","reducers/capture.js","reducers/index.js","store.js","migrations/index.js","migrations/migrate_access_token_to_dropbox_access_token.js","migrations/migrate_store_in_dropbox_to_store_in_sync_backend.js","migrations/migrate_nonsense_values_in_localstorage.js","util/parse_query_string.js","actions/sync_backend.js","sync_backend_clients/dropbox_sync_backend_client.js","sync_backend_clients/google_drive_sync_backend_client.js","components/UI/ExternalLink/index.js","components/PrivacyPolicy/index.js","images/organice.svg","components/HeaderBar/index.js","components/Landing/index.js","components/FileBrowser/index.js","components/LoadingIndicator/index.js","components/OrgFile/components/AttributedString/components/TablePart/TableActionDrawer/index.js","components/OrgFile/components/AttributedString/components/TablePart/index.js","lib/color.js","components/UI/Checkbox/index.js","components/OrgFile/components/AttributedString/components/ListPart/index.js","components/OrgFile/components/AttributedString/components/TimestampPart/index.js","components/OrgFile/components/AttributedString/index.js","components/OrgFile/components/TitleLine/index.js","components/OrgFile/components/HeaderContent/components/PlanningItems/index.js","components/OrgFile/components/HeaderContent/components/PropertyListItems/index.js","components/OrgFile/components/HeaderContent/components/LogBookEntries/index.js","components/OrgFile/components/HeaderContent/index.js","components/OrgFile/components/Header/components/HeaderActionDrawer/index.js","components/OrgFile/components/Header/index.js","components/OrgFile/components/HeaderList/index.js","components/OrgFile/components/ActionDrawer/components/ActionButton/index.js","components/OrgFile/components/ActionDrawer/index.js","lib/browser_utils.js","components/UI/Switch/index.js","components/UI/Drawer/index.js","components/OrgFile/components/CaptureModal/index.js","components/OrgFile/components/SyncConfirmationModal/index.js","components/OrgFile/components/TagsEditorModal/index.js","components/UI/TabButtons/index.js","components/OrgFile/components/TimestampEditorModal/components/TimestampEditor/index.js","components/OrgFile/components/TimestampEditorModal/index.js","components/OrgFile/components/PropertyListEditorModal/index.js","components/OrgFile/components/AgendaModal/components/AgendaDay/index.js","components/OrgFile/components/AgendaModal/index.js","components/OrgFile/components/TaskListModal/components/TaskListView/index.js","components/OrgFile/components/TaskListModal/index.js","components/OrgFile/components/SearchModal/components/HeaderListView/index.js","components/OrgFile/components/SearchModal/index.js","lib/keybindings.js","components/OrgFile/index.js","components/Settings/index.js","components/KeyboardShortcutsEditor/components/ShortcutRow/index.js","components/KeyboardShortcutsEditor/index.js","components/CaptureTemplatesEditor/components/CaptureTemplate/index.js","components/CaptureTemplatesEditor/index.js","components/FileSettingsEditor/components/FileSetting/index.js","components/FileSettingsEditor/index.js","components/SyncServiceSignIn/dropbox.svg","components/SyncServiceSignIn/google_drive.png","components/SyncServiceSignIn/index.js","components/Entry/index.js","lib/initial_setup.js","App.js","sync_backend_clients/webdav_sync_backend_client.js","registerServiceWorker.js","index.js"],"names":["peg$SyntaxError","message","expected","found","location","this","name","Error","captureStackTrace","child","parent","ctor","constructor","prototype","peg$subclass","buildMessage","DESCRIBE_EXPECTATION_FNS","literal","expectation","literalEscape","text","i","escapedParts","parts","length","Array","classEscape","inverted","any","end","other","description","hex","ch","charCodeAt","toString","toUpperCase","s","replace","j","descriptions","type","sort","slice","join","describeExpected","describeFound","module","exports","SyntaxError","parse","input","options","peg$result","peg$FAILED","peg$startRuleFunctions","Expression","peg$parseExpression","peg$startRuleFunction","peg$c0","peg$otherExpectation","peg$c4","peg$c6","peg$literalExpectation","peg$c9","peg$c11","peg$c12","peg$c13","peg$c15","peg$c17","peg$c18","peg$c19","peg$c21","peg$c22","peg$c24","peg$c25","peg$c26","peg$c27","peg$c29","peg$c30","peg$c31","peg$c32","peg$c34","peg$c35","peg$c36","peg$c42","peg$c43","peg$c44","peg$c46","peg$c48","peg$c49","peg$classExpectation","peg$c53","peg$c54","peg$c56","peg$c57","peg$c58","peg$c60","peg$c61","peg$c62","peg$c64","peg$c65","peg$c66","peg$c67","head","tail","reduce","result","element","push","peg$c68","peg$c69","peg$c70","peg$c71","peg$c72","peg$c74","peg$c75","peg$c76","peg$c77","a","peg$c79","peg$c80","peg$c81","peg$c82","peg$c83","peg$c84","peg$c85","peg$c86","peg$c87","peg$c88","peg$c89","peg$c90","peg$currPos","peg$savedPos","peg$posDetailsCache","line","column","peg$maxFailPos","peg$maxFailExpected","peg$silentFails","startRule","substring","peg$computeLocation","ignoreCase","peg$computePosDetails","pos","p","details","startPos","endPos","startPosDetails","endPosDetails","start","offset","peg$fail","peg$buildStructuredError","s0","s1","s2","s3","s4","s5","s6","peg$parse_","peg$parseLocationAnnotedTerm","peg$parsePlainTerm","field","exclude","peg$c7","peg$parseTerm","endOffset","substr","peg$parseTimeRange","timerange","peg$c23","peg$c28","peg$c33","peg$parseTermField","peg$parseStringAlternatives","match","words","peg$c10","peg$parseTermText","test","charAt","peg$parsePropertyName","property","b","peg$parseTermProp","peg$parseTagName","peg$parseTagAlternatives","peg$parseTermTag","peg$parseMoment","from","to","peg$c38","point","peg$c39","peg$c40","value","parseInt","unit","peg$parseTimeOffset","peg$parseYear","peg$parseMonth","peg$parseDay","checkDate","year","month","checkMonth","peg$c51","day","peg$c52","peg$parseTimestamp","peg$parseTimeUnit","peg$parseString","date","Date","isNaN","valueOf","nextId","renderAsText","timestamp","toJS","isActive","dayName","startHour","startMinute","endHour","endMinute","repeaterType","repeaterValue","repeaterUnit","repeaterDeadlineValue","repeaterDeadlineUnit","delayType","delayValue","delayUnit","timestampText","timestampForDate","time","withStartTime","format","getCurrentTimestampAsText","getTimestampAsText","bracketPair","formatString","dateForTimestamp","timestampString","padStart","addTimestampUnitToDate","numUnits","timestampUnit","addHours","addDays","addWeeks","addMonths","addYears","subtractTimestampUnitFromDate","subHours","subDays","subWeeks","subMonths","subYears","timestampDuration","startTimestamp","endTimestamp","map","dateDuration","pad","minDiff","differenceInMinutes","hours","Math","floor","minutes","minutesText","millisDuration","millis","undefined","formattedAttributedStringText","part","get","getIn","attributedStringToRawText","prevPartTypes","unshift","zip","linkPart","prevPartType","tablePart","rowHeights","row","max","cell","_","countBy","numColumns","size","columnWidths","times","columnIndex","content","lineLengths","split","trim","dropRight","flatten","rowIndex","rowHeight","contentRows","lineIndex","formattedLineLengths","padCount","repeat","contentRow","separator","columnWidth","concat","tablePartToRawText","listPart","bulletCharacter","previousNumber","item","optionalLeadingSpace","titleText","contentText","indentedContentText","listItemText","number","forceNumber","stateCharacter","checked","unchecked","partial","listPartToRawText","timestampPartToRawText","console","error","includes","generateTitleLine","header","includeStars","titleLine","nestingLevel","todoKeyword","rawTitle","tags","tagsString","filter","x","n","exportOrg","headers","linesBeforeHeadings","dontIndent","createRawDescriptionText","includeTitle","immutableHeader","indentation","contents","planningItemsToRender","isRegularPlanningItem","planningItemsContent","planningItem","fromJS","trimRight","propertyListItems","propertyListItemsContent","propertyListItem","logNotes","logBookEntries","logBookEntriesContent","entry","raw","fixedRawDescription","rawDescription","templateString","customVariables","Map","substitutions","entrySeq","forEach","key","substitutedString","entries","RegExp","cursorIndex","indexOf","STATIC_FILE_PREFIX","changelogHash","Promise","resolve","reject","list","c","crypto","subtle","digest","Uint8Array","then","hashArray","values","warn","hash","indexAndHeaderWithId","headerId","headerIndex","indexOfHeaderWithId","findIndex","headerWithId","subheaderIndexRangeForHeaderIndex","nextSiblingHeaderIndex","siblingHeader","subheaderIndexRangeForHeaderId","subheadersOfHeaderWithIndex","begin","subheadersOfHeaderWithId","numSubheadersOfHeaderWithId","directParentOfHeaderWithId","previousHeader","parentIdOfHeaderWithId","parentHeader","findLast","inheritedValueOfProperty","headerProp","find","parentId","isHeaderVisible","parentHeaderId","openDirectParent","state","directParentIdOfHeaderWithId","parentHeaderIndex","setIn","getOpenHeaderPaths","openedHeaders","title","subheaders","openSubheaderPaths","openedSubheaderPath","headerWithPath","headerPath","firstHeader","substituteTemplateVariables","first","rest","openHeaderWithPath","maxNestingLevel","firstTitle","update","set","take","takeLast","tablePartContainsCellId","cellId","some","doesAttributedStringContainTableCellId","headerThatContainsTableCellId","pathAndPartOfTimestampItemWithIdInAttributedString","timestampId","partIndex","path","timestampPart","itemIndex","pathAndPart","cellIndex","pathAndPartOfListItemWithIdInAttributedString","listItemId","listItemPart","pathAndPartOfTableContainingCellIdInAttributedString","pathAndPartOfTimestampItemWithIdInHeaders","makeResult","localPath","propertyListItemIndex","plistPathAndPart","pathAndPartOfTableContainingCellIdInHeaders","updateTableContainingCellId","updaterCallbackGenerator","rowIndexContainingCellId","columnIndexContainingCellId","updateIn","timestampWithIdInAttributedString","customFormatDistanceToNow","datetime","formatDistanceToNow","addSuffix","todoKeywordSetForKeyword","todoKeywordSets","keyword","keywordSet","contains","extractAllOrgTags","flatMap","h","toSet","extractAllOrgProperties","prop","valParts","isEmpty","computeAllPropertyNames","allOrgProperties","computeAllPropertyValuesFor","propertyName","toLowerCase","hasHeaderContent","createIsTodoKeywordInDoneState","startsWith","getPlanningItemTypeText","orgFileExtensions","addBreadcrumbs","breadcrumbs","getBreadcrumbs","setLoadingMessage","loadingMessage","hideLoadingMessage","setIsLoading","isLoading","setIsOnline","online","setDisappearingLoadingMessage","delay","dispatch","setTimeout","setLastViewedFile","lastViewedPath","restoreStaticFile","staticFile","lastViewedFilePath","parseFile","changelog","sample","unloadStaticFile","getState","resetFileDisplay","base","setPath","setFontSize","newFontSize","setBulletStyle","newBulletStyle","setShouldTapTodoToAdvance","newShouldTapTodoToAdvance","setAgendaDefaultDeadlineDelayUnit","newAgendaDefaultDeadlineDelayUnit","setAgendaDefaultDeadlineDelayValue","newAgendaDefaultDeadlineDelayValue","setAgendaStartOnWeekday","newAgendaStartOnWeekday","setShouldLiveSync","shouldLiveSync","setShouldSyncOnBecomingVisibile","shouldSyncOnBecomingVisibile","setShouldShowTitleInOrgFile","shouldShowTitleInOrgFile","setShouldLogIntoDrawer","shouldLogIntoDrawer","setCloseSubheadersRecursively","closeSubheadersRecursively","setShouldNotIndentOnExport","shouldNotIndentOnExport","setShouldStoreSettingsInSyncBackend","newShouldStoreSettingsInSyncBackend","client","syncBackend","deleteFile","catch","doesFileNotExist","alert","deleteFileByNameAndParent","window","previousSettingsFileContents","setColorScheme","colorScheme","setTheme","theme","setHasUnseenChangelog","newHasUnseenChangelog","setLastSeenChangelogHeader","newLastSeenChangelogHash","setCustomKeybinding","keybindingName","keybinding","restoreBaseSettings","newSettings","pushModalPage","modalPage","popModalPage","clearModalStack","activatePopup","popupType","data","closePopup","setAgendaTimeframe","agendaTimeframe","headerPaths","iconName","id","generateId","isAvailableInAllOrgFiles","letter","orgFilesWhereAvailable","shouldPrepend","template","isSample","addNewEmptyCaptureTemplate","updateTemplateFieldPathValue","templateId","fieldPath","newValue","addNewTemplateOrgFileAvailability","removeTemplateOrgFileAvailability","orgFileAvailabilityIndex","addNewTemplateHeaderPath","removeTemplateHeaderPath","headerPathIndex","deleteTemplate","restoreCaptureSettings","reorderCaptureTemplate","fromIndex","toIndex","localStorageAvailable","localStorage","setItem","localStorageRes","getItem","removeItem","e","debouncedPushConfigToSyncBackend","debounce","syncBackendClient","createFile","maxWait","persistableFields","category","default","List","readOpennessState","opennessStateJSONString","JSON","getFieldsToPersist","fields","depreacted","stringify","org","present","getConfigFileContents","fieldsToPersist","fromPairs","readInitialState","initialState","past","files","fileSettings","opennessState","search","searchFilter","searchFilterExpr","future","Set","capture","getInitialStateWithDefaultValues","templates","settings","setting","loadFilesFromLocalStorage","loadContentFromLocalStorage","subscribeToChanges","store","settingsFileContents","currentFilePath","openHeaderPaths","persistField","getPersistedField","nullable","fromUnit","d","startOfHour","startOfDay","startOfWeek","startOfMonth","startOfYear","toUnit","endOfHour","endOfDay","endOfWeek","endOfMonth","endOfYear","resolveFrom","temp","setFullYear","setMonth","setDate","startOfDate","fromSpecial","resolveTo","endOfDate","toSpecial","isRelative","moment","timeFilter","filterDescription","lower","upper","timeFilterDescription","orChain","source","xs","orChainDate","dates","computeCompletionsForDatalist","todoKeywords","tagNames","allProperties","filterExpr","filterString","curserPosition","completions","tagAndPropNames","logicalCursorPosition","computeLogicalPosition","charBeforeCursor","charTwoBeforeCursor","SPACE_SURROUNDED","textBeforeCursor","filteredTodoKeywords","indexOfOtherColon","lastIndexOf","maybePropertyName","maybeTagName","computeCompletions","tup","y","elem","next","totalFilteredTimeLogged","filters","l","ts","t","every","f","acc","val","updateHeadersTotalTimeLoggedRecursive","headersWithtotalTimeLogged","totalTimeLogged","index","totalTimeLoggedRecursive","timestampOptionalRepeaterOrDelayRegexp","timestampRegex","re","markupAndCookieRegex","timestampFromRegexMatch","partIndices","typeBracket","timeStart","timeEnd","firstDelayRepeatType","firstDelayRepeatValue","firstDelayRepeatUnit","firstRepeaterDeadlineValue","firstRepeaterDeadlineUnit","secondDelayRepeatType","secondDelayRepeatValue","secondDelayRepeatUnit","secondRepeaterDeadlineValue","secondRepeaterDeadlineUnit","parseMarkupAndCookies","rawText","shouldAppendNewline","matches","exec","uri","percentCookieMatch","percentage","fractionCookieMatch","fraction","markupType","markupPrefixLength","firstTimestamp","range","secondTimestamp","lineParts","startIndex","computeParseResults","trailingText","parseTable","tableLines","table","columnProperties","lastRow","last","lineCells","cellContents","rawContents","excludeCookies","maxNumColumns","parseRawText","excludeContentElements","lines","LIST_HEADER_REGEX","currentListHeaderNestingLevel","rawLineParts","numLeadingSpaces","processedLineParts","linePart","takeWhile","contentLines","isOrdered","checkboxState","isCheckbox","X","newListItem","lastIndex","items","numberTerminatorCharacter","createOrUpdateTimestamp","parseDescriptionPrefixElements","planningItemsParse","optionalSinglePlanningItemRegex","asStrNoSlashs","planningRegex","concatRegexes","planningMatch","planningItems","planningTypeIndex","strippedDescription","_parsePlanningItems","propertyListParse","propertiesLineIndex","endLineIndex","parsePropertyList","logbookLineIndex","makeLogNotesResult","_parseLogNotes","logBookParse","logBookEntryStartRegex","logBookEntryFullRegex","lineFullMatch","lineStartMatch","trimLeft","parseLogbook","_updateHeaderFromDescription","rawUnstrippedDescription","parsedDescription","parsedTitle","mergedPlanningItems","mergePlanningItems","extractActiveTimestampsForPlanningItemsFromParse","defaultKeywordSets","keywords","completedKeywords","parseTitleLine","todoKeywordSet","endsWith","titleParts","possibleTags","tag","newHeaderWithTitle","opened","regexes","prev","curr","regex","parseFileConfig","fileConfigLines","newKeywordSet","lineIsTodoKeywordConfig","keywordTokens","pipeIndex","configLine","parseTodoKeywordConfig","parsedData","updatePlanningItems","parsed","merge","updatePlanningItemsFromHeader","computeNestingLevel","titleLineWithAsterisk","getLinesFromFileContents","fileContents","logNotesLines","strippedDescriptionLines","rawLogNotes","action","parsedFile","parseOrg","openHeader","toggleHeaderOpened","isOpened","subheaderIndices","subheaderIndicesOfHeaderWithId","selectHeader","openParentsOfHeader","updateCookiesInAttributedStringWithChildCompletionStates","completionStates","doneCount","isDone","totalCount","updateCookiesOfHeaderWithId","file","directChildren","subheader","updateCookiesOfParentOfHeaderWithId","advanceTodoState","logIntoDrawer","existingHeaderId","currentTodoState","currentTodoSet","newStateIndex","newTodoState","indexedPlanningItemsWithRepeaters","planningItemIndex","adjustedTimestamp","currentDate","newDate","isBefore","applyRepeater","titleIndex","titlePart","descriptionIndex","descriptionPart","startupOptNoLogRepeat","elt","loggingProp","v","noLogRepeatEnabledP","lastRepeatTimestamp","newLastRepeatValue","inactiveTimestamp","newStateChangeLogText","newEntry","addNoteGeneric","noteText","addTodoStateChangeLogItem","updatePlanningItemsWithRepeaters","updateHeadlines","enterEditMode","editModeType","exitEditMode","updateHeaderTitle","newTitleLine","newRawTitle","updateHeaderDescription","newRawDescription","addHeader","newHeader","insert","selectNextSiblingHeader","nextSibling","selectNextVisibleHeader","nextVisibleHeader","nextVisibleHeaderAfterIndex","selectPreviousVisibleHeader","previousVisibleHeader","reverse","previousVisibleHeaderAfterIndex","removeHeader","numHeadersToRemove","delete","moveHeaderUp","previousSiblingIndex","indexOfPreviousSibling","moveHeaderDown","nextSiblingIndex","nextSiblingSubheaders","moveHeaderLeft","previousParentHeaderId","updateCookies","shiftTreeNestingLevel","moveHeaderRight","moveSubtreeLeft","moveSubtreeRight","moveItemInFile","fromList","targetItem","targetIndex","moveItemAcrossFiles","toList","updatedHeader","addNote","inputText","wrappedInput","maxLineLength","lineLength","word","formatTextWrap","narrowHeader","widenHeader","applyOpennessState","fileOpennessState","openHeaderPath","setDirty","isDirty","setSelectedTableCellId","updateDescriptionOfHeaderContainingTableCell","addNewTableRow","selectedTableCellId","rows","newEmptyTableRowLikeRows","removeTableRow","containingHeader","addNewTableColumn","_rowIndex","colIndex","removeTableColumn","moveTableRowDown","moveTableRowUp","moveTableColumnLeft","moveTableColumnRight","updateTableCellValue","insertCapture","insertCapturePosition","newIndex","descriptionText","newHeaderFromText","numSubheaders","updateParentListCheckboxes","itemPath","parentListItemPath","parentListItem","childrenCheckedStates","checkboxItem","childCompletionStates","advanceCheckboxState","newCheckboxState","setLastSyncAt","lastSyncAt","setHeaderTags","reorderTags","selectedHeaderId","splice","reorderPropertyList","updateTimestampWithId","newTimestamp","updatePlanningItemTimestamp","addNewPlanningItem","newPlanningItem","planningType","removePlanningItem","removeIn","removeTimestamp","updatePropertyListItems","newPropertyListItems","setLogEntryStop","entryId","headerIdx","entryIndex","createLogEntryStart","updateLogEntryTime","entryType","newTime","determineIncludedFiles","settingValue","includeByDefault","mapEntries","filePath","fileSetting","searchHeaders","filteredHeaders","headersToSearch","nrOfHeadersToSearch","searchFilterFunction","filterFilter","wordsLowerCase","filterTags","filterCS","filterIC","filterProps","filterField","filterDate","filterSchedule","filterDeadline","filterTagsExcl","filterCSExcl","filterICExcl","filterPropsExcl","headLine","headlineText","properties","scheduleds","deadlines","propertyFilter","ys","nameMatch","valueMatch","isMatch","headersFoundInCurrentFile","count","keySeq","headersFoundInFile","setSearchFilterInformation","cursorPosition","context","asMutable","searchFilterValid","headline_filter_parser","clockFilters","filterFunctions","showClockedTimes","narrowedHeaderId","headersOfFile","updateHeadersTotalFilteredTimeLoggedRecursive","clockedTime","filterIds","searchFilterSuggestions","currentFile","getTodoKeywordSetsAsFlattenedArray","asImmutable","indexOfFileSettingWithId","settingId","restoreFileSettings","config","applyFileSettingsFromConfig","reduceInFile","func","args","reducer","inFile","clearSearch","sourcePath","sourceHeaderId","targetPath","targetHeaderId","moveItem","sourceHeaders","targetHeaders","sourceHeader","sourceHeaderIndex","targetHeaderIndex","subheadersOfSourceHeader","nestingLevelSource","nestingLevelTarget","refileSubtree","setOpennessState","clearPendingCapture","setOrgFileErrorMessage","showClockDisplay","setShowClockDisplay","settingIndex","updateFileSettingFieldPathValue","reorderFileSetting","deleteFileSetting","loadOnStartup","includeInAgenda","includeInSearch","includeInRefile","includeInTasklist","addNewEmptyFileSetting","determineAffectedFiles","dirtying","captureTarget","direction","calculateNestingLevel","persistIsDirty","filesDirty","saveFunctionToDebounce","persistedFiles","debouncedSaveFunctions","saveFileToLocalStorage","debouncedSaveFunction","leading","trailing","Object","parseISO","addSeconds","saveFileContentsToLocalStorage","ActionCreators","clearHistory","debouncedSyncFunctions","syncDebounced","filesToSync","debouncedSyncFunction","doSync","sync","forceAction","log","successMessage","shouldSuppressMessages","currentPath","getFileContentsAndMetadata","lastModifiedAt","lastServerModifiedAt","isAfter","updateFile","err","ActionTypes","CLEAR_HISTORY","selectHeaderAndOpenParents","addHeaderAndEdit","dirtyAction","sampleCaptureTemplates","insertPendingCapture","pendingCapture","templateName","captureContent","customCaptureVariables","history","pushState","pathname","substitutedTemplate","initialCursorIndex","dirtyFiles","prefersColorSchemeMediaQueryList","matchMedia","addEventListener","selectedColorScheme","applyCategorySettingsFromConfig","stack","pop","replaceState","document","add","signOut","setCurrentFileBrowserDirectoryListing","listing","directoryListing","hasMore","additionalSyncBackendState","setIsLoadingMoreDirectoryListing","currentFileBrowserDirectoryListing","isLoadingMore","indexOfTemplateWithId","templateIndex","orgFiles","captureTemplates","applyCaptureSettingsFromConfig","undo","UNDO","redo","REDO","combineReducers","undoable","affectedFiles","includeAction","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","accessToken","migrateAccessTokenToDropboxAccessToken","shouldStoreSettingsInDropbox","migrateStoreInDropboxToStoreInSyncBackend","k","parseQueryString","str","ret","create","param","shift","decodeURIComponent","isArray","gapi","auth2","getAuthInstance","clear","getDirectoryListing","loadMoreDirectoryListing","getMoreDirectoryListing","extendedListing","pushBackup","pathOrFileId","duplicateFile","fileName","downloadFile","getFileContents","dropboxClient","Dropbox","fetch","bind","transformDirectoryListing","sortedListing","filterAndSortDirectoryListing","isDirectory","path_display","uploadFile","filesUpload","mode","autorename","filesDownload","response","reader","FileReader","server_modified","readAsText","fileBlob","objectContainsTagErrorP","isSignedIn","filesListFolder","has_more","cursor","filesListFolderContinue","filesDelete","getAPIClient","isInited","isIniting","afterInitCallbacks","load","initialHash","init","client_id","process","REACT_APP_GOOGLE_DRIVE_CLIENT_ID","discoveryDocs","scope","callback","handleGoogleDriveClientLoad","mimeType","getFiles","directoryId","nextPageToken","fileListPromise","drive","pageSize","q","pageToken","currentDirectoryId","fileParentPromise","fileId","parents","rootFolderIdPromise","rootFolderId","all","directoryParentId","fileIdByNameAndParent","method","Authorization","auth","getToken","access_token","body","fileContentsPromise","alt","escape","errors","reason","fileModifiedTimePromise","modifiedTime","fileNameCallback","getResponse","newFileName","backupFileId","makeCopy","copy","getFileContentsByNameAndParent","listResponse","href","children","target","rel","PrivacyPolicy","className","ExternalLink","HeaderBar","props","bindAll","backPath","fileParts","onClick","back","pathParts","directoryPath","handleBackClick","src","logo","width","height","activeModalPage","renderSettingsSubPageBackButton","renderOrgFileBackButton","getPathRoot","renderLogo","renderFileBrowserBackButton","renderHomeFileBackButton","renderSignInBackButton","titleContainerWithText","handleHeaderBarTitleClick","getFilename","isUndoEnabled","isRedoEnabled","isAuthenticated","hasUnseenChangelog","handleModalPageDoneClick","undoIconClassName","classNames","redoIconClassName","settingsIconClassName","handleUndoClick","handleRedoClick","handleHelpClick","handleChangelogClick","handleSettingsClick","renderBackButton","renderTitle","renderActions","PureComponent","withRouter","connect","syncBackendType","bindActionCreators","baseActions","orgActions","undoActions","syncBackendActions","useEffect","isTopLevelDirectory","getParentDirectoryPath","isBackupFile","isOrgFile","isSettingsFile","iconClass","useState","shouldRenderIndicator","setShouldRenderIndicator","lastMessage","setLastMessage","handleClick","style","opacity","spring","stiffness","onRest","subPartDataAndHandlers","onEnterTableEditMode","onAddNewTableRow","onRemoveTableRow","onAddNewTableColumn","onRemoveTableColumn","TablePart","rawCellValues","generateCellValueMap","shouldIgnoreBlur","prevProps","onTableCellValueUpdate","inTableEditMode","has","setState","onTableCellSelect","onExitTableEditMode","event","cellValue","insertionIndex","textarea","selectionStart","selectionEnd","focus","shouldDisableActions","isTableSelected","isCellSelected","handleCellSelect","autoFocus","onBlur","handleTextareaBlur","onChange","handleCellChange","ref","handleTextareaRef","handleInsertTimestamp","TableActionDrawer","interpolateColors","colorA","colorB","interpolationFactor","r","g","rgbaObject","rgbaString","rgba","readRgbaVariable","varName","varValue","getComputedStyle","documentElement","getPropertyValue","hexValue","rgbaValues","matchAll","themes","Solarized","Light","Dark","Gruvbox","One","Smyck","Code","uncheckedColor","checkedColor","checkboxStyle","colorFactor","backgroundColor","renderContent","itemId","lineContainerClass","onCheckboxClick","Checkbox","onTimestampClick","useLocation","normalisePath","dir","normalised","textDecoration","renderLink","ListPart","TimestampPart","TitleLine","titleValue","calculateRawTitle","containerWidth","containerDiv","offsetWidth","storeContainerWidth","inEditMode","div","span","titleSpan","hasContent","isSelected","shouldTapTodoToAdvance","stopPropagation","newTitle","lastCharacter","color","shouldDisableExplicitWidth","addition","isTodoKeywordInDoneState","titleStyle","wordBreak","additionStyle","minWidth","textAlign","marginRight","handleTitleClick","handleRef","handleTodoClick","onFocus","handleTextareaFocus","handleTitleChange","handleTitleFieldClick","handleTitleSpanRef","handleTimestampClick","ownProps","PlanningItems","onEdit","isDrawerCollapsed","setIsDrawerCollapsed","HeaderContent","descriptionValue","calculateRawDescription","logEntryIndex","handleDescriptionChange","handlePlanningItemTimestampClick","PropertyListItems","handlePropertyListEdit","LogBookEntries","handleLogEntryTimestampClick","handleTableCellSelect","handleExitTableEditMode","handleTableCellValueUpdate","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleCheckboxClick","HeaderActionDrawer","testId","onEnterTitleEditMode","onEnterDescriptionEditMode","onTagsClick","onPropertiesClick","isNarrowed","onNarrow","onWiden","onAddNewHeader","onDeadlineClick","onClockInOutClick","onScheduledClick","hasActiveClock","onShareHeader","onRefileHeader","onAddNote","iconWithFFClickCatcher","Header","SWIPE_ACTION_ACTIVATION_DISTANCE","FREE_DRAG_ACTIVATION_DISTANCE","isDraggingFreely","dragStartX","dragStartY","currentDragX","isPlayingRemoveAnimation","heightBeforeRemove","disabledBackgroundColor","onRef","dragX","dragY","closest","abs","swipeDistance","offsetHeight","handleDragStart","clientX","clientY","handleDragMove","handleDragEnd","handleDragCancel","changedTouches","classList","existingDeadlinePlanningItemIndex","handleDeadlineAndScheduledClick","logBook","existingClockIndex","now","getCurrentTimestamp","subject","mailtoURI","encodeURIComponent","open","prompt","bulletStyle","narrowedHeader","indentLevel","paddingLeft","marginLeft","heightFactor","handleRest","interpolatedStyle","swipedDistance","isLeftActionActivated","isRightActionActivated","leftActivatedBackgroundColor","rightActivatedBackgroundColor","disabledIconColor","activatedIconColor","leftSwipeActionContainerStyle","backgroundColorFactor","rightSwipeActionContainerStyle","headerStyle","handleHeaderClick","onMouseDown","handleMouseDown","onMouseMove","handleMouseMove","onMouseUp","handleMouseUp","onMouseOut","handleMouseOut","onTouchStart","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","handleTouchEnd","onTouchCancel","handleTouchCancel","leftInterpolatedStyle","leftStyle","leftIconStyle","display","rightInterpolatedStyle","rightStyle","rightIconStyle","springConfig","handleEnterTitleEditMode","handleEnterDescriptionEditMode","handleShowTagsModal","handleShowPropertyListEditorModal","handleNarrow","handleWiden","handleAddNewHeader","handleDeadlineClick","handleClockInOutClick","handleScheduledClick","handleShareHeaderClick","handleRefileHeaderRequest","handleAddNoteClick","HeaderList","headerRefs","selectedHeaderDiv","boundingRectangle","getBoundingClientRect","viewportHeight","clientHeight","top","bottom","scrollIntoView","headerRenderData","displayed","toArray","headerRenderDatum","previousRenderDatum","followingHeaders","followingHeaderIndex","followingHeader","narrowedHeaderIndex","headerColors","displayedHeaderRenderData","handleHeaderRef","ActionButton","isDisabled","subIconName","shouldRotateSubIcon","additionalClassName","tooltip","shouldSpinSubIcon","fas","subIconClassName","isNarrowedHeaderActive","captureActions","shouldDisableSyncButtons","isDisplayingArrowButtons","setIsDisplayingArrowButtons","isDisplayingCaptureButtons","setIsDisplayingCaptureButtons","isDisplayingSearchButtons","setIsDisplayingSearchButtons","mainArrowButton","useRef","mainArrowButtonBoundingRect","useMemo","current","handleUpClick","handleDownClick","handleLeftClick","handleRightClick","handleMoveSubtreeLeftClick","handleMoveSubtreeRightClick","getAvailableCaptureTemplates","availablePath","handleMainArrowButtonClick","handleMainSearchButtonClick","handleMainCaptureButtonClick","handleTaskListClick","handleSearchClick","baseArrowButtonStyle","boxShadow","centerXOffset","screen","animatedStyles","topRowYOffset","bottomRowYOffset","firstColumnXOffset","secondColumnXOffset","left","right","renderMovementButtons","baseSearchButtonStyle","position","zIndex","mainButtonStyle","animatedStyle","renderSearchButtons","availableCaptureTemplates","baseCaptureButtonStyle","renderCaptureButtons","browser","Bowser","getParser","navigator","userAgent","isMobileSafari13","satisfies","mobile","safari","isMobileBrowser","getPlatformType","isIos","getOS","isIphoneX","isIphone678","isRunningAsPWA","standalone","isInLandscapeMode","orientation","isEnabled","onToggle","disabledColor","enabledColor","switchStyle","grabberStyle","shouldIncludeCloseButton","onClose","maxSize","isVisible","setIsVisible","dragOffsetY","setDragOffsetY","useLayoutEffect","initialClientY","innerContainer","innerContainerHeight","handleInnerContainerClick","handleClose","targetTouches","isScrollingDown","scrollHeight","scrollTop","preventDefault","handleTouchEndOrCancel","innerContainerCurrent","removeEventListener","outerClassName","innerStyle","offsetY","innerHeight","transform","overflow","onCapture","targetHeader","textareaValue","setTextareaValue","setShouldPrepend","setSelectionRange","Drawer","hP","Switch","minHeight","onPull","onPush","onCancel","TagsEditorModal","allTags","prevTags","currentTags","lastTextfield","tagIndex","newTag","headerTags","tagName","idx","droppableId","provided","_snapshot","innerRef","droppableProps","draggableId","snapshot","isDragging","draggableProps","handleTagChange","textfield","handleRemoveTag","dragHandleProps","placeholder","handleAddNewTag","handleExistingTagClick","buttons","titles","selectedButton","useEqualWidthTabs","onSelect","handleButtonClick","buttonName","containerClassName","gridTemplateColumns","TimestampEditor","isNumber","newYear","newMonth","newDay","newDayName","startOrEnd","hourKey","minuteKey","hour","minute","newRepeaterType","newRepeaterUnit","newDelayType","newDelayUnit","label","timeKey","showRemoveButton","handleTimeChange","handleRemoveTime","handleAddTime","TabButtons","handleRepeaterTypeChange","min","handleRepeaterValueChange","handleRepeaterUnitChange","handleRemoveRepeater","handleAddRepeater","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange","handleRemoveDelay","handleAddDelay","handleActiveToggle","handleDateChange","nativeEvent","defaultValue","renderTimeField","renderRepeater","renderDelay","TimestampEditorModal","singleTimestampOnly","handleChange","handleRemoveEndTimestamp","handleAddEndTimestamp","PropertyListEditorModal","prevItems","currentItems","propertyListItemId","allPropertyNames","propertyListItemsWithAllPropVals","allPropertyValues","handlePropertyChange","handleValueChange","propertyValue","handleRemoveItem","handleAddNewItem","AgendaDay","onHeaderClick","dateDisplayType","onToggleDateDisplayType","agendaDefaultDeadlineDelayValue","agendaDefaultDeadlineDelayUnit","dateStart","dateEnd","planningItemsAndHeaders","getPlanningItemsAndHeaders","isToday","planningItemDate","hasTodoKeyword","dateClassName","isPast","valueSeq","isTodoKeywordCompleted","appearDate","isEqual","isWithinInterval","hasBeenRepeated","sortBy","allFiles","agendaStartOnWeekday","selectedDate","setSelectedDate","setDateDisplayType","weekStartsOn","getDay","handleToggleDateDisplayType","weekStart","daysAfter","monthStart","getDaysInMonth","weekEnd","calculateTimeframeHeader","getTimeFromPlanningItem","getTime","headersForFiles","todoKeywordSetsForFiles","Number","MAX_SAFE_INTEGER","planningInformation","setdateDisplayType","string","allHeaders","filename","allHeadersOfFile","maxBreadcrumbLength","getBreadcrumbsStringFunction","capitalize","DEFAULT_BINDINGS","calculateNamedKeybindings","customKeybindings","bindingName","binding","OrgFile","hasUncaughtError","querySelector","fileIsLoaded","urlFragment","container","loadedPath","newTags","popupData","activePopupType","activePopupData","selectedHeader","SyncConfirmationModal","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","headersOfCaptureTarget","CaptureModal","handleCapture","handlePopupClose","handleTagsChange","editingTimestamp","timestampWithId","handleTimestampChange","handlePropertyListItemsChange","handleSearchPopupClose","handleRefilePopupClose","shouldDisableDirtyIndicator","parsingErrorMessage","orgFileErrorMessage","keyMap","bindingAction","calculateActionedKeybindings","preventDefaultAndHandleEditMode","ignoreInEditMode","activeElement","nodeName","handlers","handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","advanceTodo","handleAdvanceTodoHotKey","editTitle","handleEditTitleHotKey","editDescription","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","tabIndex","handleContainerRef","renderActivePopup","loadedFiles","fromKeys","activePopup","fontSize","shouldStoreSettingsInSyncBackend","documentationHost","origin","confirm","ShortcutRow","isEditMode","rebindArea","handleKeyPress","code","Minus","Equal","Backspace","Enter","Return","Tab","BracketLeft","BracketRight","Semicolon","Quote","Backslash","Comma","Period","Slash","newModifiers","modifier","newBinding","onBindingChange","currentBinding","symbol","rebindAreaClassName","handleRebindClick","symbolizeKeybinding","handleBindingChange","alreadyInUseBinding","onFieldPathUpdate","onAddNewTemplateOrgFileAvailability","onRemoveTemplateOrgFileAvailability","onAddNewTemplateHeaderPath","onRemoveTemplateHeaderPath","onDeleteTemplate","loadedFilePaths","isCollapsed","setIsCollapsed","handleHeaderBarClick","updateField","fieldName","toggleAvailabilityInAllOrgFiles","togglePrepend","handleAddNewOrgFileAvailability","handleRemoveOrgFileAvailability","handleOrgFileAvailabilityChange","handleAddNewHeaderPath","handleRemoveHeaderPath","handleHeaderPathChange","handleDeleteClick","renderDescriptionField","renderIconField","maxLength","autoCapitalize","autoCorrect","renderOrgFileAvailability","orgFilePath","renderFilePath","renderHeaderPaths","marginTop","renderPrependField","renderTemplateField","caretClassName","handleFieldPathUpdate","handleAddNewTemplateOrgFileAvailability","handleRemoveTemplateOrgFileAvailability","handleAddNewTemplateHeaderPath","handleRemoveTemplateHeaderPath","handleDeleteTemplate","handleReorderTemplate","CaptureTemplate","onReorder","onDeleteSetting","loadedFilepaths","toggleLoadOnStartup","toggleIncludeInAgenda","toggleIncludeInSearch","toggleIncludeInTasklist","toggleIncludeInRefile","renderPathField","renderOptionFields","existingSettings","paths","currentPathIfWithoutFileSetting","settingPath","handleDeleteSetting","handleReorderSetting","FileSetting","WebDAVForm","url","setUrl","username","setUsername","password","setPassword","onSubmit","GoogleDriveNote","SyncServiceSignIn","clientId","REACT_APP_DROPBOX_CLIENT_ID","getAuthenticationUrl","authURL","apiKey","REACT_APP_GOOGLE_DRIVE_API_KEY","signIn","ux_mode","redirect_uri","handleDropboxClick","DropboxLogo","GoogleDriveLogo","handleGoogleDriveClick","Entry","setChangelogUnseenChanges","filesToLoad","lastSeenChangelogHash","hasChanged","shouldPromptWhenLeaving","onbeforeunload","shouldDisableActionDrawer","params","hasDirtyFiles","setProperty","setAttribute","loadTheme","pendingCapturePath","shouldRedirectToCapturePath","LoadingIndicator","renderChangelogFile","renderSampleFile","exact","component","render","renderFile","renderFileBrowser","Landing","filesToLoadOnStartup","debouncedDispatchSync","filepath","syncOnBecomingVisible","visProp","prefixes","getHiddenProp","evtname","App","runAllMigrations","hashContents","authenticatedSyncService","dropboxAccessToken","createDropboxSyncBackendClient","persistedDropboxAccessToken","createGoogleDriveSyncBackendClient","login","webdavClient","createClient","basename","getDirectoryContents","putFileContents","overwrite","stat","lastmod","toISOString","status","statusText","_additionalSyncBackendState","createWebDAVSyncBackendClient","queryStringContents","captureFile","captureTemplateName","capturePath","CUSTOM_VARIABLE_PREFIX","createStore","rootReducer","applyMiddleware","thunk","liveSync","toggleColorScheme","Store","subscribe","configFileContents","_error","loadSettingsFromConfigFile","urlPathMatch","urlPath","onpopstate","listenToBrowserButtons","onLine","onoffline","ononline","destination","onDragEnd","isLocalhost","Boolean","hostname","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","getElementById","URL","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.ee0bc8e9.chunk.js","sourcesContent":["/* eslint-disable */\n/*\n * Generated by PEG.js 0.10.0.\n *\n * http://pegjs.org/\n */\n\n\"use strict\";\n\nfunction peg$subclass(child, parent) {\n  function ctor() { this.constructor = child; }\n  ctor.prototype = parent.prototype;\n  child.prototype = new ctor();\n}\n\nfunction peg$SyntaxError(message, expected, found, location) {\n  this.message  = message;\n  this.expected = expected;\n  this.found    = found;\n  this.location = location;\n  this.name     = \"SyntaxError\";\n\n  if (typeof Error.captureStackTrace === \"function\") {\n    Error.captureStackTrace(this, peg$SyntaxError);\n  }\n}\n\npeg$subclass(peg$SyntaxError, Error);\n\npeg$SyntaxError.buildMessage = function(expected, found) {\n  var DESCRIBE_EXPECTATION_FNS = {\n        literal: function(expectation) {\n          return \"\\\"\" + literalEscape(expectation.text) + \"\\\"\";\n        },\n\n        \"class\": function(expectation) {\n          var escapedParts = \"\",\n              i;\n\n          for (i = 0; i < expectation.parts.length; i++) {\n            escapedParts += expectation.parts[i] instanceof Array\n              ? classEscape(expectation.parts[i][0]) + \"-\" + classEscape(expectation.parts[i][1])\n              : classEscape(expectation.parts[i]);\n          }\n\n          return \"[\" + (expectation.inverted ? \"^\" : \"\") + escapedParts + \"]\";\n        },\n\n        any: function(expectation) {\n          return \"any character\";\n        },\n\n        end: function(expectation) {\n          return \"end of input\";\n        },\n\n        other: function(expectation) {\n          return expectation.description;\n        }\n      };\n\n  function hex(ch) {\n    return ch.charCodeAt(0).toString(16).toUpperCase();\n  }\n\n  function literalEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\"/g,  '\\\\\"')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function classEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\\]/g, '\\\\]')\n      .replace(/\\^/g, '\\\\^')\n      .replace(/-/g,  '\\\\-')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function describeExpectation(expectation) {\n    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);\n  }\n\n  function describeExpected(expected) {\n    var descriptions = new Array(expected.length),\n        i, j;\n\n    for (i = 0; i < expected.length; i++) {\n      descriptions[i] = describeExpectation(expected[i]);\n    }\n\n    descriptions.sort();\n\n    if (descriptions.length > 0) {\n      for (i = 1, j = 1; i < descriptions.length; i++) {\n        if (descriptions[i - 1] !== descriptions[i]) {\n          descriptions[j] = descriptions[i];\n          j++;\n        }\n      }\n      descriptions.length = j;\n    }\n\n    switch (descriptions.length) {\n      case 1:\n        return descriptions[0];\n\n      case 2:\n        return descriptions[0] + \" or \" + descriptions[1];\n\n      default:\n        return descriptions.slice(0, -1).join(\", \")\n          + \", or \"\n          + descriptions[descriptions.length - 1];\n    }\n  }\n\n  function describeFound(found) {\n    return found ? \"\\\"\" + literalEscape(found) + \"\\\"\" : \"end of input\";\n  }\n\n  return \"Expected \" + describeExpected(expected) + \" but \" + describeFound(found) + \" found.\";\n};\n\nfunction peg$parse(input, options) {\n  options = options !== void 0 ? options : {};\n\n  var peg$FAILED = {},\n\n      peg$startRuleFunctions = { Expression: peg$parseExpression },\n      peg$startRuleFunction  = peg$parseExpression,\n\n      peg$c0 = peg$otherExpectation(\"filter expression\"),\n      peg$c1 = function(head, tail) {\n            return tail.reduce((result, element) => {\n              result.push(element[1]);\n              return result;\n            }, [head]);\n          },\n      peg$c2 = function() { return [] },\n      peg$c3 = function(a) {\n              a.offset = location().start.offset;\n              a.endOffset = location().end.offset;\n              return a;\n            },\n      peg$c4 = peg$otherExpectation(\"filter term\"),\n      peg$c5 = \"-\",\n      peg$c6 = peg$literalExpectation(\"-\", false),\n      peg$c7 = function(a) { \n          if ( a.type === 'field' && a.field.type !== 'desc') {\n            throw { message: `can't negate timerange searches yet` };\n          } else {\n            a.exclude = true;  \n            return a;\n          } },\n      peg$c8 = function(a) { a.exclude = false; return a; },\n      peg$c9 = peg$otherExpectation(\"text filter term\"),\n      peg$c10 = function(a) {\n              let type = 'ignore-case';\n              // It's hard to check for upper-case chars in JS.\n              // Best approach: https://stackoverflow.com/a/31415820/999007\n              // Simplest approach for now:\n              if (text().match(/[A-Z]/))\n                type = 'case-sensitive';\n\n              return {type: type, words: a}\n        },\n      peg$c11 = peg$otherExpectation(\"tag filter term\"),\n      peg$c12 = \":\",\n      peg$c13 = peg$literalExpectation(\":\", false),\n      peg$c14 = function(a) { return {type: 'tag', words: a} },\n      peg$c15 = peg$otherExpectation(\"property filter term\"),\n      peg$c16 = function(a, b) {\n                return {\n                  type: 'property',\n                  property: a,\n                  words: b === null ? [''] : b\n                }\n              },\n      peg$c17 = peg$otherExpectation(\"search outside of header\"),\n      peg$c18 = \"date:\",\n      peg$c19 = peg$literalExpectation(\"date:\", false),\n      peg$c20 = function(a) { return { type: 'field', field: { type: 'date',      timerange: a } }; },\n      peg$c21 = \"clock:\",\n      peg$c22 = peg$literalExpectation(\"clock:\", false),\n      peg$c23 = function(a) { return { type: 'field', field: { type: 'clock',     timerange: a } }; },\n      peg$c24 = \"sched:\",\n      peg$c25 = peg$literalExpectation(\"sched:\", false),\n      peg$c26 = \"scheduled:\",\n      peg$c27 = peg$literalExpectation(\"scheduled:\", false),\n      peg$c28 = function(a) { return { type: 'field', field: { type: 'scheduled', timerange: a } }; },\n      peg$c29 = \"dead:\",\n      peg$c30 = peg$literalExpectation(\"dead:\", false),\n      peg$c31 = \"deadline:\",\n      peg$c32 = peg$literalExpectation(\"deadline:\", false),\n      peg$c33 = function(a) { return { type: 'field', field: { type: 'deadline',  timerange: a } }; },\n      peg$c34 = peg$otherExpectation(\"moments and timeranges\"),\n      peg$c35 = \"..\",\n      peg$c36 = peg$literalExpectation(\"..\", false),\n      peg$c37 = function(a, b) { return { type: 'range', from: a, to: b }; },\n      peg$c38 = function(a) { return { type: 'range', from: a, to: null }; },\n      peg$c39 = function(a) { return { type: 'point', point: a }; },\n      peg$c40 = function(a) { return { type: 'range', from: null, to: a }; },\n      peg$c41 = function() { return { type: 'all' }; },\n      peg$c42 = peg$otherExpectation(\"moment\"),\n      peg$c43 = \"today\",\n      peg$c44 = peg$literalExpectation(\"today\", false),\n      peg$c45 = \"now\",\n      peg$c46 = peg$literalExpectation(\"now\", false),\n      peg$c47 = function(a) { return { type: 'special', value: a }; },\n      peg$c48 = /^[\\-.\\/]/,\n      peg$c49 = peg$classExpectation([\"-\", \".\", \"/\"], false, false),\n      peg$c50 = function(year, month, day) { return checkDate(year, month, day); },\n      peg$c51 = function(year, month) { return checkMonth(year, month); },\n      peg$c52 = function(year) { return { type: 'timestamp', year: parseInt(year), month: null, day: null }; },\n      peg$c53 = /^[hdwmy]/,\n      peg$c54 = peg$classExpectation([\"h\", \"d\", \"w\", \"m\", \"y\"], false, false),\n      peg$c55 = function(a) { return { type: 'unit', unit: a }; },\n      peg$c56 = peg$otherExpectation(\"year\"),\n      peg$c57 = /^[0-9]/,\n      peg$c58 = peg$classExpectation([[\"0\", \"9\"]], false, false),\n      peg$c59 = function(a) { return a; },\n      peg$c60 = peg$otherExpectation(\"month\"),\n      peg$c61 = peg$otherExpectation(\"day\"),\n      peg$c62 = peg$otherExpectation(\"offset\"),\n      peg$c63 = function(a, b) { return { type: 'offset', value: parseInt(a), unit: b, }; },\n      peg$c64 = peg$otherExpectation(\"alternatives\"),\n      peg$c65 = \"|\",\n      peg$c66 = peg$literalExpectation(\"|\", false),\n      peg$c67 = function(head, tail) {\n             return tail.reduce((result, element) => {\n               result.push(element[1]);\n               return result;\n             }, [head])\n           },\n      peg$c68 = peg$otherExpectation(\"tag alternatives\"),\n      peg$c69 = peg$otherExpectation(\"string\"),\n      peg$c70 = /^[^: \\t|'\"]/,\n      peg$c71 = peg$classExpectation([\":\", \" \", \"\\t\", \"|\", \"'\", \"\\\"\"], true, false),\n      peg$c72 = function() { return text() },\n      peg$c73 = \"'\",\n      peg$c74 = peg$literalExpectation(\"'\", false),\n      peg$c75 = /^[^']/,\n      peg$c76 = peg$classExpectation([\"'\"], true, false),\n      peg$c77 = function(a) { return a.join('') },\n      peg$c78 = \"\\\"\",\n      peg$c79 = peg$literalExpectation(\"\\\"\", false),\n      peg$c80 = /^[^\"]/,\n      peg$c81 = peg$classExpectation([\"\\\"\"], true, false),\n      peg$c82 = peg$otherExpectation(\"property name\"),\n      peg$c83 = /^[^: \\t]/,\n      peg$c84 = peg$classExpectation([\":\", \" \", \"\\t\"], true, false),\n      peg$c85 = peg$otherExpectation(\"tag name\"),\n      peg$c86 = /^[a-zA-Z0-9_@]/,\n      peg$c87 = peg$classExpectation([[\"a\", \"z\"], [\"A\", \"Z\"], [\"0\", \"9\"], \"_\", \"@\"], false, false),\n      peg$c88 = peg$otherExpectation(\"whitespace\"),\n      peg$c89 = /^[ \\t]/,\n      peg$c90 = peg$classExpectation([\" \", \"\\t\"], false, false),\n\n      peg$currPos          = 0,\n      peg$savedPos         = 0,\n      peg$posDetailsCache  = [{ line: 1, column: 1 }],\n      peg$maxFailPos       = 0,\n      peg$maxFailExpected  = [],\n      peg$silentFails      = 0,\n\n      peg$result;\n\n  if (\"startRule\" in options) {\n    if (!(options.startRule in peg$startRuleFunctions)) {\n      throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n    }\n\n    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n  }\n\n  function text() {\n    return input.substring(peg$savedPos, peg$currPos);\n  }\n\n  function location() {\n    return peg$computeLocation(peg$savedPos, peg$currPos);\n  }\n\n  function expected(description, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildStructuredError(\n      [peg$otherExpectation(description)],\n      input.substring(peg$savedPos, peg$currPos),\n      location\n    );\n  }\n\n  function error(message, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildSimpleError(message, location);\n  }\n\n  function peg$literalExpectation(text, ignoreCase) {\n    return { type: \"literal\", text: text, ignoreCase: ignoreCase };\n  }\n\n  function peg$classExpectation(parts, inverted, ignoreCase) {\n    return { type: \"class\", parts: parts, inverted: inverted, ignoreCase: ignoreCase };\n  }\n\n  function peg$anyExpectation() {\n    return { type: \"any\" };\n  }\n\n  function peg$endExpectation() {\n    return { type: \"end\" };\n  }\n\n  function peg$otherExpectation(description) {\n    return { type: \"other\", description: description };\n  }\n\n  function peg$computePosDetails(pos) {\n    var details = peg$posDetailsCache[pos], p;\n\n    if (details) {\n      return details;\n    } else {\n      p = pos - 1;\n      while (!peg$posDetailsCache[p]) {\n        p--;\n      }\n\n      details = peg$posDetailsCache[p];\n      details = {\n        line:   details.line,\n        column: details.column\n      };\n\n      while (p < pos) {\n        if (input.charCodeAt(p) === 10) {\n          details.line++;\n          details.column = 1;\n        } else {\n          details.column++;\n        }\n\n        p++;\n      }\n\n      peg$posDetailsCache[pos] = details;\n      return details;\n    }\n  }\n\n  function peg$computeLocation(startPos, endPos) {\n    var startPosDetails = peg$computePosDetails(startPos),\n        endPosDetails   = peg$computePosDetails(endPos);\n\n    return {\n      start: {\n        offset: startPos,\n        line:   startPosDetails.line,\n        column: startPosDetails.column\n      },\n      end: {\n        offset: endPos,\n        line:   endPosDetails.line,\n        column: endPosDetails.column\n      }\n    };\n  }\n\n  function peg$fail(expected) {\n    if (peg$currPos < peg$maxFailPos) { return; }\n\n    if (peg$currPos > peg$maxFailPos) {\n      peg$maxFailPos = peg$currPos;\n      peg$maxFailExpected = [];\n    }\n\n    peg$maxFailExpected.push(expected);\n  }\n\n  function peg$buildSimpleError(message, location) {\n    return new peg$SyntaxError(message, null, null, location);\n  }\n\n  function peg$buildStructuredError(expected, found, location) {\n    return new peg$SyntaxError(\n      peg$SyntaxError.buildMessage(expected, found),\n      expected,\n      found,\n      location\n    );\n  }\n\n  function peg$parseExpression() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    s2 = peg$parse_();\n    while (s2 !== peg$FAILED) {\n      s1.push(s2);\n      s2 = peg$parse_();\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseLocationAnnotedTerm();\n      if (s2 !== peg$FAILED) {\n        s3 = [];\n        s4 = peg$currPos;\n        s5 = [];\n        s6 = peg$parse_();\n        if (s6 !== peg$FAILED) {\n          while (s6 !== peg$FAILED) {\n            s5.push(s6);\n            s6 = peg$parse_();\n          }\n        } else {\n          s5 = peg$FAILED;\n        }\n        if (s5 !== peg$FAILED) {\n          s6 = peg$parseLocationAnnotedTerm();\n          if (s6 !== peg$FAILED) {\n            s5 = [s5, s6];\n            s4 = s5;\n          } else {\n            peg$currPos = s4;\n            s4 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s4;\n          s4 = peg$FAILED;\n        }\n        while (s4 !== peg$FAILED) {\n          s3.push(s4);\n          s4 = peg$currPos;\n          s5 = [];\n          s6 = peg$parse_();\n          if (s6 !== peg$FAILED) {\n            while (s6 !== peg$FAILED) {\n              s5.push(s6);\n              s6 = peg$parse_();\n            }\n          } else {\n            s5 = peg$FAILED;\n          }\n          if (s5 !== peg$FAILED) {\n            s6 = peg$parseLocationAnnotedTerm();\n            if (s6 !== peg$FAILED) {\n              s5 = [s5, s6];\n              s4 = s5;\n            } else {\n              peg$currPos = s4;\n              s4 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s4;\n            s4 = peg$FAILED;\n          }\n        }\n        if (s3 !== peg$FAILED) {\n          s4 = [];\n          s5 = peg$parse_();\n          while (s5 !== peg$FAILED) {\n            s4.push(s5);\n            s5 = peg$parse_();\n          }\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c1(s2, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = [];\n      s2 = peg$parse_();\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        s2 = peg$parse_();\n      }\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c2();\n      }\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c0); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseLocationAnnotedTerm() {\n    var s0, s1;\n\n    s0 = peg$currPos;\n    s1 = peg$parseTerm();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c3(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseTerm() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 45) {\n      s1 = peg$c5;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c6); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsePlainTerm();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c7(s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsePlainTerm();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c8(s1);\n      }\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c4); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsePlainTerm() {\n    var s0;\n\n    s0 = peg$parseTermField();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseTermText();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parseTermProp();\n        if (s0 === peg$FAILED) {\n          s0 = peg$parseTermTag();\n        }\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermText() {\n    var s0, s1;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseStringAlternatives();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c10(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c9); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermTag() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 58) {\n      s1 = peg$c12;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c13); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseTagAlternatives();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c14(s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c11); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermProp() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 58) {\n      s1 = peg$c12;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c13); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsePropertyName();\n      if (s2 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 58) {\n          s3 = peg$c12;\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c13); }\n        }\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseStringAlternatives();\n          if (s4 === peg$FAILED) {\n            s4 = null;\n          }\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c16(s2, s4);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c15); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermField() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.substr(peg$currPos, 5) === peg$c18) {\n      s1 = peg$c18;\n      peg$currPos += 5;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c19); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseTimeRange();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c20(s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      if (input.substr(peg$currPos, 6) === peg$c21) {\n        s1 = peg$c21;\n        peg$currPos += 6;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c22); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parseTimeRange();\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c23(s2);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        if (input.substr(peg$currPos, 6) === peg$c24) {\n          s1 = peg$c24;\n          peg$currPos += 6;\n        } else {\n          s1 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c25); }\n        }\n        if (s1 === peg$FAILED) {\n          if (input.substr(peg$currPos, 10) === peg$c26) {\n            s1 = peg$c26;\n            peg$currPos += 10;\n          } else {\n            s1 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c27); }\n          }\n        }\n        if (s1 !== peg$FAILED) {\n          s2 = peg$parseTimeRange();\n          if (s2 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c28(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n        if (s0 === peg$FAILED) {\n          s0 = peg$currPos;\n          if (input.substr(peg$currPos, 5) === peg$c29) {\n            s1 = peg$c29;\n            peg$currPos += 5;\n          } else {\n            s1 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c30); }\n          }\n          if (s1 === peg$FAILED) {\n            if (input.substr(peg$currPos, 9) === peg$c31) {\n              s1 = peg$c31;\n              peg$currPos += 9;\n            } else {\n              s1 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c32); }\n            }\n          }\n          if (s1 !== peg$FAILED) {\n            s2 = peg$parseTimeRange();\n            if (s2 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c33(s2);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c17); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTimeRange() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseMoment();\n    if (s1 !== peg$FAILED) {\n      if (input.substr(peg$currPos, 2) === peg$c35) {\n        s2 = peg$c35;\n        peg$currPos += 2;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c36); }\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseMoment();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c37(s1, s3);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseMoment();\n      if (s1 !== peg$FAILED) {\n        if (input.substr(peg$currPos, 2) === peg$c35) {\n          s2 = peg$c35;\n          peg$currPos += 2;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c36); }\n        }\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c38(s1);\n          s0 = s1;\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseMoment();\n        if (s1 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c39(s1);\n        }\n        s0 = s1;\n        if (s0 === peg$FAILED) {\n          s0 = peg$currPos;\n          if (input.substr(peg$currPos, 2) === peg$c35) {\n            s1 = peg$c35;\n            peg$currPos += 2;\n          } else {\n            s1 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c36); }\n          }\n          if (s1 !== peg$FAILED) {\n            s2 = peg$parseMoment();\n            if (s2 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c40(s2);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n          if (s0 === peg$FAILED) {\n            s0 = peg$currPos;\n            if (input.substr(peg$currPos, 2) === peg$c35) {\n              s1 = peg$c35;\n              peg$currPos += 2;\n            } else {\n              s1 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c36); }\n            }\n            if (s1 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c41();\n            }\n            s0 = s1;\n          }\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c34); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseMoment() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$parseTimeOffset();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseTimestamp();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parseTimeUnit();\n        if (s0 === peg$FAILED) {\n          s0 = peg$currPos;\n          s1 = peg$currPos;\n          if (input.substr(peg$currPos, 5) === peg$c43) {\n            s2 = peg$c43;\n            peg$currPos += 5;\n          } else {\n            s2 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c44); }\n          }\n          if (s2 === peg$FAILED) {\n            if (input.substr(peg$currPos, 3) === peg$c45) {\n              s2 = peg$c45;\n              peg$currPos += 3;\n            } else {\n              s2 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c46); }\n            }\n          }\n          if (s2 !== peg$FAILED) {\n            s1 = input.substring(s1, peg$currPos);\n          } else {\n            s1 = s2;\n          }\n          if (s1 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c47(s1);\n          }\n          s0 = s1;\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c42); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTimestamp() {\n    var s0, s1, s2, s3, s4, s5;\n\n    s0 = peg$currPos;\n    s1 = peg$parseYear();\n    if (s1 !== peg$FAILED) {\n      if (peg$c48.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c49); }\n      }\n      if (s2 === peg$FAILED) {\n        s2 = null;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parseMonth();\n        if (s3 !== peg$FAILED) {\n          if (peg$c48.test(input.charAt(peg$currPos))) {\n            s4 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s4 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c49); }\n          }\n          if (s4 === peg$FAILED) {\n            s4 = null;\n          }\n          if (s4 !== peg$FAILED) {\n            s5 = peg$parseDay();\n            if (s5 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c50(s1, s3, s5);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parseYear();\n      if (s1 !== peg$FAILED) {\n        if (peg$c48.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c49); }\n        }\n        if (s2 === peg$FAILED) {\n          s2 = null;\n        }\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parseMonth();\n          if (s3 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c51(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseYear();\n        if (s1 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s1 = peg$c52(s1);\n        }\n        s0 = s1;\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTimeUnit() {\n    var s0, s1;\n\n    s0 = peg$currPos;\n    if (peg$c53.test(input.charAt(peg$currPos))) {\n      s1 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c54); }\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c55(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseYear() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = peg$currPos;\n    if (peg$c57.test(input.charAt(peg$currPos))) {\n      s3 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s3 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c58); }\n    }\n    if (s3 !== peg$FAILED) {\n      if (peg$c57.test(input.charAt(peg$currPos))) {\n        s4 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c58); }\n      }\n      if (s4 !== peg$FAILED) {\n        if (peg$c57.test(input.charAt(peg$currPos))) {\n          s5 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s5 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c58); }\n        }\n        if (s5 !== peg$FAILED) {\n          if (peg$c57.test(input.charAt(peg$currPos))) {\n            s6 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s6 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c58); }\n          }\n          if (s6 !== peg$FAILED) {\n            s3 = [s3, s4, s5, s6];\n            s2 = s3;\n          } else {\n            peg$currPos = s2;\n            s2 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s2;\n          s2 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s2;\n        s2 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s2;\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c59(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c56); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseMonth() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = peg$currPos;\n    if (peg$c57.test(input.charAt(peg$currPos))) {\n      s3 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s3 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c58); }\n    }\n    if (s3 !== peg$FAILED) {\n      if (peg$c57.test(input.charAt(peg$currPos))) {\n        s4 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c58); }\n      }\n      if (s4 !== peg$FAILED) {\n        s3 = [s3, s4];\n        s2 = s3;\n      } else {\n        peg$currPos = s2;\n        s2 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s2;\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c59(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c60); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseDay() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = peg$currPos;\n    if (peg$c57.test(input.charAt(peg$currPos))) {\n      s3 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s3 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c58); }\n    }\n    if (s3 !== peg$FAILED) {\n      if (peg$c57.test(input.charAt(peg$currPos))) {\n        s4 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c58); }\n      }\n      if (s4 !== peg$FAILED) {\n        s3 = [s3, s4];\n        s2 = s3;\n      } else {\n        peg$currPos = s2;\n        s2 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s2;\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c59(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c61); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTimeOffset() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = [];\n    if (peg$c57.test(input.charAt(peg$currPos))) {\n      s3 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s3 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c58); }\n    }\n    if (s3 !== peg$FAILED) {\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        if (peg$c57.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c58); }\n        }\n      }\n    } else {\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s1 = input.substring(s1, peg$currPos);\n    } else {\n      s1 = s2;\n    }\n    if (s1 !== peg$FAILED) {\n      if (peg$c53.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c54); }\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c63(s1, s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c62); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseStringAlternatives() {\n    var s0, s1, s2, s3, s4, s5;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseString();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 124) {\n        s4 = peg$c65;\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c66); }\n      }\n      if (s4 !== peg$FAILED) {\n        s5 = peg$parseString();\n        if (s5 !== peg$FAILED) {\n          s4 = [s4, s5];\n          s3 = s4;\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s3;\n        s3 = peg$FAILED;\n      }\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 124) {\n          s4 = peg$c65;\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c66); }\n        }\n        if (s4 !== peg$FAILED) {\n          s5 = peg$parseString();\n          if (s5 !== peg$FAILED) {\n            s4 = [s4, s5];\n            s3 = s4;\n          } else {\n            peg$currPos = s3;\n            s3 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c67(s1, s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c64); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTagAlternatives() {\n    var s0, s1, s2, s3, s4, s5;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseTagName();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 124) {\n        s4 = peg$c65;\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c66); }\n      }\n      if (s4 !== peg$FAILED) {\n        s5 = peg$parseTagName();\n        if (s5 !== peg$FAILED) {\n          s4 = [s4, s5];\n          s3 = s4;\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s3;\n        s3 = peg$FAILED;\n      }\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 124) {\n          s4 = peg$c65;\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c66); }\n        }\n        if (s4 !== peg$FAILED) {\n          s5 = peg$parseTagName();\n          if (s5 !== peg$FAILED) {\n            s4 = [s4, s5];\n            s3 = s4;\n          } else {\n            peg$currPos = s3;\n            s3 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c67(s1, s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c68); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseString() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c70.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c71); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c70.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c71); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c72();\n    }\n    s0 = s1;\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 39) {\n        s1 = peg$c73;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c74); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        if (peg$c75.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c76); }\n        }\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            if (peg$c75.test(input.charAt(peg$currPos))) {\n              s3 = input.charAt(peg$currPos);\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c76); }\n            }\n          }\n        } else {\n          s2 = peg$FAILED;\n        }\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 39) {\n            s3 = peg$c73;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c74); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c77(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 34) {\n          s1 = peg$c78;\n          peg$currPos++;\n        } else {\n          s1 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c79); }\n        }\n        if (s1 !== peg$FAILED) {\n          s2 = [];\n          if (peg$c80.test(input.charAt(peg$currPos))) {\n            s3 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c81); }\n          }\n          if (s3 !== peg$FAILED) {\n            while (s3 !== peg$FAILED) {\n              s2.push(s3);\n              if (peg$c80.test(input.charAt(peg$currPos))) {\n                s3 = input.charAt(peg$currPos);\n                peg$currPos++;\n              } else {\n                s3 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c81); }\n              }\n            }\n          } else {\n            s2 = peg$FAILED;\n          }\n          if (s2 !== peg$FAILED) {\n            if (input.charCodeAt(peg$currPos) === 34) {\n              s3 = peg$c78;\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c79); }\n            }\n            if (s3 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c77(s2);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c69); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsePropertyName() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c83.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c84); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c83.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c84); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c72();\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c82); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTagName() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c86.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c87); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c86.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c87); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c72();\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c85); }\n    }\n\n    return s0;\n  }\n\n  function peg$parse_() {\n    var s0, s1;\n\n    peg$silentFails++;\n    if (peg$c89.test(input.charAt(peg$currPos))) {\n      s0 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c90); }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c88); }\n    }\n\n    return s0;\n  }\n\n\n    const checkDate = (year, month, day) => {\n      const date = new Date(year + \"-\" + month + \"-\" + day);\n      if (isNaN(date.valueOf())) {\n        throw { message: 'invalid date'};\n      } else {\n        return { \n          type: 'timestamp', \n          year: parseInt(year), \n          month: parseInt(month), \n          day: parseInt(day) \n        };\n      }\n    };\n    const checkMonth = (year, month) => {\n      if (month >= 1 && month <= 12) {\n        return { type: 'timestamp', year: parseInt(year), month: parseInt(month), day: null };\n      } else {\n        throw {message: 'invalid month'};  \n      }\n    };\n\n\n  peg$result = peg$startRuleFunction();\n\n  if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n    return peg$result;\n  } else {\n    if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n      peg$fail(peg$endExpectation());\n    }\n\n    throw peg$buildStructuredError(\n      peg$maxFailExpected,\n      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,\n      peg$maxFailPos < input.length\n        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)\n        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)\n    );\n  }\n}\n\nmodule.exports = {\n  SyntaxError: peg$SyntaxError,\n  parse:       peg$parse\n};\n","export default (() => {\n  let nextId = 1;\n  return () => nextId++;\n})();\n","import {\n  format,\n  parse,\n  addHours,\n  addDays,\n  addWeeks,\n  addMonths,\n  addYears,\n  subHours,\n  subDays,\n  subWeeks,\n  subMonths,\n  subYears,\n  isBefore,\n  differenceInMinutes,\n} from 'date-fns';\n\nexport const renderAsText = (timestamp) => {\n  const {\n    isActive,\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    repeaterDeadlineValue,\n    repeaterDeadlineUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n  } = timestamp.toJS();\n\n  let timestampText = '';\n  timestampText += isActive ? '<' : '[';\n  timestampText += `${year}-${month}-${day}`;\n  timestampText += !!dayName ? ` ${dayName}` : '';\n  timestampText += !!startHour ? ` ${startHour}:${startMinute}` : '';\n  timestampText += !!endHour ? `-${endHour}:${endMinute}` : '';\n  timestampText += !!repeaterType ? ` ${repeaterType}${repeaterValue}${repeaterUnit}` : '';\n  timestampText +=\n    !!repeaterType && !!repeaterDeadlineValue\n      ? `/${repeaterDeadlineValue}${repeaterDeadlineUnit}`\n      : '';\n  timestampText += !!delayType ? ` ${delayType}${delayValue}${delayUnit}` : '';\n  timestampText += isActive ? '>' : ']';\n\n  return timestampText;\n};\n\nexport const getCurrentTimestamp = ({ isActive = true, withStartTime = false } = {}) =>\n  timestampForDate(new Date(), { isActive, withStartTime });\n\nexport const timestampForDate = (time, { isActive = true, withStartTime = false } = {}) => {\n  const timestamp = {\n    isActive,\n    year: format(time, 'yyyy'),\n    month: format(time, 'MM'),\n    day: format(time, 'dd'),\n    dayName: format(time, 'eee'),\n    startHour: null,\n    startMinute: null,\n    endHour: null,\n    endMinute: null,\n    repeaterType: null,\n    repeaterValue: null,\n    repeaterUnit: null,\n    repeaterDeadlineValue: null,\n    repeaterDeadlineUnit: null,\n    delayType: null,\n    delayValue: null,\n    delayUnit: null,\n  };\n\n  if (withStartTime) {\n    timestamp.startHour = format(time, 'HH');\n    timestamp.startMinute = format(time, 'mm');\n  }\n\n  return timestamp;\n};\n\n// To get around the heavy-weight renderAsText(fromJS(getCurrentTimestampAsText()))\nexport const getCurrentTimestampAsText = ({ isActive = true, withStartTime = false } = {}) =>\n  getTimestampAsText(new Date(), { isActive, withStartTime });\nexport const getTimestampAsText = (time, { isActive = true, withStartTime = false } = {}) => {\n  const bracketPair = isActive ? '<>' : '[]';\n  let formatString = 'yyyy-MM-dd eee';\n  if (withStartTime) formatString += ' HH:mm';\n  return `${bracketPair[0]}${format(time, formatString)}${bracketPair[1]}`;\n};\n\nexport const dateForTimestamp = (timestamp) => {\n  const { year, month, day, startHour, startMinute } = timestamp.toJS();\n\n  let timestampString = `${year}-${month}-${day}`;\n  if (startHour && startMinute) {\n    timestampString += ` ${startHour.padStart(2, '0')}:${startMinute}`;\n  } else {\n    timestampString += ' 12:00';\n  }\n  return parse(timestampString, 'yyyy-MM-dd HH:mm', new Date());\n};\n\nexport const addTimestampUnitToDate = (date, numUnits, timestampUnit) => {\n  switch (timestampUnit) {\n    case 'h':\n      return addHours(date, numUnits);\n    case 'd':\n      return addDays(date, numUnits);\n    case 'w':\n      return addWeeks(date, numUnits);\n    case 'm':\n      return addMonths(date, numUnits);\n    case 'y':\n      return addYears(date, numUnits);\n    default:\n      return date;\n  }\n};\n\nexport const subtractTimestampUnitFromDate = (date, numUnits, timestampUnit) => {\n  switch (timestampUnit) {\n    case 'h':\n      return subHours(date, numUnits);\n    case 'd':\n      return subDays(date, numUnits);\n    case 'w':\n      return subWeeks(date, numUnits);\n    case 'm':\n      return subMonths(date, numUnits);\n    case 'y':\n      return subYears(date, numUnits);\n    default:\n      return date;\n  }\n};\n\nexport const applyRepeater = (timestamp, currentDate) => {\n  if (!timestamp.get('repeaterType')) {\n    return timestamp;\n  }\n\n  let newDate = null;\n  switch (timestamp.get('repeaterType')) {\n    case '+':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    case '++':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      while (isBefore(newDate, currentDate)) {\n        newDate = addTimestampUnitToDate(\n          newDate,\n          timestamp.get('repeaterValue'),\n          timestamp.get('repeaterUnit')\n        );\n      }\n      break;\n    case '.+':\n      newDate = addTimestampUnitToDate(\n        currentDate,\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    default:\n      console.error(`Unrecognized timestamp repeater type: ${timestamp.get('repeaterType')}`);\n      return timestamp;\n  }\n\n  timestamp = timestamp\n    .set('day', format(newDate, 'dd'))\n    .set('dayName', format(newDate, 'eee'))\n    .set('month', format(newDate, 'MM'))\n    .set('year', format(newDate, 'yyyy'));\n\n  if (timestamp.get('startHour') !== undefined && timestamp.get('startHour') !== null) {\n    timestamp = timestamp\n      .set('startHour', format(newDate, 'HH'))\n      .set('startMinute', format(newDate, 'mm'));\n  }\n\n  return timestamp;\n};\n\nexport const timestampDuration = (startTimestamp, endTimestamp) => {\n  let [start, end] = [startTimestamp, endTimestamp].map(dateForTimestamp);\n  return dateDuration(start, end);\n};\n\nexport const dateDuration = (start, end) => {\n  let pad = ' ';\n  if (start > end) {\n    pad = '-';\n    [start, end] = [end, start];\n  }\n  const minDiff = differenceInMinutes(end, start);\n  const hours = Math.floor(minDiff / 60);\n  if (hours >= 10) {\n    pad = '';\n  }\n  const minutes = minDiff % 60;\n  const minutesText = minutes >= 10 ? minutes : `0${minutes}`;\n  return `${pad}${hours}:${minutesText}`;\n};\n\nexport const millisDuration = (millis) => {\n  if (millis === undefined) {\n    return '';\n  }\n  return dateDuration(new Date(0), new Date(millis));\n};\n","import _ from 'lodash';\nimport { fromJS } from 'immutable';\n\nimport { isRegularPlanningItem } from './org_utils';\nimport { renderAsText, timestampDuration } from './timestamps';\n\nconst linkPartToRawText = (linkPart) => {\n  if (!!linkPart.getIn(['contents', 'title'])) {\n    return `[[${linkPart.getIn(['contents', 'uri'])}][${linkPart.getIn(['contents', 'title'])}]]`;\n  } else {\n    return `[[${linkPart.getIn(['contents', 'uri'])}]]`;\n  }\n};\n\nconst formattedAttributedStringText = (parts) => {\n  return parts\n    .map((part) => {\n      switch (part.get('type')) {\n        case 'text':\n          return part.get('contents');\n        case 'link':\n          if (part.getIn(['contents', 'title'])) {\n            return part.getIn(['contents', 'title']);\n          } else {\n            return part.getIn(['contents', 'uri']);\n          }\n        case 'table':\n          return '';\n        default:\n          return '';\n      }\n    })\n    .join('');\n};\n\nconst tablePartToRawText = (tablePart) => {\n  const rowHeights = tablePart\n    .get('contents')\n    .map((row) =>\n      Math.max(\n        ...row.get('contents').map((cell) => (_.countBy(cell.get('rawContents'))['\\n'] || 0) + 1)\n      )\n    )\n    .toJS();\n\n  const numColumns = tablePart.getIn(['contents', 0, 'contents']).size;\n  const columnWidths = _.times(numColumns).map((columnIndex) =>\n    Math.max(\n      ...tablePart.get('contents').map((row) => {\n        const content = row.getIn(['contents', columnIndex, 'contents']);\n        const formattedText = formattedAttributedStringText(content);\n        const lineLengths = formattedText.split('\\n').map((line) => line.trim().length);\n        return Math.max(...lineLengths);\n      })\n    )\n  );\n\n  const rowStrings = _.dropRight(\n    _.flatten(\n      tablePart\n        .get('contents')\n        .map((row, rowIndex) => {\n          const rowHeight = rowHeights[rowIndex];\n\n          const contentRows = _.times(rowHeight)\n            .map((lineIndex) =>\n              row\n                .get('contents')\n                .map((cell, columnIndex) => {\n                  const content = cell.get('contents');\n                  const formattedText = formattedAttributedStringText(content);\n                  const formattedLineLengths = formattedText\n                    .split('\\n')\n                    .map((line) => line.trim().length);\n                  const line = (cell.get('rawContents').split('\\n')[lineIndex] || '').trim();\n\n                  const padCount = columnWidths[columnIndex] - formattedLineLengths[lineIndex];\n\n                  return line + ' '.repeat(padCount);\n                })\n                .toJS()\n                .join(' | ')\n            )\n            .map((contentRow) => `| ${contentRow} |`);\n\n          const separator =\n            '|' + columnWidths.map((columnWidth) => '-'.repeat(columnWidth + 2)).join('+') + '|';\n\n          return contentRows.concat(separator);\n        })\n        .toJS()\n    )\n  );\n\n  return rowStrings.join('\\n');\n};\n\nconst listPartToRawText = (listPart) => {\n  const bulletCharacter = listPart.get('bulletCharacter');\n\n  let previousNumber = 0;\n  return listPart\n    .get('items')\n    .map((item) => {\n      const optionalLeadingSpace = !listPart.get('isOrdered') && bulletCharacter === '*' ? ' ' : '';\n\n      const titleText = attributedStringToRawText(item.get('titleLine'));\n\n      const contentText = attributedStringToRawText(item.get('contents'));\n      const indentedContentText = contentText\n        .split('\\n')\n        .map((line) => (!!line.trim() ? `${optionalLeadingSpace}  ${line}` : ''))\n        .join('\\n');\n\n      let listItemText = null;\n      if (listPart.get('isOrdered')) {\n        let number = ++previousNumber;\n        let forceNumber = item.get('forceNumber');\n        if (!!forceNumber) {\n          number = forceNumber;\n          previousNumber = number;\n        }\n\n        listItemText = `${number}${listPart.get('numberTerminatorCharacter')}`;\n\n        if (!!forceNumber) {\n          listItemText += ` [@${forceNumber}]`;\n        }\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      } else {\n        listItemText = `${optionalLeadingSpace}${bulletCharacter}`;\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      }\n\n      if (!!contentText) {\n        listItemText += `\\n${indentedContentText}`;\n      }\n\n      return listItemText;\n    })\n    .join('\\n');\n};\n\nconst timestampPartToRawText = (part) => {\n  let text = renderAsText(part.get('firstTimestamp'));\n  if (part.get('secondTimestamp')) {\n    text += `--${renderAsText(part.get('secondTimestamp'))}`;\n  }\n\n  return text;\n};\n\nexport const attributedStringToRawText = (parts) => {\n  if (!parts) {\n    return '';\n  }\n\n  const prevPartTypes = parts.map((part) => part.get('type')).unshift(null);\n\n  return parts\n    .zip(prevPartTypes)\n    .map(([part, prevPartType]) => {\n      let text = '';\n      switch (part.get('type')) {\n        case 'text':\n          text = part.get('contents');\n          break;\n        case 'link':\n          text = linkPartToRawText(part);\n          break;\n        case 'fraction-cookie':\n          text = `[${part.getIn(['fraction', 0]) || ''}/${part.getIn(['fraction', 1]) || ''}]`;\n          break;\n        case 'percentage-cookie':\n          text = `[${part.get('percentage') || ''}%]`;\n          break;\n        case 'table':\n          text = tablePartToRawText(part);\n          break;\n        case 'list':\n          text = listPartToRawText(part);\n          break;\n        case 'timestamp':\n          text = timestampPartToRawText(part);\n          break;\n        case 'url':\n        case 'www-url':\n        case 'e-mail':\n        case 'phone-number':\n          text = part.get('content');\n          break;\n        default:\n          console.error(\n            `Unknown attributed string part type in attributedStringToRawText: ${part.get('type')}`\n          );\n      }\n\n      const optionalNewlinePrefix = ['list', 'table'].includes(prevPartType) ? '\\n' : '';\n      return optionalNewlinePrefix + text;\n    })\n    .join('');\n};\n\n// Takes a plain JS object\nexport const generateTitleLine = (header, includeStars) => {\n  // Remove stars afterwards if not includeStars - because of :tag: alignment\n  let titleLine = '*'.repeat(header.nestingLevel);\n\n  if (header.titleLine.todoKeyword) {\n    titleLine += ` ${header.titleLine.todoKeyword}`;\n  }\n  titleLine += ` ${header.titleLine.rawTitle}`;\n\n  if (header.titleLine.tags.length) {\n    // TODO: filter()? Why would we add empty tags in the first place?\n    let tagsString = `:${header.titleLine.tags.filter((x) => x).join(':')}:`;\n    if (!titleLine.match(/\\s$/)) {\n      // Insert as many spaces as orgmode auto-formatting does:\n      let n = 77 - titleLine.length - tagsString.length;\n      let space = ' '.repeat(n > 0 ? n : 1);\n      titleLine += space;\n    }\n    titleLine += tagsString;\n  }\n\n  if (!includeStars) titleLine = titleLine.substring(1 + header.nestingLevel);\n  return titleLine;\n};\n\n/**\n * Convert state data into a fully rendered Orgmode file text.\n *\n * @param {*} headers Full list of org headings from redux state.\n * @param {*} linesBeforeHeadings Text that occurs before the first heading.\n * @param {boolean} dontIndent Default false means indent drawers according to\n * nesting level, else keep everything flush-left. Description is kept as is.\n */\nexport const exportOrg = ({ headers, linesBeforeHeadings, dontIndent }) => {\n  let configContent = linesBeforeHeadings.map((x) => x + '\\n').join('');\n  const headerContent = headers.map((x) => createRawDescriptionText(x, true, dontIndent)).join('');\n  return configContent + headerContent;\n};\n\n/**\n * Transform state data of complete org element / header into rendered text.\n *\n * @param {*} header Immutable map with header data\n * @param {boolean} includeTitle Render the full orgmode title\n * @param {boolean} dontIndent If true keep all text flush-left, else (DEFAULT) indent according to nesting level\n */\nexport const createRawDescriptionText = (header, includeTitle, dontIndent) => {\n  // To simplify access to properties:\n  const immutableHeader = header;\n  header = header.toJS();\n\n  // Pad things like planning items and tables appropriately\n  // considering the nestingLevel of the header, unless that is explicitly disabled\n  const indentation = dontIndent ? '' : ' '.repeat(header.nestingLevel + 1);\n  let contents = '';\n\n  if (includeTitle) {\n    contents += generateTitleLine(header, true) + '\\n';\n  }\n\n  // Special case: do not render planning items that are normal active timestamps\n  const planningItemsToRender = immutableHeader\n    .get('planningItems')\n    .filter(isRegularPlanningItem)\n    .toJS();\n  if (planningItemsToRender.length) {\n    const planningItemsContent = planningItemsToRender\n      .map((planningItem) => {\n        const timestampString = renderAsText(fromJS(planningItem.timestamp));\n        return `${planningItem.type}: ${timestampString}`;\n      })\n      .join(' ')\n      .trimRight();\n    contents += `${indentation}${planningItemsContent}\\n`;\n  }\n\n  if (header.propertyListItems.length) {\n    const propertyListItemsContent = header.propertyListItems\n      .map((propertyListItem) => {\n        return `${indentation}:${propertyListItem.property}: ${attributedStringToRawText(\n          fromJS(propertyListItem.value)\n        )}`;\n      })\n      .join('\\n');\n    contents += `${indentation}:PROPERTIES:\\n`;\n    contents += `${propertyListItemsContent}\\n`;\n    contents += `${indentation}:END:\\n`;\n  }\n\n  // Log notes come after properties and before logbook.\n  contents += attributedStringToRawText(fromJS(header.logNotes))\n    .split('\\n')\n    .map((line) => (line.trim() ? `${indentation}${line}` : ''))\n    .join('\\n');\n  contents += header.logNotes.length ? '\\n' : '';\n\n  if (header.logBookEntries.length) {\n    const logBookEntriesContent = header.logBookEntries\n      .map((entry) => {\n        if (entry.raw !== undefined) {\n          return entry.raw ? `${indentation}${entry.raw}` : '';\n        } else if (entry.end === null) {\n          return `${indentation}CLOCK: ${renderAsText(fromJS(entry.start))}`;\n        } else {\n          return `${indentation}CLOCK: ${renderAsText(fromJS(entry.start))}--${renderAsText(\n            fromJS(entry.end)\n          )} => ${timestampDuration(fromJS(entry.start), fromJS(entry.end))}`;\n        }\n      })\n      .join('\\n')\n      .trimRight();\n    contents += `${indentation}:LOGBOOK:\\n`;\n    contents += `${logBookEntriesContent}\\n`;\n    contents += `${indentation}:END:\\n`;\n  }\n\n  // A newline character belongs to its line, not to the next line.\n  // Unless rawDescription === '', it must have a trailing newline character.\n  let fixedRawDescription = header.rawDescription;\n  if (header.rawDescription.match(/[^\\n]$/)) fixedRawDescription = header.rawDescription + '\\n';\n  contents += fixedRawDescription;\n\n  return contents;\n};\n","import { Map } from 'immutable';\nimport format from 'date-fns/format';\nimport _ from 'lodash';\n\nexport default (templateString, customVariables = Map()) => {\n  if (!templateString) {\n    return ['', null];\n  }\n\n  const substitutions = {\n    '%t': `<${format(new Date(), 'yyyy-MM-dd eee')}>`,\n    '%T': `<${format(new Date(), 'yyyy-MM-dd eee HH:mm')}>`,\n    '%u': `[${format(new Date(), 'yyyy-MM-dd eee')}]`,\n    '%U': `[${format(new Date(), 'yyyy-MM-dd eee HH:mm')}]`,\n  };\n\n  customVariables.entrySeq().forEach(([key, value]) => {\n    substitutions[`%${key}`] = value;\n  });\n\n  let substitutedString = templateString;\n  _.entries(substitutions).forEach(\n    ([formatString, value]) =>\n      (substitutedString = substitutedString.replace(RegExp(formatString, 'g'), value))\n  );\n\n  const cursorIndex = substitutedString.includes('%?') ? substitutedString.indexOf('%?') : null;\n  substitutedString = substitutedString.replace(/%\\?/, '');\n\n  return [substitutedString, cursorIndex];\n};\n","import { List, fromJS } from 'immutable';\nimport _ from 'lodash';\nimport raw from 'raw.macro';\nimport { formatDistanceToNow } from 'date-fns';\n\nimport generateId from './id_generator';\nimport { attributedStringToRawText } from './export_org';\nimport substituteTemplateVariables from './capture_template_substitution';\n\nexport const STATIC_FILE_PREFIX = 'organice_internal_';\n\nfunction generateHash(list) {\n  return new Promise((resolve, reject) => {\n    if (crypto.subtle) {\n      crypto.subtle\n        .digest(\n          {\n            name: 'SHA-256',\n          },\n          new Uint8Array(list)\n        )\n        .then((hashArray) => {\n          resolve(_.values(new Uint8Array(hashArray)).join(''));\n        });\n    } else {\n      console.warn('crypto.subtle module is not available, returning an empty bogus hash.');\n      resolve('');\n    }\n  });\n}\n\nexport const changelogHash = () => {\n  return new Promise((resolve, reject) => {\n    const changelogFile = raw('../../changelog.org');\n\n    generateHash(changelogFile.split('').map((c) => c.charCodeAt(0))).then((hash) => {\n      resolve(hash);\n    });\n  });\n};\n\nexport const indexAndHeaderWithId = (headers, headerId) => {\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  return { headerIndex, header: headers.get(headerIndex) };\n};\n\nexport const indexOfHeaderWithId = (headers, headerId) => {\n  return headers.findIndex((header) => header.get('id') === headerId);\n};\n\nexport const headerWithId = (headers, headerId) => {\n  return headers.get(indexOfHeaderWithId(headers, headerId));\n};\n\nconst subheaderIndexRangeForHeaderIndex = (headers, headerIndex) => {\n  const header = headers.get(headerIndex);\n\n  const afterHeaders = headers.slice(headerIndex + 1);\n  const nextSiblingHeaderIndex = afterHeaders.findIndex((siblingHeader) => {\n    return siblingHeader.get('nestingLevel') <= header.get('nestingLevel');\n  });\n\n  if (nextSiblingHeaderIndex === -1) {\n    return [headerIndex + 1, headers.size];\n  } else {\n    return [headerIndex + 1, headerIndex + 1 + nextSiblingHeaderIndex];\n  }\n};\n\nconst subheaderIndexRangeForHeaderId = (headers, headerId) => {\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  return subheaderIndexRangeForHeaderIndex(headers, headerIndex);\n};\n\nexport const subheaderIndicesOfHeaderWithId = (headers, headerId) => {\n  let [begin, end] = subheaderIndexRangeForHeaderId(headers, headerId);\n  return _.range(begin, end);\n};\n\nexport const subheadersOfHeaderWithIndex = (headers, headerIndex) => {\n  let [begin, end] = subheaderIndexRangeForHeaderIndex(headers, headerIndex);\n  return headers.slice(begin, end);\n};\n\nexport const subheadersOfHeaderWithId = (headers, headerId) => {\n  let [begin, end] = subheaderIndexRangeForHeaderId(headers, headerId);\n  return headers.slice(begin, end);\n};\n\nexport const numSubheadersOfHeaderWithId = (headers, headerId) =>\n  subheadersOfHeaderWithId(headers, headerId).size;\n\nexport const directParentOfHeaderWithId = (headers, headerId) => {\n  const { header, headerIndex } = indexAndHeaderWithId(headers, headerId);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const previousHeader = headers.get(i);\n\n    if (previousHeader.get('nestingLevel') === header.get('nestingLevel') - 1) {\n      return previousHeader;\n    }\n\n    if (previousHeader.get('nestingLevel') < header.get('nestingLevel')) {\n      return null;\n    }\n  }\n\n  return null;\n};\n\nexport const directParentIdOfHeaderWithId = (headers, headerId) => {\n  const parent = directParentOfHeaderWithId(headers, headerId);\n  if (!parent) {\n    return null;\n  } else {\n    return parent.get('id');\n  }\n};\n\nexport const parentIdOfHeaderWithId = (headers, headerId) => {\n  const { header, headerIndex } = indexAndHeaderWithId(headers, headerId);\n\n  const previousHeaders = headers.slice(0, headerIndex);\n  const parentHeader = previousHeaders.findLast(\n    (previousHeader) => previousHeader.get('nestingLevel') < header.get('nestingLevel')\n  );\n\n  if (!parentHeader) {\n    return null;\n  }\n\n  return parentHeader.get('id');\n};\n\nexport const inheritedValueOfProperty = (headers, headerIndex, property) => {\n  const headerProp = headers\n    .getIn([headerIndex, 'propertyListItems'])\n    .find((item) => item.get('property') === property);\n  if (headerProp) {\n    return headerProp.get('value');\n  }\n  const parentId = parentIdOfHeaderWithId(headers, headers.getIn([headerIndex, 'id']));\n  if (parentId) {\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentId);\n    return inheritedValueOfProperty(headers, parentHeaderIndex, property);\n  }\n  return null;\n};\n\nexport const indexOfPreviousSibling = (headers, headerIndex) => {\n  const nestingLevel = headers.getIn([headerIndex, 'nestingLevel']);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const header = headers.get(i);\n\n    if (header.get('nestingLevel') < nestingLevel) {\n      return null;\n    }\n\n    if (header.get('nestingLevel') === nestingLevel) {\n      return i;\n    }\n  }\n\n  return null;\n};\n\nconst isHeaderVisible = (headers, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  if (!parentHeaderId) {\n    return true;\n  }\n\n  const parentHeader = headerWithId(headers, parentHeaderId);\n  return parentHeader.get('opened') && isHeaderVisible(headers, parentHeader.get('id'));\n};\n\nexport const nextVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const followingHeaders = headers.slice(headerIndex + 1);\n  return followingHeaders.find((header) => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const previousVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const previousHeaders = headers.slice(0, headerIndex).reverse();\n  return previousHeaders.find((header) => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const openDirectParent = (state, headerId) => {\n  const parentHeaderId = directParentIdOfHeaderWithId(state.get('headers'), headerId);\n  if (parentHeaderId !== null) {\n    const parentHeaderIndex = indexOfHeaderWithId(state.get('headers'), parentHeaderId);\n    state = state.setIn(['headers', parentHeaderIndex, 'opened'], true);\n  }\n\n  return state;\n};\n\nexport const getOpenHeaderPaths = (headers) => {\n  let openedHeaders = [];\n  for (let i = 0; i < headers.size; ++i) {\n    const header = headers.get(i);\n    if (!header.get('opened')) {\n      continue;\n    }\n\n    const title = header.getIn(['titleLine', 'rawTitle']);\n\n    const subheaders = subheadersOfHeaderWithId(headers, header.get('id'));\n    const openSubheaderPaths = getOpenHeaderPaths(subheaders);\n\n    if (openSubheaderPaths.length > 0) {\n      openSubheaderPaths.forEach((openedSubheaderPath) => {\n        openedHeaders.push([title].concat(openedSubheaderPath));\n      });\n    } else {\n      openedHeaders.push([title]);\n    }\n\n    i += subheaders.size;\n  }\n\n  return openedHeaders;\n};\n\nexport const headerWithPath = (headers, headerPath) => {\n  if (headerPath.size === 0) {\n    return null;\n  }\n\n  const firstHeader = headers.find(\n    (header) =>\n      parentIdOfHeaderWithId(headers, header.get('id')) === null &&\n      header.getIn(['titleLine', 'rawTitle']).trim() ===\n        substituteTemplateVariables(headerPath.first())[0].trim()\n  );\n  if (!firstHeader) {\n    return null;\n  }\n\n  if (headerPath.size === 1) {\n    return firstHeader;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, firstHeader.get('id'));\n  return headerWithPath(subheaders, headerPath.rest());\n};\n\nexport const openHeaderWithPath = (headers, headerPath, maxNestingLevel = 1) => {\n  if (headerPath.size === 0) {\n    return headers;\n  }\n\n  const firstTitle = headerPath.first();\n  const headerIndex = headers.findIndex((header) => {\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\n    const nestingLevel = header.get('nestingLevel');\n    return rawTitle === firstTitle && nestingLevel <= maxNestingLevel;\n  });\n  if (headerIndex === -1) {\n    return headers;\n  }\n\n  headers = headers.update(headerIndex, (header) => header.set('opened', true));\n\n  let subheaders = subheadersOfHeaderWithId(headers, headers.getIn([headerIndex, 'id']));\n  subheaders = openHeaderWithPath(subheaders, headerPath.rest(), maxNestingLevel + 1);\n\n  headers = headers\n    .take(headerIndex + 1)\n    .concat(subheaders)\n    .concat(headers.takeLast(headers.size - (headerIndex + 1 + subheaders.size)));\n\n  return headers;\n};\n\nconst tablePartContainsCellId = (tablePart, cellId) =>\n  tablePart\n    .get('contents')\n    .some((row) => row.get('contents').some((cell) => cell.get('id') === cellId));\n\nconst doesAttributedStringContainTableCellId = (parts, cellId) =>\n  parts\n    .filter((part) => ['table', 'list'].includes(part.get('type')))\n    .some((part) =>\n      part.get('type') === 'table'\n        ? tablePartContainsCellId(part, cellId)\n        : part\n            .get('items')\n            .some((item) => doesAttributedStringContainTableCellId(item.get('contents'), cellId))\n    );\n\nexport const headerThatContainsTableCellId = (headers, cellId) =>\n  headers.find((header) =>\n    doesAttributedStringContainTableCellId(header.get('description'), cellId)\n  );\n\nexport const pathAndPartOfTimestampItemWithIdInAttributedString = (parts, timestampId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'timestamp' && part.get('id') === timestampId) {\n        return {\n          path: [partIndex],\n          timestampPart: part,\n        };\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n              item.get('contents'),\n              timestampId\n            );\n            if (pathAndPart) {\n              const { path, timestampPart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                timestampPart,\n              };\n            } else {\n              let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                item.get('titleLine'),\n                timestampId\n              );\n              if (pathAndPart) {\n                const { path, timestampPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'titleLine'].concat(path),\n                  timestampPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter((result) => result)\n          .first();\n      } else if (part.get('type') === 'table') {\n        return part\n          .get('contents')\n          .map((row, rowIndex) => {\n            return row\n              .get('contents')\n              .map((cell, cellIndex) => {\n                const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                  cell.get('contents'),\n                  timestampId\n                );\n                if (pathAndPart) {\n                  const { path, timestampPart } = pathAndPart;\n                  return {\n                    path: [\n                      partIndex,\n                      'contents',\n                      rowIndex,\n                      'contents',\n                      cellIndex,\n                      'contents',\n                    ].concat(path),\n                    timestampPart,\n                  };\n                } else {\n                  return null;\n                }\n              })\n              .filter((result) => result)\n              .first();\n          })\n          .filter((result) => result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter((result) => result)\n    .first();\n\nexport const pathAndPartOfListItemWithIdInAttributedString = (parts, listItemId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            if (item.get('id') === listItemId) {\n              return {\n                path: [partIndex, 'items', itemIndex],\n                listItemPart: item,\n              };\n            } else {\n              const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n                item.get('contents'),\n                listItemId\n              );\n              if (pathAndPart) {\n                const { path, listItemPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                  listItemPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter((result) => result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter((result) => result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInAttributedString = (parts, cellId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'table') {\n        if (tablePartContainsCellId(part, cellId)) {\n          return { path: [partIndex], tablePart: part };\n        } else {\n          return null;\n        }\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n              item.get('contents'),\n              cellId\n            );\n            if (pathAndPart) {\n              const { path, tablePart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                tablePart,\n              };\n            } else {\n              return null;\n            }\n          })\n          .filter((result) => result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter((result) => result)\n    .first();\n\nexport const pathAndPartOfTimestampItemWithIdInHeaders = (headers, timestampId) => {\n  const makeResult = (headerIndex, pathAndPart, localPath) => ({\n    path: [headerIndex, ...localPath].concat(pathAndPart.path),\n    timestampPart: pathAndPart.timestampPart,\n  });\n\n  return headers\n    .map((header, headerIndex) => {\n      let localPath = ['titleLine', 'title'];\n      let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(localPath),\n        timestampId\n      );\n      if (pathAndPart) return makeResult(headerIndex, pathAndPart, localPath);\n\n      localPath = ['description'];\n      pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(localPath),\n        timestampId\n      );\n      if (pathAndPart) return makeResult(headerIndex, pathAndPart, localPath);\n\n      localPath = ['logNotes'];\n      pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(localPath),\n        timestampId\n      );\n      if (pathAndPart) return makeResult(headerIndex, pathAndPart, localPath);\n\n      pathAndPart = header\n        .get('propertyListItems')\n        .map((propertyListItem, propertyListItemIndex) => {\n          if (!propertyListItem.get('value')) {\n            return null;\n          }\n\n          const plistPathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n            propertyListItem.get('value'),\n            timestampId\n          );\n          localPath = ['propertyListItems', propertyListItemIndex, 'value'];\n          if (plistPathAndPart) return makeResult(headerIndex, plistPathAndPart, localPath);\n\n          return null;\n        })\n        .filter((result) => result)\n        .first();\n      if (pathAndPart) {\n        return pathAndPart;\n      }\n\n      return null;\n    })\n    .filter((result) => result)\n    .first();\n};\n\nexport const pathAndPartOfListItemWithIdInHeaders = (headers, listItemId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n        header.get('description'),\n        listItemId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, listItemPart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        listItemPart,\n      };\n    })\n    .filter((result) => result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInHeaders = (headers, cellId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n        header.get('description'),\n        cellId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, tablePart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        tablePart,\n      };\n    })\n    .filter((result) => result)\n    .first();\n\nexport const updateTableContainingCellId = (headers, cellId, updaterCallbackGenerator) => {\n  const { path, tablePart } = pathAndPartOfTableContainingCellIdInHeaders(headers, cellId);\n\n  const rowIndexContainingCellId = tablePart\n    .get('contents')\n    .findIndex((row) => row.get('contents').some((cell) => cell.get('id') === cellId));\n  const columnIndexContainingCellId = tablePart\n    .getIn(['contents', rowIndexContainingCellId, 'contents'])\n    .findIndex((cell) => cell.get('id') === cellId);\n\n  return headers.updateIn(\n    path.concat(['contents']),\n    updaterCallbackGenerator(rowIndexContainingCellId, columnIndexContainingCellId)\n  );\n};\n\nexport const newEmptyTableRowLikeRows = (rows) =>\n  rows\n    .get(0)\n    .set('id', generateId())\n    .update('contents', (contents) =>\n      contents.map((cell) =>\n        cell.set('id', generateId()).set('contents', List()).set('rawContents', '')\n      )\n    );\n\nexport const newEmptyTableCell = () =>\n  fromJS({\n    id: generateId(),\n    contents: [],\n    rawContents: '',\n  });\n\nexport const timestampWithIdInAttributedString = (parts, timestampId) => {\n  if (!parts) {\n    return null;\n  }\n\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(parts, timestampId);\n  if (pathAndPart) {\n    return pathAndPart.timestampPart;\n  } else {\n    return null;\n  }\n};\n\nexport const timestampWithId = (headers, timestampId) =>\n  headers\n    .map(\n      (header) =>\n        timestampWithIdInAttributedString(header.getIn(['titleLine', 'title']), timestampId) ||\n        timestampWithIdInAttributedString(header.get('description'), timestampId) ||\n        timestampWithIdInAttributedString(header.get('logNotes'), timestampId) ||\n        header\n          .get('propertyListItems')\n          .map((propertyListItem) =>\n            timestampWithIdInAttributedString(propertyListItem.get('value'), timestampId)\n          )\n          .filter((result) => result)\n          .first()\n    )\n    .find((result) => result);\n\nexport const customFormatDistanceToNow = (datetime) => {\n  return formatDistanceToNow(datetime, { addSuffix: true });\n};\n\nexport const todoKeywordSetForKeyword = (todoKeywordSets, keyword) =>\n  todoKeywordSets.find((keywordSet) => keywordSet.get('keywords').contains(keyword)) ||\n  todoKeywordSets.first();\n\nexport const isTodoKeywordCompleted = (todoKeywordSets, keyword) =>\n  todoKeywordSetForKeyword(todoKeywordSets, keyword).get('completedKeywords').includes(keyword);\n\nexport const extractAllOrgTags = (headers) =>\n  headers\n    .flatMap((h) => h.getIn(['titleLine', 'tags']))\n    .toSet()\n    .sort();\n\nexport const extractAllOrgProperties = (headers) =>\n  headers\n    .map((h) => {\n      const propertyList = h.get('propertyListItems');\n      return propertyList.map((property) => {\n        const prop = property.get('property');\n        const valParts = property.get('value'); // lineParts, see parser\n        const val = attributedStringToRawText(valParts);\n        return [prop, val];\n      });\n    })\n    .filter((x) => !x.isEmpty())\n    .flatten();\n\nexport const computeAllPropertyNames = (allOrgProperties) =>\n  allOrgProperties\n    .map(([x]) => x)\n    .toSet()\n    .sort();\n\nexport const computeAllPropertyValuesFor = (allOrgProperties, propertyName) =>\n  // toLowerCase() because property names (keys) are case-insensitive:\n  // https://orgmode.org/manual/Property-Syntax.html\n  allOrgProperties\n    .filter(([x]) => x.toLowerCase() === propertyName.toLowerCase())\n    .map(([_, y]) => y)\n    .toSet()\n    .sort();\n\n/**\n * Returns `true` if the header has content, i.e. description.\n * Subheaders do not count as content.\n */\nexport const hasHeaderContent = (header) =>\n  header.get('rawDescription') ||\n  !header.get('planningItems').isEmpty() ||\n  !header.get('propertyListItems').isEmpty() ||\n  !header.get('logNotes').isEmpty() ||\n  !header.get('logBookEntries').isEmpty();\n\n/**\n * Returns a function which takes a `todoKeyword` which then returns\n * if said `todoKeyword` is in any `todoKeywordSets` states.\n * @param {Object} todoKeywordSets\n */\nexport const createIsTodoKeywordInDoneState = (todoKeywordSets) => {\n  return (todoKeyword) =>\n    todoKeywordSets.some((x) => x.get('completedKeywords').includes(todoKeyword));\n};\n\n// Regular planning items in org are written directly below headline and have type SCHEDULED, DEADLINE, CLOSED.\nexport const isRegularPlanningItem = (x) => !x.get('type').startsWith('TIMESTAMP_');\n\nexport const getPlanningItemTypeText = (planningItem) =>\n  isRegularPlanningItem(planningItem) ? planningItem.get('type') : 'TIMESTAMP';\n\nexport const getTodoKeywordSetsAsFlattenedArray = (state) => {\n  return state\n    .get('todoKeywordSets')\n    .flatMap((todoKeywordSet) => {\n      return todoKeywordSet.get('keywords');\n    })\n    .toSet()\n    .toJS();\n};\n\n/** Regular expression of file extensions to validate a filename. */\nexport const orgFileExtensions = /\\.org(_archive)?$/;\n\nconst addBreadcrumbs = (headers, breadcrumbs, headerId) => {\n  const parent = directParentOfHeaderWithId(headers, headerId);\n  if (!parent) {\n    return breadcrumbs;\n  }\n  breadcrumbs.unshift(parent.get('titleLine').get('rawTitle'));\n  return addBreadcrumbs(headers, breadcrumbs, parent.get('id'));\n};\n\nconst getBreadcrumbs = (headers, headerId) => {\n  return addBreadcrumbs(headers, [], headerId);\n};\n\nexport const getBreadcrumbsStringFunction = (allHeaders, path) => {\n  const allHeadersOfFile = allHeaders.get(path);\n\n  let filename;\n  if (path.startsWith(STATIC_FILE_PREFIX)) {\n    filename = path.substring(STATIC_FILE_PREFIX.length);\n  } else if (path.endsWith('.org')) {\n    filename = path.substring(path.lastIndexOf('/') + 1, path.lastIndexOf('.'));\n  } else {\n    filename = path.substring(path.lastIndexOf('/') + 1);\n  }\n\n  return (header) => {\n    let breadcrumbs = getBreadcrumbs(allHeadersOfFile, header.get('id'));\n    breadcrumbs.unshift(filename);\n    const maxBreadcrumbLength = Math.max(\n      3,\n      Math.floor((80 - 3 * breadcrumbs.length) / breadcrumbs.length)\n    );\n    breadcrumbs = breadcrumbs.map((b) =>\n      b.length > maxBreadcrumbLength ? b.substr(0, maxBreadcrumbLength - 2) + '..' : b\n    );\n    return breadcrumbs.join(' > ');\n  };\n};\n","import { parseFile, resetFileDisplay, setPath } from './org';\nimport { STATIC_FILE_PREFIX } from '../lib/org_utils';\n\nimport raw from 'raw.macro';\n\nexport const setLoadingMessage = (loadingMessage) => ({\n  type: 'SET_LOADING_MESSAGE',\n  loadingMessage,\n});\n\nexport const hideLoadingMessage = () => ({\n  type: 'HIDE_LOADING_MESSAGE',\n});\n\nexport const setIsLoading = (isLoading, path) => ({\n  type: 'SET_IS_LOADING',\n  isLoading,\n  path,\n});\n\nexport const setIsOnline = (online) => ({\n  type: 'SET_IS_ONLINE',\n  online,\n});\n\nexport const setDisappearingLoadingMessage = (loadingMessage, delay) => (dispatch) => {\n  dispatch(setLoadingMessage(loadingMessage));\n  setTimeout(() => dispatch(hideLoadingMessage()), delay);\n};\n\nexport const setLastViewedFile = (lastViewedPath) => ({\n  type: 'SET_LAST_VIEWED_FILE',\n  lastViewedPath,\n});\n\nexport const restoreStaticFile = (staticFile, lastViewedFilePath) => {\n  return (dispatch) => {\n    dispatch(setLastViewedFile(lastViewedFilePath));\n\n    const fileContents = {\n      changelog: raw('../../changelog.org'),\n      sample: raw('../../sample.org'),\n    }[staticFile];\n\n    dispatch(parseFile(STATIC_FILE_PREFIX + staticFile, fileContents));\n  };\n};\n\nexport const unloadStaticFile = () => {\n  return (dispatch, getState) => {\n    dispatch(resetFileDisplay());\n\n    const path = getState().base.get('lastViewedPath');\n    if (!!path) {\n      dispatch(setPath(path));\n    }\n  };\n};\n\nexport const setFontSize = (newFontSize) => ({\n  type: 'SET_FONT_SIZE',\n  newFontSize,\n});\n\nexport const setBulletStyle = (newBulletStyle) => ({\n  type: 'SET_BULLET_STYLE',\n  newBulletStyle,\n});\n\nexport const setShouldTapTodoToAdvance = (newShouldTapTodoToAdvance) => ({\n  type: 'SET_SHOULD_TAP_TODO_TO_ADVANCE',\n  newShouldTapTodoToAdvance,\n});\n\nexport const setAgendaDefaultDeadlineDelayUnit = (newAgendaDefaultDeadlineDelayUnit) => ({\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT',\n  newAgendaDefaultDeadlineDelayUnit,\n});\n\nexport const setAgendaDefaultDeadlineDelayValue = (newAgendaDefaultDeadlineDelayValue) => ({\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE',\n  newAgendaDefaultDeadlineDelayValue,\n});\n\nexport const setAgendaStartOnWeekday = (newAgendaStartOnWeekday) => ({\n  type: 'SET_AGENDA_START_ON_WEEKDAY',\n  newAgendaStartOnWeekday,\n});\n\nexport const setShouldLiveSync = (shouldLiveSync) => ({\n  type: 'SET_SHOULD_LIVE_SYNC',\n  shouldLiveSync,\n});\n\nexport const setShouldSyncOnBecomingVisibile = (shouldSyncOnBecomingVisibile) => ({\n  type: 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE',\n  shouldSyncOnBecomingVisibile,\n});\n\nexport const setShouldShowTitleInOrgFile = (shouldShowTitleInOrgFile) => ({\n  type: 'SET_SHOULD_SHOW_TITLE_IN_ORG_FILE',\n  shouldShowTitleInOrgFile,\n});\n\nexport const setShouldLogIntoDrawer = (shouldLogIntoDrawer) => ({\n  type: 'SET_SHOULD_LOG_INTO_DRAWER',\n  shouldLogIntoDrawer,\n});\n\nexport const setCloseSubheadersRecursively = (closeSubheadersRecursively) => ({\n  type: 'SET_CLOSE_SUBHEADERS_RECURSIVELY',\n  closeSubheadersRecursively,\n});\n\nexport const setShouldNotIndentOnExport = (shouldNotIndentOnExport) => ({\n  type: 'SET_SHOULD_NOT_INDENT_ON_EXPORT',\n  shouldNotIndentOnExport,\n});\n\nexport const setShouldStoreSettingsInSyncBackend = (newShouldStoreSettingsInSyncBackend) => {\n  return (dispatch, getState) => {\n    dispatch({\n      type: 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND',\n      newShouldStoreSettingsInSyncBackend,\n    });\n\n    if (!newShouldStoreSettingsInSyncBackend) {\n      const client = getState().syncBackend.get('client');\n      switch (client.type) {\n        case 'Dropbox':\n        case 'WebDAV':\n          client\n            .deleteFile('/.organice-config.json')\n            .catch((doesFileNotExist, error) =>\n              doesFileNotExist\n                ? null\n                : alert(\n                    `There was an error trying to delete the .organice-config.json file: ${error}`\n                  )\n            );\n          break;\n        case 'Google Drive':\n          client.deleteFileByNameAndParent('.organice-config.json', 'root');\n          break;\n        default:\n      }\n\n      window.previousSettingsFileContents = null;\n    }\n  };\n};\n\nexport const setColorScheme = (colorScheme) => ({\n  type: 'SET_COLOR_SCHEME',\n  colorScheme,\n});\n\nexport const setTheme = (theme) => ({\n  type: 'SET_THEME',\n  theme,\n});\n\nexport const setHasUnseenChangelog = (newHasUnseenChangelog) => ({\n  type: 'SET_HAS_UNSEEN_CHANGELOG',\n  newHasUnseenChangelog,\n});\n\nexport const setLastSeenChangelogHeader = (newLastSeenChangelogHash) => ({\n  type: 'SET_LAST_SEEN_CHANGELOG_HEADER',\n  newLastSeenChangelogHash,\n});\n\nexport const setCustomKeybinding = (keybindingName, keybinding) => ({\n  type: 'SET_CUSTOM_KEYBINDING',\n  keybindingName,\n  keybinding,\n});\n\nexport const restoreBaseSettings = (newSettings) => ({\n  type: 'RESTORE_BASE_SETTINGS',\n  newSettings,\n});\n\nexport const pushModalPage = (modalPage) => ({\n  type: 'PUSH_MODAL_PAGE',\n  modalPage,\n});\n\nexport const popModalPage = () => ({\n  type: 'POP_MODAL_PAGE',\n});\n\nexport const clearModalStack = () => ({\n  type: 'CLEAR_MODAL_STACK',\n});\n\nexport const activatePopup = (popupType, data) => ({\n  type: 'ACTIVATE_POPUP',\n  popupType,\n  data,\n});\n\nexport const closePopup = () => ({\n  type: 'CLOSE_POPUP',\n});\n\nexport const setAgendaTimeframe = (agendaTimeframe) => (dispatch) =>\n  dispatch({\n    type: 'SET_AGENDA_TIMEFRAME',\n    agendaTimeframe,\n  });\n","import generateId from './id_generator';\n\nimport { fromJS } from 'immutable';\n\nexport default fromJS([\n  {\n    description: 'Groceries',\n    headerPaths: ['Capture', 'Groceries'],\n    iconName: 'lemon',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: false,\n    template: '* TODO %?',\n    isSample: true,\n  },\n  {\n    description: 'Deeply nested header',\n    headerPaths: ['Capture', 'Deeply', 'Nested', 'Headers', 'Work', 'Too!'],\n    iconName: 'fighter-jet',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: true,\n    template: '* You can insert timestamps too! %T %?',\n    isSample: true,\n  },\n]);\n","export const addNewEmptyCaptureTemplate = () => ({\n  type: 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE',\n});\n\nexport const updateTemplateFieldPathValue = (templateId, fieldPath, newValue) => ({\n  type: 'UPDATE_TEMPLATE_FIELD_PATH_VALUE',\n  templateId,\n  fieldPath,\n  newValue,\n});\n\nexport const addNewTemplateOrgFileAvailability = (templateId) => ({\n  type: 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n});\n\nexport const removeTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) => ({\n  type: 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n  orgFileAvailabilityIndex,\n});\n\nexport const addNewTemplateHeaderPath = (templateId) => ({\n  type: 'ADD_NEW_TEMPLATE_HEADER_PATH',\n  templateId,\n});\n\nexport const removeTemplateHeaderPath = (templateId, headerPathIndex) => ({\n  type: 'REMOVE_TEMPLATE_HEADER_PATH',\n  templateId,\n  headerPathIndex,\n});\n\nexport const deleteTemplate = (templateId) => ({\n  type: 'DELETE_TEMPLATE',\n  templateId,\n});\n\nexport const restoreCaptureSettings = (newSettings) => ({\n  type: 'RESTORE_CAPTURE_SETTINGS',\n  newSettings,\n});\n\nexport const reorderCaptureTemplate = (fromIndex, toIndex) => ({\n  type: 'REORDER_CAPTURE_TEMPLATE',\n  fromIndex,\n  toIndex,\n});\n","import { Map, List, Set, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport { getOpenHeaderPaths } from '../lib/org_utils';\n\nimport { restoreBaseSettings } from '../actions/base';\nimport { restoreCaptureSettings } from '../actions/capture';\nimport { restoreFileSettings } from '../actions/org';\n\nimport generateId from '../lib/id_generator';\nimport { loadFilesFromLocalStorage } from './file_persister';\n\nexport const localStorageAvailable = (() => {\n  try {\n    localStorage.setItem('test', 'test');\n    const localStorageRes = localStorage.getItem('test') === 'test';\n    localStorage.removeItem('test');\n    return localStorageRes && localStorage;\n  } catch (e) {\n    return false;\n  }\n})();\n\nconst debouncedPushConfigToSyncBackend = _.debounce(\n  (syncBackendClient, contents) => {\n    switch (syncBackendClient.type) {\n      case 'Dropbox':\n      case 'WebDAV':\n        syncBackendClient\n          .createFile('/.organice-config.json', contents)\n          .catch((error) =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      case 'Google Drive':\n        syncBackendClient\n          .createFile('.organice-config.json', 'root', contents)\n          .catch((error) =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      default:\n    }\n  },\n  1000,\n  { maxWait: 3000 }\n);\n\nexport const persistableFields = [\n  {\n    category: 'base',\n    name: 'fontSize',\n    type: 'nullable',\n  },\n  {\n    category: 'base',\n    name: 'bulletStyle',\n    type: 'nullable',\n    default: 'Fancy',\n  },\n  {\n    category: 'base',\n    name: 'shouldTapTodoToAdvance',\n    type: 'boolean',\n  },\n\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayUnit',\n    type: 'nullable',\n  },\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayValue',\n    type: 'nullable',\n  },\n  {\n    category: 'base',\n    name: 'agendaStartOnWeekday',\n    type: 'nullable',\n    default: 1,\n  },\n\n  {\n    category: 'base',\n    name: 'shouldStoreSettingsInSyncBackend',\n    type: 'boolean',\n    default: true,\n  },\n  {\n    category: 'base',\n    name: 'lastSeenChangelogHash',\n    type: 'nullable',\n  },\n  {\n    category: 'base',\n    name: 'customKeybindings',\n    type: 'json',\n  },\n  {\n    category: 'base',\n    name: 'shouldLiveSync',\n    type: 'boolean',\n    default: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldSyncOnBecomingVisibile',\n    type: 'boolean',\n    default: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldShowTitleInOrgFile',\n    type: 'boolean',\n  },\n  {\n    category: 'base',\n    name: 'shouldLogIntoDrawer',\n    type: 'boolean',\n  },\n  {\n    category: 'base',\n    name: 'closeSubheadersRecursively',\n    type: 'boolean',\n  },\n  {\n    category: 'base',\n    name: 'shouldNotIndentOnExport',\n    type: 'boolean',\n  },\n  {\n    category: 'org',\n    name: 'showClockDisplay',\n    type: 'boolean',\n  },\n  {\n    category: 'base',\n    name: 'colorScheme',\n    type: 'string',\n    default: 'Light',\n  },\n  {\n    category: 'base',\n    name: 'theme',\n    type: 'string',\n    default: 'Solarized',\n  },\n  {\n    category: 'capture',\n    name: 'captureTemplates',\n    type: 'json',\n    default: List(),\n  },\n  {\n    category: 'org',\n    name: 'fileSettings',\n    type: 'json',\n    default: List(),\n  },\n  {\n    category: 'base',\n    name: 'agendaTimeframe',\n    type: 'string',\n    default: 'Week',\n  },\n];\n\nexport const readOpennessState = () => {\n  const opennessStateJSONString = localStorage.getItem('headerOpenness');\n  return !!opennessStateJSONString ? JSON.parse(opennessStateJSONString) : null;\n};\n\nconst getFieldsToPersist = (state, fields) => {\n  return fields\n    .filter((field) => !field.depreacted)\n    .filter((field) => field.category === 'org')\n    .map((field) =>\n      field.type === 'json'\n        ? [field.name, JSON.stringify(state.org.present.get(field.name) || field.default || {})]\n        : [field.name, state.org.present.get(field.name)]\n    )\n    .concat(\n      persistableFields\n        .filter((field) => field.category !== 'org')\n        .map((field) => {\n          return field.type === 'json'\n            ? [\n                field.name,\n                JSON.stringify(state[field.category].get(field.name) || field.default || {}),\n              ]\n            : [field.name, state[field.category].get(field.name) || field.default];\n        })\n    );\n};\n\nconst getConfigFileContents = (fieldsToPersist) => {\n  return JSON.stringify(_.fromPairs(fieldsToPersist), null, 2);\n};\n\nexport const applyCategorySettingsFromConfig = (state, config, category) => {\n  persistableFields\n    .filter((field) => field.category === category)\n    .forEach((field) => {\n      field.type === 'json'\n        ? (state = state.set(field.name, fromJS(JSON.parse(config[field.name]))))\n        : (state = state.set(field.name, config[field.name]));\n    });\n\n  return state;\n};\n\nexport const applyCaptureSettingsFromConfig = (state, config) => {\n  const captureTemplates = fromJS(JSON.parse(config.captureTemplates)).map((template) =>\n    template.set('id', generateId())\n  );\n\n  return state.set('captureTemplates', captureTemplates);\n};\nexport const applyFileSettingsFromConfig = (state, config) => {\n  const fileSettings = fromJS(JSON.parse(config.fileSettings)).map((setting) =>\n    setting.set('id', generateId())\n  );\n\n  return state.set('fileSettings', fileSettings);\n};\n\nconst getInitialStateWithDefaultValues = () => {\n  let initialState = {\n    syncBackend: Map(),\n    org: {\n      past: [],\n      present: Map({\n        files: Map(),\n        fileSettings: [],\n        opennessState: Map(),\n        search: Map({\n          searchFilter: '',\n          searchFilterExpr: [],\n        }),\n      }),\n      future: [],\n    },\n    base: Map({ isLoading: Set() }),\n    capture: Map(),\n  };\n\n  persistableFields.forEach((field) => {\n    const value = field.default;\n\n    if (field.category === 'org') {\n      initialState[field.category].present = initialState[field.category].present.set(\n        field.name,\n        value\n      );\n    } else {\n      initialState[field.category] = initialState[field.category].set(field.name, value);\n    }\n  });\n\n  return initialState;\n};\n\nconst loadContentFromLocalStorage = (initialState) => {\n  persistableFields.forEach((field) => {\n    let value = localStorage.getItem(field.name);\n\n    if (field.type === 'nullable') {\n      if (value === 'null') {\n        value = null;\n      }\n    } else if (field.type === 'boolean') {\n      value = value === 'true';\n    } else if (field.type === 'json') {\n      if (!value) {\n        value = field.default || Map();\n      } else {\n        value = fromJS(JSON.parse(value));\n      }\n    }\n    // When nothing has been saved to localStorage before, keep the default.\n    value = value || field.default;\n\n    if (field.category === 'org') {\n      initialState[field.category].present = initialState[field.category].present.set(\n        field.name,\n        value\n      );\n    } else {\n      initialState[field.category] = initialState[field.category].set(field.name, value);\n    }\n  });\n\n  // Assign new ids to the capture templates.\n  if (initialState.capture.get('captureTemplates')) {\n    initialState.capture = initialState.capture.update('captureTemplates', (templates) =>\n      templates.map((template) => template.set('id', generateId()))\n    );\n  }\n  // Assign new ids to the file settings.\n  if (initialState.org.present.get('fileSettings')) {\n    initialState.org.present = initialState.org.present.update('fileSettings', (settings) =>\n      settings.map((setting) => setting.set('id', generateId()))\n    );\n  }\n\n  const opennessState = readOpennessState();\n  if (!!opennessState) {\n    initialState.org.present = initialState.org.present.set('opennessState', fromJS(opennessState));\n  }\n\n  // Cache the config file contents locally so we don't overwrite on\n  // initial page load.\n  window.previousSettingsFileContents = getConfigFileContents(\n    getFieldsToPersist(initialState, persistableFields)\n  );\n\n  return loadFilesFromLocalStorage(initialState);\n};\n\nexport const readInitialState = () => {\n  let initialState = getInitialStateWithDefaultValues();\n\n  return localStorageAvailable ? loadContentFromLocalStorage(initialState) : initialState;\n};\n\nexport const loadSettingsFromConfigFile = (dispatch, getState) => {\n  const syncBackendClient = getState().syncBackend.get('client');\n  if (!syncBackendClient) {\n    return;\n  }\n\n  let fileContentsPromise = null;\n  switch (syncBackendClient.type) {\n    case 'Dropbox':\n    case 'WebDAV':\n      fileContentsPromise = syncBackendClient.getFileContents('/.organice-config.json');\n      break;\n    case 'Google Drive':\n      fileContentsPromise = syncBackendClient.getFileContentsByNameAndParent(\n        '.organice-config.json',\n        'root'\n      );\n      break;\n    default:\n  }\n\n  fileContentsPromise\n    .then((configFileContents) => {\n      try {\n        const config = JSON.parse(configFileContents);\n        dispatch(restoreBaseSettings(config));\n        dispatch(restoreCaptureSettings(config));\n        dispatch(restoreFileSettings(config));\n      } catch (_error) {\n        // Something went wrong parsing the config file, but we don't care, we'll just\n        // overwrite it with a good local copy.\n      }\n    })\n    .catch(() => {});\n};\n\nexport const subscribeToChanges = (store) => {\n  if (!localStorageAvailable) {\n    return () => {};\n  } else {\n    return () => {\n      const state = store.getState();\n\n      const fieldsToPersist = getFieldsToPersist(state, persistableFields);\n\n      fieldsToPersist.forEach(([name, value]) => {\n        if (name && value) localStorage.setItem(name, value);\n      });\n\n      if (state.base.get('shouldStoreSettingsInSyncBackend')) {\n        const settingsFileContents = getConfigFileContents(fieldsToPersist);\n\n        if (window.previousSettingsFileContents !== settingsFileContents) {\n          debouncedPushConfigToSyncBackend(state.syncBackend.get('client'), settingsFileContents);\n        }\n\n        window.previousSettingsFileContents = settingsFileContents;\n      }\n\n      const currentFilePath = state.org.present.get('path');\n      const headers = state.org.present.getIn(['files', currentFilePath, 'headers']);\n      if (!!currentFilePath && headers) {\n        const openHeaderPaths = getOpenHeaderPaths(headers);\n\n        let opennessState = {};\n        const opennessStateJSONString = localStorage.getItem('headerOpenness');\n        if (opennessStateJSONString) {\n          opennessState = JSON.parse(opennessStateJSONString);\n        }\n\n        opennessState[currentFilePath] = openHeaderPaths;\n        localStorage.setItem('headerOpenness', JSON.stringify(opennessState));\n      }\n    };\n  }\n};\n\nexport const persistField = (field, value) => {\n  if (!localStorageAvailable) {\n    return;\n  } else {\n    localStorage.setItem(field, value);\n  }\n};\n\nexport const getPersistedField = (field, nullable = false) => {\n  if (!localStorageAvailable) {\n    return null;\n  } else {\n    const value = localStorage.getItem(field);\n    if (nullable) {\n      return value === 'null' ? null : value;\n    } else {\n      return value;\n    }\n  }\n};\n","// Matcher\n\nimport { fromJS } from 'immutable';\nimport {\n  startOfHour,\n  startOfDay,\n  startOfWeek,\n  startOfMonth,\n  startOfYear,\n  endOfHour,\n  endOfDay,\n  endOfWeek,\n  endOfMonth,\n  endOfYear,\n} from 'date-fns';\nimport { attributedStringToRawText } from './export_org.js';\nimport { computeAllPropertyNames, computeAllPropertyValuesFor } from './org_utils';\nimport {\n  addTimestampUnitToDate,\n  subtractTimestampUnitFromDate,\n  dateForTimestamp,\n} from './timestamps';\n\nconst startOfDate = (from) => {\n  const temp = new Date();\n  temp.setFullYear(from.year);\n  if (from.month === null) {\n    return startOfYear(temp);\n  } else if (from.day === null) {\n    temp.setMonth(from.month - 1);\n    return startOfMonth(temp);\n  } else {\n    temp.setMonth(from.month - 1);\n    temp.setDate(from.day);\n    return startOfDay(temp);\n  }\n};\n\nconst endOfDate = (to) => {\n  const temp = new Date();\n  temp.setFullYear(to.year);\n  if (to.month === null) {\n    return endOfYear(temp);\n  } else if (to.day === null) {\n    temp.setMonth(to.month - 1);\n    return endOfMonth(temp);\n  } else {\n    temp.setMonth(to.month - 1);\n    temp.setDate(to.day);\n    return endOfDay(temp);\n  }\n};\n\nconst fromSpecial = (from) => {\n  const temp = new Date();\n  if (from.value === 'now') {\n    return temp;\n  } else if (from.value === 'today') {\n    return startOfDay(temp);\n  }\n};\n\nconst toSpecial = (to) => {\n  const temp = new Date();\n  if (to.value === 'now') {\n    return temp;\n  } else if (to.value === 'today') {\n    return endOfDay(temp);\n  }\n};\n\nconst fromUnit = (date, unit) => {\n  const d = new Date(date);\n  switch (unit) {\n    case 'h':\n      return startOfHour(d);\n    case 'd':\n      return startOfDay(d);\n    case 'w':\n      return startOfWeek(d);\n    case 'm':\n      return startOfMonth(d);\n    case 'y':\n      return startOfYear(d);\n    default:\n      throw Error('unknown `unit` for timerange search');\n  }\n};\n\nconst toUnit = (date, unit) => {\n  const d = new Date(date);\n  switch (unit) {\n    case 'h':\n      return endOfHour(d);\n    case 'd':\n      return endOfDay(d);\n    case 'w':\n      return endOfWeek(d);\n    case 'm':\n      return endOfMonth(d);\n    case 'y':\n      return endOfYear(d);\n    default:\n      throw Error('unknown `unit` for timerange search');\n  }\n};\n\nconst resolveFrom = (from) => {\n  if (from === null) {\n    return new Date();\n  } else if (from.type === 'timestamp') {\n    return startOfDate(from);\n  } else if (from.type === 'special') {\n    return fromSpecial(from);\n  } else if (from.type === 'offset') {\n    return subtractTimestampUnitFromDate(new Date(), from.value, from.unit);\n  } else if (from.type === 'unit') {\n    return fromUnit(new Date(), from.unit);\n  }\n};\n\nconst resolveTo = (to) => {\n  if (to === null) {\n    return new Date();\n  } else if (to.type === 'timestamp') {\n    return endOfDate(to);\n  } else if (to.type === 'special') {\n    return toSpecial(to);\n  } else if (to.type === 'offset') {\n    return addTimestampUnitToDate(new Date(), to.value, to.unit);\n  } else if (to.type === 'unit') {\n    return toUnit(new Date(), to.unit);\n  }\n};\n\nconst isRelative = (moment) => {\n  return moment.type === 'offset' || moment.type === 'unit';\n};\n\nexport const timeFilter = (filterDescription) => {\n  const timeFilterDescription = filterDescription.field.timerange;\n  let lower;\n  let upper;\n  if (timeFilterDescription.type === 'point') {\n    const point = timeFilterDescription.point;\n    if (point.type === 'offset') {\n      lower = new Date();\n      upper = addTimestampUnitToDate(new Date(lower));\n    } else {\n      lower = resolveFrom(point);\n      upper = resolveTo(point);\n    }\n    return (timestamp) =>\n      lower <= dateForTimestamp(timestamp) && dateForTimestamp(timestamp) <= upper;\n  } else if (timeFilterDescription.type === 'range') {\n    const from = timeFilterDescription.from\n      ? timeFilterDescription.from\n      : { type: 'special', value: 'now' };\n    const to = timeFilterDescription.to\n      ? timeFilterDescription.to\n      : { type: 'special', value: 'now' };\n    let lower;\n    let upper;\n    if (isRelative(from) === isRelative(to)) {\n      lower = resolveFrom(from);\n      upper = resolveTo(to);\n    } else if (from.type === 'offset') {\n      upper = resolveTo(to);\n      lower = subtractTimestampUnitFromDate(new Date(upper), from.value, from.unit);\n    } else if (to.type === 'offset') {\n      lower = resolveFrom(from);\n      upper = addTimestampUnitToDate(new Date(lower), to.value, to.unit);\n    } else if (from.type === 'unit') {\n      upper = resolveTo(to);\n      lower = fromUnit(upper, from.unit);\n    } else if (to.type === 'unit') {\n      lower = resolveFrom(from);\n      upper = toUnit(lower, to.unit);\n    } else {\n      throw Error('unable to construct timerangefilter');\n    }\n    return (timestamp) =>\n      lower <= dateForTimestamp(timestamp) && dateForTimestamp(timestamp) <= upper;\n  } else if (timeFilterDescription.type === 'all') {\n    return (_) => true;\n  } else {\n    throw Error('unable to construct timefilter');\n  }\n};\n\nconst orChain = (source) => (xs) => xs.some((x) => source.includes(x));\nconst orChainDate = (dates) => (filter) => dates.size !== 0 && dates.some((x) => filter(x));\n\nexport const isMatch = (filterExpr) => {\n  const filterFilter = (type, exclude) => (x) => x.type === type && x.exclude === exclude;\n  const words = (x) => x.words;\n  const wordsLowerCase = (x) => x.words.map((y) => y.toLowerCase());\n\n  const filterTags = filterExpr.filter(filterFilter('tag', false)).map(words);\n  const filterCS = filterExpr.filter(filterFilter('case-sensitive', false)).map(words);\n  const filterIC = filterExpr.filter(filterFilter('ignore-case', false)).map(wordsLowerCase);\n  const filterProps = filterExpr\n    .filter(filterFilter('property', false))\n    .map((x) => [x.property, x.words]);\n  const filterField = filterExpr.filter(filterFilter('field', false));\n  const filterDate = filterField.filter((f) => f.field.type === 'date').map(timeFilter);\n  //const filterClock = filterField.filter((f) => f.field.type === 'clock').map(timeFilter);\n  const filterSchedule = filterField.filter((f) => f.field.type === 'scheduled').map(timeFilter);\n  const filterDeadline = filterField.filter((f) => f.field.type === 'deadline').map(timeFilter);\n\n  const filterTagsExcl = filterExpr.filter(filterFilter('tag', true)).map(words);\n  const filterCSExcl = filterExpr.filter(filterFilter('case-sensitive', true)).map(words);\n  const filterICExcl = filterExpr.filter(filterFilter('ignore-case', true)).map(wordsLowerCase);\n  const filterPropsExcl = filterExpr\n    .filter(filterFilter('property', true))\n    .map((x) => [x.property, x.words]);\n\n  return (header) => {\n    const headLine = header.get('titleLine');\n    const tags = headLine.get('tags');\n    const todoKeyword = headLine.get('todoKeyword');\n    const rawTitle = headLine.get('rawTitle');\n    const headlineText = todoKeyword ? `${todoKeyword} ${rawTitle}` : rawTitle;\n    const properties = header\n      .get('propertyListItems')\n      .map((p) => [p.get('property'), attributedStringToRawText(p.get('value'))]);\n    const planningItems = header\n      .get('planningItems')\n      .filter((p) => p.get('timestamp').get('isActive') === true);\n    const dates = planningItems.map((p) => p.get('timestamp'));\n    const scheduleds = planningItems\n      .filter((p) => p.get('type') === 'SCHEDULED')\n      .map((p) => p.get('timestamp'));\n    const deadlines = planningItems\n      .filter((p) => p.get('type') === 'DEADLINE')\n      .map((p) => p.get('timestamp'));\n    //const clocks = header\n    //  .get('logBookEntries')\n    //  .flatMap((l) => [l.get('start'), l.get('end')])\n    //  .filter((t) => t !== undefined && t !== null);\n    const propertyFilter = ([x, ys]) =>\n      !properties\n        .filter(([key, val]) => {\n          // Property names (keys) are case-insensitive\n          // https://orgmode.org/manual/Property-Syntax.html\n          const nameMatch = key.toLowerCase() === x.toLowerCase();\n          const valueMatch = ys.some((y) => val.includes(y));\n          return nameMatch && valueMatch;\n        })\n        .isEmpty();\n\n    return (\n      filterTags.every(orChain(tags)) &&\n      filterCS.every(orChain(headlineText)) &&\n      filterIC.every(orChain(headlineText.toLowerCase())) &&\n      filterProps.every(propertyFilter) &&\n      filterDate.every(orChainDate(dates)) &&\n      //filterClock.every(orChainDate(clocks)) &&\n      filterSchedule.every(orChainDate(scheduleds)) &&\n      filterDeadline.every(orChainDate(deadlines)) &&\n      !filterTagsExcl.some(orChain(tags)) &&\n      !filterCSExcl.some(orChain(headlineText)) &&\n      !filterICExcl.some(orChain(headlineText.toLowerCase())) &&\n      !filterPropsExcl.some(propertyFilter)\n    );\n  };\n};\n\n// Suggestions / Completions\n\n// The computation of completions rely on the fact, that the filter syntax does NOT\n// support quoted strings (i.e. no search for a quoted 'master headline').\n\n// This function is complex and still not perfect. It resembles parts of the\n// filter syntax parser. If the parser would annotate all parsed symbols with\n// offsets information, computeLogicalPosition could simplify the algorithm as\n// long as the filter string is parsed successfully.\n\nexport const computeCompletions = (todoKeywords, tagNames, allProperties) => (\n  filterExpr,\n  filterString,\n  curserPosition\n) => {\n  const tagAndPropNames = [].concat(\n    tagNames,\n    computeAllPropertyNames(fromJS(allProperties))\n      .toJS()\n      .map((x) => x + ':')\n  );\n\n  const logicalCursorPosition = filterExpr\n    ? computeLogicalPosition(filterExpr, filterString, curserPosition)\n    : null;\n\n  const charBeforeCursor = filterString.charAt(curserPosition - 1);\n  const charTwoBeforeCursor = curserPosition > 1 ? filterString.charAt(curserPosition - 2) : '';\n\n  if (logicalCursorPosition === null) {\n  } else if (logicalCursorPosition === SPACE_SURROUNDED) {\n    return todoKeywords;\n  } else if (logicalCursorPosition.type === 'case-sensitive') {\n    if (charBeforeCursor.match(/[A-Z]/)) {\n      const textBeforeCursor = charBeforeCursor;\n      const filteredTodoKeywords = todoKeywords\n        .filter((x) => x.startsWith(textBeforeCursor))\n        .map((x) => x.substring(textBeforeCursor.length));\n      if ([' ', '', '|', '-'].includes(charTwoBeforeCursor)) {\n        return filteredTodoKeywords;\n      }\n    }\n  } else if (logicalCursorPosition.type === 'ignore-case') {\n    // A text filter starting with '-' turns into an exclude filter as soon as text is appended\n    if (charBeforeCursor === '-' && [' ', ''].includes(charTwoBeforeCursor)) return todoKeywords;\n    return [];\n  } else if (logicalCursorPosition.type === 'tag') {\n    // This case will likely not occur because ':' alone cannot be parsed\n    if (charBeforeCursor === ':') return tagAndPropNames;\n  } else if (logicalCursorPosition.type === 'property') {\n    if (charBeforeCursor === ':') {\n      if (charTwoBeforeCursor === ' ' || charTwoBeforeCursor === '') return tagAndPropNames;\n      else {\n        // Either property name or text filter\n        const indexOfOtherColon = filterString.substring(0, curserPosition - 1).lastIndexOf(':');\n        const maybePropertyName = filterString.substring(indexOfOtherColon + 1, curserPosition - 1);\n        const quoteStringIfPossible = (x) => {\n          if (x.match(/ /)) {\n            if (!x.match(/\"/)) return [`\"${x}\"`];\n            if (!x.match(/'/)) return [`'${x}'`];\n            const match = x.match(/^[^ ]*/);\n            return [match[0]];\n          }\n          return [x];\n        };\n        if (indexOfOtherColon >= 0 && maybePropertyName.match(/^[^ ]+$/)) {\n          // No space in property name -> is property -> return values for that property\n          return computeAllPropertyValuesFor(fromJS(allProperties), maybePropertyName)\n            .flatMap(quoteStringIfPossible)\n            .toJS();\n        }\n      }\n    }\n  }\n\n  // If ':' or '|' is before cursor, the filter string is likely not\n  // successfully parsed and therefore cannot be handled above.\n  if (charBeforeCursor === ':') {\n    if ([' ', '', '-'].includes(charTwoBeforeCursor)) {\n      return tagAndPropNames;\n    }\n  } else if (charBeforeCursor === '|') {\n    const indexOfOtherColon = filterString.substring(0, curserPosition).lastIndexOf(':');\n    const maybeTagName = filterString.substring(indexOfOtherColon + 1, curserPosition - 1);\n    if (indexOfOtherColon > -1 && !maybeTagName.match(/ /)) {\n      // No space characters between ':' and '|'  ->  '|' is in a tag filter\n      return tagNames;\n    } else {\n      return todoKeywords;\n    }\n  }\n\n  return [];\n};\n\nexport const computeCompletionsForDatalist = (todoKeywords, tagNames, allProperties) => (\n  filterExpr,\n  filterString,\n  curserPosition\n) => {\n  const completions = computeCompletions(todoKeywords, tagNames, allProperties)(\n    filterExpr,\n    filterString,\n    curserPosition\n  );\n  return completions.map(\n    (x) => filterString.substring(0, curserPosition) + x + filterString.substring(curserPosition)\n  );\n};\n\nconst SPACE_SURROUNDED = ' ';\n\n// Compute the logical curser position within the parsed filter expression.\n// Return SPACE_SURROUNDED if the curser is inbetween two expressions and\n// surrounded by spaces (begin and end of line count as space).\n// Return the the filter term if the curser is in or at the edge of an filter term.\nconst computeLogicalPosition = (filterExpr, filterString, curserPosition) => {\n  if (filterExpr.length === 0) return SPACE_SURROUNDED;\n  const tup = (x, y) => ({ value: x, elem: y });\n  const firstElem = { offset: -1, endOffset: -1 };\n  const { value } = filterExpr.reduce(\n    ({ value, elem }, next) => {\n      if (elem === null) {\n        return tup(value, null); // short-circuit if already found\n      }\n      if (curserPosition >= next.offset && curserPosition <= next.endOffset) {\n        return tup(next, null);\n      }\n      if (curserPosition > elem.endOffset && curserPosition < next.offset) {\n        return tup(SPACE_SURROUNDED, null);\n      }\n      return tup(null, next);\n    },\n    { value: null, elem: firstElem }\n  );\n  if (curserPosition > filterExpr[filterExpr.length - 1].endOffset) return SPACE_SURROUNDED;\n  return value;\n};\n","import { subheadersOfHeaderWithIndex } from './org_utils';\nimport { dateForTimestamp } from './timestamps';\n\nconst totalTimeLogged = (header) => {\n  const logBookEntries = header.get('logBookEntries', []);\n\n  const times = logBookEntries.map((entry) =>\n    entry.get('start') && entry.get('end')\n      ? dateForTimestamp(entry.get('end')) - dateForTimestamp(entry.get('start'))\n      : 0\n  );\n\n  const addedTimes = times.reduce((acc, val) => acc + val, 0);\n  return addedTimes;\n};\n\nexport const totalFilteredTimeLogged = (filters, header) => {\n  const clocks = header\n    .get('logBookEntries', [])\n    .map((l) => [l.get('start'), l.get('end')])\n    .filter(([start, end]) => start && end)\n    .filter((ts) => ts.some((t) => filters.every((f) => f(t))));\n\n  const times = clocks.map(([start, end]) => dateForTimestamp(end) - dateForTimestamp(start));\n\n  const addedTimes = times.reduce((acc, val) => acc + val, 0);\n  return addedTimes;\n};\n\nexport const updateHeadersTotalTimeLoggedRecursive = (headers) => {\n  if (!headers) {\n    return headers;\n  }\n  const headersWithtotalTimeLogged = headers.map((header) =>\n    header.set('totalTimeLogged', totalTimeLogged(header))\n  );\n  const headersWithtotalTimeLoggedRecursive = headersWithtotalTimeLogged.map((header, index) => {\n    const subheaders = subheadersOfHeaderWithIndex(headersWithtotalTimeLogged, index);\n    const totalTimeLoggedRecursive = subheaders.reduce(\n      (acc, val) => acc + val.get('totalTimeLogged'),\n      header.get('totalTimeLogged')\n    );\n    return header.set('totalTimeLoggedRecursive', totalTimeLoggedRecursive);\n  });\n  return headersWithtotalTimeLoggedRecursive;\n};\n\nexport const updateHeadersTotalFilteredTimeLoggedRecursive = (filters, headers) => {\n  if (!headers) {\n    return headers;\n  }\n  const headersWithtotalTimeLogged = headers.map((header) =>\n    header.set('totalFilteredTimeLogged', totalFilteredTimeLogged(filters, header))\n  );\n  const headersWithtotalTimeLoggedRecursive = headersWithtotalTimeLogged.map((header, index) => {\n    const subheaders = subheadersOfHeaderWithIndex(headersWithtotalTimeLogged, index);\n    const totalTimeLoggedRecursive = subheaders.reduce(\n      (acc, val) => acc + val.get('totalFilteredTimeLogged'),\n      header.get('totalFilteredTimeLogged')\n    );\n    return header.set('totalFilteredTimeLoggedRecursive', totalTimeLoggedRecursive);\n  });\n  return headersWithtotalTimeLoggedRecursive;\n};\n","import generateId from './id_generator';\nimport { updateHeadersTotalTimeLoggedRecursive } from './clocking';\n\nimport { fromJS, List } from 'immutable';\nimport _ from 'lodash';\n\n// TODO: Extract all match groups of `beginningRegexp` (for example\n// like `emailRegexp`), so that they can be documented and are less\n// unwieldly.\nconst beginningRegexp = /(\\[\\[([^\\]]*)\\]\\]|\\[\\[([^\\]]*)\\]\\[([^\\]]*)\\]\\])|(\\[((\\d*%)|(\\d*\\/\\d*))\\])|(([\\s({'\"]?)([*/~=_+])([^\\s,'](.*)[^\\s,'])\\11([\\s\\-.,:;!?'\")}]?))/;\n\n// Regexp taken from https://stackoverflow.com/a/3809435/999007\nconst httpUrlRegexp = /(https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\\\+.~#?&//=]*))/;\n\n// Regexp taken from https://stackoverflow.com/a/1373724/999007\nconst urlRegexp = /([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)/;\n\nconst internationalPhoneRegexp = /((\\+|00)\\d{8,30})/;\n\n// Regexp taken from https://stackoverflow.com/a/16699507/252585\nconst usPhoneRegexp = /((\\+\\d{1,2}\\s)?\\(?\\d{3}\\)?[\\s.-]\\d{3}[\\s.-]\\d{4})/;\n\n// Works for formatted mobile phone numbers like \"078 326 86 74\"\nconst swissPhoneRegexp1 = /(0[1-9]{2}\\s[0-9]{3}\\s[0-9]{2}\\s[0-9]{2})/;\n\n// Works for unformatted mobile phone numbers like \"0783268674\" and\n// unformatted landline numbers like \"041783268675\"\nconst swissPhoneRegexp2 = /(0[0-9]{9,11})/;\n\nconst wwwUrlRegexp = /(www(\\.[-_a-zA-Z0-9]+){2,}(\\/[-_a-zA-Z0-9]+)*)/;\n\nconst timestampOptionalRepeaterOrDelayRegexp = /(?: (\\+|\\+\\+|\\.\\+|-|--)(\\d+)([hdwmy])(?:\\/(\\d+)([hdwmy]))?)?/;\nconst timestampRegex = new RegExp(\n  [\n    /([<[])/,\n    /(\\d{4})-(\\d{2})-(\\d{2})/,\n    /(?: ([^0-9\\s]{1,9}))?/,\n    /(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?/,\n    timestampOptionalRepeaterOrDelayRegexp,\n    timestampOptionalRepeaterOrDelayRegexp,\n    /[>\\]]/,\n  ]\n    .map((re) => re.source)\n    .join('')\n);\n\nconst markupAndCookieRegex = new RegExp(\n  [\n    beginningRegexp.source,\n    `(${timestampRegex.source}(?:--${timestampRegex.source})?)`,\n    httpUrlRegexp.source,\n    urlRegexp.source,\n    internationalPhoneRegexp.source,\n    usPhoneRegexp.source,\n    swissPhoneRegexp1.source,\n    swissPhoneRegexp2.source,\n    wwwUrlRegexp.source,\n  ].join('|'),\n  'g'\n);\n\n// INFO: https://www.debuggex.com/ is a good tool to inspect how the\n// matches work.\n// console.log(markupAndCookieRegex);\n\nconst timestampFromRegexMatch = (match, partIndices) => {\n  const [\n    typeBracket,\n    year,\n    month,\n    day,\n    dayName,\n    timeStart,\n    timeEnd,\n    firstDelayRepeatType,\n    firstDelayRepeatValue,\n    firstDelayRepeatUnit,\n    firstRepeaterDeadlineValue,\n    firstRepeaterDeadlineUnit,\n    secondDelayRepeatType,\n    secondDelayRepeatValue,\n    secondDelayRepeatUnit,\n    secondRepeaterDeadlineValue,\n    secondRepeaterDeadlineUnit,\n  ] = partIndices.map((partIndex) => match[partIndex]);\n\n  if (!year) {\n    return null;\n  }\n\n  const [startHour, startMinute] = !!timeStart ? timeStart.split(':') : [];\n  const [endHour, endMinute] = !!timeEnd ? timeEnd.split(':') : [];\n\n  let repeaterType, repeaterValue, repeaterUnit, repeaterDeadlineValue, repeaterDeadlineUnit;\n  let delayType, delayValue, delayUnit;\n\n  if (['+', '++', '.+'].includes(firstDelayRepeatType)) {\n    repeaterType = firstDelayRepeatType;\n    repeaterValue = firstDelayRepeatValue;\n    repeaterUnit = firstDelayRepeatUnit;\n    repeaterDeadlineValue = firstRepeaterDeadlineValue;\n    repeaterDeadlineUnit = firstRepeaterDeadlineUnit;\n  } else if (['-', '--'].includes(firstDelayRepeatType)) {\n    delayType = firstDelayRepeatType;\n    delayValue = firstDelayRepeatValue;\n    delayUnit = firstDelayRepeatUnit;\n  }\n  if (['+', '++', '.+'].includes(secondDelayRepeatType)) {\n    repeaterType = secondDelayRepeatType;\n    repeaterValue = secondDelayRepeatValue;\n    repeaterUnit = secondDelayRepeatUnit;\n    repeaterDeadlineValue = secondRepeaterDeadlineValue;\n    repeaterDeadlineUnit = secondRepeaterDeadlineUnit;\n  } else if (['-', '--'].includes(secondDelayRepeatType)) {\n    delayType = secondDelayRepeatType;\n    delayValue = secondDelayRepeatValue;\n    delayUnit = secondDelayRepeatUnit;\n  }\n\n  return {\n    isActive: typeBracket === '<',\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n    repeaterDeadlineValue,\n    repeaterDeadlineUnit,\n  };\n};\n\nexport const parseMarkupAndCookies = (rawText, { shouldAppendNewline = false } = {}) => {\n  const matches = [];\n  let match = markupAndCookieRegex.exec(rawText);\n  while (match) {\n    if (!!match[2]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[2],\n        index: match.index,\n      });\n    } else if (!!match[3] && !!match[4]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[3],\n        title: match[4],\n        index: match.index,\n      });\n    } else if (!!match[7]) {\n      const percentCookieMatch = match[7].match(/(\\d*)%/);\n      matches.push({\n        type: 'percentage-cookie',\n        rawText: match[0],\n        percentage: percentCookieMatch[1],\n        index: match.index,\n      });\n    } else if (!!match[8]) {\n      const fractionCookieMatch = match[8].match(/(\\d*)\\/(\\d*)/);\n      matches.push({\n        type: 'fraction-cookie',\n        rawText: match[0],\n        fraction: [fractionCookieMatch[1], fractionCookieMatch[2]],\n        index: match.index,\n      });\n    } else if (!!match[11]) {\n      const markupType = {\n        '~': 'inline-code',\n        '*': 'bold',\n        '/': 'italic',\n        '+': 'strikethrough',\n        _: 'underline',\n        '=': 'verbatim',\n      }[match[11]];\n\n      const markupPrefixLength = match[10].length;\n\n      matches.push({\n        type: 'inline-markup',\n        rawText: match[0].substring(markupPrefixLength, match[12].length + 2 + markupPrefixLength),\n        index: match.index + markupPrefixLength,\n        content: match[12],\n        markupType,\n      });\n    } else if (!!match[15]) {\n      const firstTimestamp = timestampFromRegexMatch(match, _.range(16, 33));\n      const secondTimestamp = timestampFromRegexMatch(match, _.range(33, 50));\n\n      matches.push({\n        type: 'timestamp',\n        rawText: match[0],\n        index: match.index,\n        firstTimestamp,\n        secondTimestamp,\n      });\n    } else if (!!match[50]) {\n      matches.push({\n        type: 'url',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[53]) {\n      matches.push({\n        type: 'e-mail',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[54] || !!match[56] || !!match[58] || !!match[59]) {\n      matches.push({\n        type: 'phone-number',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[60]) {\n      matches.push({\n        type: 'www-url',\n        rawText: match[0],\n        index: match.index,\n      });\n    }\n    match = markupAndCookieRegex.exec(rawText);\n  }\n\n  const lineParts = [];\n  let startIndex = 0;\n  matches.forEach((match) => {\n    let index = match.index;\n\n    // Get the part before the first match:\n    if (index !== startIndex) {\n      const text = rawText.substring(startIndex, index);\n      lineParts.push({\n        type: 'text',\n        contents: text,\n      });\n    }\n\n    // Get this match:\n    const part = computeParseResults(rawText, match);\n    lineParts.push(part);\n\n    startIndex = match.index + match.rawText.length;\n  });\n\n  if (startIndex !== rawText.length || shouldAppendNewline) {\n    const trailingText =\n      rawText.substring(startIndex, rawText.length) + (shouldAppendNewline ? '\\n' : '');\n    lineParts.push({\n      type: 'text',\n      contents: trailingText,\n    });\n  }\n\n  return lineParts;\n};\n\nconst computeParseResults = (rawText, match) => {\n  switch (match.type) {\n    case 'link':\n      const linkPart = {\n        id: generateId(),\n        type: 'link',\n        contents: {\n          uri: match.uri,\n        },\n      };\n      if (match.title) {\n        linkPart.contents.title = match.title;\n      }\n      return linkPart;\n    case 'percentage-cookie':\n      return {\n        id: generateId(),\n        type: 'percentage-cookie',\n        percentage: match.percentage,\n      };\n    case 'fraction-cookie':\n      return {\n        id: generateId(),\n        type: 'fraction-cookie',\n        fraction: match.fraction,\n      };\n    case 'inline-markup':\n      return {\n        id: generateId(),\n        type: 'inline-markup',\n        content: match.content,\n        markupType: match.markupType,\n      };\n    case 'timestamp':\n      return {\n        id: generateId(),\n        type: 'timestamp',\n        firstTimestamp: match.firstTimestamp,\n        secondTimestamp: match.secondTimestamp,\n      };\n    case 'url':\n    case 'www-url':\n    case 'e-mail':\n    case 'phone-number':\n      return {\n        id: generateId(),\n        type: match.type,\n        content: match.rawText,\n      };\n    default:\n      throw Error(\n        'The regex parser parsed something but it is not converted to proper data structure.'\n      );\n  }\n};\n\nconst parseTable = (tableLines) => {\n  const table = {\n    id: generateId(),\n    type: 'table',\n    contents: [[]],\n    columnProperties: [],\n  };\n\n  tableLines\n    .map((line) => line.trim())\n    .forEach((line) => {\n      if (line.startsWith('|-')) {\n        table.contents.push([]);\n      } else {\n        const lastRow = _.last(table.contents);\n        const lineCells = line.substr(1, line.length - 2).split('|');\n\n        if (lastRow.length === 0) {\n          lineCells.forEach((cell) => lastRow.push(cell));\n        } else {\n          lineCells.forEach((cellContents, cellIndex) => {\n            lastRow[cellIndex] += `\\n${cellContents}`;\n          });\n        }\n      }\n    });\n\n  // Parse the contents of each cell.\n  table.contents = table.contents.map((row) => ({\n    id: generateId(),\n    contents: row.map((rawContents) => ({\n      id: generateId(),\n      contents: parseMarkupAndCookies(rawContents, { excludeCookies: true }),\n      rawContents,\n    })),\n  }));\n\n  // We sometimes end up with an extra, empty row - remove it if so.\n  if (_.last(table.contents).contents.length === 0) {\n    table.contents = table.contents.slice(0, table.contents.length - 1);\n  }\n\n  // Make sure each row has the same number of columns.\n  const maxNumColumns = Math.max(...table.contents.map((row) => row.contents.length));\n  table.contents.forEach((row) => {\n    if (row.contents.length < maxNumColumns) {\n      _.times(maxNumColumns - row.contents.length, () => {\n        row.contents.push({\n          id: generateId(),\n          contents: [],\n          rawContents: '',\n        });\n      });\n    }\n  });\n\n  return table;\n};\n\nexport const parseRawText = (rawText, { excludeContentElements = false } = {}) => {\n  const lines = rawText.split('\\n');\n\n  const LIST_HEADER_REGEX = /^\\s*([-+*]|(\\d+(\\.|\\)))) (.*)/;\n\n  let currentListHeaderNestingLevel = null;\n  const rawLineParts = _.flatten(\n    lines.map((line, lineIndex) => {\n      const numLeadingSpaces = line.match(/^( *)/)[0].length;\n\n      if (\n        currentListHeaderNestingLevel !== null &&\n        (numLeadingSpaces > currentListHeaderNestingLevel || !line.trim())\n      ) {\n        return [\n          {\n            type: 'raw-list-content',\n            line,\n          },\n        ];\n      } else {\n        currentListHeaderNestingLevel = null;\n\n        if (line.match(LIST_HEADER_REGEX) && !excludeContentElements) {\n          currentListHeaderNestingLevel = numLeadingSpaces;\n\n          return [\n            {\n              type: 'raw-list-header',\n              line,\n            },\n          ];\n        } else if (line.trim().startsWith('|') && !excludeContentElements) {\n          return [\n            {\n              type: 'raw-table',\n              line,\n            },\n          ];\n        } else {\n          return parseMarkupAndCookies(line, {\n            shouldAppendNewline: lineIndex !== lines.length - 1,\n            excludeCookies: true,\n          });\n        }\n      }\n    })\n  );\n\n  const processedLineParts = [];\n  for (let partIndex = 0; partIndex < rawLineParts.length; ++partIndex) {\n    const linePart = rawLineParts[partIndex];\n    if (linePart.type === 'raw-table') {\n      const tableLines = _.takeWhile(\n        rawLineParts.slice(partIndex),\n        (part) => part.type === 'raw-table'\n      ).map((part) => part.line);\n\n      processedLineParts.push(parseTable(tableLines));\n\n      partIndex += tableLines.length - 1;\n    } else if (linePart.type === 'raw-list-header') {\n      const numLeadingSpaces = linePart.line.match(/^( *)/)[0].length;\n      const contentLines = _.takeWhile(\n        rawLineParts.slice(partIndex + 1),\n        (part) => part.type === 'raw-list-content'\n      )\n        .map((part) => part.line)\n        .map((line) =>\n          line.startsWith(' '.repeat(numLeadingSpaces + 2))\n            ? line.substr(numLeadingSpaces + 2)\n            : line.substr(numLeadingSpaces + 1)\n        );\n      if (contentLines[contentLines.length - 1] === '') {\n        contentLines[contentLines.length - 1] = ' ';\n      }\n      const contents = parseRawText(contentLines.join('\\n')).toJS();\n\n      partIndex += contentLines.length;\n\n      const isOrdered = !!linePart.line.match(/^\\s*\\d+[.)]/);\n\n      // Remove the leading -, +, *, or number characters.\n      let line = linePart.line.match(LIST_HEADER_REGEX)[4];\n\n      let forceNumber = null;\n      if (line.match(/^\\s*\\[@\\d+\\]/)) {\n        forceNumber = line.match(/^\\s*\\[@(\\d+)\\]/)[1];\n        line = line.replace(/^\\s*\\[@\\d+\\]\\s*/, '');\n      }\n\n      let checkboxState = null;\n      const isCheckbox = !!line.match(/^\\s*\\[[ X-]\\]/);\n      if (isCheckbox) {\n        const stateCharacter = line.match(/^\\s*\\[([ X-])\\]/)[1];\n        checkboxState = {\n          ' ': 'unchecked',\n          X: 'checked',\n          '-': 'partial',\n        }[stateCharacter];\n\n        line = line.replace(/^\\s*\\[[ X-]\\]\\s*/, '');\n      }\n\n      const newListItem = {\n        id: generateId(),\n        titleLine: parseMarkupAndCookies(line),\n        contents,\n        forceNumber,\n        isCheckbox,\n        checkboxState,\n      };\n\n      const lastIndex = processedLineParts.length - 1;\n      if (lastIndex >= 0 && processedLineParts[lastIndex].type === 'list') {\n        processedLineParts[lastIndex].items.push(newListItem);\n      } else {\n        processedLineParts.push({\n          type: 'list',\n          id: generateId(),\n          items: [newListItem],\n          bulletCharacter: linePart.line.trim()[0],\n          numberTerminatorCharacter: isOrdered ? linePart.line.match(/\\s*\\d+([.)])/)[1] : null,\n          isOrdered,\n        });\n      }\n    } else {\n      processedLineParts.push(linePart);\n    }\n  }\n\n  return fromJS(processedLineParts);\n};\n\nexport const _parsePlanningItems = (rawText) => {\n  const optionalSinglePlanningItemRegex = RegExp(\n    `((DEADLINE|SCHEDULED|CLOSED):\\\\s*${asStrNoSlashs(timestampRegex)})?`\n  );\n\n  // If there are any planning items, consume not more\n  // than one newline after the last planning item.\n  const planningRegex = concatRegexes(\n    /^\\s*/,\n    optionalSinglePlanningItemRegex,\n    /[ \\t]*/,\n    optionalSinglePlanningItemRegex,\n    /[ \\t]*/,\n    optionalSinglePlanningItemRegex,\n    /[ \\t]*\\n?/\n  );\n  const planningRegexCaptureGroupsOfType = [2, 21, 40]; // depends on timestampRegex\n  const planningMatch = rawText.match(planningRegex);\n\n  const planningItems = fromJS(\n    planningRegexCaptureGroupsOfType\n      .map((planningTypeIndex) => {\n        const type = planningMatch[planningTypeIndex];\n        if (!type) {\n          return null;\n        }\n\n        const timestamp = timestampFromRegexMatch(\n          planningMatch,\n          _.range(planningTypeIndex + 1, planningTypeIndex + 1 + 17)\n        );\n\n        return createOrUpdateTimestamp({ type, timestamp });\n      })\n      .filter((item) => !!item)\n  );\n\n  if (planningItems.size === 0) {\n    // If there are no matches for planning items, return the original rawText.\n    return { planningItems: fromJS([]), strippedDescription: rawText };\n  } else {\n    const remainingDescriptionWithoutPlanningItem = rawText.replace(planningRegex, '');\n    return { planningItems, strippedDescription: remainingDescriptionWithoutPlanningItem };\n  }\n};\n\nconst createOrUpdateTimestamp = ({ type, timestamp, id }) =>\n  fromJS({ type, timestamp, id: id || generateId() });\n\nconst parsePropertyList = (rawText) => {\n  const lines = rawText.split('\\n');\n  const propertiesLineIndex = lines.findIndex((line) => line.trim() === ':PROPERTIES:');\n  const endLineIndex = lines.findIndex((line) => line.trim() === ':END:');\n\n  if (\n    propertiesLineIndex === -1 ||\n    endLineIndex === -1 ||\n    !rawText.trim().startsWith(':PROPERTIES:')\n  ) {\n    return {\n      propertyListItems: List(),\n      strippedDescription: rawText,\n    };\n  }\n\n  const propertyListItems = fromJS(\n    lines\n      .slice(propertiesLineIndex + 1, endLineIndex)\n      .map((line) => {\n        const match = line.match(/:([^\\s]*):(?: (.*))?/);\n        if (!match) {\n          return null;\n        }\n\n        // Parse the properties value even though most values would\n        // not need parsing. Only timestamps are interactive, the rest\n        // will be saved as plain text.\n        let value = !!match[2] ? parseMarkupAndCookies(match[2]) : null;\n\n        if (value && value[0].type !== 'timestamp') {\n          value = [{ contents: match[2], type: 'text' }];\n        }\n\n        return {\n          property: match[1],\n          value,\n          id: generateId(),\n        };\n      })\n      .filter((result) => !!result)\n  );\n\n  return {\n    propertyListItems,\n    strippedDescription: lines.slice(endLineIndex + 1).join('\\n'),\n  };\n};\n\nconst parseLogbook = (rawText) => {\n  const lines = rawText.split('\\n');\n  const logbookLineIndex = lines.findIndex((line) => line.trim() === ':LOGBOOK:');\n  const endLineIndex = lines.findIndex((line) => line.trim() === ':END:');\n\n  if (logbookLineIndex === -1 || endLineIndex === -1 || !rawText.trim().startsWith(':LOGBOOK:')) {\n    return {\n      logBookEntries: List(),\n      strippedDescription: rawText,\n    };\n  }\n\n  const logBookEntryStartRegex = concatRegexes(/^CLOCK: /, timestampRegex, /$/);\n  const logBookEntryFullRegex = concatRegexes(\n    /^CLOCK: /,\n    timestampRegex,\n    '/--/',\n    timestampRegex,\n    /\\s*=>\\s*\\S+$/\n  );\n  const logBookEntries = fromJS(\n    lines.slice(logbookLineIndex + 1, endLineIndex).map((line) => {\n      const lineFullMatch = line.trim().match(logBookEntryFullRegex);\n      if (lineFullMatch) {\n        return {\n          start: timestampFromRegexMatch(lineFullMatch, _.range(1, 18)),\n          end: timestampFromRegexMatch(lineFullMatch, _.range(18, 39)),\n          id: generateId(),\n        };\n      }\n      const lineStartMatch = line.trim().match(logBookEntryStartRegex);\n      if (lineStartMatch) {\n        return {\n          start: timestampFromRegexMatch(lineStartMatch, _.range(1, 18)),\n          end: null,\n          id: generateId(),\n        };\n      }\n      return { raw: line.trimLeft(), id: generateId() };\n    })\n  );\n\n  return {\n    logBookEntries,\n    strippedDescription: lines.slice(endLineIndex + 1).join('\\n'),\n  };\n};\n\nexport const _parseLogNotes = (rawText) => {\n  // Only parse log notes if a logbook exists. Otherwise, a list - log notes\n  // or just a normal list - will go into the description.\n  const lines = rawText.split('\\n');\n  const logbookLineIndex = lines.findIndex((line) => line.trim() === ':LOGBOOK:');\n  if (logbookLineIndex !== -1)\n    return makeLogNotesResult(lines.slice(0, logbookLineIndex), lines.slice(logbookLineIndex));\n  return makeLogNotesResult([], [rawText]);\n};\n\nexport const parseDescriptionPrefixElements = (rawText) => {\n  const planningItemsParse = _parsePlanningItems(rawText);\n\n  const planningItems = planningItemsParse.planningItems;\n  const propertyListParse = parsePropertyList(planningItemsParse.strippedDescription);\n  // In Orgmode, notes are added below properties and before\n  // logbook. However, logbook is added directly below properties if\n  // it does not exist.\n  const logNotes = _parseLogNotes(propertyListParse.strippedDescription);\n  const logBookParse = parseLogbook(logNotes.strippedDescription);\n\n  return {\n    planningItems: planningItems,\n    propertyListItems: propertyListParse.propertyListItems,\n    logNotes: logNotes.logNotes,\n    logBookEntries: logBookParse.logBookEntries,\n    strippedDescription: logBookParse.strippedDescription,\n  };\n};\n\nexport const _updateHeaderFromDescription = (header, rawUnstrippedDescription) => {\n  const {\n    planningItems,\n    propertyListItems,\n    logNotes,\n    logBookEntries,\n    strippedDescription,\n  } = parseDescriptionPrefixElements(rawUnstrippedDescription);\n  const parsedDescription = parseRawText(strippedDescription);\n\n  const parsedTitle = header.getIn(['titleLine', 'title']);\n  const mergedPlanningItems = mergePlanningItems(\n    planningItems,\n    extractActiveTimestampsForPlanningItemsFromParse('TIMESTAMP_TITLE', parsedTitle),\n    extractActiveTimestampsForPlanningItemsFromParse('TIMESTAMP_DESCRIPTION', parsedDescription),\n    extractActiveTimestampsForPlanningItemsFromParse('TIMESTAMP_LOG_NOTES', logNotes)\n  );\n\n  return header\n    .set('rawDescription', strippedDescription)\n    .set('description', parsedDescription)\n    .set('planningItems', mergedPlanningItems)\n    .set('propertyListItems', propertyListItems)\n    .set('logNotes', logNotes)\n    .set('logBookEntries', logBookEntries);\n};\n\nconst defaultKeywordSets = fromJS([\n  {\n    keywords: ['TODO', 'DONE'],\n    completedKeywords: ['DONE'],\n    default: true,\n  },\n]);\n\nexport const parseTitleLine = (titleLine, todoKeywordSets) => {\n  const allKeywords = todoKeywordSets.flatMap((todoKeywordSet) => {\n    return todoKeywordSet.get('keywords');\n  });\n  const todoKeyword = allKeywords.filter((keyword) => titleLine.startsWith(keyword + ' ')).first();\n  let rawTitle = titleLine;\n  if (todoKeyword) {\n    rawTitle = rawTitle.substr(todoKeyword.length + 1);\n  }\n\n  // Check for tags.\n  let tags = [];\n  if (rawTitle.trimRight().endsWith(':')) {\n    const titleParts = rawTitle.trimRight().split(' ');\n    const possibleTags = titleParts[titleParts.length - 1];\n    if (/^:[^\\s]+:$/.test(possibleTags)) {\n      rawTitle = rawTitle.substr(0, rawTitle.length - possibleTags.length);\n      tags = possibleTags.split(':').filter((tag) => tag !== '');\n    }\n  }\n\n  const title = parseMarkupAndCookies(rawTitle);\n\n  return fromJS({ title, rawTitle, todoKeyword, tags });\n};\n\nexport const newHeaderWithTitle = (line, nestingLevel, todoKeywordSets) => {\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  const titleLine = parseTitleLine(line, todoKeywordSets);\n  return fromJS({\n    titleLine,\n    rawDescription: '',\n    description: [],\n    opened: false,\n    id: generateId(),\n    nestingLevel,\n    planningItems: [],\n    propertyListItems: [],\n    logNotes: [],\n    logBookEntries: [],\n  });\n};\n\nconst concatRegexes = (...regexes) =>\n  regexes.reduce((prev, curr) => RegExp(asStrNoSlashs(prev) + asStrNoSlashs(curr)));\n\n// Converts RegExp or strings like '/regex/' to a string without these slashes.\nconst asStrNoSlashs = (regex) => {\n  const s = regex.toString();\n  return s.substring(1, s.length - 1);\n};\n\nexport const newHeaderFromText = (rawText, todoKeywordSets) => {\n  // This function is currently only used for capture templates.\n  // Hence, it's acceptable that it is opinionated on treating\n  // whitespace.\n  const titleLine = rawText.split('\\n')[0].replace(/^\\**\\s*|\\s*$/g, '');\n  const descriptionText = rawText.split('\\n').slice(1).join('\\n');\n\n  // TODO: possible addition: allow subheaders in description!\n\n  const newHeader = newHeaderWithTitle(titleLine, 1, todoKeywordSets);\n  return _updateHeaderFromDescription(newHeader, descriptionText);\n};\n\nexport const lineIsTodoKeywordConfig = (line) => {\n  return (\n    line.startsWith('#+TODO: ') ||\n    line.startsWith('#+TYP_TODO: ') ||\n    line.startsWith('#+SEQ_TODO: ')\n  );\n};\n\nexport const parseTodoKeywordConfig = (line) => {\n  if (!lineIsTodoKeywordConfig(line)) {\n    return null;\n  }\n\n  const keywordsString = line.substr(line.indexOf(':') + 2);\n  const keywordTokens = keywordsString.split(/\\s/);\n  const keywords = keywordTokens\n    .filter((keyword) => keyword !== '|')\n    // Remove fast access TODO states suffix from keyword, because\n    // there's no UI to handle those in organice\n    // https://orgmode.org/manual/Fast-access-to-TODO-states.html#Fast-access-to-TODO-states\n    .map((keyword) => keyword.replace(/\\(.[!@]?(\\/[!@])?\\)$/, ''));\n\n  const pipeIndex = keywordTokens.indexOf('|');\n  const completedKeywords = pipeIndex >= 0 ? keywords.slice(pipeIndex) : [];\n\n  return fromJS({\n    keywords,\n    completedKeywords,\n    configLine: line,\n    default: false,\n  });\n};\n\nexport const parseFileConfig = (lines) => {\n  let todoKeywordSets = List();\n  let fileConfigLines = List();\n\n  lines.forEach((line) => {\n    const newKeywordSet = parseTodoKeywordConfig(line);\n    if (newKeywordSet) {\n      todoKeywordSets = todoKeywordSets.push(newKeywordSet);\n    } else if (line.startsWith('#+')) {\n      fileConfigLines = fileConfigLines.push(line);\n    }\n  });\n\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  return {\n    todoKeywordSets,\n    fileConfigLines,\n  };\n};\n\nexport const parseOrg = (fileContents) => {\n  let headers = List();\n  const lines = getLinesFromFileContents(fileContents);\n\n  let linesBeforeHeadings = List();\n\n  // This is the first pass over the whole file\n  const { todoKeywordSets, fileConfigLines } = parseFileConfig(lines);\n\n  // This is the second pass over the whole file\n  lines.forEach((line) => {\n    // A header has to start with at least one consecutive asterisk\n    // followed by a blank\n    if (line.match(/^\\*+ /)) {\n      const nestingLevel = computeNestingLevel(line);\n      const title = line.substr(nestingLevel + 1);\n      headers = headers.push(newHeaderWithTitle(title, nestingLevel, todoKeywordSets));\n    } else if (headers.size === 0) {\n      linesBeforeHeadings = linesBeforeHeadings.push(line);\n    } else {\n      headers = headers.updateIn([headers.size - 1, 'rawDescription'], (rawDescription) => {\n        // In the beginning of the parseOrg function, the original\n        // fileContent lines are split by '\\n'. Therefore, the newline\n        // has to be added again to the line:\n        const lineToAdd = line + '\\n';\n        rawDescription = rawDescription ? rawDescription : '';\n        return rawDescription + lineToAdd;\n      });\n    }\n  });\n\n  headers = headers.map((header) => {\n    // Normally, rawDescription contains the \"stripped\" raw description text,\n    // i.e. no log book, properties, or planning items.\n    // In this case (parsing the complete org file), rawDescription contains\n    // the full raw description text. Only after _updateHeaderFromDescription(),\n    // the contents of rawDescription are correct.\n    const description = header.get('rawDescription');\n    return _updateHeaderFromDescription(header, description);\n  });\n\n  headers = updateHeadersTotalTimeLoggedRecursive(headers);\n\n  return fromJS({\n    headers,\n    todoKeywordSets,\n    fileConfigLines,\n    linesBeforeHeadings,\n  });\n};\n\nconst extractActiveTimestampsForPlanningItemsFromParse = (type, parsedData) => {\n  // planningItems only accept a single timestamp -> ignore second timestamp\n  return parsedData\n    .filter((x) => x.get('type') === 'timestamp' && x.getIn(['firstTimestamp', 'isActive']))\n    .map((x) =>\n      createOrUpdateTimestamp({ type: type, timestamp: x.get('firstTimestamp'), id: x.get('id') })\n    );\n};\n\n// Merge planningItems from parsed title, description, and planning keywords.\nconst mergePlanningItems = (...planningItems) => {\n  return planningItems[0].concat(...planningItems.slice(1));\n};\n\nexport const updatePlanningItems = (planningItems, type, parsed) =>\n  planningItems\n    .filter((x) => x.get('type') !== type)\n    .merge(extractActiveTimestampsForPlanningItemsFromParse(type, parsed));\n\nexport const updatePlanningItemsFromHeader = (header) => {\n  let items = header.get('planningItems');\n  items = updatePlanningItems(items, 'TIMESTAMP_TITLE', header.getIn(['titleLine', 'title']));\n  items = updatePlanningItems(items, 'TIMESTAMP_DESCRIPTION', header.get('description'));\n  items = updatePlanningItems(items, 'TIMESTAMP_LOG_NOTES', header.get('logNotes'));\n  return items;\n};\n\nconst computeNestingLevel = (titleLineWithAsterisk) => {\n  const nestingLevel = titleLineWithAsterisk.indexOf(' ');\n  if (nestingLevel === -1) return titleLineWithAsterisk.trimRight().length;\n  return nestingLevel;\n};\n\nconst getLinesFromFileContents = (fileContents) => {\n  // We expect a newline at EOF (from the last line of fileContents).\n  // After split(), this results in an empty string at the last position of the\n  // array => Remove that last array item.\n  const lines = fileContents.split('\\n');\n\n  // Special case when last line did not end with a newline character:\n  if (lines.length > 0 && lines[lines.length - 1] !== '') return lines;\n\n  return lines.slice(0, lines.length - 1);\n};\n\nconst makeLogNotesResult = (logNotesLines, strippedDescriptionLines) => {\n  const rawLogNotes = logNotesLines.join('\\n');\n  return {\n    rawLogNotes: rawLogNotes,\n    logNotes: parseRawText(rawLogNotes),\n    strippedDescription: strippedDescriptionLines.join('\\n'),\n  };\n};\n","import { Map, List, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport headline_filter_parser from '../lib/headline_filter_parser';\nimport { isMatch, computeCompletionsForDatalist, timeFilter } from '../lib/headline_filter';\nimport {\n  updateHeadersTotalTimeLoggedRecursive,\n  totalFilteredTimeLogged,\n  updateHeadersTotalFilteredTimeLoggedRecursive,\n} from '../lib/clocking';\n\nimport {\n  extractAllOrgTags,\n  extractAllOrgProperties,\n  getTodoKeywordSetsAsFlattenedArray,\n  STATIC_FILE_PREFIX,\n} from '../lib/org_utils';\n\nimport {\n  parseOrg,\n  parseTitleLine,\n  parseRawText,\n  parseMarkupAndCookies,\n  newHeaderWithTitle,\n  newHeaderFromText,\n  updatePlanningItems,\n  updatePlanningItemsFromHeader,\n  _updateHeaderFromDescription,\n} from '../lib/parse_org';\nimport { attributedStringToRawText } from '../lib/export_org';\nimport {\n  indexOfHeaderWithId,\n  indexAndHeaderWithId,\n  parentIdOfHeaderWithId,\n  subheadersOfHeaderWithId,\n  subheaderIndicesOfHeaderWithId,\n  numSubheadersOfHeaderWithId,\n  indexOfPreviousSibling,\n  openDirectParent,\n  openHeaderWithPath,\n  nextVisibleHeaderAfterIndex,\n  previousVisibleHeaderAfterIndex,\n  updateTableContainingCellId,\n  newEmptyTableRowLikeRows,\n  newEmptyTableCell,\n  headerThatContainsTableCellId,\n  headerWithPath,\n  pathAndPartOfListItemWithIdInHeaders,\n  pathAndPartOfTimestampItemWithIdInHeaders,\n  todoKeywordSetForKeyword,\n  inheritedValueOfProperty,\n} from '../lib/org_utils';\nimport { timestampForDate, getTimestampAsText, applyRepeater } from '../lib/timestamps';\nimport generateId from '../lib/id_generator';\nimport { formatTextWrap } from '../util/misc';\nimport { applyFileSettingsFromConfig } from '../util/settings_persister';\n\nexport const parseFile = (state, action) => {\n  const { path, contents } = action;\n\n  const parsedFile = parseOrg(contents);\n\n  return state\n    .setIn(['files', path, 'headers'], parsedFile.get('headers'))\n    .setIn(['files', path, 'todoKeywordSets'], parsedFile.get('todoKeywordSets'))\n    .setIn(['files', path, 'fileConfigLines'], parsedFile.get('fileConfigLines'))\n    .setIn(['files', path, 'linesBeforeHeadings'], parsedFile.get('linesBeforeHeadings'));\n};\n\nconst clearSearch = (state) => state.setIn(['search', 'filteredHeaders'], null);\n\nconst openHeader = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  return state.setIn(['headers', headerIndex, 'opened'], true);\n};\n\nconst toggleHeaderOpened = (state, action) => {\n  const headers = state.get('headers');\n\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n  const isOpened = header.get('opened');\n\n  if (isOpened && state.get('narrowedHeaderId') === action.headerId) {\n    return state;\n  }\n\n  if (isOpened && action.closeSubheadersRecursively) {\n    const subheaderIndices = subheaderIndicesOfHeaderWithId(headers, action.headerId);\n    subheaderIndices.forEach((index) => {\n      state = state.setIn(['headers', index, 'opened'], false);\n    });\n  }\n\n  return state.setIn(['headers', headerIndex, 'opened'], !isOpened);\n};\n\nconst selectHeader = (state, action) => {\n  return state.set('selectedHeaderId', action.headerId);\n};\n\nconst openParentsOfHeader = (state, action) => {\n  let headers = state.get('headers');\n  const { headerId } = action;\n\n  let parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  while (!!parentHeaderId) {\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeaderId);\n    headers = headers.setIn([parentHeaderIndex, 'opened'], true);\n    parentHeaderId = parentIdOfHeaderWithId(headers, parentHeaderId);\n  }\n\n  return state.set('headers', headers);\n};\n\nconst updateCookiesInAttributedStringWithChildCompletionStates = (parts, completionStates) => {\n  const doneCount = completionStates.filter((isDone) => isDone).length;\n  const totalCount = completionStates.length;\n\n  return parts.map((part) => {\n    switch (part.get('type')) {\n      case 'fraction-cookie':\n        return part.set('fraction', List([doneCount, totalCount]));\n      case 'percentage-cookie':\n        return part.set('percentage', Math.floor((doneCount / totalCount) * 100));\n      default:\n        return part;\n    }\n  });\n};\n\nconst updateCookiesOfHeaderWithId = (file, headerId) => {\n  const headers = file.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  const subheaders = subheadersOfHeaderWithId(headers, headerId);\n\n  const directChildren = [];\n  for (let i = 0; i < subheaders.size; ++i) {\n    const subheader = subheaders.get(i);\n    directChildren.push(subheader);\n\n    const subheaderSubheaders = subheadersOfHeaderWithId(headers, subheader.get('id'));\n    i += subheaderSubheaders.size;\n  }\n\n  let completionStates = directChildren\n    .map((header) => header.getIn(['titleLine', 'todoKeyword']))\n    .filter((todoKeyword) => !!todoKeyword)\n    .map((todoKeyword) =>\n      todoKeywordSetForKeyword(file.get('todoKeywordSets'), todoKeyword)\n        .get('completedKeywords')\n        .contains(todoKeyword)\n    );\n\n  // If there are no headers with possible completion states, check for plain lists instead.\n  if (completionStates.length === 0) {\n    completionStates = headers\n      .get(headerIndex)\n      .get('description')\n      .filter((part) => part.get('type') === 'list')\n      .flatMap((listPart) => listPart.get('items'))\n      .filter((item) => item.get('isCheckbox'))\n      .map((item) => item.get('checkboxState') === 'checked')\n      .toJS();\n  }\n\n  return file\n    .updateIn(['headers', headerIndex, 'titleLine', 'title'], (title) =>\n      updateCookiesInAttributedStringWithChildCompletionStates(title, completionStates)\n    )\n    .updateIn(['headers', headerIndex, 'titleLine'], (titleLine) =>\n      titleLine.set('rawTitle', attributedStringToRawText(titleLine.get('title')))\n    );\n};\n\nconst updateCookiesOfParentOfHeaderWithId = (file, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(file.get('headers'), headerId);\n  if (!parentHeaderId) {\n    return file;\n  }\n\n  return updateCookiesOfHeaderWithId(file, parentHeaderId);\n};\n\nconst advanceTodoState = (state, action) => {\n  const { headerId, logIntoDrawer, timestamp } = action;\n  const existingHeaderId = headerId || state.get('selectedHeaderId');\n  if (!existingHeaderId) {\n    return state;\n  }\n\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, existingHeaderId);\n\n  const currentTodoState = header.getIn(['titleLine', 'todoKeyword']);\n  const currentTodoSet = todoKeywordSetForKeyword(state.get('todoKeywordSets'), currentTodoState);\n\n  const currentStateIndex = currentTodoSet.get('keywords').indexOf(currentTodoState);\n  const newStateIndex = currentStateIndex + 1;\n  const newTodoState = currentTodoSet.get('keywords').get(newStateIndex) || '';\n\n  const indexedPlanningItemsWithRepeaters = header\n    .get('planningItems')\n    .map((planningItem, index) => [planningItem, index])\n    .filter(([planningItem]) => !!planningItem.getIn(['timestamp', 'repeaterType']));\n\n  state = updateHeadlines({\n    currentTodoSet,\n    newTodoState,\n    indexedPlanningItemsWithRepeaters,\n    state,\n    headerIndex,\n    currentTodoState,\n    logIntoDrawer,\n    timestamp,\n  });\n\n  state = updateCookiesOfParentOfHeaderWithId(state, existingHeaderId);\n\n  return state;\n};\n\nconst enterEditMode = (state, action) => state.set('editMode', action.editModeType);\n\nconst exitEditMode = (state) => state.set('editMode', null);\n\nconst updateHeaderTitle = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  const todoKeywordSets = state.get('todoKeywordSets');\n\n  const newTitleLine = parseTitleLine(action.newRawTitle.trim(), todoKeywordSets);\n\n  state = state.setIn(['headers', headerIndex, 'titleLine'], newTitleLine);\n\n  state = state.updateIn(['headers', headerIndex, 'planningItems'], (planningItems) =>\n    updatePlanningItems(planningItems, 'TIMESTAMP_TITLE', newTitleLine.get('title'))\n  );\n\n  return updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n};\n\nconst updateHeaderDescription = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  return state.updateIn(['headers', headerIndex], (header) =>\n    _updateHeaderFromDescription(header, action.newRawDescription)\n  );\n};\n\nconst addHeader = (state, action) => {\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n\n  const newHeader = newHeaderWithTitle(\n    todoKeyword ? todoKeyword + ' ' : '',\n    header.get('nestingLevel'),\n    state.get('todoKeywordSets')\n  );\n\n  if (action.headerId === state.get('narrowedHeaderId')) {\n    state = state.set('narrowedHeaderId', null);\n  }\n\n  return state.update('headers', (headers) =>\n    headers.insert(headerIndex + subheaders.size + 1, newHeader)\n  );\n};\n\nconst selectNextSiblingHeader = (state, action) => {\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  const nextSibling = headers.get(headerIndex + subheaders.size + 1);\n\n  if (!nextSibling || nextSibling.get('nestingLevel') !== header.get('nestingLevel')) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', nextSibling.get('id'));\n};\n\nconst selectNextVisibleHeader = (state) => {\n  const headers = state.get('headers');\n\n  if (state.get('selectedHeaderId') === undefined) {\n    return state.set('selectedHeaderId', headers.getIn([0, 'id']));\n  }\n\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\n\n  const nextVisibleHeader = nextVisibleHeaderAfterIndex(headers, headerIndex);\n\n  if (!nextVisibleHeader) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', nextVisibleHeader.get('id'));\n};\n\nconst selectPreviousVisibleHeader = (state) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\n\n  const previousVisibleHeader = previousVisibleHeaderAfterIndex(headers, headerIndex);\n\n  if (!previousVisibleHeader) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', previousVisibleHeader.get('id'));\n};\n\nconst removeHeader = (state, action) => {\n  let headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  const numHeadersToRemove = 1 + subheaders.size;\n\n  const parentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  _.times(numHeadersToRemove).forEach(() => {\n    headers = headers.delete(headerIndex);\n  });\n\n  if (action.headerId === state.get('narrowedHeaderId')) {\n    state = state.set('narrowedHeaderId', null);\n  }\n\n  state = state.set('headers', headers);\n\n  if (parentHeaderId) {\n    state = updateCookiesOfHeaderWithId(state, parentHeaderId);\n  }\n\n  return state;\n};\n\nconst moveHeaderUp = (state, action) => {\n  let headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousSiblingIndex = indexOfPreviousSibling(headers, headerIndex);\n  if (previousSiblingIndex === null) {\n    return state;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  _.times(1 + subheaders.size).forEach(() => {\n    headers = headers.insert(previousSiblingIndex, headers.get(headerIndex + subheaders.size));\n    headers = headers.delete(headerIndex + subheaders.size + 1);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst moveHeaderDown = (state, action) => {\n  let headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  const nextSiblingIndex = headerIndex + subheaders.size + 1;\n  const nextSibling = headers.get(nextSiblingIndex);\n  if (!nextSibling || nextSibling.get('nestingLevel') < header.get('nestingLevel')) {\n    return state;\n  }\n\n  const nextSiblingSubheaders = subheadersOfHeaderWithId(headers, nextSibling.get('id'));\n  _.times(1 + nextSiblingSubheaders.size).forEach(() => {\n    headers = headers.insert(\n      headerIndex,\n      headers.get(nextSiblingIndex + nextSiblingSubheaders.size)\n    );\n    headers = headers.delete(nextSiblingIndex + nextSiblingSubheaders.size + 1);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst moveHeaderLeft = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex }, '-');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveHeaderRight = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex }, '+');\n  state = openDirectParent(state, action.headerId);\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveSubtreeLeft = (state, action) => {\n  const headers = state.get('headers');\n  const { header, headerIndex } = indexAndHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  if (header.get('nestingLevel') === 1) {\n    return state;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex, subheaders }, '-');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveSubtreeRight = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex, subheaders }, '+');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return openDirectParent(state, action.headerId);\n};\n\n/**\n * Move an item in immutablejs Lists.\n * @param {list} List\n * @param {integer} fromIndex\n * @param {integer} toIndex\n * @param {any} integer\n */\nconst moveItemInFile = ({ fromList, fromIndex, toIndex, item }) => {\n  const targetItem = fromList.get(toIndex);\n  fromList = fromList.delete(fromIndex);\n  const targetIndex = fromList.indexOf(targetItem);\n  fromList = fromList.insert(targetIndex + 1, item);\n  return [fromList, fromList];\n};\n\nconst moveItemAcrossFiles = ({ fromList, fromIndex, toList, toIndex, item }) => {\n  const targetItem = toList.get(toIndex);\n  fromList = fromList.delete(fromIndex);\n  const targetIndex = toList.indexOf(targetItem);\n  toList = toList.insert(targetIndex + 1, item);\n  return [fromList, toList];\n};\n\nconst refileSubtree = (state, action) => {\n  const { sourcePath, sourceHeaderId, targetPath, targetHeaderId } = action;\n  const moveItem = sourcePath === targetPath ? moveItemInFile : moveItemAcrossFiles;\n  let sourceHeaders = state.getIn(['files', sourcePath, 'headers']);\n  let targetHeaders = state.getIn(['files', targetPath, 'headers']);\n  let { header: sourceHeader, headerIndex: sourceHeaderIndex } = indexAndHeaderWithId(\n    sourceHeaders,\n    sourceHeaderId\n  );\n  let targetHeaderIndex = indexOfHeaderWithId(targetHeaders, targetHeaderId);\n\n  let subheadersOfSourceHeader = subheadersOfHeaderWithId(sourceHeaders, sourceHeaderId);\n\n  const nestingLevelSource = sourceHeaders.getIn([sourceHeaderIndex, 'nestingLevel']);\n  const nestingLevelTarget = targetHeaders.getIn([targetHeaderIndex, 'nestingLevel']);\n\n  // Indent the newly placed sourceheader so that it fits underneath the targetHeader\n  sourceHeader = sourceHeader.set('nestingLevel', nestingLevelTarget + 1);\n\n  // Put the sourceHeader into the right slot after the targetHeader\n  [sourceHeaders, targetHeaders] = moveItem({\n    fromList: sourceHeaders,\n    fromIndex: sourceHeaderIndex,\n    toList: targetHeaders,\n    toIndex: targetHeaderIndex,\n    item: sourceHeader,\n  });\n\n  // Put the subheaders of the sourceHeader right after\n  subheadersOfSourceHeader.forEach((subheader, index) => {\n    subheader = subheader.set(\n      'nestingLevel',\n      // target\n      // 1\n      //   source\n      //   2 (1)\n      //     subheader\n      //      3 (2)\n      //       subheader\n      //       4 (3)\n      subheader.get('nestingLevel') - nestingLevelSource + nestingLevelTarget + 1\n    );\n    const fromIndex = indexOfHeaderWithId(sourceHeaders, subheader.get('id'));\n\n    targetHeaderIndex = indexOfHeaderWithId(targetHeaders, targetHeaderId);\n    const toIndex = targetHeaderIndex + index + 1;\n\n    [sourceHeaders, targetHeaders] = moveItem({\n      fromList: sourceHeaders,\n      fromIndex,\n      toList: targetHeaders,\n      toIndex,\n      item: subheader,\n    });\n  });\n\n  state = state.setIn(['files', sourcePath, 'headers'], sourceHeaders);\n  state = state.setIn(['files', targetPath, 'headers'], targetHeaders);\n\n  state = state.updateIn(['files', sourcePath], (file) =>\n    updateCookies(file, sourceHeaderId, action)\n  );\n  state = state.updateIn(['files', targetPath], (file) =>\n    updateCookies(file, targetHeaderId, action)\n  );\n\n  return state;\n};\n\n// Add a log note to the selected header. This can be any type of log\n// note as defined in the Emacs Org mode variable\n// `org-log-note-headings`.\nconst addNoteGeneric = (state, action) => {\n  const { noteText } = action;\n\n  const headerId = state.get('selectedHeaderId');\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  return state.updateIn(['headers', headerIndex], (header) => {\n    const updatedHeader = header.update('logNotes', (logNotes) =>\n      parseRawText(noteText + (logNotes.isEmpty() ? '\\n' : '')).concat(logNotes)\n    );\n    return updatedHeader.set('planningItems', updatePlanningItemsFromHeader(updatedHeader));\n  });\n};\n\n// See Emacs Org mode `org-add-note` (C-c C-z) and variable\n// `org-log-note-headings`.\nconst addNote = (state, action) => {\n  const { inputText, currentDate } = action;\n  // Wrap line at 70 characters, see Emacs `fill-column` in \"Insert\n  // note\" window (C-c C-z)\n  const wrappedInput = formatTextWrap(inputText, 70).replace(/\\n(.)/, '\\n  $1');\n  // Generate note based on a template string (as defined in Emacs Org\n  // mode `org-log-note-headings`):\n  const timestamp = getTimestampAsText(currentDate, { isActive: false, withStartTime: true });\n  const noteText = `- Note taken on ${timestamp} \\\\\\\\\\n  ${wrappedInput}`;\n  return addNoteGeneric(state, { noteText });\n};\n\nconst narrowHeader = (state, action) => {\n  return state.set('narrowedHeaderId', action.headerId);\n};\n\nconst widenHeader = (state) => state.set('narrowedHeaderId', null);\n\nconst applyOpennessState = (state, action) => {\n  const { path } = action;\n  const opennessState = state.get('opennessState');\n  if (!opennessState) {\n    return state;\n  }\n\n  const fileOpennessState = opennessState.get(path);\n  if (!fileOpennessState || fileOpennessState.size === 0) {\n    return state;\n  }\n\n  let headers = state.getIn(['files', path, 'headers']);\n  fileOpennessState.forEach((openHeaderPath) => {\n    headers = openHeaderWithPath(headers, openHeaderPath);\n  });\n\n  return state.setIn(['files', path, 'headers'], headers);\n};\n\nconst setOpennessState = (state, action) => {\n  const { path, opennessState } = action;\n  return state.setIn(['opennessState', path], fromJS(opennessState));\n};\n\nconst setDirty = (state, action) => state.set('isDirty', action.isDirty);\n\nconst setSelectedTableCellId = (state, action) => state.set('selectedTableCellId', action.cellId);\n\nconst updateDescriptionOfHeaderContainingTableCell = (state, cellId, header = null) => {\n  const headers = state.get('headers');\n  if (!header) {\n    header = headerThatContainsTableCellId(headers, cellId);\n  }\n  const headerIndex = indexOfHeaderWithId(headers, header.get('id'));\n\n  return state.updateIn(['headers', headerIndex], (header) =>\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\n  );\n};\n\nconst addNewTableRow = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (rowIndex) => (rows) =>\n      rows.insert(rowIndex + 1, newEmptyTableRowLikeRows(rows))\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst removeTableRow = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (rowIndex) => (rows) =>\n      rows.delete(rowIndex)\n    )\n  );\n\n  state = state.set('selectedTableCellId', null);\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\n};\n\nconst addNewTableColumn = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, colIndex) => (rows) =>\n      rows.map((row) =>\n        row.update('contents', (contents) => contents.insert(colIndex + 1, newEmptyTableCell()))\n      )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst removeTableColumn = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, colIndex) => (rows) =>\n      rows.map((row) => row.update('contents', (contents) => contents.delete(colIndex)))\n    )\n  );\n\n  state = state.set('selectedTableCellId', null);\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\n};\n\nconst moveTableRowDown = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (rowIndex) => (rows) =>\n      rowIndex + 1 === rows.size\n        ? rows\n        : rows.insert(rowIndex, rows.get(rowIndex + 1)).delete(rowIndex + 2)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableRowUp = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (rowIndex) => (rows) =>\n      rowIndex === 0 ? rows : rows.insert(rowIndex - 1, rows.get(rowIndex)).delete(rowIndex + 1)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableColumnLeft = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, columnIndex) => (rows) =>\n      columnIndex === 0\n        ? rows\n        : rows.map((row) =>\n            row.update('contents', (contents) =>\n              contents.size === 0\n                ? contents\n                : contents\n                    .insert(columnIndex - 1, contents.get(columnIndex))\n                    .delete(columnIndex + 1)\n            )\n          )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableColumnRight = (state) => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, columnIndex) => (rows) =>\n      columnIndex + 1 >= rows.getIn([0, 'contents']).size\n        ? rows\n        : rows.map((row) =>\n            row.update('contents', (contents) =>\n              contents.size === 0\n                ? contents\n                : contents\n                    .insert(columnIndex, contents.get(columnIndex + 1))\n                    .delete(columnIndex + 2)\n            )\n          )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst updateTableCellValue = (state, action) => {\n  state = state.update('headers', (headers) =>\n    updateTableContainingCellId(headers, action.cellId, (rowIndex, colIndex) => (rows) =>\n      rows.updateIn([rowIndex, 'contents', colIndex], (cell) =>\n        cell\n          .set('rawContents', action.newValue)\n          .set('contents', fromJS(parseMarkupAndCookies(action.newValue, { excludeCookies: true })))\n      )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, action.cellId);\n};\n\nconst insertCapture = (state, action) => {\n  const headers = state.get('headers');\n  const { template, content, shouldPrepend } = action;\n\n  const { newIndex, nestingLevel, parentHeader } = insertCapturePosition(\n    template,\n    headers,\n    shouldPrepend\n  );\n  if (newIndex === undefined) {\n    // Should never happen; see comment in insertCapturePosition below.\n    return state;\n  }\n\n  const newHeader = newHeaderFromText(content, state.get('todoKeywordSets')).set(\n    'nestingLevel',\n    nestingLevel\n  );\n\n  state = state.update('headers', (headers) => headers.insert(newIndex, newHeader));\n  if (parentHeader !== undefined) {\n    // We inserted the new header under a parent rather than at the top or\n    // bottom of the file.\n    state = updateCookiesOfHeaderWithId(state, parentHeader.get('id'));\n  }\n\n  return state;\n};\n\nconst insertCapturePosition = (template, headers, shouldPrepend) => {\n  const headerPaths = template.get('headerPaths');\n  if (headerPaths.size === 0) {\n    if (shouldPrepend) {\n      // Insert at beginning of file\n      return { newIndex: 0, nestingLevel: 1 };\n    } else {\n      // Insert at end of file\n      return { newIndex: headers.size + 1, nestingLevel: 1 };\n    }\n  }\n\n  const parentHeader = headerWithPath(headers, headerPaths);\n  if (parentHeader == null) {\n    // No parent header found.  In theory this shouldn't happen since\n    // CaptureModal already checks whether a valid targetHeader can be\n    // found if headerPaths is non-empty.\n    return {};\n  }\n  const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeader.get('id'));\n  const numSubheaders = numSubheadersOfHeaderWithId(headers, parentHeader.get('id'));\n  const newIndex = parentHeaderIndex + 1 + (shouldPrepend ? 0 : numSubheaders);\n  const nestingLevel = parentHeader.get('nestingLevel') + 1;\n  return { newIndex, nestingLevel, parentHeader };\n};\n\nconst clearPendingCapture = (state) => state.set('pendingCapture', null);\n\nconst updateParentListCheckboxes = (state, itemPath) => {\n  const parentListItemPath = itemPath.slice(0, itemPath.length - 4);\n  const parentListItem = state.getIn(parentListItemPath);\n  if (!parentListItem.get('isCheckbox')) {\n    return state;\n  }\n\n  const childrenCheckedStates = parentListItem\n    .get('contents')\n    .filter((part) => part.get('type') === 'list')\n    .flatMap((listPart) =>\n      listPart\n        .get('items')\n        .filter((item) => item.get('isCheckbox'))\n        .map((checkboxItem) => checkboxItem.get('checkboxState'))\n    );\n\n  if (childrenCheckedStates.every((state) => state === 'checked')) {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'checked');\n  } else if (childrenCheckedStates.every((state) => state === 'unchecked')) {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'unchecked');\n  } else {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'partial');\n  }\n\n  const childCompletionStates = childrenCheckedStates\n    .map((state) => {\n      switch (state) {\n        case 'checked':\n          return true;\n        case 'unchecked':\n          return false;\n        case 'partial':\n          return false;\n        default:\n          if (process.env.NODE_ENV !== 'production') {\n            throw Error(\"Unexpected checkboxState: '\" + state + \"'\");\n          } else {\n            return false;\n          }\n      }\n    })\n    .toJS();\n\n  state = state.updateIn(parentListItemPath.concat('titleLine'), (titleLine) =>\n    updateCookiesInAttributedStringWithChildCompletionStates(titleLine, childCompletionStates)\n  );\n\n  return updateParentListCheckboxes(state, parentListItemPath);\n};\n\nconst advanceCheckboxState = (state, action) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(state.get('headers'), action.listItemId);\n  const { path, listItemPart } = pathAndPart;\n\n  const hasDirectCheckboxChildren = listItemPart\n    .get('contents')\n    .filter((part) => part.get('type') === 'list')\n    .some((listPart) => listPart.get('items').some((item) => item.get('isCheckbox')));\n  if (hasDirectCheckboxChildren) {\n    return state;\n  }\n\n  const newCheckboxState = {\n    checked: 'unchecked',\n    unchecked: 'checked',\n    partial: 'unchecked',\n  }[listItemPart.get('checkboxState')];\n\n  state = state.setIn(['headers'].concat(path).concat(['checkboxState']), newCheckboxState);\n  state = updateParentListCheckboxes(state, ['headers'].concat(path));\n\n  const headerIndex = path[0];\n  state = updateCookiesOfHeaderWithId(state, state.getIn(['headers', headerIndex, 'id']));\n  state = state.updateIn(['headers', headerIndex], (header) =>\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\n  );\n\n  return state;\n};\n\nconst setLastSyncAt = (state, action) => state.set('lastSyncAt', action.lastSyncAt);\n\nconst setHeaderTags = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  if (headerIndex === -1) {\n    return state;\n  }\n\n  return state.setIn(['headers', headerIndex, 'titleLine', 'tags'], action.tags);\n};\n\nconst reorderTags = (state, action) => {\n  const selectedHeaderId = state.get('selectedHeaderId');\n  if (!selectedHeaderId) {\n    return state;\n  }\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), selectedHeaderId);\n\n  return state.updateIn(['headers', headerIndex, 'titleLine', 'tags'], (tags) =>\n    tags.splice(action.fromIndex, 1).splice(action.toIndex, 0, tags.get(action.fromIndex))\n  );\n};\n\nconst reorderPropertyList = (state, action) => {\n  const headerId = action.headerId;\n  if (!headerId) {\n    return state;\n  }\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\n\n  return state.updateIn(['headers', headerIndex, 'propertyListItems'], (propertyListItems) =>\n    propertyListItems\n      .splice(action.fromIndex, 1)\n      .splice(action.toIndex, 0, propertyListItems.get(action.fromIndex))\n  );\n};\n\nconst updateTimestampWithId = (state, action) => {\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInHeaders(\n    state.get('headers'),\n    action.timestampId\n  );\n  if (!pathAndPart) {\n    return state;\n  }\n\n  const { path } = pathAndPart;\n  const headerIndex = path[0];\n\n  return state\n    .setIn(['headers'].concat(path), action.newTimestamp)\n    .updateIn(['headers', headerIndex], (header) => {\n      const description = header.get('description');\n      const title = header.getIn(['titleLine', 'title']);\n\n      return header\n        .setIn(['titleLine', 'rawTitle'], attributedStringToRawText(title))\n        .set('rawDescription', attributedStringToRawText(description))\n        .set('planningItems', updatePlanningItemsFromHeader(header));\n    });\n};\n\n// This is for special planning items like SCHEDULED: and DEADLINE:; but not\n// for normal active timestamps (which are also added to planning items).\nconst updatePlanningItemTimestamp = (state, action) => {\n  const { headerId, planningItemIndex, newTimestamp } = action;\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\n\n  return state.setIn(\n    ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\n    newTimestamp\n  );\n};\n\nconst addNewPlanningItem = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n\n  const newPlanningItem = fromJS({\n    id: generateId(),\n    type: action.planningType,\n    timestamp: timestampForDate(action.timestamp),\n  });\n\n  return state.updateIn(['headers', headerIndex, 'planningItems'], (planningItems) =>\n    !!planningItems ? planningItems.push(newPlanningItem) : List([newPlanningItem])\n  );\n};\n\nconst removePlanningItem = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n  const { planningItemIndex } = action;\n\n  return state.removeIn(['headers', headerIndex, 'planningItems', planningItemIndex]);\n};\n\nconst removeTimestamp = (state, action) => {\n  const { path } = pathAndPartOfTimestampItemWithIdInHeaders(\n    state.get('headers'),\n    action.timestampId\n  );\n\n  // remove parsed timestamp\n  state = state.removeIn(['headers', ...path]);\n\n  // in case this is an active timestamp, remove it from planning items.\n  state = state.updateIn(['headers', path[0], 'planningItems'], (planningItems) =>\n    planningItems.filter((item) => item.get('id') !== action.timestampId)\n  );\n\n  // rebuild text representation of header\n  state = state.setIn(\n    ['headers', path[0], 'titleLine', 'rawTitle'],\n    attributedStringToRawText(state.getIn(['headers', path[0], 'titleLine', 'title']))\n  );\n  state = state.setIn(\n    ['headers', path[0], 'rawDescription'],\n    attributedStringToRawText(state.getIn(['headers', path[0], 'description']))\n  );\n\n  return state;\n};\n\nexport const updatePropertyListItems = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n\n  return state.setIn(['headers', headerIndex, 'propertyListItems'], action.newPropertyListItems);\n};\n\nexport const setLogEntryStop = (state, action) => {\n  const { headerId, entryId, time } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  const entryIndex = state\n    .getIn(['headers', headerIdx, 'logBookEntries'])\n    .findIndex((entry) => entry.get('id') === entryId);\n  return state.setIn(['headers', headerIdx, 'logBookEntries', entryIndex, 'end'], fromJS(time));\n};\n\nexport const createLogEntryStart = (state, action) => {\n  const { headerId, time } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  const newEntry = fromJS({\n    id: generateId(),\n    start: time,\n    end: null,\n  });\n  return state.updateIn(['headers', headerIdx, 'logBookEntries'], (entries) =>\n    !!entries ? entries.unshift(newEntry) : List([newEntry])\n  );\n};\n\nexport const updateLogEntryTime = (state, action) => {\n  const { headerId, entryIndex, entryType, newTime } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  return state.setIn(\n    ['headers', headerIdx, 'logBookEntries', entryIndex, entryType],\n    fromJS(newTime)\n  );\n};\n\nexport const determineIncludedFiles = (files, fileSettings, path, settingValue, includeByDefault) =>\n  files.mapEntries(([filePath, file]) => [\n    filePath,\n    file.update('headers', (headers) => {\n      const fileSetting = fileSettings.find((setting) => filePath === setting.get('path'));\n      // always include the viewed file\n      if (path === filePath) {\n        return headers;\n      } else if (fileSetting) {\n        if (fileSetting.get(settingValue)) {\n          return headers;\n        } else {\n          return List();\n        }\n      } else if (filePath.startsWith(STATIC_FILE_PREFIX)) {\n        // never include static files\n        return List();\n      } else {\n        // if no setting exists\n        return includeByDefault ? headers : List();\n      }\n    }),\n  ]);\n\nconst searchHeaders = ({ searchFilterExpr = [], headersToSearch, path }) => {\n  let filteredHeaders;\n  let nrOfHeadersToSearch = 200;\n  const searchFilterFunction = isMatch(searchFilterExpr);\n\n  // search the current file first\n  const headersFoundInCurrentFile = headersToSearch\n    .get(path)\n    .filter(searchFilterFunction)\n    .take(nrOfHeadersToSearch);\n  nrOfHeadersToSearch -= headersFoundInCurrentFile.count();\n  filteredHeaders = Map().set(path, headersFoundInCurrentFile);\n\n  // search rest of files until nrOfHeadersToDisplay results are found\n  const filePathsToSearch = headersToSearch.keySeq().filter((p) => p !== path);\n  filePathsToSearch.forEach((filePath) => {\n    if (nrOfHeadersToSearch > 0) {\n      const headersFoundInFile = headersToSearch\n        .get(filePath)\n        .filter(searchFilterFunction)\n        .take(nrOfHeadersToSearch);\n      nrOfHeadersToSearch -= headersFoundInFile.count();\n      filteredHeaders = filteredHeaders.set(filePath, headersFoundInFile);\n    }\n  });\n  return filteredHeaders;\n};\n\nexport const setSearchFilterInformation = (state, action) => {\n  const { searchFilter, cursorPosition, context } = action;\n\n  let files = state.get('files');\n  state = state.asMutable();\n\n  let searchFilterValid = true;\n  let searchFilterExpr;\n  try {\n    searchFilterExpr = headline_filter_parser.parse(searchFilter);\n    state.setIn(['search', 'searchFilterExpr'], searchFilterExpr);\n  } catch (e) {\n    // No need to print this parser exceptions. They are expected, see\n    // *.grammar.pegjs. However, we don't need to update the filtered\n    // headers when given an invalid search filter.\n    searchFilterValid = false;\n  }\n\n  const path = state.get('path');\n  const fileSettings = state.get('fileSettings');\n  // Decide which files to include\n  if (context === 'agenda') {\n    files = determineIncludedFiles(files, fileSettings, path, 'includeInAgenda', false);\n  } else if (context === 'search') {\n    files = determineIncludedFiles(files, fileSettings, path, 'includeInSearch', false);\n  } else if (context === 'task-list') {\n    files = determineIncludedFiles(files, fileSettings, path, 'includeInTasklist', false);\n  } else if (context === 'refile') {\n    files = determineIncludedFiles(files, fileSettings, path, 'includeInRefile', false);\n  } // there should not be another context, but if so use all files\n\n  state.setIn(['search', 'searchFilterValid'], searchFilterValid);\n  // Only run filter if a filter is given and parsing was successful\n  if (searchFilterValid) {\n    const headers = files.map((file) => file.get('headers'));\n\n    // show clocked times & sum if there is a clock search term\n    const clockFilters = searchFilterExpr\n      .filter((f) => f.type === 'field')\n      .filter((f) => f.field.type === 'clock');\n    const filterFunctions = clockFilters.map(timeFilter);\n    const showClockedTimes = clockFilters.length !== 0;\n    state.setIn(['search', 'showClockedTimes'], showClockedTimes);\n\n    // Only search subheaders if a header is narrowed\n    const narrowedHeaderId = state.getIn(['files', path, 'narrowedHeaderId']);\n    let headersToSearch;\n    if (!narrowedHeaderId || context === 'refile') {\n      headersToSearch = headers;\n    } else {\n      headersToSearch = Map().set(\n        path,\n        subheadersOfHeaderWithId(headers.get(path), narrowedHeaderId)\n      );\n    }\n\n    // calculate relevant clocked times and total\n    if (showClockedTimes) {\n      headersToSearch = headersToSearch.map((headersOfFile) =>\n        headersOfFile.map((header) =>\n          header.set('totalFilteredTimeLogged', totalFilteredTimeLogged(filterFunctions, header))\n        )\n      );\n      headersToSearch = headersToSearch.map((headersOfFile) =>\n        updateHeadersTotalFilteredTimeLoggedRecursive(filterFunctions, headersOfFile).filter(\n          (header) => header.get('totalFilteredTimeLoggedRecursive') !== 0\n        )\n      );\n    }\n\n    // perform the actual search\n    let filteredHeaders = searchHeaders({ searchFilterExpr, headersToSearch, path });\n\n    if (showClockedTimes) {\n      const clockedTime = filteredHeaders\n        .map((headersOfFile) =>\n          headersOfFile.reduce((acc, val) => acc + val.get('totalFilteredTimeLogged'), 0)\n        )\n        .toList()\n        .reduce((acc, val) => acc + val, 0);\n      state.setIn(['search', 'clockedTime'], clockedTime);\n    }\n\n    // Filter selectedHeader and its subheaders from `headers`,\n    // because you don't want to refile a header to itself or to one\n    // of its subheaders.\n    if (context === 'refile') {\n      const selectedHeaderId = state.getIn(['files', path, 'selectedHeaderId']);\n      const subheaders = subheadersOfHeaderWithId(headers.get(path), selectedHeaderId);\n      let filterIds = subheaders.map((s) => s.get('id')).toJS();\n      filterIds.push(selectedHeaderId);\n      filteredHeaders = filteredHeaders.update(path, (headersOfFile) =>\n        headersOfFile.filter((h) => {\n          return !filterIds.includes(h.get('id'));\n        })\n      );\n    }\n\n    state.setIn(['search', 'filteredHeaders'], filteredHeaders);\n  }\n\n  state.setIn(['search', 'searchFilter'], searchFilter);\n\n  // INFO: This is a POC draft of a future feature\n  // This could come from the last session, hence from localStorage.\n  // Just some more examples for now:\n  const lastUsedFilterStrings = [\n    'TODO organice',\n    '-organice :medium',\n    '-DONE doc|man :assignee:none',\n  ];\n\n  let searchFilterSuggestions = [];\n  if (_.isEmpty(searchFilter)) {\n    // Only for an empty filter string,  provide last used filters as suggestions.\n    searchFilterSuggestions = lastUsedFilterStrings;\n  } else {\n    // TODO: Currently only showing suggestions based on opened file.\n    // Decide if they should be based on all files.\n    const currentFile = files.get(path);\n    const headersOfFile = currentFile.get('headers');\n    const todoKeywords = getTodoKeywordSetsAsFlattenedArray(currentFile);\n    const tagNames = extractAllOrgTags(headersOfFile).toJS();\n    const allProperties = extractAllOrgProperties(headersOfFile).toJS();\n    searchFilterSuggestions = computeCompletionsForDatalist(todoKeywords, tagNames, allProperties)(\n      searchFilterExpr,\n      searchFilter,\n      cursorPosition\n    );\n  }\n\n  state.setIn(['search', 'searchFilterSuggestions'], searchFilterSuggestions);\n\n  return state.asImmutable();\n};\n\nconst setOrgFileErrorMessage = (state, action) => state.set('orgFileErrorMessage', action.message);\n\nconst setPath = (state, action) => state.set('path', action.path);\n\nconst setShowClockDisplay = (state, action) => {\n  if (action.showClockDisplay) {\n    state = state.update('headers', updateHeadersTotalTimeLoggedRecursive);\n  }\n  return state.set('showClockDisplay', action.showClockDisplay);\n};\n\nconst indexOfFileSettingWithId = (settings, settingId) =>\n  settings.findIndex((setting) => setting.get('id') === settingId);\n\nconst updateFileSettingFieldPathValue = (state, action) => {\n  const settingIndex = indexOfFileSettingWithId(state.get('fileSettings'), action.settingId);\n\n  return state.setIn(['fileSettings', settingIndex].concat(action.fieldPath), action.newValue);\n};\n\nconst reorderFileSetting = (state, action) =>\n  state.update('fileSettings', (settings) =>\n    settings.splice(action.fromIndex, 1).splice(action.toIndex, 0, settings.get(action.fromIndex))\n  );\n\nconst deleteFileSetting = (state, action) => {\n  const settingIndex = indexOfFileSettingWithId(state.get('fileSettings'), action.settingId);\n\n  return state.update('fileSettings', (settings) => settings.delete(settingIndex));\n};\n\nconst addNewEmptyFileSetting = (state) =>\n  state.update('fileSettings', (settings) =>\n    settings.push(\n      fromJS({\n        id: generateId(),\n        path: '',\n        loadOnStartup: false,\n        includeInAgenda: false,\n        includeInSearch: false,\n        includeInRefile: false,\n        includeInTasklist: false,\n      })\n    )\n  );\n\nconst restoreFileSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyFileSettingsFromConfig(state, action.newSettings);\n};\n\nconst reduceInFile = (state, action, path) => (func, ...args) => {\n  return state.updateIn(['files', path], (file) => func(file ? file : Map(), action, ...args));\n};\n\nconst reducer = (state, action) => {\n  const path = state.get('path');\n  const inFile = reduceInFile(state, action, path);\n\n  switch (action.type) {\n    case 'PARSE_FILE':\n      return parseFile(state, action);\n    case 'CLEAR_SEARCH':\n      return clearSearch(state, action);\n    case 'TOGGLE_HEADER_OPENED':\n      return inFile(toggleHeaderOpened);\n    case 'OPEN_HEADER':\n      return inFile(openHeader);\n    case 'SELECT_HEADER':\n      return inFile(selectHeader);\n    case 'OPEN_PARENTS_OF_HEADER':\n      return inFile(openParentsOfHeader);\n    case 'ADVANCE_TODO_STATE':\n      return inFile(advanceTodoState);\n    case 'ENTER_EDIT_MODE':\n      return inFile(enterEditMode);\n    case 'EXIT_EDIT_MODE':\n      return inFile(exitEditMode);\n    case 'UPDATE_HEADER_TITLE':\n      return inFile(updateHeaderTitle);\n    case 'UPDATE_HEADER_DESCRIPTION':\n      return inFile(updateHeaderDescription);\n    case 'ADD_HEADER':\n      return inFile(addHeader);\n    case 'SELECT_NEXT_SIBLING_HEADER':\n      return inFile(selectNextSiblingHeader);\n    case 'SELECT_NEXT_VISIBLE_HEADER':\n      return inFile(selectNextVisibleHeader);\n    case 'SELECT_PREVIOUS_VISIBLE_HEADER':\n      return inFile(selectPreviousVisibleHeader);\n    case 'REMOVE_HEADER':\n      return inFile(removeHeader);\n    case 'MOVE_HEADER_UP':\n      return inFile(moveHeaderUp);\n    case 'MOVE_HEADER_DOWN':\n      return inFile(moveHeaderDown);\n    case 'MOVE_HEADER_LEFT':\n      return inFile(moveHeaderLeft);\n    case 'MOVE_HEADER_RIGHT':\n      return inFile(moveHeaderRight);\n    case 'MOVE_SUBTREE_LEFT':\n      return inFile(moveSubtreeLeft);\n    case 'MOVE_SUBTREE_RIGHT':\n      return inFile(moveSubtreeRight);\n    case 'REFILE_SUBTREE':\n      return refileSubtree(state, action);\n    case 'HEADER_ADD_NOTE':\n      return inFile(addNote);\n    case 'APPLY_OPENNESS_STATE':\n      return applyOpennessState(state, action);\n    case 'SET_OPENNESS_STATE':\n      return setOpennessState(state, action);\n    case 'SET_DIRTY':\n      return action.path ? reduceInFile(state, action, action.path)(setDirty) : inFile(setDirty);\n    case 'NARROW_HEADER':\n      return inFile(narrowHeader);\n    case 'WIDEN_HEADER':\n      return inFile(widenHeader);\n    case 'SET_SELECTED_TABLE_CELL_ID':\n      return inFile(setSelectedTableCellId);\n    case 'ADD_NEW_TABLE_ROW':\n      return inFile(addNewTableRow);\n    case 'REMOVE_TABLE_ROW':\n      return inFile(removeTableRow);\n    case 'ADD_NEW_TABLE_COLUMN':\n      return inFile(addNewTableColumn);\n    case 'REMOVE_TABLE_COLUMN':\n      return inFile(removeTableColumn);\n    case 'MOVE_TABLE_ROW_DOWN':\n      return inFile(moveTableRowDown);\n    case 'MOVE_TABLE_ROW_UP':\n      return inFile(moveTableRowUp);\n    case 'MOVE_TABLE_COLUMN_LEFT':\n      return inFile(moveTableColumnLeft);\n    case 'MOVE_TABLE_COLUMN_RIGHT':\n      return inFile(moveTableColumnRight);\n    case 'UPDATE_TABLE_CELL_VALUE':\n      return inFile(updateTableCellValue);\n    case 'INSERT_CAPTURE':\n      return action.template.get('file')\n        ? reduceInFile(state, action, action.template.get('file'))(insertCapture)\n        : inFile(insertCapture);\n    case 'CLEAR_PENDING_CAPTURE':\n      return clearPendingCapture(state, action);\n    case 'ADVANCE_CHECKBOX_STATE':\n      return inFile(advanceCheckboxState);\n    case 'SET_LAST_SYNC_AT':\n      return action.path\n        ? reduceInFile(state, action, action.path)(setLastSyncAt)\n        : inFile(setLastSyncAt);\n    case 'SET_HEADER_TAGS':\n      return inFile(setHeaderTags);\n    case 'REORDER_TAGS':\n      return inFile(reorderTags);\n    case 'REORDER_PROPERTY_LIST':\n      return inFile(reorderPropertyList);\n    case 'UPDATE_TIMESTAMP_WITH_ID':\n      return inFile(updateTimestampWithId);\n    case 'UPDATE_PLANNING_ITEM_TIMESTAMP':\n      return inFile(updatePlanningItemTimestamp);\n    case 'ADD_NEW_PLANNING_ITEM':\n      return inFile(addNewPlanningItem);\n    case 'REMOVE_PLANNING_ITEM':\n      return inFile(removePlanningItem);\n    case 'REMOVE_TIMESTAMP':\n      return inFile(removeTimestamp);\n    case 'UPDATE_PROPERTY_LIST_ITEMS':\n      return inFile(updatePropertyListItems);\n    case 'SET_ORG_FILE_ERROR_MESSAGE':\n      return setOrgFileErrorMessage(state, action);\n    case 'SET_LOG_ENTRY_STOP':\n      return inFile(setLogEntryStop);\n    case 'CREATE_LOG_ENTRY_START':\n      return inFile(createLogEntryStart);\n    case 'UPDATE_LOG_ENTRY_TIME':\n      return inFile(updateLogEntryTime);\n    case 'SET_SEARCH_FILTER_INFORMATION':\n      return setSearchFilterInformation(state, action);\n    case 'SET_PATH':\n      return setPath(state, action);\n    case 'TOGGLE_CLOCK_DISPLAY':\n      return setShowClockDisplay(state, action);\n    case 'UPDATE_FILE_SETTING_FIELD_PATH_VALUE':\n      return updateFileSettingFieldPathValue(state, action);\n    case 'REORDER_FILE_SETTING':\n      return reorderFileSetting(state, action);\n    case 'DELETE_FILE_SETTING':\n      return deleteFileSetting(state, action);\n    case 'ADD_NEW_EMPTY_FILE_SETTING':\n      return addNewEmptyFileSetting(state, action);\n    case 'RESTORE_FILE_SETTINGS':\n      return restoreFileSettings(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default (state = Map(), action) => {\n  const affectedFiles = determineAffectedFiles(state, action);\n  affectedFiles.forEach((path) => {\n    state = state.setIn(['files', path, 'isDirty'], true);\n  });\n\n  state = reducer(state, action);\n\n  if (action.dirtying && state.get('showClockDisplay')) {\n    affectedFiles.forEach((path) => {\n      state = state.updateIn(['files', path, 'headers'], updateHeadersTotalTimeLoggedRecursive);\n    });\n  }\n  return state;\n};\n\nexport const determineAffectedFiles = (state, action) => {\n  if (action.dirtying) {\n    if (action.type === 'REFILE_SUBTREE') {\n      return [action.sourcePath, action.targetPath];\n    } else if (action.type === 'INSERT_CAPTURE') {\n      const captureTarget = action.template.get('file');\n      if (captureTarget) {\n        return [captureTarget];\n      } else {\n        return [state.get('path')];\n      }\n    } else {\n      return [state.get('path')];\n    }\n  } else {\n    return [];\n  }\n};\n\n/**\n * Updates Headlines with the next todoKeyword `newTodoState`. Also\n * reschedules planning items with repeaters if applicable.\n * @param {any} currentTodoSet\n * @param {String} newTodoState\n * @param {any} indexedPlanningItemsWithRepeaters\n * @param {Object} state - redux state\n * @param {Number} headerIndex\n * @param {String} currentTodoState\n */\nfunction updateHeadlines({\n  currentTodoSet,\n  newTodoState,\n  indexedPlanningItemsWithRepeaters,\n  state,\n  headerIndex,\n  currentTodoState,\n  logIntoDrawer,\n  timestamp,\n}) {\n  if (\n    currentTodoSet.get('completedKeywords').includes(newTodoState) &&\n    indexedPlanningItemsWithRepeaters.size > 0\n  )\n    return updatePlanningItemsWithRepeaters({\n      indexedPlanningItemsWithRepeaters,\n      state,\n      headerIndex,\n      currentTodoSet,\n      newTodoState,\n      currentTodoState,\n      logIntoDrawer,\n      timestamp,\n    });\n  // Update simple headline (without repeaters)\n  return state.setIn(['headers', headerIndex, 'titleLine', 'todoKeyword'], newTodoState);\n}\n\n/**\n * Add a TODO state change log item either to the heading body or LOGBOOK drawer.\n *\n * @param {*} state\n * @param {*} headerIndex Index of header where the state change log item should be added.\n * @param {string} newTodoState New TODO state, e.g. DONE.\n * @param {string} currentTodoState Current TODO state, e.g. TODO or DONE.\n * @param {boolean} logIntoDrawer By default false, so add log messages as bullets into the body. If true, add into LOGBOOK drawer.\n */\nfunction addTodoStateChangeLogItem(\n  state,\n  headerIndex,\n  newTodoState,\n  currentTodoState,\n  logIntoDrawer,\n  timestamp\n) {\n  // This is how the TODO state change will be logged\n  const inactiveTimestamp = getTimestampAsText(timestamp, { isActive: false, withStartTime: true });\n  const newStateChangeLogText = `- State \"${newTodoState}\"       from \"${currentTodoState}\"       ${inactiveTimestamp}`;\n\n  if (logIntoDrawer) {\n    // Prepend this single item to the :LOGBOOK: drawer, same as org-log-into-drawer setting\n    // https://www.gnu.org/software/emacs/manual/html_node/org/Tracking-TODO-state-changes.html\n    const newEntry = fromJS({\n      id: generateId(),\n      raw: newStateChangeLogText,\n    });\n    return state.updateIn(['headers', headerIndex, 'logBookEntries'], (entries) =>\n      entries.unshift(newEntry)\n    );\n  } else {\n    // When org-log-into-drawer not set, prepend state change log text to log notes\n    return addNoteGeneric(state, { noteText: newStateChangeLogText });\n  }\n}\n\nfunction updatePlanningItemsWithRepeaters({\n  indexedPlanningItemsWithRepeaters,\n  state,\n  headerIndex,\n  currentTodoSet,\n  newTodoState,\n  currentTodoState,\n  logIntoDrawer,\n  timestamp,\n}) {\n  indexedPlanningItemsWithRepeaters.forEach(([planningItem, planningItemIndex]) => {\n    const adjustedTimestamp = applyRepeater(planningItem.get('timestamp'), timestamp);\n    state = state.setIn(\n      ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\n      adjustedTimestamp\n    );\n\n    // INFO: Active timestamps are now manually updated in place.\n    // Rationale: The active timestamps in title and description are\n    // added to `planningItems` on parse. Since there can be an\n    // arbitrary amount of timestamps it makes sense not to have one\n    // `planningItem` representing the title or the description. We\n    // need to preserve the place of a timestamp in title/description\n    // and we want to have it in a list of `planningItems`. So they\n    // necessarily exist in more than one place. There might be a\n    // cleaner solution where we store the timestamp only in one place\n    // and use references to that place but I don't see any extra\n    // benefit for what would be no negligible refactoring effort.\n\n    // Scheduled / deadline timestamps on the other hand are part of\n    // `rawDescription` but not of the parsed description. These\n    // timestamps only exist in one place (`planningItems`) so\n    // changing them there is visible and will be persisted.\n    switch (planningItem.get('type')) {\n      case 'TIMESTAMP_TITLE':\n        const titleIndex = state\n          .getIn(['headers', headerIndex, 'titleLine', 'title'])\n          .findIndex((titlePart) => planningItem.get('id') === titlePart.get('id'));\n        state = state.setIn(\n          ['headers', headerIndex, 'titleLine', 'title', titleIndex, 'firstTimestamp'],\n          adjustedTimestamp\n        );\n        state = state.setIn(\n          ['headers', headerIndex, 'titleLine', 'rawTitle'],\n          attributedStringToRawText(state.getIn(['headers', headerIndex, 'titleLine', 'title']))\n        );\n        break;\n      case 'TIMESTAMP_DESCRIPTION':\n        const descriptionIndex = state\n          .getIn(['headers', headerIndex, 'description'])\n          .findIndex((descriptionPart) => planningItem.get('id') === descriptionPart.get('id'));\n        state = state.setIn(\n          ['headers', headerIndex, 'description', descriptionIndex, 'firstTimestamp'],\n          adjustedTimestamp\n        );\n        state = state.setIn(\n          ['headers', headerIndex, 'rawDescription'],\n          attributedStringToRawText(state.getIn(['headers', headerIndex, 'description']))\n        );\n        break;\n      default:\n        break;\n    }\n  });\n  state = state.setIn(\n    ['headers', headerIndex, 'titleLine', 'todoKeyword'],\n    currentTodoSet.get('keywords').first()\n  );\n  if (!noLogRepeatEnabledP({ state, headerIndex })) {\n    const lastRepeatTimestamp = timestampForDate(timestamp, {\n      isActive: false,\n      withStartTime: true,\n    });\n    const newLastRepeatValue = [\n      {\n        type: 'timestamp',\n        id: generateId(),\n        firstTimestamp: lastRepeatTimestamp,\n        secondTimestamp: null,\n      },\n    ];\n\n    state = state.updateIn(['headers', headerIndex, 'propertyListItems'], (propertyListItems) =>\n      propertyListItems.some((item) => item.get('property') === 'LAST_REPEAT')\n        ? propertyListItems.map((item) =>\n            item.get('property') === 'LAST_REPEAT'\n              ? item.set('value', fromJS(newLastRepeatValue))\n              : item\n          )\n        : propertyListItems.push(\n            fromJS({\n              property: 'LAST_REPEAT',\n              value: newLastRepeatValue,\n              id: generateId(),\n            })\n          )\n    );\n    state = addTodoStateChangeLogItem(\n      state,\n      headerIndex,\n      newTodoState,\n      currentTodoState,\n      logIntoDrawer,\n      timestamp\n    );\n  }\n  return state;\n}\n\n/**\n * Is the `nologrepeat` feature enabled for this buffer?\n * More info:\n * https://www.gnu.org/software/emacs/manual/html_node/org/Repeated-tasks.html\n */\nexport function noLogRepeatEnabledP({ state, headerIndex }) {\n  const startupOptNoLogRepeat = state\n    .get('fileConfigLines')\n    .some((elt) => elt.match(/^#\\+STARTUP:.*nologrepeat.*/));\n  const loggingProp = inheritedValueOfProperty(state.get('headers'), headerIndex, 'LOGGING');\n  return !!(\n    startupOptNoLogRepeat ||\n    (loggingProp &&\n      loggingProp.some(\n        (v) => v.get('type') === 'text' && v.get('contents').match(/\\s*nologrepeat\\s*/)\n      ))\n  );\n}\n\n/**\n * Function wrapper around `updateCookiesOfHeaderWithId` and\n * `updateCookiesOfParentOfHeaderWithId`.\n */\nfunction updateCookies(file, previousParentHeaderId, action) {\n  file = updateCookiesOfHeaderWithId(file, previousParentHeaderId);\n  file = updateCookiesOfParentOfHeaderWithId(file, action.headerId);\n  return file;\n}\n\n/**\n * Helper function to calculate the new state when moving a header\n * (either with or without subheaders) to the left or right.\n * @param {Object} param0 - Current state\n * @param {Object} param0.state - Redux `state` object\n * @param {Object} param0.headerIndex - Position of relevant header object\n * @param {Object} param0.subheaders - List of subheaders of relevant header\n * @param {String} direction: Can be either '-' to move the header left\n * or '+' to move it right\n */\nfunction shiftTreeNestingLevel({ state, headerIndex, subheaders = [] }, direction = '-') {\n  state = state.updateIn(['headers', headerIndex, 'nestingLevel'], calculateNestingLevel());\n  subheaders.forEach((_, index) => {\n    state = state.updateIn(\n      ['headers', headerIndex + index + 1, 'nestingLevel'],\n      calculateNestingLevel()\n    );\n  });\n  return state;\n\n  function calculateNestingLevel() {\n    return (nestingLevel) => {\n      if (direction === '-') {\n        // Don't move a header further to the left than the first\n        // column\n        return Math.max(nestingLevel - 1, 1);\n      } else {\n        return nestingLevel + 1;\n      }\n    };\n  }\n}\n","// Hard-wrap long lines - from https://codereview.stackexchange.com/a/171857\nexport const formatTextWrap = (text, maxLineLength) => {\n  const words = text.replace(/[\\r\\n]+/g, ' ').split(' ');\n  let lineLength = 0;\n\n  return words.reduce((result, word) => {\n    if (lineLength + word.length >= maxLineLength) {\n      lineLength = word.length;\n      return result + `\\n${word}`; // don't add spaces upfront\n    } else {\n      lineLength += word.length + (result ? 1 : 0);\n      return result ? result + ` ${word}` : `${word}`; // add space only when needed\n    }\n  }, '');\n};\n","import { debounce } from 'lodash';\nimport { parseISO, addSeconds } from 'date-fns';\nimport { localStorageAvailable } from '../util/settings_persister';\nimport { exportOrg } from '../lib/export_org';\nimport { parseFile } from '../reducers/org';\nimport { STATIC_FILE_PREFIX } from '../lib/org_utils';\n\nexport const persistIsDirty = (isDirty, path) => {\n  if (localStorageAvailable) {\n    const filesDirty = JSON.parse(localStorage.getItem('isDirty')) || {};\n    filesDirty[path] = isDirty;\n    localStorage.setItem('isDirty', JSON.stringify(filesDirty));\n  }\n};\n\nexport const saveFileContentsToLocalStorage = (path, contents) => {\n  if (localStorageAvailable && !path.startsWith(STATIC_FILE_PREFIX)) {\n    let persistedFiles = JSON.parse(localStorage.getItem('persistedFiles'));\n    persistedFiles = persistedFiles || {};\n\n    localStorage.setItem('files__' + path, contents);\n    persistedFiles[path] = addSeconds(new Date(), 5);\n\n    localStorage.setItem('persistedFiles', JSON.stringify(persistedFiles));\n  }\n};\n\nconst saveFunctionToDebounce = (state, path) => {\n  if (localStorageAvailable && !path.startsWith(STATIC_FILE_PREFIX)) {\n    const persistedFiles = JSON.parse(localStorage.getItem('persistedFiles')) || {};\n\n    const contents = exportOrg({\n      headers: state.org.present.getIn(['files', path, 'headers']),\n      linesBeforeHeadings: state.org.present.getIn(['files', path, 'linesBeforeHeadings']),\n      dontIndent: state.base.get('shouldNotIndentOnExport'),\n    });\n    localStorage.setItem('files__' + path, contents);\n\n    persistedFiles[path] = state.org.present.getIn(['files', path, 'lastSyncAt']);\n    localStorage.setItem('persistedFiles', JSON.stringify(persistedFiles));\n  }\n};\nconst getDebouncedSaveFunction = () =>\n  debounce(saveFunctionToDebounce, 3000, {\n    leading: true,\n    trailing: true,\n  });\nconst debouncedSaveFunctions = {};\nexport const saveFileToLocalStorage = (state, path) => {\n  // to make sure no file is skipped when multiple files are dirty\n  // a seperately debounced function is used per file\n  let debouncedSaveFunction = debouncedSaveFunctions[path];\n  if (!debouncedSaveFunction) {\n    debouncedSaveFunctions[path] = getDebouncedSaveFunction();\n    debouncedSaveFunction = debouncedSaveFunctions[path];\n  }\n  debouncedSaveFunction(state, path);\n};\n\nexport const loadFilesFromLocalStorage = (state) => {\n  if (localStorageAvailable) {\n    const persistedFiles = JSON.parse(localStorage.getItem('persistedFiles')) || {};\n    const isDirty = JSON.parse(localStorage.getItem('isDirty')) || {};\n    Object.entries(persistedFiles).forEach(([path, lastSyncAt]) => {\n      const contents = localStorage.getItem('files__' + path);\n      if (contents) {\n        state.org.present = state.org.present.update((org) => parseFile(org, { path, contents }));\n        state.org.present = state.org.present.setIn(\n          ['files', path, 'lastSyncAt'],\n          parseISO(lastSyncAt)\n        );\n        state.org.present = state.org.present.setIn(['files', path, 'isDirty'], isDirty[path]);\n      }\n    });\n  }\n  return state;\n};\n","import { ActionCreators, ActionTypes } from 'redux-undo';\nimport { debounce } from 'lodash';\nimport {\n  setLoadingMessage,\n  hideLoadingMessage,\n  setIsLoading,\n  setDisappearingLoadingMessage,\n  activatePopup,\n  closePopup,\n} from './base';\nimport { exportOrg } from '../lib/export_org';\nimport substituteTemplateVariables from '../lib/capture_template_substitution';\nimport { headerWithPath, STATIC_FILE_PREFIX } from '../lib/org_utils';\n\nimport sampleCaptureTemplates from '../lib/sample_capture_templates';\n\nimport { isAfter, addSeconds } from 'date-fns';\nimport { parseISO } from 'date-fns';\nimport { persistIsDirty, saveFileContentsToLocalStorage } from '../util/file_persister';\nimport { localStorageAvailable, readOpennessState } from '../util/settings_persister';\n\nexport const parseFile = (path, contents) => (dispatch) => {\n  if (localStorageAvailable && !path.startsWith(STATIC_FILE_PREFIX)) {\n    saveFileContentsToLocalStorage(path, contents);\n    const opennessState = readOpennessState();\n    if (!!opennessState) {\n      dispatch(setOpennessState(path, opennessState[path]));\n    }\n  }\n  dispatch({\n    type: 'PARSE_FILE',\n    path,\n    contents,\n  });\n  dispatch(applyOpennessState(path));\n};\n\nexport const setLastSyncAt = (lastSyncAt, path) => ({\n  type: 'SET_LAST_SYNC_AT',\n  path,\n  lastSyncAt,\n});\n\nexport const resetFileDisplay = () => {\n  return (dispatch) => {\n    dispatch(widenHeader());\n    dispatch(closePopup());\n    dispatch({ type: 'CLEAR_SEARCH' });\n    dispatch(setPath(null));\n    dispatch(ActionCreators.clearHistory());\n  };\n};\n\nconst getDebouncedSyncFunction = () =>\n  debounce((dispatch, options) => dispatch(doSync(options)), 3000, {\n    leading: true,\n    trailing: true,\n  });\nconst debouncedSyncFunctions = {};\nconst syncDebounced = (dispatch, getState, options) => {\n  // to make sure no file is skipped when multiple files are dirty\n  // a seperately debounced function is used per file\n  let filesToSync = [];\n  if (options.path) {\n    filesToSync = [options.path];\n  } else {\n    // if no path is passed in, sync all dirty files\n    const files = getState().org.present.get('files');\n    filesToSync = files.keySeq().filter((path) => files.getIn([path, 'isDirty']));\n  }\n  filesToSync.forEach((path) => {\n    let debouncedSyncFunction = debouncedSyncFunctions[path];\n    if (!debouncedSyncFunction) {\n      debouncedSyncFunctions[path] = getDebouncedSyncFunction();\n      debouncedSyncFunction = debouncedSyncFunctions[path];\n    }\n    debouncedSyncFunction(dispatch, options);\n  });\n};\n\nexport const sync = (options) => (dispatch, getState) => {\n  // Don't do anything if the browser is not online. When it gets back\n  // from an offline state, a new `sync`action will be triggered then.\n  if (getState().base.get('online')) {\n    // If the user hits the 'sync' button, no matter if there's a sync\n    // in progress or if the sync 'should' be debounced, listen to the\n    // user and start a sync.\n    if (options.forceAction === 'manual') {\n      console.log('forcing sync');\n      const files = getState().org.present.get('files');\n      // sync all files on manual sync\n      files.keySeq().forEach((path) => dispatch(doSync({ ...options, path })));\n    } else {\n      syncDebounced(dispatch, getState, options);\n    }\n  }\n};\n\n// doSync is the actual sync action synchronizing/persisting the Org\n// file. When 'live sync' is enabled, there's potentially a quick\n// succession of calls to 'sync' and therefore to the sync back-end\n// happening. These calls need to be debounced. If there's a really\n// succession of calls, only the first and last synchronization will\n// happen.\n// Note: This action is a redux-thunk action (because it returns a\n// function). This function is defined every time it is called. Hence,\n// wrapping it in `debounce` will not be good enough. Since it would\n// be a new function every time, it would be called every time. The\n// solution is to define an inner function `sync` outside of the\n// wrapping function `syncDebounced`. This will actually debounce\n// `doSync`, because the inner function `sync` will be created only\n// once.\nconst doSync = ({\n  forceAction = null,\n  successMessage = 'Changes pushed',\n  shouldSuppressMessages = false,\n  path,\n} = {}) => (dispatch, getState) => {\n  const client = getState().syncBackend.get('client');\n  const currentPath = getState().org.present.get('path');\n  path = path || currentPath;\n  if (!path || path.startsWith(STATIC_FILE_PREFIX)) {\n    return;\n  }\n\n  // Calls do `doSync` are already debounced using a timer, but on big\n  // Org files or slow connections, it's still possible to have\n  // concurrent requests to `doSync` which has no merit. When\n  // `isLoading`, don't trigger another sync in parallel. Instead,\n  // call `syncDebounced` and return immediately. This will\n  // recursively enqueue the request to do a sync until the current\n  // sync is finished. Since it's a debounced call, enqueueing it\n  // recursively is efficient.\n  // That is, unless the user manually hits the 'sync' button\n  // (indicated by `forceAction === 'manual'`). Then, do what the user\n  // requests.\n  if (getState().base.get('isLoading').includes(path) && forceAction !== 'manual') {\n    // Since there is a quick succession of debounced requests to\n    // synchronize, the user likely is in a undo/redo workflow with\n    // potential new changes to the Org file in between. In such a\n    // situation, it is easy for the remote file to have a newer\n    // `lastModifiedAt` date than the `lastSyncAt` date. Hence,\n    // pushing is the right action - no need for the modal to ask the\n    // user for her request to pull/push or cancel.\n    dispatch(sync({ forceAction: 'push' }));\n    return;\n  }\n\n  if (!shouldSuppressMessages) {\n    dispatch(setLoadingMessage(`Syncing ...`));\n  }\n  dispatch(setIsLoading(true, path));\n  dispatch(setOrgFileErrorMessage(null));\n\n  client\n    .getFileContentsAndMetadata(path)\n    .then(({ contents, lastModifiedAt }) => {\n      const isDirty = getState().org.present.getIn(['files', path, 'isDirty']);\n      const lastServerModifiedAt = parseISO(lastModifiedAt);\n      const lastSyncAt = getState().org.present.getIn(['files', path, 'lastSyncAt']);\n\n      if (isAfter(lastSyncAt, lastServerModifiedAt) || forceAction === 'push') {\n        if (isDirty) {\n          const contents =\n            localStorage.getItem('files__' + path) ||\n            exportOrg({\n              headers: getState().org.present.getIn(['files', path, 'headers']),\n              linesBeforeHeadings: getState().org.present.getIn([\n                'files',\n                path,\n                'linesBeforeHeadings',\n              ]),\n              dontIndent: getState().base.get('shouldNotIndentOnExport'),\n            });\n          client\n            .updateFile(path, contents)\n            .then(() => {\n              if (!shouldSuppressMessages) {\n                dispatch(setDisappearingLoadingMessage(successMessage, 2000));\n              } else {\n                setTimeout(() => dispatch(hideLoadingMessage()), 2000);\n              }\n              dispatch(setIsLoading(false, path));\n              dispatch(setDirty(false, path));\n              dispatch(setLastSyncAt(addSeconds(new Date(), 5), path));\n            })\n            .catch((error) => {\n              const err = `There was an error pushing the file ${path}: ${error.toString()}`;\n              console.error(err);\n              dispatch(setDisappearingLoadingMessage(err, 5000));\n              dispatch(hideLoadingMessage());\n              dispatch(setIsLoading(false, path));\n              // Re-enqueue the file to be synchronized again\n              dispatch(sync({ path }));\n            });\n        } else {\n          if (!shouldSuppressMessages) {\n            dispatch(setDisappearingLoadingMessage('Nothing to sync', 2000));\n          } else {\n            setTimeout(() => dispatch(hideLoadingMessage()), 2000);\n          }\n          dispatch(setIsLoading(false, path));\n        }\n      } else {\n        if (isDirty && forceAction !== 'pull') {\n          dispatch(hideLoadingMessage());\n          dispatch(setIsLoading(false, path));\n          dispatch(activatePopup('sync-confirmation', { lastServerModifiedAt, lastSyncAt, path }));\n        } else {\n          dispatch(parseFile(path, contents));\n          dispatch(setDirty(false, path));\n          dispatch(setLastSyncAt(addSeconds(new Date(), 5), path));\n          if (!shouldSuppressMessages) {\n            dispatch(setDisappearingLoadingMessage(`Latest version pulled: ${path}`, 2000));\n          } else {\n            setTimeout(() => dispatch(hideLoadingMessage()), 2000);\n          }\n          dispatch(setIsLoading(false, path));\n        }\n      }\n    })\n    .catch(() => {\n      dispatch(hideLoadingMessage());\n      dispatch(setIsLoading(false, path));\n      dispatch(setOrgFileErrorMessage(`File ${path} not found`));\n    });\n};\n\nexport const openHeader = (headerId) => ({\n  type: 'OPEN_HEADER',\n  headerId,\n});\n\nexport const toggleHeaderOpened = (headerId, closeSubheadersRecursively) => ({\n  type: 'TOGGLE_HEADER_OPENED',\n  headerId,\n  closeSubheadersRecursively,\n});\n\nexport const selectHeader = (headerId) => (dispatch) => {\n  dispatch({ type: 'SELECT_HEADER', headerId });\n\n  if (!!headerId) {\n    dispatch(setSelectedTableCellId(null));\n  }\n};\n\nexport const setPath = (path) => (dispatch) => {\n  dispatch({\n    type: 'SET_PATH',\n    path,\n  });\n  dispatch({ type: ActionTypes.CLEAR_HISTORY });\n};\n\nexport const selectHeaderAndOpenParents = (path, headerId) => (dispatch) => {\n  dispatch(setPath(path));\n  dispatch({ type: 'OPEN_PARENTS_OF_HEADER', headerId });\n  // select header after the file is displayed to allow the header to scroll into view\n  setTimeout(() => dispatch(selectHeader(headerId)), 0);\n};\n\n/**\n * Action to advance the state, e.g. TODO -> DONE, of the header specified in headerId.\n *\n * @param {*} headerId headerId to advance, or null if you want the currently narrowed header.\n * @param {*} logIntoDrawer false to log state change into body, true to log into :LOGBOOK: drawer.\n */\nexport const advanceTodoState = (headerId, logIntoDrawer) => ({\n  type: 'ADVANCE_TODO_STATE',\n  headerId,\n  logIntoDrawer,\n  dirtying: true,\n  timestamp: new Date(),\n});\n\nexport const enterEditMode = (editModeType) => ({\n  type: 'ENTER_EDIT_MODE',\n  editModeType,\n});\n\nexport const exitEditMode = () => ({\n  type: 'EXIT_EDIT_MODE',\n});\n\nexport const updateHeaderTitle = (headerId, newRawTitle) => ({\n  type: 'UPDATE_HEADER_TITLE',\n  headerId,\n  newRawTitle,\n  dirtying: true,\n});\n\nexport const updateHeaderDescription = (headerId, newRawDescription) => ({\n  type: 'UPDATE_HEADER_DESCRIPTION',\n  headerId,\n  newRawDescription,\n  dirtying: true,\n});\n\nexport const addHeader = (headerId) => ({\n  type: 'ADD_HEADER',\n  headerId,\n  // Performance optimization: Don't actually sync a whole Org file\n  // for an empty header. When the user adds some data and triggers\n  // UPDATE_HEADER_TITLE, then it makes sense to save it.\n  dirtying: false,\n});\n\nexport const selectNextSiblingHeader = (headerId) => ({\n  type: 'SELECT_NEXT_SIBLING_HEADER',\n  headerId,\n});\n\nexport const addHeaderAndEdit = (headerId) => (dispatch) => {\n  dispatch(addHeader(headerId));\n  dispatch(selectNextSiblingHeader(headerId));\n  dispatch(enterEditMode('title'));\n};\n\nexport const selectNextVisibleHeader = (headerId) => ({\n  type: 'SELECT_NEXT_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const selectPreviousVisibleHeader = (headerId) => ({\n  type: 'SELECT_PREVIOUS_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const removeHeader = (headerId) => ({\n  type: 'REMOVE_HEADER',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderUp = (headerId) => ({\n  type: 'MOVE_HEADER_UP',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderDown = (headerId) => ({\n  type: 'MOVE_HEADER_DOWN',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderLeft = (headerId) => ({\n  type: 'MOVE_HEADER_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderRight = (headerId) => ({\n  type: 'MOVE_HEADER_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeLeft = (headerId) => ({\n  type: 'MOVE_SUBTREE_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeRight = (headerId) => ({\n  type: 'MOVE_SUBTREE_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const refileSubtree = (sourcePath, sourceHeaderId, targetPath, targetHeaderId) => ({\n  type: 'REFILE_SUBTREE',\n  sourcePath,\n  sourceHeaderId,\n  targetPath,\n  targetHeaderId,\n  dirtying: true,\n});\n\nexport const addNote = (inputText, currentDate) => ({\n  type: 'HEADER_ADD_NOTE',\n  inputText,\n  currentDate,\n  dirtying: true,\n});\n\nexport const narrowHeader = (headerId) => ({\n  type: 'NARROW_HEADER',\n  headerId,\n});\n\nexport const widenHeader = () => ({\n  type: 'WIDEN_HEADER',\n});\n\nexport const setOpennessState = (path, opennessState) => ({\n  type: 'SET_OPENNESS_STATE',\n  path,\n  opennessState,\n});\n\nexport const applyOpennessState = (path) => ({\n  type: 'APPLY_OPENNESS_STATE',\n  path,\n});\n\nexport const dirtyAction = (isDirty, path) => ({\n  type: 'SET_DIRTY',\n  isDirty,\n  path,\n});\n\nexport const setDirty = (isDirty, path) => (dispatch) => {\n  persistIsDirty(isDirty, path);\n  dispatch(dirtyAction(isDirty, path));\n};\n\nexport const setSelectedTableCellId = (cellId) => (dispatch) => {\n  dispatch({ type: 'SET_SELECTED_TABLE_CELL_ID', cellId });\n\n  if (!!cellId) {\n    dispatch(selectHeader(null));\n  }\n};\n\nexport const addNewTableRow = () => ({\n  type: 'ADD_NEW_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const removeTableRow = () => ({\n  type: 'REMOVE_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const addNewTableColumn = () => ({\n  type: 'ADD_NEW_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const removeTableColumn = () => ({\n  type: 'REMOVE_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const moveTableRowDown = () => ({\n  type: 'MOVE_TABLE_ROW_DOWN',\n  dirtying: true,\n});\n\nexport const moveTableRowUp = () => ({\n  type: 'MOVE_TABLE_ROW_UP',\n  dirtying: true,\n});\n\nexport const moveTableColumnLeft = () => ({\n  type: 'MOVE_TABLE_COLUMN_LEFT',\n  dirtying: true,\n});\n\nexport const moveTableColumnRight = () => ({\n  type: 'MOVE_TABLE_COLUMN_RIGHT',\n  dirtying: true,\n});\n\nexport const updateTableCellValue = (cellId, newValue) => ({\n  type: 'UPDATE_TABLE_CELL_VALUE',\n  cellId,\n  newValue,\n  dirtying: true,\n});\n\nexport const insertCapture = (templateId, content, shouldPrepend) => (dispatch, getState) => {\n  dispatch(closePopup());\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .concat(sampleCaptureTemplates)\n    .find((template) => template.get('id') === templateId);\n  dispatch({ type: 'INSERT_CAPTURE', template, content, shouldPrepend, dirtying: true });\n};\n\nexport const clearPendingCapture = () => ({\n  type: 'CLEAR_PENDING_CAPTURE',\n});\n\nexport const insertPendingCapture = () => (dispatch, getState) => {\n  const path = getState().org.present.get('path');\n  const pendingCapture = getState().org.present.get('pendingCapture');\n  const templateName = pendingCapture.get('captureTemplateName');\n  const captureContent = pendingCapture.get('captureContent');\n  const customCaptureVariables = pendingCapture.get('customCaptureVariables');\n\n  dispatch(clearPendingCapture());\n  window.history.pushState({}, '', window.location.pathname);\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .filter(\n      (template) =>\n        template.get('isAvailableInAllOrgFiles') ||\n        template.get('orgFilesWhereAvailable').includes(getState().org.present.get('path'))\n    )\n    .find((template) => template.get('description').trim() === templateName.trim());\n  if (!template) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${templateName}\" template not found or not available in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const targetHeader = headerWithPath(\n    getState().org.present.getIn(['files', path, 'headers']),\n    template.get('headerPaths')\n  );\n  if (!targetHeader) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${template.get('description')}\" header path invalid in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const [substitutedTemplate, initialCursorIndex] = substituteTemplateVariables(\n    template.get('template'),\n    customCaptureVariables\n  );\n\n  const content = !!initialCursorIndex\n    ? `${substitutedTemplate.substring(\n        0,\n        initialCursorIndex\n      )}${captureContent}${substitutedTemplate.substring(initialCursorIndex)}`\n    : `${substitutedTemplate}${captureContent}`;\n\n  dispatch(insertCapture(template.get('id'), content, template.get('shouldPrepend')));\n  dispatch(sync({ successMessage: 'Item captured' }));\n};\n\nexport const advanceCheckboxState = (listItemId) => ({\n  type: 'ADVANCE_CHECKBOX_STATE',\n  listItemId,\n  dirtying: true,\n});\n\nexport const setHeaderTags = (headerId, tags) => ({\n  type: 'SET_HEADER_TAGS',\n  headerId,\n  tags,\n  dirtying: true,\n});\n\nexport const reorderTags = (fromIndex, toIndex) => ({\n  type: 'REORDER_TAGS',\n  fromIndex,\n  toIndex,\n  dirtying: true,\n});\n\nexport const reorderPropertyList = (fromIndex, toIndex) => (dispatch, getState) =>\n  dispatch({\n    type: 'REORDER_PROPERTY_LIST',\n    fromIndex,\n    toIndex,\n    headerId: getState().base.getIn(['activePopup', 'data', 'headerId']),\n    dirtying: true,\n  });\n\n/**\n * Action to change the timestamp using a cross-cutting id.\n *\n * @param {*} timestampId cross-cutting id of the timestamp (might be in the title or description).\n * @param {*} newTimestamp the new value for the timestamp;\n *                         must have the form: {id:, type:, firstTimestamp:, secondTimestamp:}.\n */\nexport const updateTimestampWithId = (timestampId, newTimestamp) => ({\n  type: 'UPDATE_TIMESTAMP_WITH_ID',\n  timestampId,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const updatePlanningItemTimestamp = (headerId, planningItemIndex, newTimestamp) => ({\n  type: 'UPDATE_PLANNING_ITEM_TIMESTAMP',\n  headerId,\n  planningItemIndex,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const addNewPlanningItem = (headerId, planningType) => ({\n  type: 'ADD_NEW_PLANNING_ITEM',\n  headerId,\n  planningType,\n  dirtying: true,\n  timestamp: new Date(),\n});\n\nexport const removePlanningItem = (headerId, planningItemIndex) => ({\n  type: 'REMOVE_PLANNING_ITEM',\n  headerId,\n  planningItemIndex,\n  dirtying: true,\n});\n\nexport const removeTimestamp = (headerId, timestampId) => ({\n  type: 'REMOVE_TIMESTAMP',\n  headerId,\n  timestampId,\n  dirtying: true,\n});\n\nexport const updatePropertyListItems = (headerId, newPropertyListItems) => ({\n  type: 'UPDATE_PROPERTY_LIST_ITEMS',\n  headerId,\n  newPropertyListItems,\n  dirtying: true,\n});\n\nexport const setOrgFileErrorMessage = (message) => ({\n  type: 'SET_ORG_FILE_ERROR_MESSAGE',\n  message,\n});\n\nexport const setLogEntryStop = (headerId, entryId, time) => ({\n  type: 'SET_LOG_ENTRY_STOP',\n  headerId,\n  entryId,\n  time,\n  dirtying: true,\n});\n\nexport const createLogEntryStart = (headerId, time) => ({\n  type: 'CREATE_LOG_ENTRY_START',\n  headerId,\n  time,\n  dirtying: true,\n});\n\nexport const updateLogEntryTime = (headerId, entryIndex, entryType, newTime) => ({\n  type: 'UPDATE_LOG_ENTRY_TIME',\n  headerId,\n  entryIndex,\n  entryType,\n  newTime,\n  dirtying: true,\n});\n\nexport const setSearchFilterInformation = (searchFilter, cursorPosition, context) => ({\n  type: 'SET_SEARCH_FILTER_INFORMATION',\n  searchFilter,\n  cursorPosition,\n  context,\n});\n\nexport const setShowClockDisplay = (showClockDisplay) => ({\n  type: 'TOGGLE_CLOCK_DISPLAY',\n  showClockDisplay,\n});\n\nexport const updateFileSettingFieldPathValue = (settingId, fieldPath, newValue) => ({\n  type: 'UPDATE_FILE_SETTING_FIELD_PATH_VALUE',\n  settingId,\n  fieldPath,\n  newValue,\n});\n\nexport const reorderFileSetting = (fromIndex, toIndex) => ({\n  type: 'REORDER_FILE_SETTING',\n  fromIndex,\n  toIndex,\n});\n\nexport const deleteFileSetting = (settingId) => ({\n  type: 'DELETE_FILE_SETTING',\n  settingId,\n});\n\nexport const addNewEmptyFileSetting = () => (dispatch) =>\n  dispatch({ type: 'ADD_NEW_EMPTY_FILE_SETTING' });\n\nexport const restoreFileSettings = (newSettings) => ({\n  type: 'RESTORE_FILE_SETTINGS',\n  newSettings,\n});\n","import { sync } from '../actions/org';\nimport { persistIsDirty, saveFileToLocalStorage } from '../util/file_persister';\nimport { determineAffectedFiles } from '../reducers/org';\n\nexport default (store) => (next) => (action) => {\n  // middleware is run before the reducer. to persist the result of the action,\n  // save and sync are done in a callback so they happen after the state is changed\n  setTimeout(() => {\n    let dirtyFiles = determineAffectedFiles(store.getState().org.present, action);\n\n    dirtyFiles.forEach((path) => saveFileToLocalStorage(store.getState(), path));\n    dirtyFiles.forEach((path) => persistIsDirty(true, path));\n\n    if (store.getState().base.get('shouldLiveSync')) {\n      dirtyFiles.forEach((path) => store.dispatch(sync({ shouldSuppressMessages: true, path })));\n    }\n  }, 0);\n\n  return next(action);\n};\n","import { setColorScheme } from '../actions/base';\n\nexport default (store) => (next) => (action) => {\n  // Watch if the user changes the preferred color scheme through the\n  // OS or browser.\n\n  // Returns a MediaQueryList object\n  const prefersColorSchemeMediaQueryList = window.matchMedia('(prefers-color-scheme: dark)');\n\n  // Feature detection. If there's no dark mode (i.e. iOS <14), then\n  // the `matchMedia` query above does not resolve in anything that\n  // can be observed.\n  if ('addEventListener' in prefersColorSchemeMediaQueryList) {\n    prefersColorSchemeMediaQueryList.addEventListener('change', (e) => {\n      const selectedColorScheme = e.matches ? 'Dark' : 'Light';\n      store.dispatch(setColorScheme(selectedColorScheme));\n    });\n  }\n\n  return next(action);\n};\n","import { Map, List, fromJS } from 'immutable';\n\nimport { applyCategorySettingsFromConfig } from '../util/settings_persister';\n\nconst setLoadingMessage = (state, action) => state.set('loadingMessage', action.loadingMessage);\n\nconst hideLoadingMessage = (state) => state.set('loadingMessage', null);\n\nconst setFontSize = (state, action) => state.set('fontSize', action.newFontSize);\n\nconst setBulletStyle = (state, action) => state.set('bulletStyle', action.newBulletStyle);\n\nconst setShouldTapTodoToAdvance = (state, action) =>\n  state.set('shouldTapTodoToAdvance', action.newShouldTapTodoToAdvance);\n\nconst setAgendaDefaultDeadlineDelayUnit = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayUnit', action.newAgendaDefaultDeadlineDelayUnit);\n\nconst setAgendaDefaultDeadlineDelayValue = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayValue', action.newAgendaDefaultDeadlineDelayValue);\n\nconst setAgendaStartOnWeekday = (state, action) =>\n  state.set('agendaStartOnWeekday', action.newAgendaStartOnWeekday);\n\nconst setShouldStoreSettingsInSyncBackend = (state, action) =>\n  state.set('shouldStoreSettingsInSyncBackend', action.newShouldStoreSettingsInSyncBackend);\n\nconst setShouldLiveSync = (state, action) => state.set('shouldLiveSync', action.shouldLiveSync);\n\nconst setShouldSyncOnBecomingVisibile = (state, action) =>\n  state.set('shouldSyncOnBecomingVisibile', action.shouldSyncOnBecomingVisibile);\n\nconst setShouldShowTitleInOrgFile = (state, action) =>\n  state.set('shouldShowTitleInOrgFile', action.shouldShowTitleInOrgFile);\n\nconst setShouldLogIntoDrawer = (state, action) =>\n  state.set('shouldLogIntoDrawer', action.shouldLogIntoDrawer);\n\nconst setCloseSubheadersRecursively = (state, action) =>\n  state.set('closeSubheadersRecursively', action.closeSubheadersRecursively);\n\n/**\n * When enabled, keep all heading body text flush-left. When disabled (the\n * default) indent the body text of headings according to the nesting level of\n * the heading.\n */\nconst setShouldNotIndentOnExport = (state, action) =>\n  state.set('shouldNotIndentOnExport', action.shouldNotIndentOnExport);\n\nconst setHasUnseenChangelog = (state, action) =>\n  state.set('hasUnseenChangelog', action.newHasUnseenChangelog);\n\nconst setLastSeenChangelogHeader = (state, action) =>\n  state.set('lastSeenChangelogHash', action.newLastSeenChangelogHash);\n\nconst setLastViewedFile = (state, action) => state.set('lastViewedPath', action.lastViewedPath);\n\nconst setCustomKeybinding = (state, action) => {\n  if (!state.get('customKeybindings')) {\n    state = state.set('customKeybindings', Map());\n  }\n\n  return state.setIn(['customKeybindings', action.keybindingName], action.keybinding);\n};\n\nconst restoreBaseSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCategorySettingsFromConfig(state, action.newSettings, 'base');\n};\n\nconst pushModalPage = (state, action) =>\n  state.update('modalPageStack', (stack) =>\n    !!stack ? stack.push(action.modalPage) : List([action.modalPage])\n  );\n\nconst popModalPage = (state) =>\n  state.update('modalPageStack', (stack) => (!!stack ? stack.pop() : stack));\n\nconst clearModalStack = (state) => state.set('modalPageStack', List());\n\nconst activatePopup = (state, action) => {\n  const { data, popupType } = action;\n\n  // Remember active popup in URL state for popups that are uniquely\n  // identifiable (aka not related to a single header like tags,\n  // properties or timestamps).\n  if (['search', 'task-list', 'agenda'].includes(popupType)) {\n    window.history.replaceState({}, '', `${window.location.pathname}#${popupType}`);\n  }\n\n  return state.set(\n    'activePopup',\n    fromJS({\n      type: popupType,\n      data,\n    })\n  );\n};\n\nconst closePopup = (state) => {\n  window.history.replaceState(\n    '',\n    document.title,\n    window.location.pathname + window.location.search\n  );\n  return state.set('activePopup', null);\n};\n\nconst setIsLoading = (state, action) => {\n  if (action.isLoading) {\n    return state.update('isLoading', (isLoading) => isLoading.add(action.path));\n  } else {\n    return state.update('isLoading', (isLoading) => isLoading.delete(action.path));\n  }\n};\n\nconst setIsOnline = (state, action) => {\n  return state.set('online', action.online);\n};\n\nconst setAgendaTimeframe = (state, action) => state.set('agendaTimeframe', action.agendaTimeframe);\n\nconst setColorScheme = (state, action) => {\n  return state.set('colorScheme', action.colorScheme);\n};\n\nconst setTheme = (state, action) => {\n  return state.set('theme', action.theme);\n};\n\n/**\n * Reducer that is responsible for the \"base\" state slice.\n */\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'SET_LOADING_MESSAGE':\n      return setLoadingMessage(state, action);\n    case 'HIDE_LOADING_MESSAGE':\n      return hideLoadingMessage(state, action);\n    case 'SET_FONT_SIZE':\n      return setFontSize(state, action);\n    case 'SET_BULLET_STYLE':\n      return setBulletStyle(state, action);\n    case 'SET_SHOULD_TAP_TODO_TO_ADVANCE':\n      return setShouldTapTodoToAdvance(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT':\n      return setAgendaDefaultDeadlineDelayUnit(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE':\n      return setAgendaDefaultDeadlineDelayValue(state, action);\n    case 'SET_AGENDA_START_ON_WEEKDAY':\n      return setAgendaStartOnWeekday(state, action);\n    case 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND':\n      return setShouldStoreSettingsInSyncBackend(state, action);\n    case 'SET_COLOR_SCHEME':\n      return setColorScheme(state, action);\n    case 'SET_THEME':\n      return setTheme(state, action);\n    case 'SET_SHOULD_LIVE_SYNC':\n      return setShouldLiveSync(state, action);\n    case 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE':\n      return setShouldSyncOnBecomingVisibile(state, action);\n    case 'SET_SHOULD_SHOW_TITLE_IN_ORG_FILE':\n      return setShouldShowTitleInOrgFile(state, action);\n    case 'SET_SHOULD_LOG_INTO_DRAWER':\n      return setShouldLogIntoDrawer(state, action);\n    case 'SET_CLOSE_SUBHEADERS_RECURSIVELY':\n      return setCloseSubheadersRecursively(state, action);\n    case 'SET_SHOULD_NOT_INDENT_ON_EXPORT':\n      return setShouldNotIndentOnExport(state, action);\n    case 'SET_HAS_UNSEEN_CHANGELOG':\n      return setHasUnseenChangelog(state, action);\n    case 'SET_LAST_SEEN_CHANGELOG_HEADER':\n      return setLastSeenChangelogHeader(state, action);\n    case 'SET_LAST_VIEWED_FILE':\n      return setLastViewedFile(state, action);\n    case 'SET_CUSTOM_KEYBINDING':\n      return setCustomKeybinding(state, action);\n    case 'RESTORE_BASE_SETTINGS':\n      return restoreBaseSettings(state, action);\n    case 'PUSH_MODAL_PAGE':\n      return pushModalPage(state, action);\n    case 'POP_MODAL_PAGE':\n      return popModalPage(state, action);\n    case 'CLEAR_MODAL_STACK':\n      return clearModalStack(state, action);\n    case 'ACTIVATE_POPUP':\n      return activatePopup(state, action);\n    case 'CLOSE_POPUP':\n      return closePopup(state, action);\n    case 'SET_IS_LOADING':\n      return setIsLoading(state, action);\n    case 'SET_IS_ONLINE':\n      return setIsOnline(state, action);\n    case 'SET_AGENDA_TIMEFRAME':\n      return setAgendaTimeframe(state, action);\n    default:\n      return state;\n  }\n};\n","import { Map } from 'immutable';\n\nconst signOut = (state) => state.set('isAuthenticated', false).set('client', null);\n\nconst setCurrentFileBrowserDirectoryListing = (state, action) =>\n  state.set(\n    'currentFileBrowserDirectoryListing',\n    Map({\n      listing: action.directoryListing,\n      hasMore: action.hasMore,\n      additionalSyncBackendState: action.additionalSyncBackendState,\n    })\n  );\n\nconst setIsLoadingMoreDirectoryListing = (state, action) =>\n  state\n    .update('currentFileBrowserDirectoryListing', (currentFileBrowserDirectoryListing) =>\n      !!currentFileBrowserDirectoryListing ? currentFileBrowserDirectoryListing : Map()\n    )\n    .setIn(['currentFileBrowserDirectoryListing', 'isLoadingMore'], action.isLoadingMore);\n\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'SIGN_OUT':\n      return signOut(state);\n    case 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING':\n      return setCurrentFileBrowserDirectoryListing(state, action);\n    case 'SET_IS_LOADING_MORE_DIRECTORY_LISTING':\n      return setIsLoadingMoreDirectoryListing(state, action);\n    default:\n      return state;\n  }\n};\n","import { Map, List, fromJS } from 'immutable';\n\nimport generateId from '../lib/id_generator';\nimport { applyCaptureSettingsFromConfig } from '../util/settings_persister';\n\nconst indexOfTemplateWithId = (templates, templateId) =>\n  templates.findIndex((template) => template.get('id') === templateId);\n\nconst addNewEmptyCaptureTemplate = (state) => {\n  if (!state.get('captureTemplates')) {\n    state = state.set('captureTemplates', List());\n  }\n\n  return state.update('captureTemplates', (templates) =>\n    templates.push(\n      fromJS({\n        id: generateId(),\n        description: '',\n        letter: '',\n        iconName: '',\n        isAvailableInAllOrgFiles: true,\n        file: '',\n        orgFilesWhereAvailable: [''],\n        headerPaths: [''],\n        shouldPrepend: false,\n        template: '',\n      })\n    )\n  );\n};\n\nconst updateTemplateFieldPathValue = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.setIn(['captureTemplates', templateIndex].concat(action.fieldPath), action.newValue);\n};\n\nconst addNewTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], (orgFiles) =>\n    orgFiles.push('')\n  );\n};\n\nconst removeTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], (orgFiles) =>\n    orgFiles.delete(action.orgFileAvailabilityIndex)\n  );\n};\n\nconst addNewTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], (headerPaths) =>\n    headerPaths.push('')\n  );\n};\n\nconst removeTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], (headerPaths) =>\n    headerPaths.delete(action.headerPathIndex)\n  );\n};\n\nconst deleteTemplate = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.update('captureTemplates', (templates) => templates.delete(templateIndex));\n};\n\nconst restoreCaptureSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCaptureSettingsFromConfig(state, action.newSettings);\n};\n\nconst reorderCaptureTemplate = (state, action) =>\n  state.update('captureTemplates', (templates) =>\n    templates.splice(action.fromIndex, 1).splice(action.toIndex, 0, templates.get(action.fromIndex))\n  );\n\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE':\n      return addNewEmptyCaptureTemplate(state, action);\n    case 'UPDATE_TEMPLATE_FIELD_PATH_VALUE':\n      return updateTemplateFieldPathValue(state, action);\n    case 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return addNewTemplateOrgFileAvailability(state, action);\n    case 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return removeTemplateOrgFileAvailability(state, action);\n    case 'ADD_NEW_TEMPLATE_HEADER_PATH':\n      return addNewTemplateHeaderPath(state, action);\n    case 'REMOVE_TEMPLATE_HEADER_PATH':\n      return removeTemplateHeaderPath(state, action);\n    case 'DELETE_TEMPLATE':\n      return deleteTemplate(state, action);\n    case 'RESTORE_CAPTURE_SETTINGS':\n      return restoreCaptureSettings(state, action);\n    case 'REORDER_CAPTURE_TEMPLATE':\n      return reorderCaptureTemplate(state, action);\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from 'redux';\nimport undoable, { includeAction, ActionCreators, ActionTypes } from 'redux-undo';\n\nimport baseReducer from './base';\nimport syncBackendReducer from './sync_backend';\nimport orgReducer from './org';\nimport captureReducer from './capture';\nimport { setDirty, sync } from '../actions/org';\n\nconst UNDOABLE_ACTIONS = [\n  'ADD_HEADER',\n  'REMOVE_HEADER',\n  'MOVE_HEADER_UP',\n  'MOVE_HEADER_DOWN',\n  'MOVE_HEADER_LEFT',\n  'MOVE_HEADER_RIGHT',\n  'MOVE_SUBTREE_LEFT',\n  'MOVE_SUBTREE_RIGHT',\n  'ADVANCE_TODO_STATE',\n  'UPDATE_HEADER_TITLE',\n  'UPDATE_HEADER_DESCRIPTION',\n  'ADD_NEW_TABLE_ROW',\n  'ADD_NEW_TABLE_COLUMN',\n  'REMOVE_TABLE_ROW',\n  'REMOVE_TABLE_COLUMN',\n  'UPDATE_TABLE_CELL_VALUE',\n  'MOVE_TABLE_ROW_DOWN',\n  'MOVE_TABLE_ROW_UP',\n  'MOVE_TABLE_COLUMN_LEFT',\n  'MOVE_TABLE_COLUMN_RIGHT',\n  'INSERT_CAPTURE',\n  'REFILE_SUBTREE',\n  'HEADER_ADD_NOTE',\n  'SET_HEADER_TAGS',\n  'UPDATE_PROPERTY_LIST_ITEMS',\n  'ADD_NEW_PLANNING_ITEM',\n  'REMOVE_PLANNING_ITEM',\n  'CREATE_LOG_ENTRY_START',\n  'SET_LOG_ENTRY_STOP',\n];\n\n// INFO: An `undo` in organice is always related to changing the Org\n// file structure. Hence, it is necessary to trigger a `sync` action.\n// This needs a little extra work, because this `sync` would result in\n// a conflict: The state is now in the `past` the Org file has been\n// synchronized in the `future`. Hence the `lastModifiedAt` timestamp\n// will be in the future and organice won't see a reason to push. Even\n// if we wanted to push, organice would show the 'conflict' modal,\n// because the remote file is newer. For this reason, when doing an\n// 'undo', organice will suppress this modal and 'force' a push. We\n// don't want the user to need to understand that an 'undo' means\n// moving to the past and the conflict has been created by herself in\n// the future (which in real life might have been seconds ago).\n\n// Implementation: Override the redux-undo `undo` and `redo` action creators. Additionally to the redux `undo`, they will force a sync, always.\nActionCreators.undo = function () {\n  return (dispatch) => {\n    dispatch({ type: ActionTypes.UNDO });\n    dispatch(setDirty(true));\n    dispatch(sync({ forceAction: 'push' }));\n  };\n};\n\nActionCreators.redo = function () {\n  return (dispatch) => {\n    dispatch({ type: ActionTypes.REDO });\n    dispatch(setDirty(true));\n    dispatch(sync({ forceAction: 'push' }));\n  };\n};\n\nexport default combineReducers({\n  base: baseReducer,\n  syncBackend: syncBackendReducer,\n  org: undoable(orgReducer, {\n    filter: includeAction(UNDOABLE_ACTIONS),\n  }),\n  capture: captureReducer,\n});\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport liveSync from './middleware/live_sync';\nimport toggleColorScheme from './middleware/toggle_color_scheme';\nimport rootReducer from './reducers';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nexport default (initialState) =>\n  createStore(\n    rootReducer,\n    initialState,\n    composeEnhancers(applyMiddleware(thunk, liveSync, toggleColorScheme))\n  );\n","import migrateAccessTokenToDropboxAccessToken from './migrate_access_token_to_dropbox_access_token';\nimport migrateStoreInDropboxToStoreInSyncBackend from './migrate_store_in_dropbox_to_store_in_sync_backend';\nimport migrateNonsenseValuesInLocalstorage from './migrate_nonsense_values_in_localstorage';\n\nexport default () => {\n  migrateAccessTokenToDropboxAccessToken();\n  migrateStoreInDropboxToStoreInSyncBackend();\n  migrateNonsenseValuesInLocalstorage();\n};\n","import { localStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!localStorageAvailable) {\n    return;\n  }\n\n  const accessToken = localStorage.getItem('accessToken');\n  if (!accessToken) {\n    return;\n  }\n\n  localStorage.setItem('dropboxAccessToken', accessToken);\n  localStorage.removeItem('accessToken');\n};\n","import { localStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!localStorageAvailable) {\n    return;\n  }\n\n  const shouldStoreSettingsInDropbox = localStorage.getItem('shouldStoreSettingsInDropbox');\n  if (!shouldStoreSettingsInDropbox) {\n    return;\n  }\n\n  localStorage.setItem('shouldStoreSettingsInSyncBackend', shouldStoreSettingsInDropbox);\n  localStorage.removeItem('shouldStoreSettingsInDropbox');\n};\n","import { localStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!localStorageAvailable) {\n    return;\n  }\n\n  Object.entries(localStorage).forEach(([k, v], _) => {\n    if (['null', 'undefined'].includes(v)) {\n      console.warn(`localStorage contains a bogus entry: '${k}': '${v}'`);\n      console.warn('Deleting the bogus entry.');\n      localStorage.removeItem(k);\n    }\n  });\n};\n","const parseQueryString = (str) => {\n  var ret = Object.create(null);\n\n  if (typeof str !== 'string') {\n    return ret;\n  }\n\n  str = str.trim().replace(/^(\\?|#|&)/, '');\n\n  if (!str) {\n    return ret;\n  }\n\n  str.split('&').forEach(function (param) {\n    var parts = param.replace(/\\+/g, ' ').split('=');\n    // Firefox (pre 40) decodes `%3D` to `=`\n    // https://github.com/sindresorhus/query-string/pull/37\n    var key = parts.shift();\n    var val = parts.length > 0 ? parts.join('=') : undefined;\n\n    key = decodeURIComponent(key);\n\n    // missing `=` should be `null`:\n    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n    val = val === undefined ? null : decodeURIComponent(val);\n\n    if (ret[key] === undefined) {\n      ret[key] = val;\n    } else if (Array.isArray(ret[key])) {\n      ret[key].push(val);\n    } else {\n      ret[key] = [ret[key], val];\n    }\n  });\n\n  return ret;\n};\n\nexport default parseQueryString;\n","/* global gapi */\nimport { ActionCreators } from 'redux-undo';\n\nimport { setLoadingMessage, hideLoadingMessage, clearModalStack, setIsLoading } from './base';\nimport { parseFile, setDirty, setLastSyncAt, setOrgFileErrorMessage } from './org';\nimport { localStorageAvailable, persistField } from '../util/settings_persister';\n\nimport { addSeconds } from 'date-fns';\n\nexport const signOut = () => (dispatch, getState) => {\n  switch (getState().syncBackend.get('client', {}).type) {\n    case 'WebDAV':\n      ['Endpoint', 'Username', 'Password'].forEach((e) => {\n        persistField('webdav' + e, null);\n      });\n      break;\n    case 'Dropbox':\n      persistField('dropboxAccessToken', null);\n      break;\n    case 'Google Drive':\n      gapi.auth2.getAuthInstance().signOut();\n      break;\n    default:\n  }\n\n  persistField('authenticatedSyncService', null);\n\n  dispatch({ type: 'SIGN_OUT' });\n  dispatch(clearModalStack());\n  dispatch(hideLoadingMessage());\n\n  if (localStorageAvailable) {\n    localStorage.clear();\n  }\n};\n\nexport const setCurrentFileBrowserDirectoryListing = (\n  directoryListing,\n  hasMore,\n  additionalSyncBackendState\n) => ({\n  type: 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING',\n  directoryListing,\n  hasMore,\n  additionalSyncBackendState,\n});\n\nexport const setIsLoadingMoreDirectoryListing = (isLoadingMore) => ({\n  type: 'SET_IS_LOADING_MORE_DIRECTORY_LISTING',\n  isLoadingMore,\n});\n\nexport const getDirectoryListing = (path) => (dispatch, getState) => {\n  dispatch(setLoadingMessage('Getting listing...'));\n\n  const client = getState().syncBackend.get('client');\n  client\n    .getDirectoryListing(path)\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\n      dispatch(setCurrentFileBrowserDirectoryListing(listing, hasMore, additionalSyncBackendState));\n      dispatch(hideLoadingMessage());\n    })\n    .catch((error) => {\n      alert('There was an error retrieving files!');\n      console.error(error);\n      dispatch(hideLoadingMessage());\n    });\n};\n\nexport const loadMoreDirectoryListing = () => (dispatch, getState) => {\n  dispatch(setIsLoadingMoreDirectoryListing(true));\n\n  const client = getState().syncBackend.get('client');\n  const currentFileBrowserDirectoryListing = getState().syncBackend.get(\n    'currentFileBrowserDirectoryListing'\n  );\n  client\n    .getMoreDirectoryListing(currentFileBrowserDirectoryListing.get('additionalSyncBackendState'))\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\n      const extendedListing = currentFileBrowserDirectoryListing.get('listing').concat(listing);\n      dispatch(\n        setCurrentFileBrowserDirectoryListing(extendedListing, hasMore, additionalSyncBackendState)\n      );\n      dispatch(setIsLoadingMoreDirectoryListing(false));\n    });\n};\n\nexport const pushBackup = (pathOrFileId, contents) => {\n  return (dispatch, getState) => {\n    const client = getState().syncBackend.get('client');\n    switch (client.type) {\n      case 'Dropbox':\n      case 'WebDAV':\n        client.createFile(`${pathOrFileId}.organice-bak`, contents);\n        break;\n      case 'Google Drive':\n        pathOrFileId = pathOrFileId.startsWith('/') ? pathOrFileId.substr(1) : pathOrFileId;\n        client.duplicateFile(pathOrFileId, (fileName) => `${fileName}.organice-bak`);\n        break;\n      default:\n    }\n  };\n};\n\nexport const downloadFile = (path) => {\n  return (dispatch, getState) => {\n    dispatch(setLoadingMessage(`Downloading file ...`));\n    getState()\n      .syncBackend.get('client')\n      .getFileContents(path)\n      .then((fileContents) => {\n        dispatch(hideLoadingMessage());\n        dispatch(pushBackup(path, fileContents));\n        dispatch(parseFile(path, fileContents));\n        dispatch(setLastSyncAt(addSeconds(new Date(), 5), path));\n        dispatch(setDirty(false, path));\n        dispatch(ActionCreators.clearHistory());\n      })\n      .catch(() => {\n        dispatch(hideLoadingMessage());\n        dispatch(setIsLoading(false, path));\n        dispatch(setOrgFileErrorMessage(`File ${path} not found`));\n      });\n  };\n};\n","import { Dropbox } from 'dropbox';\nimport { isEmpty } from 'lodash';\nimport { orgFileExtensions } from '../lib/org_utils';\n\nimport { fromJS, Map } from 'immutable';\n\n/**\n * Gets a directory listing ready to be rendered by organice.\n *  - Filters files from `listing` down to org files.\n *  - Sorts folders atop of files.\n *  - Sorts both folders and files alphabetically.\n * @param {Array} listing\n */\nexport const filterAndSortDirectoryListing = (listing) => {\n  const filteredListing = listing.filter((file) => {\n    // Show all folders\n    if (file['.tag'] === 'folder') return true;\n    // Filter out all non-org files\n    return file.name.match(orgFileExtensions);\n  });\n  return filteredListing.sort((a, b) => {\n    // Folders before files\n    if (a['.tag'] === 'folder' && b['.tag'] === 'file') {\n      return -1;\n    } else {\n      // Sorth both folders and files alphabetically\n      return a.name > b.name ? 1 : -1;\n    }\n  });\n};\n\nexport default (accessToken) => {\n  const dropboxClient = new Dropbox({ accessToken, fetch: fetch.bind(window) });\n\n  const isSignedIn = () => new Promise((resolve) => resolve(true));\n\n  const transformDirectoryListing = (listing) => {\n    const sortedListing = filterAndSortDirectoryListing(listing);\n    return fromJS(\n      sortedListing.map((entry) => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry['.tag'] === 'folder',\n        path: entry.path_display,\n      }))\n    );\n  };\n\n  const getDirectoryListing = (path) =>\n    new Promise((resolve, reject) => {\n      dropboxClient\n        .filesListFolder({ path })\n        .then((response) => {\n          resolve({\n            listing: transformDirectoryListing(response.result.entries),\n            hasMore: response.result.has_more,\n            additionalSyncBackendState: Map({\n              cursor: response.result.cursor,\n            }),\n          });\n        })\n        .catch(reject);\n    });\n\n  const getMoreDirectoryListing = (additionalSyncBackendState) => {\n    const cursor = additionalSyncBackendState.get('cursor');\n    return new Promise((resolve, reject) =>\n      dropboxClient.filesListFolderContinue({ cursor }).then((response) =>\n        resolve({\n          listing: transformDirectoryListing(response.result.entries),\n          hasMore: response.result.has_more,\n          additionalSyncBackendState: Map({\n            cursor: response.result.cursor,\n          }),\n        })\n      )\n    );\n  };\n\n  const uploadFile = (path, contents) =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesUpload({\n          path,\n          contents,\n          mode: {\n            '.tag': 'overwrite',\n          },\n          autorename: true,\n        })\n        .then(resolve)\n        .catch(reject)\n    );\n\n  const updateFile = uploadFile;\n  const createFile = uploadFile;\n\n  const getFileContentsAndMetadata = (path) =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesDownload({ path })\n        .then((response) => {\n          const reader = new FileReader();\n          reader.addEventListener('loadend', () =>\n            resolve({\n              contents: reader.result,\n              lastModifiedAt: response.result.server_modified,\n            })\n          );\n          reader.readAsText(response.result.fileBlob);\n        })\n        .catch((error) => {\n          // INFO: It's possible organice is using the Dropbox API\n          // wrongly. In any case, for some files and only sometimes,\n          // when a file is requested, there's either:\n          //   - a 400 with a plain text error or\n          //   - a 409 with an embedded JSON error\n          //   - a 409 with a plain text error under `.error`\n          // coming back. Sometimes, there's even two API calls to\n          // `/download` happening at the same time (of types `json`\n          // and `octet-stream`) where one might fail and the other\n          // might prevail.\n          // More debug information in this issue:\n          // https://github.com/200ok-ch/organice/issues/108\n          const objectContainsTagErrorP = (function () {\n            try {\n              return JSON.parse(error.error).error.path['.tag'] === 'not_found';\n            } catch (e) {\n              return false;\n            }\n          })();\n          if (\n            (typeof error === 'string' && error.match(/missing required field 'path'/)) ||\n            objectContainsTagErrorP\n          ) {\n            reject();\n          }\n        })\n    );\n\n  const getFileContents = (path) => {\n    if (isEmpty(path)) return Promise.reject('No path given');\n    return new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(path)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n  };\n\n  const deleteFile = (path) =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesDelete({ path })\n        .then(resolve)\n        .catch((error) => reject(error.error.error['.tag'] === 'path_lookup', error))\n    );\n\n  return {\n    type: 'Dropbox',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","import { fromJS, Map } from 'immutable';\n\nexport default () => {\n  const initGoogleDriveAPIClient = () =>\n    new Promise((resolve, reject) =>\n      window.gapi.load('client:auth2', () => {\n        window.location.hash = window.initialHash;\n        window.gapi.client\n          .init({\n            client_id: process.env.REACT_APP_GOOGLE_DRIVE_CLIENT_ID,\n            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\n            scope: 'https://www.googleapis.com/auth/drive.file',\n          })\n          .then(resolve);\n      })\n    );\n\n  const getAPIClient = (() => {\n    let isInited = false;\n    let isIniting = false;\n    const afterInitCallbacks = [];\n\n    return () => {\n      return new Promise((resolve, reject) => {\n        if (isInited) {\n          resolve(window.gapi);\n        } else {\n          if (window.gapi && !isIniting) {\n            isIniting = true;\n            initGoogleDriveAPIClient().then(() => {\n              isInited = true;\n              afterInitCallbacks.forEach((callback) => callback(window.gapi));\n              resolve(window.gapi);\n            });\n          } else {\n            afterInitCallbacks.push(resolve);\n          }\n        }\n      });\n    };\n  })();\n\n  // Trigger the API client init when the gapi script loads.\n  if (window.gapi) {\n    getAPIClient();\n  } else {\n    // This handler will be called when the <script> tag loads.\n    window.handleGoogleDriveClientLoad = getAPIClient;\n  }\n\n  const isSignedIn = () =>\n    new Promise((resolve, reject) =>\n      getAPIClient().then((gapi) => resolve(gapi.auth2.getAuthInstance().isSignedIn.get()))\n    );\n\n  const transformDirectoryListing = (listing) =>\n    fromJS(\n      listing.map((entry) => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry.mimeType === 'application/vnd.google-apps.folder',\n        path: `/${entry.id}`,\n      }))\n    );\n\n  const getFiles = (directoryId, nextPageToken = null) => {\n    const fileListPromise = new Promise((resolve, reject) => {\n      getAPIClient().then((gapi) => {\n        gapi.client.drive.files\n          .list({\n            pageSize: 30,\n            fields: 'nextPageToken, files(id, name, mimeType, parents)',\n            q: `'${directoryId === '' ? 'root' : directoryId}' in parents and trashed = false`,\n            pageToken: nextPageToken,\n          })\n          .then((response) => {\n            resolve({\n              listing: transformDirectoryListing(response.result.files),\n              hasMore: !!response.result.nextPageToken,\n              additionalSyncBackendState: Map({\n                currentDirectoryId: directoryId,\n                nextPageToken: response.result.nextPageToken,\n              }),\n            });\n          })\n          .catch(reject);\n      });\n    });\n\n    const fileParentPromise = new Promise((resolve, reject) => {\n      if (directoryId === '') {\n        resolve(null);\n      } else {\n        getAPIClient()\n          .then((gapi) =>\n            gapi.client.drive.files.get({\n              fileId: directoryId,\n              fields: 'parents',\n            })\n          )\n          .then((response) => {\n            if (!response.result.parents) {\n              resolve(null);\n            } else {\n              resolve(response.result.parents[0]);\n            }\n          })\n          .catch(reject);\n      }\n    });\n\n    const rootFolderIdPromise = new Promise((resolve, reject) => {\n      if (!!window.rootFolderId) {\n        resolve(window.rootFolderId);\n      } else {\n        getAPIClient()\n          .then((gapi) =>\n            gapi.client.drive.files.get({\n              fileId: 'root',\n              fields: 'id',\n            })\n          )\n          .then((response) => {\n            window.rootFolderId = response.result.id;\n            resolve(response.result.id);\n          })\n          .catch(reject);\n      }\n    });\n\n    return new Promise((resolve, reject) => {\n      Promise.all([fileListPromise, fileParentPromise, rootFolderIdPromise]).then(\n        ([listing, parentId, rootFolderId]) => {\n          const directoryParentId = parentId === rootFolderId ? '' : parentId;\n          listing.additionalSyncBackendState = listing.additionalSyncBackendState.set(\n            'parentId',\n            directoryParentId\n          );\n          resolve(listing);\n        }\n      );\n    });\n  };\n\n  const getDirectoryListing = (directoryId) =>\n    getFiles(directoryId.startsWith('/') ? directoryId.substr(1) : directoryId);\n\n  const getMoreDirectoryListing = (additionalSyncBackendState) => {\n    const directoryId = additionalSyncBackendState.get('currentDirectoryId');\n    const nextPageToken = additionalSyncBackendState.get('nextPageToken');\n    return getFiles(directoryId, nextPageToken);\n  };\n\n  const fileIdByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) => {\n      getAPIClient()\n        .then((gapi) =>\n          gapi.client.drive.files.list({\n            pageSize: 1,\n            fields: 'files(id)',\n            q: `'${parentId}' in parents and trashed = false and name = '${name}'`,\n          })\n        )\n        .then((response) =>\n          resolve(response.result.files.length > 0 ? response.result.files[0].id : null)\n        )\n        .catch(reject);\n    });\n\n  const updateFile = (fileId, contents) => {\n    fileId = fileId.startsWith('/') ? fileId.substr(1) : fileId;\n\n    return getAPIClient().then((gapi) => {\n      fetch(`https://www.googleapis.com/upload/drive/v3/files/${fileId}?uploadType=media`, {\n        method: 'PATCH',\n        headers: {\n          Authorization: `Bearer ${gapi.auth.getToken().access_token}`,\n        },\n        body: contents,\n      });\n    });\n  };\n\n  const createFile = (name, parentId, contents) => {\n    return new Promise((resolve, reject) => {\n      fileIdByNameAndParent(name, parentId)\n        .then((fileId) =>\n          !!fileId\n            ? updateFile(fileId, contents).then(resolve).catch(reject)\n            : getAPIClient().then((gapi) => {\n                gapi.client.drive.files\n                  .create({\n                    name,\n                    parents: parentId,\n                  })\n                  .then((response) => updateFile(response.result.id, contents))\n                  .then(resolve)\n                  .catch(reject);\n              })\n        )\n        .catch(reject);\n    });\n  };\n\n  const duplicateFile = (fileId, fileNameCallback) => {\n    return new Promise((resolve, reject) => {\n      getAPIClient().then((gapi) => {\n        gapi.client.drive.files\n          .get({\n            fileId,\n            fields: 'name, parents',\n          })\n          .then((getResponse) => {\n            if (!getResponse.result.name) {\n              reject();\n            } else {\n              const newFileName = fileNameCallback(getResponse.result.name);\n              const parents = getResponse.result.parents[0];\n              fileIdByNameAndParent(newFileName, parents).then((backupFileId) => {\n                const makeCopy = () => {\n                  gapi.client.drive.files\n                    .copy({\n                      fileId,\n                      parents,\n                      name: newFileName,\n                    })\n                    .then(() => {\n                      resolve();\n                    })\n                    .catch(reject);\n                };\n\n                if (!!backupFileId) {\n                  gapi.client.drive.files\n                    .delete({ fileId: backupFileId })\n                    .then(makeCopy)\n                    .catch(reject);\n                } else {\n                  makeCopy();\n                }\n              });\n            }\n          });\n      });\n    });\n  };\n\n  const getFileContentsAndMetadata = (fileId) =>\n    new Promise((resolve, reject) => {\n      if (!fileId) return reject();\n      getAPIClient().then((gapi) => {\n        fileId = fileId.startsWith('/') ? fileId.substr(1) : fileId;\n\n        const fileContentsPromise = new Promise((resolve) => {\n          gapi.client.drive.files\n            .get({\n              fileId,\n              alt: 'media',\n            })\n            .then((response) => resolve(decodeURIComponent(escape(response.body))))\n            .catch((error) => {\n              if (error.body && JSON.parse(error.body).error.errors[0].reason === 'notFound') {\n                reject();\n              }\n            });\n        });\n\n        const fileModifiedTimePromise = new Promise((resolve) => {\n          gapi.client.drive.files\n            .get({\n              fileId,\n              fields: 'modifiedTime',\n            })\n            .then((response) => {\n              resolve(response.result.modifiedTime);\n            })\n            .catch((error) => {\n              if (error.body && JSON.parse(error.body).error.errors[0].reason === 'notFound') {\n                reject();\n              }\n            });\n        });\n\n        Promise.all([fileContentsPromise, fileModifiedTimePromise]).then(\n          ([contents, lastModifiedAt]) => {\n            resolve({\n              contents,\n              lastModifiedAt,\n            });\n          }\n        );\n      });\n    });\n\n  const getFileContents = (fileId) => {\n    return new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(fileId)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n  };\n\n  const getFileContentsByNameAndParent = (name, parentId) => {\n    return new Promise((resolve, reject) =>\n      fileIdByNameAndParent(name, parentId).then((fileId) => {\n        if (fileId) {\n          getFileContents(fileId).then(resolve);\n        } else {\n          reject();\n        }\n      })\n    );\n  };\n\n  const deleteFileByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) => {\n      getAPIClient().then((gapi) =>\n        gapi.client.drive.files\n          .list({\n            pageSize: 1,\n            fields: 'files(id)',\n            q: `'${parentId}' in parents and trashed = false and name = '${name}'`,\n          })\n          .then((listResponse) => {\n            if (listResponse.result.files.length > 0) {\n              gapi.client.drive.files\n                .delete({\n                  fileId: listResponse.result.files[0].id,\n                })\n                .then(resolve)\n                .catch(reject);\n            } else {\n              resolve();\n            }\n          })\n      );\n    });\n\n  return {\n    type: 'Google Drive',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    duplicateFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    getFileContentsByNameAndParent,\n    deleteFileByNameAndParent,\n  };\n};\n","import React from 'react';\nexport default ({ href, children }) => {\n  return (\n    <a href={href} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children ? children : href}\n    </a>\n  );\n};\n","import React from 'react';\nimport './stylesheet.css';\nimport ExternalLink from '../UI/ExternalLink';\nconst PrivacyPolicy = () => {\n  return (\n    <div className=\"privacy-policy-container\">\n      <h1>organice privacy policy</h1>\n      <p>Last updated: May 9th, 2020</p>\n\n      <p>\n        <ExternalLink href=\"https://200ok.ch/\">200ok llc</ExternalLink> operates the{' '}\n        <ExternalLink href=\"https://organice.200ok.ch\" /> website and mobile apps.\n      </p>\n\n      <p>\n        This page is used to inform website visitors regarding our policies with the collection,\n        use, and disclosure of Personal Information if anyone decided to use our Service.\n      </p>\n      <p>\n        If you choose to use our Service, then you agree to the collection and use of information in\n        relation with this policy. The Personal Information that we collect are used for providing\n        and improving the Service. We will not use or share your information with anyone except as\n        described in this Privacy Policy.\n      </p>\n      {/* <p> */}\n      {/*   <span> */}\n      {/*     The terms used in this Privacy Policy have the same meanings as in our */}\n      {/*     <a href=\"/static/terms-of-service\">Terms and Conditions</a> */}\n      {/*   </span> */}\n      {/*   <span>, unless otherwise defined in this Privacy Policy.</span> */}\n      {/* </p> */}\n      <p>\n        <strong>Information Collection and Use</strong>\n      </p>\n      <p>\n        For a better experience while using our Service, we may require you to provide us with\n        certain personally identifiable information, including but not limited to your name, phone\n        number, and postal address. The information that we collect will be used to contact or\n        identify you.\n      </p>\n      <p>\n        <strong>Log Data</strong>\n      </p>\n      <p>\n        We want to inform you that whenever you visit our Service, we collect information that your\n        browser sends to us that is called Log Data. This Log Data may include information such as\n        your computer’s Internet Protocol (“IP”) address, browser version, pages of our Service that\n        you visit, the time and date of your visit, the time spent on those pages, and other\n        statistics.\n      </p>\n      <p>\n        <strong>User data</strong>\n      </p>\n      <p>\n        No user data, including user data from third-party services such as Dropbox or Google, will\n        be stored or monitored by our Service. All access to user data is done through the proper\n        APIs of the respective services, and all data is only processed by the browser. No data will\n        be shared with any other service.\n      </p>\n\n      <p>\n        <strong>Cookies</strong>\n      </p>\n      <p>\n        Cookies are files with small amount of data that is commonly used an anonymous unique\n        identifier. These are sent to your browser from the website that you visit and are stored on\n        your computer’s hard drive.\n      </p>\n      <p>\n        Our website uses these “cookies” to collection information and to improve our Service. You\n        have the option to either accept or refuse these cookies, and know when a cookie is being\n        sent to your computer. If you choose to refuse our cookies, you may not be able to use some\n        portions of our Service.\n      </p>\n      <p>\n        <strong>Service Providers</strong>\n      </p>\n      <p>We may employ third-party companies and individuals due to the following reasons:</p>\n      <ul>\n        <li>To facilitate our Service;</li>\n        <li>To provide the Service on our behalf;</li>\n        <li>To perform Service-related services; or</li>\n        <li>To assist us in analyzing how our Service is used.</li>\n      </ul>\n\n      <p>\n        We want to inform our Service users that these third parties have access to your Personal\n        Information. The reason is to perform the tasks assigned to them on our behalf. However,\n        they are obligated not to disclose or use the information for any other purpose.\n      </p>\n      <p>\n        <strong>Security</strong>\n      </p>\n      <p>\n        We value your trust in providing us your Personal Information, thus we are striving to use\n        commercially acceptable means of protecting it. But remember that no method of transmission\n        over the internet, or method of electronic storage is 100% secure and reliable, and we\n        cannot guarantee its absolute security.\n      </p>\n\n      <p>\n        <strong>Links to Other Sites</strong>\n      </p>\n      <p>\n        Our Service may contain links to other sites. If you click on a third-party link, you will\n        be directed to that site. Note that these external sites are not operated by us. Therefore,\n        we strongly advise you to review the Privacy Policy of these websites. We have no control\n        over, and assume no responsibility for the content, privacy policies, or practices of any\n        third-party sites or services.\n      </p>\n      <p>\n        <strong>Children’s Privacy</strong>\n      </p>\n      <p>\n        Our Services do not address anyone under the age of 13. We do not knowingly collect personal\n        identifiable information from children under 13. In the case we discover that a child under\n        13 has provided us with personal information, we immediately delete this from our servers.\n        If you are a parent or guardian and you are aware that your child has provided us with\n        personal information, please contact us so that we will be able to do necessary actions.\n      </p>\n      <p>\n        <strong>Changes to This Privacy Policy</strong>\n      </p>\n      <p>\n        We may update our Privacy Policy from time to time. Thus, we advise you to review this page\n        periodically for any changes. We will notify you of any changes by posting the new Privacy\n        Policy on this page. These changes are effective immediately, after they are posted on this\n        page.\n      </p>\n\n      <p>\n        <strong>Contact us</strong>\n      </p>\n\n      <p>\n        If you have any questions about this Privacy Policy, please{' '}\n        <a href=\"mailto:info@200ok.ch\">contact us</a>.\n      </p>\n    </div>\n  );\n};\nexport default PrivacyPolicy;\n","export default __webpack_public_path__ + \"static/media/organice.5121bc75.svg\";","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link, withRouter } from 'react-router-dom';\n\nimport logo from '../../images/organice.svg';\n\nimport './stylesheet.css';\n\nimport * as baseActions from '../../actions/base';\nimport * as orgActions from '../../actions/org';\nimport { ActionCreators as undoActions } from 'redux-undo';\n\nimport ExternalLink from '../UI/ExternalLink';\n\nimport { List } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nclass HeaderBar extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleChangelogClick',\n      'handleModalPageDoneClick',\n      'handleHeaderBarTitleClick',\n      'handleBackClick',\n      'handleUndoClick',\n      'handleRedoClick',\n      'handleHelpClick',\n      'handleSettingsClick',\n    ]);\n  }\n\n  getPathRoot() {\n    const {\n      location: { pathname },\n    } = this.props;\n    return pathname.split('/')[1];\n  }\n\n  getFilename() {\n    const {\n      location: { pathname },\n    } = this.props;\n    // only show a filename if it's a file and not a path\n    if (pathname.includes('.org')) {\n      return pathname.substring(pathname.lastIndexOf('/') + 1, pathname.lastIndexOf('.'));\n    } else {\n      return '';\n    }\n  }\n\n  renderFileBrowserBackButton() {\n    let backPath = 'Back';\n    const fileParts = window.location.href.split('/').map((e) => decodeURIComponent(e));\n    if (_.includes(fileParts, 'files')) {\n      backPath = _.last(fileParts);\n    }\n\n    return (\n      <div\n        onClick={() => {\n          window.history.back();\n        }}\n        className=\"header-bar__back-button\"\n      >\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">{backPath}</span>\n      </div>\n    );\n  }\n\n  renderOrgFileBackButton() {\n    const {\n      location: { pathname },\n    } = this.props;\n\n    let filePath = pathname.substr('/file'.length);\n    if (filePath.endsWith('/')) {\n      filePath = filePath.substring(0, filePath.length - 1);\n    }\n\n    const pathParts = filePath.split('/');\n    const directoryPath = pathParts.slice(0, pathParts.length - 1).join('/');\n\n    return (\n      <Link\n        to={`/files${directoryPath}`}\n        onClick={this.handleBackClick}\n        className=\"header-bar__back-button\"\n      >\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">File browser</span>\n      </Link>\n    );\n  }\n\n  renderLogo() {\n    return (\n      <div className=\"header-bar__logo-container\">\n        <img className=\"header-bar__logo\" src={logo} alt=\"Logo\" width=\"30\" height=\"30\" />\n        <h2 className=\"header-bar__app-name\">organice</h2>\n      </div>\n    );\n  }\n\n  renderHomeFileBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  renderSignInBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  handleBackClick() {\n    this.props.base.popModalPage();\n  }\n\n  renderSettingsSubPageBackButton() {\n    return (\n      <div className=\"header-bar__back-button\" onClick={this.handleBackClick}>\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Settings</span>\n      </div>\n    );\n  }\n\n  renderBackButton() {\n    const { activeModalPage } = this.props;\n\n    switch (activeModalPage) {\n      case 'changelog':\n        return this.renderSettingsSubPageBackButton();\n      case 'keyboard_shortcuts_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'capture_templates_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'file_settings_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'sample':\n        return this.renderOrgFileBackButton();\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case '':\n        return this.renderLogo();\n      case 'files':\n        return this.renderFileBrowserBackButton();\n      case 'file':\n        return this.renderOrgFileBackButton();\n      case 'sample':\n        return this.renderHomeFileBackButton();\n      case 'sign_in':\n        return this.renderSignInBackButton();\n      case 'settings':\n        return this.renderFileBrowserBackButton();\n      default:\n        return <div />;\n    }\n  }\n\n  renderTitle() {\n    const titleContainerWithText = (text) => (\n      <div className=\"header-bar__title\" onClick={this.handleHeaderBarTitleClick}>\n        {text}\n      </div>\n    );\n\n    switch (this.props.activeModalPage) {\n      case 'changelog':\n        return titleContainerWithText('Changelog');\n      case 'settings':\n        return titleContainerWithText('Settings');\n      case 'keyboard_shortcuts_editor':\n        return titleContainerWithText('Shortcuts');\n      case 'capture_templates_editor':\n        return titleContainerWithText('Capture');\n      case 'file_settings_editor':\n        return titleContainerWithText('Files');\n      case 'sample':\n        return titleContainerWithText('Sample');\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case 'sample':\n        return titleContainerWithText('Sample');\n      case 'sign_in':\n        return titleContainerWithText('Sign in');\n      case 'settings':\n        return titleContainerWithText('Settings');\n      default:\n    }\n\n    return titleContainerWithText(this.props.shouldShowTitleInOrgFile ? this.getFilename() : '');\n  }\n\n  handleChangelogClick() {\n    this.props.base.restoreStaticFile('changelog');\n    this.props.base.pushModalPage('changelog');\n  }\n\n  handleModalPageDoneClick() {\n    this.props.base.clearModalStack();\n  }\n\n  handleHeaderBarTitleClick() {\n    this.props.org.selectHeader(null);\n  }\n\n  handleUndoClick() {\n    if (this.props.isUndoEnabled) {\n      this.props.undo.undo();\n    }\n  }\n\n  handleRedoClick() {\n    if (this.props.isRedoEnabled) {\n      this.props.undo.redo();\n    }\n  }\n\n  handleHelpClick() {\n    this.props.base.restoreStaticFile('sample');\n    this.props.base.pushModalPage('sample');\n  }\n\n  handleSettingsClick() {\n    this.props.base.setLastViewedFile(this.props.path);\n  }\n\n  renderActions() {\n    const {\n      isAuthenticated,\n      hasUnseenChangelog,\n      activeModalPage,\n      path,\n      isUndoEnabled,\n      isRedoEnabled,\n    } = this.props;\n\n    if (!!activeModalPage) {\n      return (\n        <div className=\"header-bar__actions\" onClick={this.handleModalPageDoneClick}>\n          Done\n        </div>\n      );\n    } else if (this.getPathRoot() !== 'settings') {\n      const undoIconClassName = classNames('fas fa-undo header-bar__actions__item', {\n        'header-bar__actions__item--disabled': !isUndoEnabled,\n      });\n      const redoIconClassName = classNames('fas fa-redo header-bar__actions__item', {\n        'header-bar__actions__item--disabled': !isRedoEnabled,\n      });\n\n      const settingsIconClassName = classNames('fas fa-cogs header-bar__actions__item');\n\n      return (\n        <div className=\"header-bar__actions\">\n          {!isAuthenticated && this.getPathRoot() !== 'sign_in' && (\n            <Link to=\"/sign_in\">\n              <div className=\"header-bar__actions__item\" title=\"Sign in\">\n                Sign in\n              </div>\n            </Link>\n          )}\n\n          {!isAuthenticated && (\n            <ExternalLink href=\"https://github.com/200ok-ch/organice\">\n              <i className=\"fab fa-github header-bar__actions__item\" />\n            </ExternalLink>\n          )}\n\n          {isAuthenticated && !activeModalPage && !!path && (\n            <Fragment>\n              <i className={undoIconClassName} onClick={this.handleUndoClick} title=\"Undo\" />\n              <i className={redoIconClassName} onClick={this.handleRedoClick} title=\"Redo\" />\n              <i\n                className=\"fas fa-question-circle header-bar__actions__item\"\n                onClick={this.handleHelpClick}\n                title=\"Help\"\n              />\n            </Fragment>\n          )}\n\n          {isAuthenticated && (\n            <div>\n              {hasUnseenChangelog && (\n                <i\n                  className=\"changelog-icon--has-unseen-changelog header-bar__actions__item fas fa-gift\"\n                  onClick={this.handleChangelogClick}\n                />\n              )}\n              <Link to=\"/settings\" onClick={this.handleSettingsClick}>\n                <i className={settingsIconClassName} title=\"Settings\" />\n              </Link>\n            </div>\n          )}\n        </div>\n      );\n    }\n  }\n\n  render() {\n    const className = classNames('header-bar', {\n      'header-bar--with-logo': this.getPathRoot() === '',\n    });\n\n    return (\n      <div className={className}>\n        {this.renderBackButton()}\n        {this.renderTitle()}\n        {this.renderActions()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    shouldShowTitleInOrgFile: state.base.get('shouldShowTitleInOrgFile'),\n    path: state.org.present.get('path'),\n    isUndoEnabled: state.org.past.length > 0,\n    isRedoEnabled: state.org.future.length > 0,\n    syncBackendType: state.syncBackend.get('client') && state.syncBackend.get('client').type,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(HeaderBar));\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport './stylesheet.css';\nimport logo from '../../images/organice.svg';\nimport ExternalLink from '../UI/ExternalLink';\n\nexport default () => {\n  return (\n    <main className=\"landing-container-wrapper\">\n      <div className=\"landing-container\">\n        <h1 className=\"landing-app-name\">organice</h1>\n\n        <img className=\"landing-logo\" src={logo} alt=\"Logo\" />\n\n        <h2 className=\"landing-tagline\">organice organizes Org files nicely!</h2>\n\n        <h2 className=\"landing-tagline\">\n          Syncs with Dropbox,\n          <br /> Google Drive and WebDAV.\n        </h2>\n\n        <p className=\"landing-description\">\n          organice allows you to view and edit Org files from cloud storage directly on your device!\n          No Org file or other user-data will be stored on our servers; the entire app is\n          browser-based.\n        </p>\n\n        <Link to=\"/sign_in\">\n          <div className=\"btn landing-button\">Sign in</div>\n        </Link>\n        <Link to=\"/sample\">\n          <div className=\"btn landing-button doc-button\">View sample</div>\n        </Link>\n        <ExternalLink href=\"https://organice.200ok.ch/documentation.html\">\n          <div className=\"btn landing-button doc-button\">Documentation</div>\n        </ExternalLink>\n      </div>\n      <footer>\n        <Link to=\"/privacy-policy\">Privacy Policy</Link>\n      </footer>\n    </main>\n  );\n};\n","import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\n\nconst FileBrowser = ({\n  path,\n  listing,\n  hasMore,\n  isLoadingMore,\n  syncBackendType,\n  syncBackend,\n  additionalSyncBackendState,\n}) => {\n  useEffect(() => syncBackend.getDirectoryListing(path), [syncBackend, path]);\n\n  const handleLoadMoreClick = () => syncBackend.loadMoreDirectoryListing();\n\n  const getParentDirectoryPath = () => {\n    switch (syncBackendType) {\n      case 'Dropbox':\n      case 'WebDAV':\n        const pathParts = path.split('/');\n        return pathParts.slice(0, pathParts.length - 1).join('/');\n      case 'Google Drive':\n        return !!additionalSyncBackendState.get('parentId')\n          ? '/' + additionalSyncBackendState.get('parentId')\n          : null;\n      default:\n        return null;\n    }\n  };\n\n  const isTopLevelDirectory = path === '';\n\n  return (\n    <div className=\"file-browser-container\">\n      {syncBackendType === 'Dropbox' && (\n        <h3 className=\"file-browser__header\">Directory: {isTopLevelDirectory ? '/' : path}</h3>\n      )}\n\n      <ul className=\"file-browser__file-list\">\n        {!isTopLevelDirectory && (\n          <Link to={`/files${getParentDirectoryPath()}`}>\n            <li className=\"file-browser__file-list__element\">\n              <i className=\"fas fa-folder file-browser__file-list__icon--directory\" /> ..\n            </li>\n          </Link>\n        )}\n\n        {(listing || []).map((file) => {\n          const isDirectory = file.get('isDirectory');\n          const isBackupFile = file.get('name').endsWith('.organice-bak');\n          const isOrgFile = file.get('name').endsWith('.org');\n          const isSettingsFile = file.get('name') === '.organice-config.json';\n\n          const iconClass = classNames('file-browser__file-list__icon fas', {\n            'fa-folder': isDirectory,\n            'file-browser__file-list__icon--directory': isDirectory,\n            'fa-file': !isDirectory && !isBackupFile && !isSettingsFile,\n            'file-browser__file-list__icon--not-org': !isOrgFile,\n            'fa-copy': isBackupFile,\n            'fa-cogs': isSettingsFile,\n          });\n\n          if (file.get('isDirectory')) {\n            return (\n              <Link to={`/files${file.get('path')}`} key={file.get('id')}>\n                <li className=\"file-browser__file-list__element\">\n                  <i className={iconClass} /> {file.get('name')}/\n                </li>\n              </Link>\n            );\n          } else {\n            return (\n              <Link to={`/file${file.get('path')}`} key={file.get('id')}>\n                <li className=\"file-browser__file-list__element\">\n                  <i className={iconClass} /> {file.get('name')}\n                </li>\n              </Link>\n            );\n          }\n        })}\n\n        {hasMore &&\n          (isLoadingMore ? (\n            <li className=\"file-browser__file-list__loading-more-container\">\n              <i className=\"fas fa-spinner fa-lg fa-spin\" />\n            </li>\n          ) : (\n            <li\n              className=\"file-browser__file-list__element file-browser__file-list__element--load-more-row\"\n              onClick={handleLoadMoreClick}\n            >\n              Load more...\n            </li>\n          ))}\n      </ul>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const currentFileBrowserDirectoryListing = state.syncBackend.get(\n    'currentFileBrowserDirectoryListing'\n  );\n  return {\n    syncBackendType: state.syncBackend.get('client').type,\n    listing: !!currentFileBrowserDirectoryListing\n      ? currentFileBrowserDirectoryListing.get('listing')\n      : null,\n    hasMore:\n      !!currentFileBrowserDirectoryListing && currentFileBrowserDirectoryListing.get('hasMore'),\n    isLoadingMore:\n      !!currentFileBrowserDirectoryListing &&\n      currentFileBrowserDirectoryListing.get('isLoadingMore'),\n    additionalSyncBackendState:\n      !!currentFileBrowserDirectoryListing &&\n      currentFileBrowserDirectoryListing.get('additionalSyncBackendState'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FileBrowser);\n","import React, { useState, useEffect } from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nexport default ({ message }) => {\n  const [shouldRenderIndicator, setShouldRenderIndicator] = useState(true);\n  const [lastMessage, setLastMessage] = useState(message);\n\n  useEffect(() => {\n    if (!!message) {\n      setLastMessage(message);\n      setShouldRenderIndicator(true);\n    }\n  }, [message]);\n\n  const handleAnimationRest = () => {\n    if (!!message) {\n      return;\n    }\n\n    setShouldRenderIndicator(false);\n    setLastMessage(null);\n  };\n\n  const handleClick = () => setShouldRenderIndicator(false);\n\n  if (!shouldRenderIndicator) {\n    return null;\n  }\n\n  const style = {\n    opacity: spring(!!message ? 0.9 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={style} onRest={handleAnimationRest}>\n      {(style) => (\n        <div className=\"loading-indicator\" style={style} onClick={handleClick}>\n          {lastMessage}\n        </div>\n      )}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nexport default ({\n  subPartDataAndHandlers: {\n    onEnterTableEditMode,\n    onAddNewTableRow,\n    onRemoveTableRow,\n    onAddNewTableColumn,\n    onRemoveTableColumn,\n  },\n}) => {\n  return (\n    <div className=\"table-action-drawer-container\">\n      <div className=\" table-action-drawer__edit-icon-container\" onClick={onEnterTableEditMode}>\n        <i className=\"fas fa-pencil-alt fa-lg\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onAddNewTableRow}>\n        <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onRemoveTableRow}>\n        <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onAddNewTableColumn}>\n        <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onRemoveTableColumn}>\n        <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n      </div>\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\nimport TableActionDrawer from './TableActionDrawer';\n\nimport { getCurrentTimestampAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nexport default class TablePart extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleCellSelect',\n      'handleTextareaBlur',\n      'handleCellChange',\n      'handleInsertTimestamp',\n      'handleTextareaRef',\n    ]);\n\n    this.state = {\n      rawCellValues: this.generateCellValueMap(props.table),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      subPartDataAndHandlers: { onTableCellValueUpdate, selectedTableCellId, inTableEditMode },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    if (prevProps.subPartDataAndHandlers.inTableEditMode && !inTableEditMode) {\n      if (rawCellValues.has(selectedTableCellId)) {\n        onTableCellValueUpdate(selectedTableCellId, rawCellValues.get(selectedTableCellId));\n      }\n    }\n\n    if (this.props.table !== prevProps.table) {\n      this.setState({ rawCellValues: this.generateCellValueMap(this.props.table) });\n    }\n  }\n\n  generateCellValueMap(table) {\n    return Map(\n      table\n        .get('contents')\n        .map((row) => row.get('contents').map((cell) => [cell.get('id'), cell.get('rawContents')]))\n        .flatten()\n    );\n  }\n\n  handleCellSelect(cellId) {\n    return () => this.props.subPartDataAndHandlers.onTableCellSelect(cellId);\n  }\n\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.subPartDataAndHandlers.onExitTableEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleCellChange(event) {\n    const { rawCellValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedTableCellId },\n    } = this.props;\n\n    this.setState({\n      rawCellValues: rawCellValues.set(selectedTableCellId, event.target.value),\n    });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { rawCellValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedTableCellId },\n    } = this.props;\n    const cellValue = rawCellValues.get(selectedTableCellId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      rawCellValues: rawCellValues.set(\n        selectedTableCellId,\n        cellValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          cellValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  render() {\n    const {\n      table,\n      subPartDataAndHandlers: { selectedTableCellId, inTableEditMode, shouldDisableActions },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    const isTableSelected = table\n      .get('contents')\n      .some((row) => row.get('contents').some((cell) => cell.get('id') === selectedTableCellId));\n\n    return (\n      <Fragment>\n        <table className=\"table-part\">\n          <tbody>\n            {table.get('contents').map((row) => (\n              <tr key={row.get('id')}>\n                {row.get('contents').map((cell) => {\n                  const isCellSelected = cell.get('id') === selectedTableCellId;\n\n                  const className = classNames('table-part__cell', {\n                    'table-part__cell--selected': isCellSelected,\n                  });\n\n                  return (\n                    <td\n                      className={className}\n                      key={cell.get('id')}\n                      onClick={this.handleCellSelect(cell.get('id'))}\n                    >\n                      {isCellSelected && inTableEditMode ? (\n                        <div className=\"table-cell__edit-container\">\n                          <textarea\n                            autoFocus\n                            className=\"textarea\"\n                            rows=\"3\"\n                            value={rawCellValues.get(cell.get('id'))}\n                            onBlur={this.handleTextareaBlur}\n                            onChange={this.handleCellChange}\n                            ref={this.handleTextareaRef}\n                          />\n                          <div\n                            className=\"table-cell__insert-timestamp-button\"\n                            onClick={this.handleInsertTimestamp}\n                          >\n                            <i className=\"fas fa-plus insert-timestamp-icon\" />\n                            Insert timestamp\n                          </div>\n                        </div>\n                      ) : cell.get('contents').size > 0 ? (\n                        <AttributedString\n                          parts={cell.get('contents')}\n                          subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n                        />\n                      ) : (\n                        '   '\n                      )}\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n\n        <Collapse isOpened={isTableSelected && !shouldDisableActions}>\n          <TableActionDrawer subPartDataAndHandlers={this.props.subPartDataAndHandlers} />\n        </Collapse>\n      </Fragment>\n    );\n  }\n}\n","// Interpolates between two colors.\n// colorA and colorB should be objects with keys {r, g, b, a}.\n// interpolationFactor should be a number between 0 and 1 representing how far from colorA to\n// colorB it should interpolate.\n// An object with keys {r, g, b, a} will be returned.\nexport const interpolateColors = (colorA, colorB, interpolationFactor) => {\n  return {\n    r: parseInt((colorB.r - colorA.r) * interpolationFactor + colorA.r, 10),\n    g: parseInt((colorB.g - colorA.g) * interpolationFactor + colorA.g, 10),\n    b: parseInt((colorB.b - colorA.b) * interpolationFactor + colorA.b, 10),\n    a: (colorB.a - colorA.a) * interpolationFactor + colorA.a,\n  };\n};\n\nexport const rgbaObject = (r, g, b, a) => {\n  return { r, g, b, a };\n};\n\nexport const rgbaString = (rgba) => {\n  return `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\n};\n\n// assumes var is either a longform-hex or rgb(a) color value\nexport const readRgbaVariable = (varName) => {\n  const varValue = getComputedStyle(document.documentElement).getPropertyValue(varName);\n  if (varValue.charAt(0) === '#') {\n    const hexValue = varValue.substring(1, 7);\n    return rgbaObject(\n      parseInt(hexValue.substring(0, 2), 16),\n      parseInt(hexValue.substring(2, 4), 16),\n      parseInt(hexValue.substring(4, 6), 16),\n      1\n    );\n  } else {\n    const rgbaValues = [...varValue.matchAll(/[0-9.]+/g)].map((a) => +a[0]);\n    if (rgbaValues.length === 3) {\n      return rgbaObject(...rgbaValues, 0);\n    } else if (rgbaValues.length === 4) {\n      return rgbaObject(...rgbaValues);\n    } else {\n      return rgbaObject(0, 0, 0, 0);\n    }\n  }\n};\n\nconst themes = {\n  Solarized: {\n    /* \n      https://ethanschoonover.com/solarized/ \n    */\n    Light: {\n      '--base3': '#fdf6e3',\n      '--base2': '#eee8d5',\n      '--base1': '#93a1a1',\n      '--base0': '#839496',\n      // highlights\n      '--base00': '#657b83',\n      '--base01': '#586e75',\n      '--base02': '#073642',\n      '--base03': '#002b36',\n      // shadows\n      '--base0-soft': 'rgba(131, 148, 150, 0.75)',\n      // highlighted backgrounds\n      '--base1-soft': 'rgba(147, 161, 161, 0.4)',\n      // header colors\n      '--blue': '#268bd2',\n      '--green': '#859900',\n      '--cyan': '#2aa198',\n      '--yellow': '#b58900',\n      // additional colors\n      '--orange': '#cb4b16',\n      '--red': '#dc322f',\n      '--magenta': '#d33682',\n      '--violet': '#6c71c4',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      // backgrounds\n      '--base3': '#002b36',\n      '--base2': '#073642',\n      '--base1': '#586e75',\n      '--base0': '#657b83',\n      // highlights\n      '--base03': '#fdf6e3',\n      '--base02': '#eee8d5',\n      '--base01': '#93a1a1',\n      '--base00': '#839496',\n      // shadows\n      '--base0-soft': 'rgba(0, 21, 27, 0.75)',\n      // highlighted backgrounds\n      '--base1-soft': 'rgba(0, 21, 27, 0.4)',\n      // header colors\n      '--blue': '#268bd2',\n      '--green': '#859900',\n      '--cyan': '#2aa198',\n      '--yellow': '#b58900',\n      // additional colors\n      '--orange': '#cb4b16',\n      '--red': '#dc322f',\n      '--magenta': '#6c71c4',\n      '--violet': '#d33682',\n      // table highlight\n      '--green-soft:': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n  Gruvbox: {\n    Light: {\n      /*\n        see https://github.com/morhetz/gruvbox for palette\n        this theme uses the 'faded' version of the color palette\n      */\n      // background and highlights\n      '--base3': '#fbf1c7', // bg0\n      '--base2': '#d5c4a1', // bg2\n      '--base1': '#bdae93', // bg3\n      '--base0': '#a89984', // bg4\n      '--base00': '#7c6f64', // fg4\n      '--base01': '#665c54', // fg3\n      '--base02': '#504945', // fg2\n      '--base03': '#282828', // fg0\n      // transparent versions\n      '--base0-soft': 'rgba(168, 153, 132, 0.75)',\n      '--base1-soft': 'rgba(189, 174, 147, 0.4)',\n      // header colors\n      '--blue': '#076678',\n      '--green': '#79740e',\n      '--cyan': '#427b58',\n      '--yellow': '#b57614',\n      // additional colors\n      '--orange': '#af3a03',\n      '--red': '#9d0006',\n      '--magenta': '#8f3f71', // faded purple\n      '--violet': '#b16286', // neutral purple\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      /*\n        see https://github.com/morhetz/gruvbox for palette\n        this theme uses the 'neutral' version of the color palette\n      */\n      // background and highlights\n      '--base3': '#282828', // bg0\n      '--base2': '#504945', // bg2\n      '--base1': '#665c54', // bg3\n      '--base0': '#7c6f64', // bg4\n      '--base00': '#a89984', // fg4\n      '--base01': '#bdae93', // fg3\n      '--base02': '#d5c4a1', // fg2\n      '--base03': '#fbf1c7', // fg0\n      // transparent versions\n      '--base0-soft': 'rgba(20, 20, 20, 0.75)',\n      '--base1-soft': 'rgba(20, 20, 20, 0.4)',\n      // header colors\n      '--blue': '#458588',\n      '--green': '#98971a',\n      '--cyan': '#689d6a',\n      '--yellow': '#d79921',\n      // additional colors\n      '--orange': '#d65d0e',\n      '--red': '#cc241d',\n      '--magenta': '#b16286', // neutral purple\n      '--violet': '#d3869b', // bright purple\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n  One: {\n    Light: {\n      /*\n        adaptation of atom one light theme\n        https://github.com/atom/atom/tree/master/packages/one-light-ui\n      */\n      // background and highlights\n      '--base03': '#383A42',\n      '--base02': '#585A5F',\n      '--base01': '#79797C',\n      '--base00': '#999999',\n      '--base0': '#A0A1A7',\n      '--base1': '#C0C0C4',\n      '--base2': '#DFE0E2',\n      '--base3': '#FFFFFF',\n      // transparent versions\n      '--base0-soft': 'rgba(160, 161, 167, 0.75)',\n      '--base1-soft': 'rgba(192, 192, 196, 0.4)',\n      // header colors\n      '--blue': '#1492ff',\n      '--green': '#2db448',\n      '--cyan': '#D831B0', // pink\n      '--yellow': '#d5880b',\n      // additional colors\n      '--orange': '#f42a2a', //red\n      '--red': '#f42a2a',\n      '--magenta': 'hsl(208, 100%, 56%)', // blue\n      '--violet': '#D831B0', // pink\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      /*\n        adaptation of atom one dark theme\n        https://github.com/atom/atom/tree/master/packages/one-dark-ui\n      */\n      // background and highlights\n      '--base03': '#abb2bf',\n      '--base02': '#9198A5',\n      '--base01': '#767D8A',\n      '--base00': '#5c6370',\n      '--base0': '#4c5263',\n      '--base1': '#404553',\n      '--base2': '#343944',\n      '--base3': '#282c34',\n      // transparent versions\n      '--base0-soft': 'rgba(20, 22, 26, 0.75)',\n      '--base1-soft': 'rgba(20, 22, 26, 0.4)',\n      // header colors\n      '--blue': 'rgb(100, 148, 237)',\n      '--green': 'rgb(115, 201, 144)',\n      '--cyan': 'rgb(204, 133, 51)', //orange\n      '--yellow': 'rgb(226, 192, 141)',\n      // additional colors\n      '--orange': 'rgb(255, 99, 71)', //red\n      '--red': '#D831B0', //pink\n      '--magenta': 'rgb(0, 136, 255)', //blue\n      '--violet': '#d33682',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n  Smyck: {\n    /*\n      see http://color.smyck.org/ for palette\n    */\n    Light: {\n      // background and highlights\n      '--base3': '#F7F7F7',\n      '--base2': '#DFDFDF',\n      '--base1': '#C8C8C8',\n      '--base0': '#B0B0B0',\n      '--base00': '#5D5D5D',\n      '--base01': '#3E3E3E',\n      '--base02': '#1F1F1F',\n      '--base03': '#000000',\n      // transparent versions\n      '--base0-soft': 'rgba(176, 176, 176, 0.75)',\n      '--base1-soft': 'rgba(200, 200, 200, 0.4)',\n      // header colors\n      '--blue': '#72B3CC',\n      '--green': '#8EB33B',\n      '--cyan': '#218693',\n      '--yellow': '#D0B03C',\n      // additional colors\n      '--orange': '#C75646',\n      '--red': '#E09690',\n      '--magenta': '#77DFD8',\n      '--violet': '#FBB1F9',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      // background and highlights\n      '--base3': '#000000',\n      '--base2': '#1F1F1F',\n      '--base1': '#3E3E3E',\n      '--base0': '#5D5D5D',\n      '--base00': '#B0B0B0',\n      '--base01': '#C8C8C8',\n      '--base02': '#DFDFDF',\n      '--base03': '#F7F7F7',\n      // transparent versions\n      '--base0-soft': 'rgba(31, 31, 31, 0.75)',\n      '--base1-soft': 'rgba(31, 31, 31, 0.4)',\n      // header colors\n      '--blue': '#72B3CC',\n      '--green': '#8EB33B',\n      '--cyan': '#218693',\n      '--yellow': '#D0B03C',\n      // additional colors\n      '--orange': '#C75646',\n      '--red': '#E09690',\n      '--magenta': '#77DFD8',\n      '--violet': '#FBB1F9',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n  Code: {\n    Light: {\n      /*\n        a rough approximation of Light+ (default light theme of VS Code)\n        https://github.com/microsoft/vscode/blob/master/extensions/theme-defaults/themes/dark_plus.json\n      */\n      // backgrounds\n      '--base3': '#FFFFFF',\n      '--base2': '#DBDBDB',\n      '--base1': '#B6B6B6',\n      '--base0': '#929292',\n      // highlights\n      '--base00': '#6D6D6D',\n      '--base01': '#494949',\n      '--base02': '#242424',\n      '--base03': '#000000',\n      // shadows\n      '--base0-soft': 'rgba(146, 146, 146, 0.75)',\n      // highlighted backgrounds\n      '--base1-soft': 'rgba(172, 172, 172, 0.4)',\n      // header colors\n      '--blue': '#0000ff',\n      '--green': '#098658',\n      '--cyan': '#267f99',\n      '--yellow': '#795e26',\n      // additional colors\n      '--orange': '#ee0000',\n      '--red': '#a31515',\n      '--magenta': '#0070c1',\n      '--violet': '#811f3f',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n    Dark: {\n      /*\n        a rough approximation of Dark+ (default dark theme of VS Code)\n        https://github.com/microsoft/vscode/blob/master/extensions/theme-defaults/themes/dark_plus.json\n      */\n      // backgrounds\n      '--base3': '#1E1E1E',\n      '--base2': '#2C2C32',\n      '--base1': '#303036',\n      '--base0': '#34343a',\n      // highlights\n      '--base00': '#C8C8C8',\n      '--base01': '#cccccc',\n      '--base02': '#D0D0D0',\n      '--base03': '#D4D4D4',\n      // shadows\n      '--base0-soft': 'rgba(15, 15, 15, 0.75)',\n      // highlighted backgrounds\n      '--base1-soft': 'rgba(15, 15, 15, 0.4)',\n      // header colors\n      '--blue': 'rgb(79,193,255)',\n      '--green': 'rgb(106, 153, 85)',\n      '--cyan': '#ce9178', // orange (cyan is #4EC9B0)\n      '--yellow': '#d7ba7d',\n      // additional colors\n      '--orange': '#d16969', // red\n      '--red': '#d16969',\n      '--magenta': '#569cd6', // light blue\n      '--violet': '#C586C0',\n      // table highlight\n      '--green-soft': 'rgba(133, 153, 0, 0.28)',\n    },\n  },\n};\n\nexport const loadTheme = (theme = 'Solarized', colorScheme = 'Light') => {\n  const style = document.documentElement.style;\n  Object.entries(themes[theme][colorScheme]).forEach(([k, v]) => style.setProperty(k, v));\n\n  // set theme color on android\n  document\n    .querySelector('meta[name=\"theme-color\"]')\n    .setAttribute('content', themes[theme]['--base3']);\n};\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ state, onClick }) => {\n  const uncheckedColor = rgbaObject(255, 255, 255, 1);\n  const checkedColor = rgbaObject(238, 232, 213, 1);\n\n  const checkboxStyle = {\n    colorFactor: spring(\n      {\n        checked: 1,\n        partial: 1,\n        unchecked: 0,\n      }[state],\n      { stiffness: 300 }\n    ),\n  };\n\n  return (\n    <Motion style={checkboxStyle}>\n      {(style) => {\n        const backgroundColor = rgbaString(\n          interpolateColors(uncheckedColor, checkedColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"checkbox\" onClick={onClick} style={{ backgroundColor }}>\n            <div className=\"checkbox__inner-container\">\n              {state === 'checked' && <i className=\"fas fa-check\" />}\n              {state === 'partial' && <i className=\"fas fa-minus\" />}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString/';\nimport Checkbox from '../../../../../UI/Checkbox/';\n\nimport classNames from 'classnames';\n\nexport default ({ part, subPartDataAndHandlers }) => {\n  const handleCheckboxClick = (itemId) => () => subPartDataAndHandlers.onCheckboxClick(itemId);\n\n  const renderContent = () => {\n    return part.get('items').map((item) => {\n      const lineContainerClass = classNames({\n        'list-part__checkbox-container': item.get('isCheckbox'),\n      });\n\n      return (\n        <li key={item.get('id')} value={item.get('forceNumber')}>\n          <span\n            className={lineContainerClass}\n            onClick={item.get('isCheckbox') ? handleCheckboxClick(item.get('id')) : null}\n          >\n            {item.get('isCheckbox') && <Checkbox state={item.get('checkboxState')} />}\n            <AttributedString\n              parts={item.get('titleLine')}\n              subPartDataAndHandlers={subPartDataAndHandlers}\n            />\n          </span>\n          <br />\n          <AttributedString\n            parts={item.get('contents')}\n            subPartDataAndHandlers={subPartDataAndHandlers}\n          />\n        </li>\n      );\n    });\n  };\n\n  return part.get('isOrdered') ? (\n    <ol className=\"attributed-string__list-part attributed-string__list-part--ordered\">\n      {renderContent()}\n    </ol>\n  ) : (\n    <ul className=\"attributed-string__list-part\">{renderContent()}</ul>\n  );\n};\n","import React, { Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nexport default ({ part, subPartDataAndHandlers: { onTimestampClick, shouldDisableActions } }) => {\n  const handleClick = () => (shouldDisableActions ? void 0 : onTimestampClick(part.get('id')));\n\n  const firstTimestamp = part.get('firstTimestamp');\n  const secondTimestamp = part.get('secondTimestamp');\n\n  return (\n    <span className=\"attributed-string__timestamp-part\" onClick={handleClick}>\n      {!!firstTimestamp && renderAsText(firstTimestamp)}\n      {!!secondTimestamp && (\n        <Fragment>\n          {'--'}\n          {renderAsText(secondTimestamp)}\n        </Fragment>\n      )}\n    </span>\n  );\n};\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link, useLocation } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport TablePart from './components/TablePart';\nimport ListPart from './components/ListPart';\nimport TimestampPart from './components/TimestampPart';\nimport ExternalLink from '../../../UI/ExternalLink';\n\nimport { orgFileExtensions } from '../../../../lib/org_utils';\nimport * as orgActions from '../../../../actions/org';\n\nimport classNames from 'classnames';\n\nconst AttributedString = ({ org, parts, subPartDataAndHandlers }) => {\n  let className;\n\n  let location = useLocation();\n\n  const renderLink = (part) => {\n    const id = part.get('id');\n    const uri = part.getIn(['contents', 'uri']);\n    const title = part.getIn(['contents', 'title']) || uri;\n    let target = uri;\n    if (uri.startsWith('file:')) {\n      target = uri.substr(5);\n      const isRelativeFileLink = !target.startsWith('/') && !target.startsWith('~');\n      if (isRelativeFileLink) {\n        // N.B. Later on we may improve this conditional by performing\n        // an existence check on the backend if it allows that\n        // operation.\n\n        target = normalisePath(target);\n        if (!target.includes('/../')) {\n          // Normalisation succeeded, so we can safely return a <Link>\n          if (!uri.match(orgFileExtensions)) {\n            // Optimistically assume that the link is pointing to a\n            // directory.\n            target = target.replace(/^\\/file\\//, '/files/');\n            return (\n              <Link key={id} to={target}>\n                {title}\n              </Link>\n            );\n          }\n        }\n      }\n      target = target.replace(/^\\/file\\//, '/');\n      return (\n        <span\n          key={id}\n          style={{ textDecoration: 'underline' }}\n          data-target={target}\n          onClick={() => org.setPath(target)}\n        >\n          {title}\n        </span>\n      );\n    }\n\n    return (\n      <ExternalLink key={id} href={target}>\n        {title}\n      </ExternalLink>\n    );\n  };\n\n  const normalisePath = (target) => {\n    let dir = location.pathname.match(/(.*)\\//)[1];\n    let normalised = target;\n    while (normalised.startsWith('../')) {\n      if (!dir.match(/^\\/file\\/.+/)) {\n        // We're already at the top; can't break out of the area accessible\n        // via HTTP, so just the original non-normalised path\n        return target;\n      }\n      normalised = normalised.substr(3);\n      dir = dir.match(/(.*)\\//)[1];\n    }\n    return dir + '/' + normalised;\n  };\n\n  return (\n    <span>\n      {parts.map((part) => {\n        switch (part.get('type')) {\n          case 'text':\n            return part.get('contents');\n          case 'link':\n            return renderLink(part);\n          case 'percentage-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                parseInt(part.get('percentage'), 10) === 100,\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.get('percentage')}\n                %]\n              </span>\n            );\n          case 'fraction-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                part.getIn(['fraction', 0]) !== '' &&\n                part.getIn(['fraction', 0]) === part.getIn(['fraction', 1]),\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.getIn(['fraction', 0])}/{part.getIn(['fraction', 1])}]\n              </span>\n            );\n          case 'table':\n            return (\n              <TablePart\n                key={part.get('id')}\n                table={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'list':\n            return (\n              <ListPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'inline-markup':\n            className = classNames(\n              'attributed-string__inline-markup',\n              `attributed-string__inline-markup--${part.get('markupType')}`\n            );\n\n            return (\n              <span key={part.get('id')} className={className}>\n                {part.get('content')}\n              </span>\n            );\n          case 'timestamp':\n            return (\n              <TimestampPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'url':\n            return (\n              <ExternalLink href={part.get('content')} key={part.get('id')}>\n                {part.get('content')}\n              </ExternalLink>\n            );\n          case 'www-url':\n            return (\n              <ExternalLink href={`https://${part.get('content')}`} key={part.get('id')}>\n                {part.get('content')}\n              </ExternalLink>\n            );\n          case 'e-mail':\n            return (\n              <a href={`mailto:${part.get('content')}`} key={part.get('id')}>\n                {part.get('content')}\n              </a>\n            );\n          case 'phone-number':\n            return (\n              <a href={`tel:${part.get('content')}`} key={part.get('id')}>\n                {part.get('content')}\n              </a>\n            );\n          default:\n            console.error(`Unrecognized attributed string part type! ${part.get('type')}`);\n            return '';\n        }\n      })}\n    </span>\n  );\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(AttributedString);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\nimport { createIsTodoKeywordInDoneState } from '../../../../lib/org_utils';\n\nimport { generateTitleLine } from '../../../../lib/export_org';\nimport AttributedString from '../AttributedString';\n\nclass TitleLine extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleTitleSpanRef',\n      'handleTextareaRef',\n      'handleTitleClick',\n      'handleTextareaBlur',\n      'handleTextareaFocus',\n      'handleTitleChange',\n      'handleTitleFieldClick',\n      'handleTodoClick',\n      'handleTimestampClick',\n      'handleInsertTimestamp',\n    ]);\n\n    this.state = {\n      titleValue: this.calculateRawTitle(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.inEditMode && !this.props.inEditMode) {\n      this.props.org.updateHeaderTitle(header.get('id'), this.state.titleValue);\n    }\n\n    if (prevProps.header !== this.props.header) {\n      this.setState(\n        {\n          titleValue: this.calculateRawTitle(this.props.header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  handleRef(div) {\n    this.containerDiv = div;\n  }\n\n  handleTitleSpanRef(span) {\n    this.titleSpan = span;\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  calculateRawTitle(header) {\n    return generateTitleLine(header.toJS(), false);\n  }\n\n  handleTitleClick() {\n    const { header, hasContent, isSelected, onClick, closeSubheadersRecursively } = this.props;\n\n    if (!!onClick) {\n      onClick();\n    } else {\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'), closeSubheadersRecursively);\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleTodoClick(event) {\n    const { header, shouldTapTodoToAdvance, setShouldLogIntoDrawer, onClick } = this.props;\n\n    if (!!onClick) {\n      onClick();\n      event.stopPropagation();\n    } else {\n      this.props.org.selectHeader(header.get('id'));\n\n      if (shouldTapTodoToAdvance) {\n        this.props.org.advanceTodoState(null, setShouldLogIntoDrawer);\n      }\n    }\n  }\n\n  // Rationale for setTimeout documented in HeaderContent/index.js\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.org.exitEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 200);\n  }\n\n  handleTextareaFocus(event) {\n    const { header } = this.props;\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\n    if (rawTitle === '') {\n      const text = event.target.value;\n      event.target.selectionStart = text.length;\n      event.target.selectionEnd = text.length;\n    }\n  }\n\n  handleTitleChange(event) {\n    // If the last character typed was a newline at the end, exit edit mode.\n    const newTitle = event.target.value;\n    const lastCharacter = newTitle[newTitle.length - 1];\n    if (\n      this.state.titleValue === newTitle.substring(0, newTitle.length - 1) &&\n      lastCharacter === '\\n'\n    ) {\n      this.props.org.exitEditMode();\n      return;\n    }\n\n    this.setState({ titleValue: newTitle });\n  }\n\n  handleTitleFieldClick(event) {\n    event.stopPropagation();\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', {\n      headerId: this.props.header.get('id'),\n      timestampId,\n    });\n  }\n\n  handleInsertTimestamp(event) {\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { titleValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      titleValue:\n        titleValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        titleValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n\n    this.textarea.focus();\n\n    event.stopPropagation();\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      inEditMode,\n      shouldDisableActions,\n      shouldDisableExplicitWidth,\n      todoKeywordSets,\n      addition,\n    } = this.props;\n    const { containerWidth } = this.state;\n\n    const isTodoKeywordInDoneState = createIsTodoKeywordInDoneState(todoKeywordSets);\n    const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n\n    const titleStyle = {\n      color,\n      wordBreak: 'break-word',\n    };\n\n    const additionStyle = {\n      color,\n      minWidth: '5em',\n      textAlign: 'right',\n      marginRight: '5px',\n    };\n\n    return (\n      <div\n        className=\"title-line\"\n        onClick={this.handleTitleClick}\n        ref={this.handleRef}\n        style={{ width: shouldDisableExplicitWidth ? '' : containerWidth }}\n      >\n        {!inEditMode && !!todoKeyword ? (\n          <span\n            // INFO: Instead of `todoKeyword.toLowerCase()` it would\n            // be best to render todo-keyword--done if the keyword is\n            // the last of a keywordSet. Then it would get rendered\n            // with the appropriate color, no matter what the keyword\n            // is.\n            // Relevant issue: https://github.com/200ok-ch/organice/issues/16\n            className={classNames(\n              'todo-keyword',\n              isTodoKeywordInDoneState(todoKeyword) ? 'todo-keyword--done-state' : null\n            )}\n            onClick={this.handleTodoClick}\n          >\n            {todoKeyword}\n          </span>\n        ) : (\n          ''\n        )}\n\n        {inEditMode ? (\n          <div className=\"title-line__edit-container\">\n            <textarea\n              autoFocus\n              className=\"textarea\"\n              data-testid=\"titleLineInput\"\n              rows=\"3\"\n              ref={this.handleTextareaRef}\n              value={this.state.titleValue}\n              onBlur={this.handleTextareaBlur}\n              onFocus={this.handleTextareaFocus}\n              onChange={this.handleTitleChange}\n              onClick={this.handleTitleFieldClick}\n            />\n            <div\n              className=\"title-line__insert-timestamp-button\"\n              onClick={this.handleInsertTimestamp}\n            >\n              <i className=\"fas fa-plus insert-timestamp-icon\" />\n              Insert timestamp\n            </div>\n          </div>\n        ) : (\n          <div style={{ width: '100%' }}>\n            <div className=\"title-line-text\">\n              <span style={titleStyle} ref={this.handleTitleSpanRef}>\n                <AttributedString\n                  parts={header.getIn(['titleLine', 'title'])}\n                  subPartDataAndHandlers={{\n                    onTimestampClick: this.handleTimestampClick,\n                    shouldDisableActions,\n                  }}\n                />\n                {!header.get('opened') && hasContent ? '...' : ''}\n              </span>\n              {addition ? <span style={additionStyle}>{addition}</span> : null}\n            </div>\n            {header.getIn(['titleLine', 'tags']).size > 0 && (\n              <div>\n                {header\n                  .getIn(['titleLine', 'tags'])\n                  .toSet()\n                  .toList()\n                  .filter((tag) => !!tag)\n                  .map((tag) => (\n                    <div className=\"header-tag\" key={tag}>\n                      {tag}\n                    </div>\n                  ))}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path]);\n  return {\n    inEditMode:\n      file.get('editMode') === 'title' &&\n      file.get('selectedHeaderId') === ownProps.header.get('id'),\n    setShouldLogIntoDrawer: state.base.get('shouldLogIntoDrawer'),\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    closeSubheadersRecursively: state.base.get('closeSubheadersRecursively'),\n    isSelected: file.get('selectedHeaderId') === ownProps.header.get('id'),\n    todoKeywordSets: file.get('todoKeywordSets'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TitleLine);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\nimport { isRegularPlanningItem } from '../../../../../../lib/org_utils';\n\nimport _ from 'lodash';\n\nexport default class PlanningItems extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTimestampClick']);\n  }\n\n  handleTimestampClick(planningItemIndex) {\n    return () => this.props.onClick(planningItemIndex);\n  }\n\n  render() {\n    const { planningItems } = this.props;\n\n    const planningItemsToRender = planningItems.filter((x) => isRegularPlanningItem(x));\n    if (planningItemsToRender.isEmpty()) return null;\n\n    return (\n      <div>\n        {planningItemsToRender.map((planningItem, index) => (\n          <div key={planningItem.get('id')} className=\"planning-items__item-container\">\n            <div className=\"planning-item__type\">{planningItem.get('type')}: </div>\n            <div className=\"planning-item__timestamp\" onClick={this.handleTimestampClick(index)}>\n              {renderAsText(planningItem.get('timestamp'))}\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n","import React, { Fragment, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\n\nexport default ({ propertyListItems, shouldDisableActions, onTimestampClick, onEdit }) => {\n  const [isDrawerCollapsed, setIsDrawerCollapsed] = useState(true);\n\n  const handleCollapseToggle = () => setIsDrawerCollapsed(!isDrawerCollapsed);\n\n  return propertyListItems.size === 0 ? null : (\n    <div className=\"property-list-container\">\n      <div className=\"property-list__property\" onClick={handleCollapseToggle}>\n        :PROPERTIES:\n        {isDrawerCollapsed ? '...' : ''}\n      </div>\n\n      {!isDrawerCollapsed && (\n        <Fragment>\n          {propertyListItems.map((propertyListItem) => (\n            <div className=\"property-list__item-container\" key={propertyListItem.get('id')}>\n              <div\n                className=\"property-list__property\"\n                onClick={shouldDisableActions ? null : onEdit}\n              >\n                :{propertyListItem.get('property')}:\n              </div>\n              <div className=\"property-list__value\">\n                <AttributedString\n                  parts={propertyListItem.get('value') || []}\n                  subPartDataAndHandlers={{\n                    onTimestampClick,\n                    shouldDisableActions,\n                  }}\n                />\n              </div>\n            </div>\n          ))}\n\n          <div className=\"property-list__property\" onClick={onEdit}>\n            :END:\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { Fragment, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText, timestampDuration } from '../../../../../../lib/timestamps';\n\nexport default ({ logBookEntries, onTimestampClick, shouldDisableActions }) => {\n  const [isDrawerCollapsed, setIsDrawerCollapsed] = useState(true);\n\n  const handleCollapseToggle = () => setIsDrawerCollapsed(!isDrawerCollapsed);\n\n  const onClick = (entryIndex, type) => () =>\n    shouldDisableActions ? void 0 : onTimestampClick(entryIndex, type);\n\n  return logBookEntries.size === 0 ? null : (\n    <div className=\"logbook-entries-container\">\n      <div className=\"logbook-entries__logbook\" onClick={handleCollapseToggle}>\n        :LOGBOOK:\n        {isDrawerCollapsed ? '...' : ''}\n      </div>\n      {!isDrawerCollapsed && (\n        <Fragment>\n          {logBookEntries.map((entry, index) =>\n            entry.get('raw') !== undefined ? (\n              <div className=\"logbook-entries__item-container\" key={entry.get('id')}>\n                {entry.get('raw') || ' '}\n              </div>\n            ) : (\n              <div className=\"logbook-entries__item-container\" key={entry.get('id')}>\n                <span className=\"logbook-entries__item-clock\">CLOCK:</span>\n                <span className=\"logbook-entries__item-start\" onClick={onClick(index, 'start')}>\n                  {renderAsText(entry.get('start'))}\n                </span>\n                {entry.get('end') === null ? (\n                  ''\n                ) : (\n                  <Fragment>\n                    --\n                    <span className=\"logbook-entries__item-end\" onClick={onClick(index, 'end')}>\n                      {renderAsText(entry.get('end'))}\n                    </span>\n                    <span className=\"logbook-entries__item-duration\">\n                      => {timestampDuration(entry.get('start'), entry.get('end'))}\n                    </span>\n                  </Fragment>\n                )}\n              </div>\n            )\n          )}\n          <div className=\"logbook-entries__logbook\">:END:</div>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport PlanningItems from './components/PlanningItems';\nimport PropertyListItems from './components/PropertyListItems';\nimport LogBookEntries from './components/LogBookEntries';\n\nimport _ from 'lodash';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\nimport { createRawDescriptionText } from '../../../../lib/export_org';\n\nimport AttributedString from '../AttributedString';\n\nclass HeaderContent extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleTextareaRef',\n      'handleDescriptionChange',\n      'handleTextareaBlur',\n      'handleTableCellSelect',\n      'handleExitTableEditMode',\n      'handleTableCellValueUpdate',\n      'handleEnterTableEditMode',\n      'handleAddNewTableRow',\n      'handleRemoveTableRow',\n      'handleAddNewTableColumn',\n      'handleRemoveTableColumn',\n      'handleCheckboxClick',\n      'handleTimestampClick',\n      'handleLogEntryTimestampClick',\n      'handleInsertTimestamp',\n      'handlePlanningItemTimestampClick',\n      'handlePropertyListEdit',\n    ]);\n\n    this.state = {\n      descriptionValue: this.calculateRawDescription(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.inEditMode && !this.props.inEditMode) {\n      this.props.org.updateHeaderDescription(header.get('id'), this.state.descriptionValue);\n    }\n\n    if (prevProps.header !== this.props.header) {\n      this.setState(\n        {\n          descriptionValue: this.calculateRawDescription(this.props.header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  calculateRawDescription(header) {\n    // This generates the text that appears in the description text field.\n    const dontIndent = this.props.dontIndent;\n    return createRawDescriptionText(header, false, dontIndent);\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  handleRef(div) {\n    this.containerDiv = div;\n  }\n\n  handleDescriptionChange(event) {\n    this.setState({ descriptionValue: event.target.value });\n  }\n\n  // Exits from edit mode if a 'blur' happens. One exception: If an\n  // 'insert timestamp' event happened before, this actually also\n  // triggered a 'blur'. Since the 'blur' and 'click' events are\n  // non-deterministic in their order, the only option to prevent the\n  // blur is to mark it as 'should be ignored' in the 'click' event.\n  // However, sufficient time needs to pass for this workaround to be\n  // consistent. Hence, the functionality is wrapped in a setTimeout.\n  // Original workaround taken from an old blog post:\n  // https://medium.com/@jessebeach/dealing-with-focus-and-blur-in-a-composite-widget-in-react-90d3c3b49a9b\n  // The same workaround is used in TitleLine/index.js\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.org.exitEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 200);\n  }\n\n  handleTableCellSelect(cellId) {\n    this.props.org.setSelectedTableCellId(cellId);\n  }\n\n  handleExitTableEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleTableCellValueUpdate(cellId, newValue) {\n    this.props.org.updateTableCellValue(cellId, newValue);\n  }\n\n  handleEnterTableEditMode() {\n    this.props.org.enterEditMode('table');\n  }\n\n  handleAddNewTableRow() {\n    this.props.org.addNewTableRow();\n  }\n\n  handleRemoveTableRow() {\n    this.props.org.removeTableRow();\n  }\n\n  handleAddNewTableColumn() {\n    this.props.org.addNewTableColumn();\n  }\n\n  handleRemoveTableColumn() {\n    this.props.org.removeTableColumn();\n  }\n\n  handleCheckboxClick(listItemId) {\n    this.props.org.advanceCheckboxState(listItemId);\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', {\n      timestampId,\n      headerId: this.props.header.get('id'),\n    });\n  }\n\n  handleLogEntryTimestampClick(headerId) {\n    return (logEntryIndex, entryType) =>\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId,\n        logEntryIndex,\n        entryType,\n      });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { descriptionValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      descriptionValue:\n        descriptionValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        descriptionValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n    this.textarea.focus();\n  }\n\n  handlePlanningItemTimestampClick(headerId) {\n    return (planningItemIndex) =>\n      this.props.base.activatePopup('timestamp-editor', { headerId, planningItemIndex });\n  }\n\n  handlePropertyListEdit() {\n    const { header } = this.props;\n    this.props.base.activatePopup('property-list-editor', { headerId: header.get('id') });\n  }\n\n  render() {\n    const {\n      header,\n      inEditMode,\n      selectedTableCellId,\n      inTableEditMode,\n      shouldDisableActions,\n    } = this.props;\n    const { containerWidth } = this.state;\n\n    if (!header.get('opened')) {\n      return <div />;\n    }\n\n    return (\n      <div\n        className=\"header-content-container nice-scroll\"\n        ref={this.handleRef}\n        style={{ width: containerWidth }}\n      >\n        {inEditMode ? (\n          <div className=\"header-content__edit-container\">\n            <textarea\n              autoFocus\n              className=\"textarea\"\n              rows=\"8\"\n              ref={this.handleTextareaRef}\n              value={this.state.descriptionValue}\n              onBlur={this.handleTextareaBlur}\n              onChange={this.handleDescriptionChange}\n            />\n            <div\n              className=\"header-content__insert-timestamp-button\"\n              onClick={this.handleInsertTimestamp}\n            >\n              <i className=\"fas fa-plus insert-timestamp-icon\" />\n              Insert timestamp\n            </div>\n          </div>\n        ) : (\n          <Fragment>\n            <PlanningItems\n              planningItems={header.get('planningItems')}\n              onClick={this.handlePlanningItemTimestampClick(header.get('id'))}\n            />\n            <PropertyListItems\n              propertyListItems={header.get('propertyListItems')}\n              onTimestampClick={this.handleTimestampClick}\n              shouldDisableActions={shouldDisableActions}\n              onEdit={this.handlePropertyListEdit}\n            />\n            <AttributedString\n              parts={header.get('logNotes')}\n              subPartDataAndHandlers={{\n                onTimestampClick: this.handleTimestampClick,\n                shouldDisableActions,\n              }}\n            />\n            <LogBookEntries\n              logBookEntries={header.get('logBookEntries')}\n              onTimestampClick={this.handleLogEntryTimestampClick(header.get('id'))}\n              shouldDisableActions={shouldDisableActions}\n            />\n            <AttributedString\n              parts={header.get('description')}\n              subPartDataAndHandlers={{\n                onTableCellSelect: this.handleTableCellSelect,\n                selectedTableCellId: selectedTableCellId,\n                inTableEditMode: inTableEditMode,\n                onExitTableEditMode: this.handleExitTableEditMode,\n                onTableCellValueUpdate: this.handleTableCellValueUpdate,\n                onEnterTableEditMode: this.handleEnterTableEditMode,\n                onAddNewTableRow: this.handleAddNewTableRow,\n                onRemoveTableRow: this.handleRemoveTableRow,\n                onAddNewTableColumn: this.handleAddNewTableColumn,\n                onRemoveTableColumn: this.handleRemoveTableColumn,\n                onCheckboxClick: this.handleCheckboxClick,\n                onTimestampClick: this.handleTimestampClick,\n                shouldDisableActions,\n              }}\n            />\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path]);\n  return {\n    inEditMode:\n      file.get('editMode') === 'description' &&\n      file.get('selectedHeaderId') === ownProps.header.get('id'),\n    isSelected: file.get('selectedHeaderId') === ownProps.header.get('id'),\n    selectedTableCellId: file.get('selectedTableCellId'),\n    inTableEditMode: file.get('editMode') === 'table',\n    dontIndent: state.base.get('shouldNotIndentOnExport'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderContent);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nexport default class HeaderActionDrawer extends PureComponent {\n  // A nasty hack required to get click handling to work properly in Firefox. No idea why its\n  // broken in the first place or why this fixes it.\n  iconWithFFClickCatcher({ className, onClick, title, testId = '' }) {\n    return (\n      <div\n        title={title}\n        onClick={onClick}\n        className=\"header-action-drawer__ff-click-catcher-container\"\n      >\n        <div className=\"header-action-drawer__ff-click-catcher\" />\n        <i className={className} data-testid={testId} />\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      onEnterTitleEditMode,\n      onEnterDescriptionEditMode,\n      onTagsClick,\n      onPropertiesClick,\n      isNarrowed,\n      onNarrow,\n      onWiden,\n      onAddNewHeader,\n      onDeadlineClick,\n      onClockInOutClick,\n      onScheduledClick,\n      hasActiveClock,\n      onShareHeader,\n      onRefileHeader,\n      onAddNote,\n    } = this.props;\n\n    return (\n      <div className=\"header-action-drawer-container\">\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-pencil-alt fa-lg',\n            onClick: onEnterTitleEditMode,\n            title: 'Edit header title',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-edit fa-lg',\n            onClick: onEnterDescriptionEditMode,\n            title: 'Edit header description',\n            testId: 'edit-header-title',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-tags fa-lg',\n            onClick: onTagsClick,\n            title: 'Modify tags',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-list fa-lg',\n            onClick: onPropertiesClick,\n            title: 'Modify properties',\n          })}\n\n          {isNarrowed\n            ? this.iconWithFFClickCatcher({\n                className: 'fas fa-expand fa-lg',\n                onClick: onWiden,\n                title: 'Widen (Cancelling the narrowing.)',\n              })\n            : this.iconWithFFClickCatcher({\n                className: 'fas fa-compress fa-lg',\n                onClick: onNarrow,\n                testId: 'header-action-narrow',\n                title:\n                  'Narrow to subtree (focusing in on some portion of the buffer, making the rest temporarily inaccessible.)',\n              })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-plus fa-lg',\n            onClick: onAddNewHeader,\n            testId: 'header-action-plus',\n            title: 'Create new header below',\n          })}\n        </div>\n\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-envelope fa-lg',\n            onClick: onShareHeader,\n            testId: 'share',\n            title: 'Share this header via email',\n          })}\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-calendar-check fa-lg',\n            onClick: onDeadlineClick,\n            title: 'Set deadline datetime',\n          })}\n          {this.iconWithFFClickCatcher({\n            className: 'far fa-calendar-check fa-lg',\n            onClick: onScheduledClick,\n            title: 'Set scheduled datetime',\n          })}\n          {hasActiveClock\n            ? this.iconWithFFClickCatcher({\n                className: 'fas fa-hourglass-end fa-lg',\n                onClick: onClockInOutClick,\n                testId: 'org-clock-out',\n                title: 'Clock out (Stop the clock)',\n              })\n            : this.iconWithFFClickCatcher({\n                className: 'fas fa-hourglass-start fa-lg',\n                onClick: onClockInOutClick,\n                testId: 'org-clock-in',\n                title: 'Clock in (Start the clock)',\n              })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-file-export fa-lg',\n            onClick: onRefileHeader,\n            testId: 'org-refile',\n            title: 'Refile this header to another header',\n          })}\n          {this.iconWithFFClickCatcher({\n            className: 'far fa-sticky-note fa-lg',\n            onClick: onAddNote,\n            title: 'Add a note',\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nimport TitleLine from '../TitleLine';\nimport HeaderContent from '../HeaderContent';\nimport HeaderActionDrawer from './components/HeaderActionDrawer';\n\nimport { headerWithId } from '../../../../lib/org_utils';\nimport { interpolateColors, rgbaObject, rgbaString, readRgbaVariable } from '../../../../lib/color';\nimport { getCurrentTimestamp, millisDuration } from '../../../../lib/timestamps';\nimport { Map } from 'immutable';\n\nclass Header extends PureComponent {\n  SWIPE_ACTION_ACTIVATION_DISTANCE = 80;\n  FREE_DRAG_ACTIVATION_DISTANCE = 10;\n\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleMouseDown',\n      'handleMouseMove',\n      'handleMouseUp',\n      'handleMouseOut',\n      'handleTouchMove',\n      'handleTouchStart',\n      'handleTouchEnd',\n      'handleTouchCancel',\n      'handleHeaderClick',\n      'handleEnterTitleEditMode',\n      'handleEnterDescriptionEditMode',\n      'handleShowTagsModal',\n      'handleShowPropertyListEditorModal',\n      'handleNarrow',\n      'handleWiden',\n      'handleAddNewHeader',\n      'handleRest',\n      'handleDeadlineClick',\n      'handleClockInOutClick',\n      'handleScheduledClick',\n      'handleShareHeaderClick',\n      'handleRefileHeaderRequest',\n      'handleAddNoteClick',\n    ]);\n\n    this.state = {\n      isDraggingFreely: false,\n      dragStartX: null,\n      dragStartY: null,\n      currentDragX: null,\n      containerWidth: null,\n      isPlayingRemoveAnimation: false,\n      heightBeforeRemove: null,\n      disabledBackgroundColor: readRgbaVariable('--base3'),\n    };\n  }\n\n  componentDidMount() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  handleRef(containerDiv) {\n    this.containerDiv = containerDiv;\n    this.props.onRef(containerDiv);\n  }\n\n  handleDragStart(event, dragX, dragY) {\n    if (this.props.shouldDisableActions) {\n      return;\n    }\n    if (this.props.inEditMode) {\n      return;\n    }\n\n    if (!!event.target.closest('.table-part')) {\n      return;\n    }\n\n    this.setState({\n      dragStartX: dragX,\n      dragStartY: dragY,\n    });\n  }\n\n  handleDragMove(dragX, dragY) {\n    const { dragStartX, dragStartY } = this.state;\n    if (dragStartX === null) {\n      return;\n    }\n\n    if (!this.state.isDraggingFreely) {\n      if (Math.abs(dragX - dragStartX) >= this.FREE_DRAG_ACTIVATION_DISTANCE) {\n        this.setState({ isDraggingFreely: true });\n      }\n    }\n\n    if (Math.abs(dragY - dragStartY) >= this.SWIPE_ACTION_ACTIVATION_DISTANCE / 2) {\n      this.setState({ dragStartX: null });\n    } else {\n      this.setState({ currentDragX: dragX });\n    }\n  }\n\n  handleDragEnd() {\n    const { dragStartX, currentDragX } = this.state;\n\n    if (!!dragStartX && !!currentDragX) {\n      const swipeDistance = currentDragX - dragStartX;\n\n      if (swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.props.org.advanceTodoState(\n          this.props.header.get('id'),\n          this.props.shouldLogIntoDrawer\n        );\n      }\n\n      if (-1 * swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.setState({\n          isPlayingRemoveAnimation: true,\n          heightBeforeRemove: this.containerDiv.offsetHeight,\n        });\n      }\n    }\n\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleDragCancel() {\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleMouseDown(event) {\n    this.handleDragStart(event, event.clientX, event.clientY);\n  }\n\n  handleMouseMove(event) {\n    this.handleDragMove(event.clientX, event.clientY);\n  }\n\n  handleMouseUp() {\n    this.handleDragEnd();\n  }\n\n  handleMouseOut() {\n    this.handleDragCancel();\n  }\n\n  handleTouchStart(event) {\n    this.handleDragStart(event, event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  handleTouchMove(event) {\n    this.handleDragMove(event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  handleTouchEnd() {\n    this.handleDragEnd();\n  }\n\n  handleTouchCancel() {\n    this.handleDragCancel();\n  }\n\n  handleHeaderClick(event) {\n    const classList = event.target.classList;\n    if (classList.contains('header') || classList.contains('header__bullet')) {\n      const { header, hasContent, isSelected, closeSubheadersRecursively } = this.props;\n\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'), closeSubheadersRecursively);\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleEnterTitleEditMode() {\n    this.props.org.enterEditMode('title');\n  }\n\n  handleEnterDescriptionEditMode() {\n    this.props.org.openHeader(this.props.header.get('id'));\n    this.props.org.enterEditMode('description');\n  }\n\n  handleShowTagsModal() {\n    this.props.base.activatePopup('tags-editor');\n  }\n\n  handleShowPropertyListEditorModal() {\n    this.props.base.activatePopup('property-list-editor');\n  }\n\n  handleNarrow() {\n    this.props.org.narrowHeader(this.props.header.get('id'));\n  }\n\n  handleWiden() {\n    this.props.org.widenHeader();\n  }\n\n  handleAddNewHeader() {\n    this.props.org.addHeaderAndEdit(this.props.header.get('id'));\n  }\n\n  handleRest() {\n    if (this.state.isPlayingRemoveAnimation) {\n      this.props.org.removeHeader(this.props.header.get('id'));\n    }\n  }\n\n  handleDeadlineAndScheduledClick(planningType) {\n    const { header } = this.props;\n\n    const existingDeadlinePlanningItemIndex = header\n      .get('planningItems', [])\n      .findIndex((planningItem) => planningItem.get('type') === planningType);\n\n    if (existingDeadlinePlanningItemIndex === -1) {\n      this.props.org.addNewPlanningItem(header.get('id'), planningType);\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId: header.get('id'),\n        planningItemIndex: header.get('planningItems').size,\n      });\n    } else {\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId: header.get('id'),\n        planningItemIndex: existingDeadlinePlanningItemIndex,\n      });\n    }\n\n    this.props.org.openHeader(header.get('id'));\n  }\n\n  handleDeadlineClick() {\n    this.handleDeadlineAndScheduledClick('DEADLINE');\n  }\n\n  handleClockInOutClick() {\n    const { header } = this.props;\n    const logBook = header.get('logBookEntries', []);\n    const existingClockIndex = logBook.findIndex((entry) => entry.get('end') === null);\n    const now = getCurrentTimestamp({ isActive: false, withStartTime: true });\n    if (existingClockIndex !== -1) {\n      this.props.org.setLogEntryStop(\n        header.get('id'),\n        logBook.getIn([existingClockIndex, 'id']),\n        now\n      );\n    } else {\n      this.props.org.createLogEntryStart(header.get('id'), now);\n    }\n  }\n\n  handleScheduledClick() {\n    this.handleDeadlineAndScheduledClick('SCHEDULED');\n  }\n\n  handleShareHeaderClick() {\n    const { header } = this.props;\n\n    const titleLine = header.get('titleLine');\n    const todoKeyword = titleLine.get('todoKeyword');\n    const tags = titleLine.get('tags');\n    const title = titleLine.get('rawTitle').trim();\n    const subject = todoKeyword ? `${todoKeyword} ${title}` : title;\n    const body = `\n${tags.isEmpty() ? '' : `Tags: ${tags.join(' ')}\\n`}\n${header.get('rawDescription')}`;\n    //const titleParts = titleLine.get('title'); // List of parsed tokens in title\n    //const properties = header.get('propertyListItem'); //.get(0) .get('property') or .get('value')\n    //const planningItems = header.get('planningItems'); //.get(0) .get('type') [DEADLINE|SCHEDULED] or .get('timestamp')\n    const mailtoURI = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(\n      body\n    )}`;\n    // TODO: If available, use webshare\n    // Maybe there's synergy with this PR: https://github.com/200ok-ch/organice/pull/138/files\n\n    window.open(mailtoURI);\n    // INFO: Alternative implementation that works without having a\n    // popup window. We didn't go this route, because it's non-trivial\n    // to mock the window object, so it's harder to test. Having\n    // slightly worse UX in favor of having a test is not optimal, as\n    // well, of course.\n    // window.location.href = mailtoURI;\n  }\n\n  handleAddNoteClick() {\n    let input = prompt('Enter a note to add to the header:');\n    if (input !== null) input = input.trim();\n    if (!input) return;\n\n    this.props.org.addNote(input, new Date());\n  }\n\n  handlePopupClose() {\n    this.props.base.closePopup();\n  }\n\n  handleRefileHeaderRequest() {\n    this.props.base.activatePopup('refile');\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      isSelected,\n      bulletStyle,\n      narrowedHeader,\n      isNarrowed,\n      shouldDisableActions,\n      showClockDisplay,\n    } = this.props;\n    const indentLevel = !!narrowedHeader\n      ? header.get('nestingLevel') - narrowedHeader.get('nestingLevel') + 1\n      : header.get('nestingLevel');\n\n    const {\n      dragStartX,\n      currentDragX,\n      isDraggingFreely,\n      isPlayingRemoveAnimation,\n      containerWidth,\n    } = this.state;\n    const marginLeft =\n      !!dragStartX && !!currentDragX && isDraggingFreely\n        ? currentDragX - dragStartX\n        : isPlayingRemoveAnimation\n        ? spring(-1 * containerWidth, { stiffness: 300 })\n        : spring(0, { stiffness: 300 });\n\n    const style = {\n      paddingLeft: 20 * indentLevel,\n      marginLeft,\n      heightFactor: isPlayingRemoveAnimation ? spring(0, { stiffness: 300 }) : 1,\n    };\n\n    const className = classNames('header', {\n      'header--selected': isSelected,\n      'header--removing': isPlayingRemoveAnimation,\n    });\n\n    const logBookEntries = header\n      .get('logBookEntries')\n      .filter((entry) => entry.get('raw') === undefined);\n    const hasActiveClock =\n      logBookEntries.size !== 0 && logBookEntries.filter((entry) => !entry.get('end')).size !== 0;\n\n    return (\n      <Motion style={style} onRest={this.handleRest}>\n        {(interpolatedStyle) => {\n          const swipedDistance = interpolatedStyle.marginLeft;\n          const isLeftActionActivated = swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n          const isRightActionActivated =\n            -1 * swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n\n          const leftActivatedBackgroundColor = rgbaObject(0, 128, 0, 1);\n          const rightActivatedBackgroundColor = rgbaObject(255, 0, 0, 1);\n\n          const disabledIconColor = rgbaObject(0, 0, 0, 1);\n          const activatedIconColor = rgbaObject(255, 255, 255, 1);\n\n          const leftSwipeActionContainerStyle = {\n            width: interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isLeftActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n          const rightSwipeActionContainerStyle = {\n            width: -1 * interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isRightActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n\n          const { heightFactor, ...headerStyle } = interpolatedStyle;\n\n          if (isPlayingRemoveAnimation) {\n            headerStyle.height = this.state.heightBeforeRemove * heightFactor;\n          }\n\n          return (\n            <div\n              className={className}\n              style={headerStyle}\n              ref={this.handleRef}\n              onClick={this.handleHeaderClick}\n              onMouseDown={this.handleMouseDown}\n              onMouseMove={this.handleMouseMove}\n              onMouseUp={this.handleMouseUp}\n              onMouseOut={this.handleMouseOut}\n              onTouchStart={this.handleTouchStart}\n              onTouchMove={this.handleTouchMove}\n              onTouchEnd={this.handleTouchEnd}\n              onTouchCancel={this.handleTouchCancel}\n            >\n              <Motion style={leftSwipeActionContainerStyle}>\n                {(leftInterpolatedStyle) => {\n                  const leftStyle = {\n                    width: leftInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        this.state.disabledBackgroundColor,\n                        leftActivatedBackgroundColor,\n                        leftInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  const leftIconStyle = {\n                    display: swipedDistance > 30 ? '' : 'none',\n                    color: rgbaString(\n                      interpolateColors(\n                        disabledIconColor,\n                        activatedIconColor,\n                        leftInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"left-swipe-action-container\" style={leftStyle}>\n                      <i\n                        className=\"fas fa-check swipe-action-container__icon swipe-action-container__icon--left\"\n                        style={leftIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n              <Motion style={rightSwipeActionContainerStyle}>\n                {(rightInterpolatedStyle) => {\n                  const rightStyle = {\n                    width: rightInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        this.state.disabledBackgroundColor,\n                        rightActivatedBackgroundColor,\n                        rightInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  const rightIconStyle = {\n                    display: -1 * swipedDistance > 30 ? '' : 'none',\n                    color: rgbaString(\n                      interpolateColors(\n                        disabledIconColor,\n                        activatedIconColor,\n                        rightInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"right-swipe-action-container\" style={rightStyle}>\n                      <i\n                        className=\"fas fa-times swipe-action-container__icon swipe-action-container__icon--right\"\n                        style={rightIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n\n              <div style={{ marginLeft: -16, color }} className=\"header__bullet\">\n                {bulletStyle === 'Fancy' ? '●' : '*'}\n              </div>\n              <TitleLine\n                header={header}\n                color={color}\n                hasContent={hasContent}\n                isSelected={isSelected}\n                shouldDisableExplicitWidth={swipedDistance === 0}\n                shouldDisableActions={shouldDisableActions}\n                addition={\n                  showClockDisplay && header.get('totalTimeLoggedRecursive') !== 0\n                    ? millisDuration(header.get('totalTimeLoggedRecursive'))\n                    : ''\n                }\n              />\n\n              <Collapse\n                isOpened={isSelected && !shouldDisableActions}\n                springConfig={{ stiffness: 300 }}\n                style={{ marginRight: rightSwipeActionContainerStyle.width }}\n              >\n                <HeaderActionDrawer\n                  onEnterTitleEditMode={this.handleEnterTitleEditMode}\n                  onEnterDescriptionEditMode={this.handleEnterDescriptionEditMode}\n                  isNarrowed={isNarrowed}\n                  onTagsClick={this.handleShowTagsModal}\n                  onPropertiesClick={this.handleShowPropertyListEditorModal}\n                  onNarrow={this.handleNarrow}\n                  onWiden={this.handleWiden}\n                  onAddNewHeader={this.handleAddNewHeader}\n                  onDeadlineClick={this.handleDeadlineClick}\n                  onClockInOutClick={this.handleClockInOutClick}\n                  onScheduledClick={this.handleScheduledClick}\n                  hasActiveClock={hasActiveClock}\n                  onShareHeader={this.handleShareHeaderClick}\n                  onRefileHeader={this.handleRefileHeaderRequest}\n                  onAddNote={this.handleAddNoteClick}\n                />\n              </Collapse>\n\n              <HeaderContent header={header} shouldDisableActions={shouldDisableActions} />\n            </div>\n          );\n        }}\n      </Motion>\n    );\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  const narrowedHeader = !!file.get('narrowedHeaderId')\n    ? headerWithId(file.get('headers'), file.get('narrowedHeaderId'))\n    : null;\n\n  return {\n    bulletStyle: state.base.get('bulletStyle'),\n    shouldLogIntoDrawer: state.base.get('shouldLogIntoDrawer'),\n    closeSubheadersRecursively: state.base.get('closeSubheadersRecursively'),\n    narrowedHeader,\n    isNarrowed: !!narrowedHeader && narrowedHeader.get('id') === ownProps.header.get('id'),\n    inEditMode: !!file.get('editMode'),\n    showClockDisplay: state.org.present.get('showClockDisplay'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport './stylesheet.css';\n\nimport Header from '../Header';\n\nimport { numSubheadersOfHeaderWithId, hasHeaderContent } from '../../../../lib/org_utils';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { List, Map } from 'immutable';\n\nclass HeaderList extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.headerRefs = {};\n\n    _.bindAll(this, ['handleHeaderRef']);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.selectedHeaderId !== this.props.selectedHeaderId) {\n      const selectedHeaderDiv = this.headerRefs[this.props.selectedHeaderId];\n      if (!!selectedHeaderDiv) {\n        const boundingRectangle = selectedHeaderDiv.getBoundingClientRect();\n        const viewportHeight = document.documentElement.clientHeight;\n\n        if (boundingRectangle.top > viewportHeight * 0.9 || boundingRectangle.bottom < 0) {\n          selectedHeaderDiv.scrollIntoView();\n        }\n      }\n    }\n  }\n\n  handleHeaderRef(headerId) {\n    return (div) => (this.headerRefs[headerId] = div);\n  }\n\n  render() {\n    const { headers, selectedHeaderId, narrowedHeaderId, shouldDisableActions } = this.props;\n    const headerRenderData = headers\n      .map((header) => {\n        return {\n          header,\n          displayed: false,\n          hasContent: hasHeaderContent(header),\n        };\n      })\n      .toArray();\n\n    headerRenderData.forEach((headerRenderDatum, index) => {\n      const nestingLevel = headerRenderDatum.header.get('nestingLevel');\n\n      const hasNoParents = headerRenderData\n        .slice(0, index)\n        .every(\n          (previousRenderDatum) => previousRenderDatum.header.get('nestingLevel') >= nestingLevel\n        );\n      if (hasNoParents) {\n        headerRenderDatum.displayed = true;\n      }\n\n      const followingHeaders = headerRenderData.slice(index + 1);\n      for (\n        let followingHeaderIndex = 0;\n        followingHeaderIndex < followingHeaders.length;\n        ++followingHeaderIndex\n      ) {\n        const followingHeader = followingHeaders[followingHeaderIndex];\n        if (followingHeader.header.get('nestingLevel') <= nestingLevel) {\n          break;\n        }\n\n        headerRenderDatum.hasContent = true;\n\n        followingHeader.displayed =\n          headerRenderDatum.header.get('opened') && headerRenderDatum.displayed;\n      }\n    });\n\n    if (!!narrowedHeaderId) {\n      const narrowedHeaderIndex = headerRenderData.findIndex(\n        (headerRenderDatum) => headerRenderDatum.header.get('id') === narrowedHeaderId\n      );\n\n      const previousHeaders = headerRenderData.slice(0, narrowedHeaderIndex);\n      previousHeaders.forEach((headerRenderDatum) => (headerRenderDatum.displayed = false));\n\n      const numSubheaders = numSubheadersOfHeaderWithId(headers, narrowedHeaderId);\n      const followingHeaders = headerRenderData.slice(narrowedHeaderIndex + numSubheaders + 1);\n      followingHeaders.forEach((headerRenderDatum) => (headerRenderDatum.displayed = false));\n    }\n\n    const headerColors = [\n      'var(--blue)',\n      'var(--green)',\n      'var(--cyan)',\n      'var(--yellow)',\n      'var(--blue)',\n      'var(--green)',\n      'var(--cyan)',\n      'var(--yellow)',\n    ];\n\n    const displayedHeaderRenderData = headerRenderData.filter(\n      (headerRenderDatum) => headerRenderDatum.displayed\n    );\n\n    const className = classNames('header-list-container', {\n      'header-list-container--narrowed': !!narrowedHeaderId,\n    });\n    return (\n      <div className={className}>\n        {displayedHeaderRenderData.map((headerRenderDatum) => {\n          const header = headerRenderDatum.header;\n          const color = headerColors[(header.get('nestingLevel') - 1) % headerColors.length];\n\n          return (\n            <Header\n              key={header.get('id')}\n              header={header}\n              color={color}\n              hasContent={headerRenderDatum.hasContent}\n              isSelected={header.get('id') === selectedHeaderId}\n              onRef={this.handleHeaderRef(header.get('id'))}\n              shouldDisableActions={shouldDisableActions}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  return {\n    headers: file.get('headers', List()),\n    selectedHeaderId: file.get('selectedHeaderId'),\n    narrowedHeaderId: file.get('narrowedHeaderId'),\n  };\n};\n\nexport default connect(mapStateToProps)(HeaderList);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nexport default class ActionButton extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleClick']);\n  }\n\n  handleClick() {\n    const { onClick, isDisabled } = this.props;\n\n    if (isDisabled) {\n      return;\n    }\n\n    onClick();\n  }\n\n  render() {\n    const {\n      iconName,\n      subIconName,\n      isDisabled,\n      shouldRotateSubIcon,\n      letter,\n      additionalClassName,\n      style,\n      tooltip,\n      shouldSpinSubIcon,\n      onRef,\n    } = this.props;\n\n    const className = classNames(\n      'btn',\n      'btn--circle',\n      'action-drawer__btn',\n      additionalClassName || '',\n      {\n        fas: !letter,\n        'fa-lg': !letter,\n        [`fa-${iconName}`]: !letter,\n        'action-drawer__btn--with-sub-icon': !!subIconName,\n        'btn--disabled': isDisabled,\n        'action-drawer__btn--letter': !!letter,\n      }\n    );\n\n    const subIconClassName = classNames(\n      'fas',\n      'fa-xs',\n      `fa-${subIconName}`,\n      'action-drawer__btn__sub-icon',\n      {\n        'action-drawer__btn__sub-icon--rotated': shouldRotateSubIcon,\n        'fa-spin': shouldSpinSubIcon,\n      }\n    );\n\n    return (\n      <button\n        className={className}\n        onClick={this.handleClick}\n        style={style}\n        title={tooltip}\n        ref={onRef}\n      >\n        {!!letter && letter}\n        {!!subIconName && <i className={subIconClassName} />}\n      </button>\n    );\n  }\n}\n","import React, { Fragment, useState, useMemo, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nimport { List, Map } from 'immutable';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as captureActions from '../../../../actions/capture';\nimport * as baseActions from '../../../../actions/base';\n\nimport sampleCaptureTemplates from '../../../../lib/sample_capture_templates';\n\nimport ActionButton from './components/ActionButton/';\n\nconst ActionDrawer = ({\n  org,\n  selectedHeaderId,\n  base,\n  staticFile,\n  captureTemplates,\n  path,\n  selectedTableCellId,\n  inEditMode,\n  isLoading,\n  online,\n  shouldDisableSyncButtons,\n}) => {\n  const [isDisplayingArrowButtons, setIsDisplayingArrowButtons] = useState(false);\n  const [isDisplayingCaptureButtons, setIsDisplayingCaptureButtons] = useState(false);\n  const [isDisplayingSearchButtons, setIsDisplayingSearchButtons] = useState(false);\n\n  const mainArrowButton = useRef(null);\n\n  const mainArrowButtonBoundingRect = useMemo(\n    () => (!!mainArrowButton.current ? mainArrowButton.current.getBoundingClientRect() : null),\n    [mainArrowButton]\n  );\n\n  const handleUpClick = () =>\n    !!selectedHeaderId ? org.moveHeaderUp(selectedHeaderId) : org.moveTableRowUp();\n\n  const handleDownClick = () =>\n    !!selectedHeaderId ? org.moveHeaderDown(selectedHeaderId) : org.moveTableRowDown();\n\n  const handleLeftClick = () =>\n    !!selectedHeaderId ? org.moveHeaderLeft(selectedHeaderId) : org.moveTableColumnLeft();\n\n  const handleRightClick = () =>\n    !!selectedHeaderId ? org.moveHeaderRight(selectedHeaderId) : org.moveTableColumnRight();\n\n  const handleMoveSubtreeLeftClick = () => org.moveSubtreeLeft(selectedHeaderId);\n\n  const handleMoveSubtreeRightClick = () => org.moveSubtreeRight(selectedHeaderId);\n\n  const handleDoneClick = () => org.exitEditMode();\n\n  const handleCaptureButtonClick = (templateId) => () => {\n    setIsDisplayingCaptureButtons(false);\n    base.activatePopup('capture', { templateId });\n  };\n\n  const getSampleCaptureTemplates = () => sampleCaptureTemplates;\n\n  const getAvailableCaptureTemplates = () =>\n    staticFile === 'sample'\n      ? getSampleCaptureTemplates()\n      : captureTemplates.filter(\n          (template) =>\n            template.get('isAvailableInAllOrgFiles') ||\n            template\n              .get('orgFilesWhereAvailable')\n              .map((availablePath) =>\n                availablePath.trim().startsWith('/')\n                  ? availablePath.trim()\n                  : '/' + availablePath.trim()\n              )\n              .includes((path || '').trim())\n        );\n\n  const handleSync = () => org.sync({ forceAction: 'manual' });\n\n  const handleMainArrowButtonClick = () => setIsDisplayingArrowButtons(!isDisplayingArrowButtons);\n\n  const handleMainSearchButtonClick = () => {\n    setIsDisplayingSearchButtons(!isDisplayingSearchButtons);\n  };\n\n  const handleMainCaptureButtonClick = () => {\n    if (!isDisplayingCaptureButtons && getAvailableCaptureTemplates().size === 0) {\n      alert(\n        `You don't have any capture templates set up for this file! Add some in Settings > Capture Templates`\n      );\n      return;\n    }\n\n    setIsDisplayingCaptureButtons(!isDisplayingCaptureButtons);\n  };\n\n  const renderCaptureButtons = () => {\n    const availableCaptureTemplates = getAvailableCaptureTemplates();\n\n    const baseCaptureButtonStyle = {\n      position: 'absolute',\n      zIndex: 0,\n      left: 0,\n      opacity: isDisplayingArrowButtons || isDisplayingSearchButtons ? 0 : 1,\n    };\n    if (!isDisplayingCaptureButtons) {\n      baseCaptureButtonStyle.boxShadow = 'none';\n    }\n\n    const mainButtonStyle = {\n      opacity: isDisplayingArrowButtons || isDisplayingSearchButtons ? 0 : 1,\n      position: 'relative',\n      zIndex: 1,\n    };\n\n    const animatedStyle = {\n      bottom: spring(isDisplayingCaptureButtons ? 70 : 0, { stiffness: 300 }),\n    };\n\n    return (\n      <Motion style={animatedStyle}>\n        {(style) => (\n          <div className=\"action-drawer__capture-buttons-container\">\n            <ActionButton\n              iconName={isDisplayingCaptureButtons ? 'times' : 'plus'}\n              isDisabled={false}\n              onClick={handleMainCaptureButtonClick}\n              style={mainButtonStyle}\n              tooltip={\n                isDisplayingCaptureButtons ? 'Hide capture templates' : 'Show capture templates'\n              }\n            />\n\n            {availableCaptureTemplates.map((template, index) => (\n              <ActionButton\n                key={template.get('id')}\n                letter={template.get('letter')}\n                iconName={template.get('iconName')}\n                isDisabled={false}\n                onClick={handleCaptureButtonClick(template.get('id'))}\n                style={{ ...baseCaptureButtonStyle, bottom: style.bottom * (index + 1) }}\n                tooltip={`Activate \"${template.get('description')}\" capture template`}\n              />\n            ))}\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const renderSearchButtons = () => {\n    const baseSearchButtonStyle = {\n      position: 'absolute',\n      zIndex: 0,\n      left: 0,\n      opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1,\n    };\n    if (!isDisplayingSearchButtons) {\n      baseSearchButtonStyle.boxShadow = 'none';\n    }\n\n    const mainButtonStyle = {\n      opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1,\n      position: 'relative',\n      zIndex: 1,\n    };\n\n    const animatedStyle = {\n      bottom: spring(isDisplayingSearchButtons ? 70 : 0, { stiffness: 300 }),\n    };\n\n    return (\n      <Motion style={animatedStyle}>\n        {(style) => (\n          <div className=\"action-drawer__capture-buttons-container\">\n            <ActionButton\n              iconName={isDisplayingSearchButtons ? 'times' : 'search'}\n              isDisabled={false}\n              onClick={handleMainSearchButtonClick}\n              style={mainButtonStyle}\n              tooltip={\n                isDisplayingSearchButtons ? 'Hide Search / Task List' : 'Show Search / Task List'\n              }\n            />\n\n            <ActionButton\n              iconName=\"search\"\n              isDisabled={false}\n              onClick={handleSearchClick}\n              style={{ ...baseSearchButtonStyle, bottom: style.bottom * 1 }}\n              tooltip=\"Show search\"\n            />\n\n            <ActionButton\n              iconName=\"tasks\"\n              isDisabled={false}\n              onClick={handleTaskListClick}\n              style={{ ...baseSearchButtonStyle, bottom: style.bottom * 2 }}\n              tooltip=\"Show task list\"\n            />\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const renderMovementButtons = () => {\n    const baseArrowButtonStyle = {\n      opacity: isDisplayingCaptureButtons || isDisplayingSearchButtons ? 0 : 1,\n    };\n    if (!isDisplayingArrowButtons) {\n      baseArrowButtonStyle.boxShadow = 'none';\n    }\n\n    let centerXOffset = 0;\n    if (!!mainArrowButtonBoundingRect) {\n      centerXOffset =\n        window.screen.width / 2 -\n        (mainArrowButtonBoundingRect.x + mainArrowButtonBoundingRect.width / 2);\n    }\n\n    const animatedStyles = {\n      centerXOffset: spring(isDisplayingArrowButtons ? centerXOffset : 0, { stiffness: 300 }),\n      topRowYOffset: spring(isDisplayingArrowButtons ? 150 : 0, { stiffness: 300 }),\n      bottomRowYOffset: spring(isDisplayingArrowButtons ? 80 : 0, { stiffness: 300 }),\n      firstColumnXOffset: spring(isDisplayingArrowButtons ? 70 : 0, {\n        stiffness: 300,\n      }),\n      secondColumnXOffset: spring(isDisplayingArrowButtons ? 140 : 0, {\n        stiffness: 300,\n      }),\n    };\n\n    return (\n      <Motion style={animatedStyles}>\n        {(style) => (\n          <div\n            className=\"action-drawer__arrow-buttons-container\"\n            style={{ left: style.centerXOffset }}\n          >\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-up\"\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              isDisabled={false}\n              onClick={handleUpClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.topRowYOffset }}\n              tooltip={!!selectedTableCellId ? 'Move row up' : 'Move header up'}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-down\"\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              isDisabled={false}\n              onClick={handleDownClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.bottomRowYOffset }}\n              tooltip={!!selectedTableCellId ? 'Move row down' : 'Move header down'}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-left\"\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              isDisabled={false}\n              onClick={handleLeftClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                right: style.firstColumnXOffset,\n              }}\n              tooltip={!!selectedTableCellId ? 'Move column left' : 'Move header left'}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-right\"\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              isDisabled={false}\n              onClick={handleRightClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                left: style.firstColumnXOffset,\n              }}\n              tooltip={!!selectedTableCellId ? 'Move column right' : 'Move header right'}\n            />\n            {!selectedTableCellId && (\n              <Fragment>\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-left\"\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeLeftClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    right: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree left\"\n                />\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-right\"\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeRightClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    left: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree right\"\n                />\n              </Fragment>\n            )}\n\n            <ActionButton\n              iconName={isDisplayingArrowButtons ? 'times' : 'arrows-alt'}\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              additionalClassName=\"action-drawer__main-arrow-button\"\n              isDisabled={false}\n              onClick={handleMainArrowButtonClick}\n              style={{ opacity: isDisplayingCaptureButtons || isDisplayingSearchButtons ? 0 : 1 }}\n              tooltip={isDisplayingArrowButtons ? 'Hide movement buttons' : 'Show movement buttons'}\n              onRef={mainArrowButton}\n            />\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const handleAgendaClick = () => base.activatePopup('agenda');\n  const handleTaskListClick = () => {\n    setIsDisplayingSearchButtons(false);\n    base.activatePopup('task-list');\n  };\n  const handleSearchClick = () => {\n    setIsDisplayingSearchButtons(false);\n    base.activatePopup('search');\n  };\n\n  return (\n    <div className=\"action-drawer-container nice-scroll\">\n      {inEditMode ? (\n        <button className=\"btn action-drawer__done-btn\" onClick={handleDoneClick}>\n          Done\n        </button>\n      ) : (\n        <Fragment>\n          <ActionButton\n            iconName=\"cloud\"\n            subIconName=\"sync-alt\"\n            shouldSpinSubIcon={isLoading}\n            isDisabled={shouldDisableSyncButtons || !online}\n            onClick={handleSync}\n            style={{\n              opacity:\n                isDisplayingArrowButtons || isDisplayingCaptureButtons || isDisplayingSearchButtons\n                  ? 0\n                  : 1,\n            }}\n            tooltip=\"Sync changes\"\n          />\n\n          <ActionButton\n            iconName=\"calendar-alt\"\n            isDisabled={false}\n            onClick={handleAgendaClick}\n            style={{\n              opacity:\n                isDisplayingArrowButtons || isDisplayingCaptureButtons || isDisplayingSearchButtons\n                  ? 0\n                  : 1,\n            }}\n            tooltip=\"Show agenda\"\n          />\n\n          {renderMovementButtons()}\n\n          {renderSearchButtons()}\n          {renderCaptureButtons()}\n        </Fragment>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path], Map());\n  return {\n    inEditMode: !!file.get('editMode'),\n    selectedHeaderId: file.get('selectedHeaderId'),\n    isDirty: file.get('isDirty'),\n    isNarrowedHeaderActive: !!file.get('narrowedHeaderId'),\n    selectedTableCellId: file.get('selectedTableCellId'),\n    captureTemplates: state.capture.get('captureTemplates', List()),\n    path,\n    isLoading: !state.base.get('isLoading').isEmpty(),\n    online: state.base.get('online'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ActionDrawer);\n","import Bowser from 'bowser';\n\nconst browser = Bowser.getParser(window.navigator.userAgent);\n\n/** Is the browser Mobile Safari with iOS version of at least 13, but\nless than 13.3 */\nexport const isMobileSafari13 = (() => {\n  return (\n    browser.satisfies({\n      mobile: {\n        safari: '>=13',\n      },\n    }) &&\n    browser.satisfies({\n      mobile: {\n        safari: '<13.0.4',\n      },\n    })\n  );\n})();\n\n/** Is the OS iOS or Android? */\nexport const isMobileBrowser = (() => {\n  return browser.getPlatformType() !== 'desktop';\n})();\n\nexport const isIos = () => {\n  return browser.getOS().name === 'iOS';\n};\n\n/** Is iPhone Model X (tested with Xs) */\nexport const isIphoneX = window.matchMedia\n  ? window.matchMedia('(max-device-width: 812px) and (-webkit-device-pixel-ratio : 3)').matches\n  : false;\n\n/** Is iPhone Model 6, 7 or 8 (tested with 6s) */\nexport const isIphone678 = window.matchMedia\n  ? window.matchMedia('(min-device-width: 375px) and (-webkit-device-pixel-ratio : 2)').matches\n  : false;\n\n/** Is running in standalone mode (not in Mobile Safari) */\nexport const isRunningAsPWA = 'standalone' in window.navigator && window.navigator.standalone;\n\n/** Is running in Landscape Mode (as opposed to Portrait Mode) */\nexport function isInLandscapeMode() {\n  return [90, -90].includes(window.orientation);\n}\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ isEnabled, onToggle }) => {\n  const disabledColor = rgbaObject(255, 255, 255, 1);\n  const enabledColor = rgbaObject(238, 232, 213, 1);\n\n  const switchStyle = {\n    colorFactor: spring(isEnabled ? 1 : 0, { stiffness: 300 }),\n  };\n\n  const grabberStyle = {\n    marginLeft: spring(isEnabled ? 42 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={switchStyle}>\n      {(style) => {\n        const backgroundColor = rgbaString(\n          interpolateColors(disabledColor, enabledColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"switch\" style={{ backgroundColor }} onClick={onToggle}>\n            <Motion style={grabberStyle}>\n              {(style) => <div className=\"switch__grabber\" style={style} />}\n            </Motion>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { useState, useEffect, useLayoutEffect, useRef } from 'react';\n\nimport './stylesheet.css';\n\nimport { Motion, spring } from 'react-motion';\nimport classNames from 'classnames';\n\nexport default ({ children, shouldIncludeCloseButton, onClose, maxSize = false }) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [dragOffsetY, setDragOffsetY] = useState(null);\n\n  useLayoutEffect(() => {\n    setIsVisible(true);\n  }, []);\n\n  const initialClientY = useRef();\n  const innerContainer = useRef();\n\n  const innerContainerHeight = useRef();\n  useLayoutEffect(() => {\n    innerContainerHeight.current = innerContainer.current.offsetHeight;\n  });\n\n  const handleInnerContainerClick = (event) => event.stopPropagation();\n\n  const handleClose = () => setIsVisible(false);\n\n  const handleAnimationRest = () => (!isVisible && !!onClose ? onClose() : void 0);\n\n  const handleTouchStart = (event) => (initialClientY.current = event.targetTouches[0].clientY);\n\n  const handleTouchMove = (event) => {\n    if (event.target.classList.contains('drag-handle')) {\n      return;\n    }\n\n    const isScrollingDown = initialClientY.current > event.targetTouches[0].clientY;\n\n    if (\n      isScrollingDown &&\n      innerContainer.current.scrollHeight - innerContainer.current.scrollTop <=\n        innerContainer.current.clientHeight\n    ) {\n      event.preventDefault();\n    } else if (!isScrollingDown && innerContainer.current.scrollTop === 0) {\n      event.preventDefault();\n\n      setDragOffsetY(event.targetTouches[0].clientY - initialClientY.current);\n    }\n  };\n\n  useEffect(() => {\n    const endInnerContainerDrag = () => {\n      setIsVisible(dragOffsetY <= innerContainerHeight.current * 0.3);\n      setDragOffsetY(null);\n    };\n    const handleTouchEndOrCancel = () => endInnerContainerDrag();\n\n    if (!!innerContainer.current) {\n      // Super annoying logic for disabling scrolling of the body when a slide up is active.\n      // Briefly: if we're already at the top of our Drawer and trying to scroll up, disable\n      // scrolling. Likewise, if we're already at the bottom of our Drawer and trying to scroll\n      // down, disable scrolling.\n      innerContainer.current.addEventListener('touchstart', handleTouchStart);\n      innerContainer.current.addEventListener('touchmove', handleTouchMove);\n      innerContainer.current.addEventListener('touchend', handleTouchEndOrCancel);\n      innerContainer.current.addEventListener('touchcancel', handleTouchEndOrCancel);\n\n      // Tmp variable for cleanup. Otherwise the linter will complain\n      // that the `current` value will change. It suggested this tmp\n      // variable.\n      const innerContainerCurrent = innerContainer.current;\n\n      return () => {\n        innerContainerCurrent.removeEventListener('touchstart', handleTouchStart);\n        innerContainerCurrent.removeEventListener('touchmove', handleTouchMove);\n        innerContainerCurrent.removeEventListener('touchend', handleTouchEndOrCancel);\n        innerContainerCurrent.removeEventListener('touchcancel', handleTouchEndOrCancel);\n      };\n    } else {\n      return null;\n    }\n  }, [innerContainer, dragOffsetY]);\n\n  const outerClassName = classNames('drawer-outer-container', {\n    'drawer-outer-container--visible': isVisible,\n  });\n\n  const innerStyle = {\n    offsetY:\n      dragOffsetY ||\n      spring(isVisible ? 0 : innerContainerHeight.current || window.innerHeight, {\n        stiffness: 300,\n      }),\n  };\n\n  return (\n    <Motion style={innerStyle} onRest={handleAnimationRest}>\n      {(style) => {\n        const interpolatedStyle = {\n          transform: `translateY(${style.offsetY}px)`,\n        };\n\n        // For maximized drawers, there's different rules:\n        if (maxSize) {\n          interpolatedStyle.height = '92%';\n          interpolatedStyle.overflow = 'none';\n        }\n\n        return (\n          <div className={outerClassName} onClick={!!onClose ? handleClose : null}>\n            <div\n              onClick={handleInnerContainerClick}\n              className=\"drawer-inner-container nice-scroll\"\n              data-testid=\"drawer\"\n              ref={innerContainer}\n              style={interpolatedStyle}\n            >\n              <div className=\"drawer__grabber\" />\n\n              {shouldIncludeCloseButton && (\n                <button className=\"fas fa-times fa-lg drawer__close-button\" onClick={handleClose} />\n              )}\n\n              {children}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { Fragment, useState, useEffect, useRef, useMemo } from 'react';\nimport {\n  isMobileSafari13,\n  isRunningAsPWA,\n  isInLandscapeMode,\n  isIphoneX,\n  isIphone678,\n} from '../../../../lib/browser_utils';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../ActionDrawer/components/ActionButton/';\nimport Switch from '../../../UI/Switch/';\nimport Drawer from '../../../UI/Drawer/';\n\nimport { headerWithPath } from '../../../../lib/org_utils';\nimport substituteTemplateVariables from '../../../../lib/capture_template_substitution';\n\nexport default ({ template, onCapture, headers, onClose }) => {\n  const [substitutedTemplate, initialCursorIndex] = useMemo(\n    () => substituteTemplateVariables(template.get('template')),\n    [template]\n  );\n\n  const targetHeader = useMemo(\n    () =>\n      template.get('headerPaths').size === 0\n        ? 'FILE'\n        : headerWithPath(headers, template.get('headerPaths')),\n    [headers, template]\n  );\n\n  const [textareaValue, setTextareaValue] = useState(substitutedTemplate);\n  const [shouldPrepend, setShouldPrepend] = useState(template.get('shouldPrepend'));\n\n  /** INFO: Some versions of Mobile Safari do _not_ like it when the\n  focus is set without an explicit user interaction. This is the case\n  in organice, because the user interaction is on a button which in\n  turn opens a textarea which should have the focus. It will open the\n  software keyboard, but the capture template will stay on the bottom\n  of the view, so it will be hidden by the keyboard. The user would\n  have to manually scroll down. On iOS 12, it worked without this\n  workaround. Starting with iOS 13.3, the workaround isn't needed,\n  anymore. */\n  const getMinHeight = () => {\n    // Only Mobile Safari needs the shenannigans for moving the input\n    // above the software keyboard.\n    if (isMobileSafari13) {\n      if (isRunningAsPWA) {\n        if (isInLandscapeMode()) {\n          return '9em';\n        } else {\n          if (isIphoneX) {\n            return '23em';\n          } else if (isIphone678) {\n            return '19em';\n          }\n          // For unmeasured models, it's safest to stick with the\n          // default iOS behavior - even if the keyboard hides the\n          // input field it's better than if it's moved too far up.\n          else {\n            return 'auto';\n          }\n        }\n      }\n      // Portrait mode\n      else {\n        if (isInLandscapeMode()) {\n          return '9em';\n        } else {\n          if (isIphoneX) {\n            return '18em';\n          } else if (isIphone678) {\n            return '18em';\n          } else {\n            return 'auto';\n          }\n        }\n      }\n    } else {\n      return 'auto';\n    }\n  };\n\n  const textarea = useRef(null);\n\n  useEffect(() => {\n    if (textarea.current) {\n      textarea.current.focus();\n      // Set Cursor position to the %? part of the template.\n      textarea.current.setSelectionRange(initialCursorIndex, initialCursorIndex);\n    }\n  }, [textarea, initialCursorIndex]);\n\n  const handleCaptureClick = () => onCapture(template.get('id'), textareaValue, shouldPrepend);\n\n  const handleTextareaChange = (event) => setTextareaValue(event.target.value);\n\n  const handlePrependSwitchToggle = () => setShouldPrepend(!shouldPrepend);\n\n  return (\n    <Drawer onClose={onClose}>\n      <div className=\"capture-modal-header\">\n        <ActionButton\n          letter={template.get('letter')}\n          iconName={template.get('iconName')}\n          isDisabled={false}\n          onClick={() => {}}\n          style={{ marginRight: 20 }}\n        />\n\n        <span>{template.get('description')}</span>\n      </div>\n\n      <div className=\"capture-modal-header-path\">\n        {template\n          .get('headerPaths')\n          .map((hP) => substituteTemplateVariables(hP)[0])\n          .join(' > ')}\n      </div>\n\n      {targetHeader ? (\n        <Fragment>\n          <textarea\n            className=\"textarea capture-modal-textarea\"\n            rows=\"4\"\n            value={textareaValue}\n            onChange={handleTextareaChange}\n            autoFocus\n            ref={textarea}\n          />\n          <div className=\"capture-modal-button-container\">\n            <div className=\"capture-modal-prepend-container\">\n              <span className=\"capture-modal-prepend-label\">Prepend:</span>\n              <Switch isEnabled={shouldPrepend} onToggle={handlePrependSwitchToggle} />\n            </div>\n\n            <button className=\"btn capture-modal-button\" onClick={handleCaptureClick}>\n              Capture\n            </button>\n          </div>\n          {/* Add padding to move the above textarea above the fold.\n          More documentation, see getMinHeight(). */}\n          {isMobileSafari13 && <div style={{ minHeight: getMinHeight() }} />}\n        </Fragment>\n      ) : (\n        <div className=\"capture-modal-error-message\">\n          The specified header path doesn't exist in this org file!\n        </div>\n      )}\n\n      <br />\n    </Drawer>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer/';\n\nimport { customFormatDistanceToNow } from '../../../../lib/org_utils';\nimport format from 'date-fns/format';\n\nexport default ({ lastServerModifiedAt, lastSyncAt, path, onPull, onPush, onCancel }) => {\n  return (\n    <Drawer>\n      <h2 className=\"sync-confirmation-modal__header\">Sync conflict</h2>\n      Since you last pulled {path}, a newer version of the file has been pushed to the server. The\n      newer version is from:\n      <br />\n      &nbsp;\n      <br />\n      <div className=\"sync-confirmation-modal__last-sync-time\">\n        {format(lastServerModifiedAt, 'MMMM do, yyyy [at] h:mm:ss a')}\n        <br />({customFormatDistanceToNow(lastServerModifiedAt)})\n      </div>\n      <br />\n      &nbsp;\n      <br />\n      While your version is from:\n      <br />\n      &nbsp;\n      <br />\n      <div className=\"sync-confirmation-modal__last-sync-time\">\n        {format(lastSyncAt, 'MMMM do, yyyy [at] h:mm:ss a')}\n        <br />({customFormatDistanceToNow(lastSyncAt)})\n      </div>\n      <div className=\"sync-confirmation-modal__buttons-container\">\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPull}>\n          Pull latest version from server\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPush}>\n          Overwrite server version\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onCancel}>\n          Cancel sync\n        </button>\n      </div>\n      <br />\n    </Drawer>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer/';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class TagsEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRemoveTag', 'handleAddNewTag', 'handleTagChange']);\n\n    this.state = {\n      allTags: props.allTags,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevTags = prevProps.header.getIn(['titleLine', 'tags']);\n    const currentTags = this.props.header.getIn(['titleLine', 'tags']);\n    if (prevTags.size === currentTags.size - 1 && currentTags.last() === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handleTagChange(tagIndex) {\n    return (event) => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.set(tagIndex, event.target.value.replace(/(\\s+|:)/g, '')));\n    };\n  }\n\n  handleRemoveTag(tagIndex) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.delete(tagIndex));\n    };\n  }\n\n  handleAddNewTag() {\n    const tags = this.props.header.getIn(['titleLine', 'tags']);\n    this.props.onChange(tags.push(''));\n  }\n\n  handleExistingTagClick(newTag) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      if (tags.includes(newTag)) {\n        this.props.onChange(tags.filter((tag) => tag !== newTag));\n      } else {\n        this.props.onChange(tags.push(newTag));\n      }\n    };\n  }\n\n  render() {\n    const { header, onClose } = this.props;\n    const { allTags } = this.state;\n\n    const headerTags = header.getIn(['titleLine', 'tags']);\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"drawer-modal__title\">Edit tags</h2>\n\n        <datalist id=\"drawer-modal__datalist-tag-names\">\n          {allTags.map((tagName, idx) => (\n            <option key={idx} value={tagName} />\n          ))}\n        </datalist>\n\n        {headerTags.size === 0 ? (\n          <div className=\"no-tags-message\">\n            This header doesn't have any tags.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one, or choose from the list\n            of all of your tags below.\n          </div>\n        ) : (\n          <Droppable droppableId=\"tags-editor-droppable\" type=\"TAG\">\n            {(provided, _snapshot) => (\n              <div className=\"tags-container\" ref={provided.innerRef} {...provided.droppableProps}>\n                <Fragment>\n                  {headerTags.map((tag, index) => (\n                    <Draggable draggableId={`tag--${index}`} index={index} key={index}>\n                      {(provided, snapshot) => (\n                        <div\n                          className={classNames('tag-container', {\n                            'tag-container--dragging': snapshot.isDragging,\n                          })}\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                        >\n                          <input\n                            type=\"text\"\n                            className=\"textfield tag-container__textfield\"\n                            value={tag}\n                            onChange={this.handleTagChange(index)}\n                            ref={(textfield) => (this.lastTextfield = textfield)}\n                            list=\"drawer-modal__datalist-tag-names\"\n                          />\n                          <div className=\"tag-container__actions-container\">\n                            <i\n                              className=\"fas fa-times fa-lg\"\n                              onClick={this.handleRemoveTag(index)}\n                            />\n                            <i\n                              className=\"fas fa-bars fa-lg tag-container__drag-handle drag-handle\"\n                              {...provided.dragHandleProps}\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"tags-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewTag} />\n        </div>\n\n        <hr className=\"tags-editor__separator\" />\n\n        <h2 className=\"tags-editor__title\">All tags</h2>\n\n        <div className=\"all-tags-container\">\n          {allTags\n            .filter((tag) => !!tag)\n            .map((tag) => {\n              const className = classNames('all-tags__tag', {\n                'all-tags__tag--in-use': headerTags.includes(tag),\n              });\n\n              return (\n                <div className={className} key={tag} onClick={this.handleExistingTagClick(tag)}>\n                  {tag}\n                </div>\n              );\n            })}\n        </div>\n      </Drawer>\n    );\n  }\n}\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nexport default ({ buttons, titles, values, selectedButton, useEqualWidthTabs, onSelect }) => {\n  const handleButtonClick = (buttonName) => () => onSelect(buttonName);\n\n  const containerClassName = classNames('tab-buttons', {\n    'tab-buttons--equal-width-tabs': useEqualWidthTabs,\n  });\n\n  const style = {\n    gridTemplateColumns: useEqualWidthTabs ? `repeat(${buttons.length}, 1fr)` : null,\n  };\n\n  return (\n    <div className={containerClassName} style={style}>\n      {buttons.map((buttonName, index) => {\n        const value = values ? values[index] : buttonName;\n        const className = classNames('tab-buttons__btn', {\n          'tab-buttons__btn--selected': value === selectedButton,\n        });\n        // Optionally add a title\n        let title = '';\n        if (titles) {\n          title = titles[index];\n        }\n\n        return (\n          <div\n            key={buttonName + index}\n            title={title}\n            className={className}\n            onClick={handleButtonClick(value)}\n          >\n            {buttonName}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport Switch from '../../../../../UI/Switch/';\nimport TabButtons from '../../../../../UI/TabButtons/';\n\nimport * as orgActions from '../../../../../../actions/org';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport { parseISO } from 'date-fns';\nimport format from 'date-fns/format';\n\nclass TimestampEditor extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleActiveToggle',\n      'handleDateChange',\n      'handleAddRepeater',\n      'handleRemoveRepeater',\n      'handleRepeaterTypeChange',\n      'handleRepeaterValueChange',\n      'handleRepeaterUnitChange',\n      'handleAddDelay',\n      'handleRemoveDelay',\n      'handleDelayTypeChange',\n      'handleDelayValueChange',\n      'handleDelayUnitChange',\n    ]);\n  }\n\n  handleActiveToggle() {\n    this.props.onChange(this.props.timestamp.update('isActive', (isActive) => !isActive));\n  }\n\n  handleDateChange(event, planningItemIndex, timestampId) {\n    // The user deleted the timestamp\n    if (_.isEmpty(event.target.value)) {\n      // It's a planning item and the parser knows which one.\n      if (_.isNumber(planningItemIndex)) {\n        this.props.org.removePlanningItem(this.props.headerId, planningItemIndex);\n      } else if (_.isNumber(timestampId)) {\n        this.props.org.removeTimestamp(this.props.headerId, timestampId);\n      }\n      this.props.onClose();\n    } else {\n      const { onChange, timestamp } = this.props;\n\n      const [newYear, newMonth, newDay, newDayName] = format(\n        parseISO(event.target.value),\n        'yyyy MM dd eee'\n      ).split(' ');\n      onChange(\n        timestamp\n          .set('year', newYear)\n          .set('month', newMonth)\n          .set('day', newDay)\n          .set('dayName', newDayName)\n      );\n    }\n  }\n\n  handleAddTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      const [hour, minute] = format(new Date(), 'HH:mm').split(':');\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleRemoveTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      onChange(timestamp.set(hourKey, null).set(minuteKey, null));\n    };\n  }\n\n  handleTimeChange(startOrEnd) {\n    return (event) => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      let [hour, minute] = event.target.value.split(':');\n      hour = hour.startsWith('0') ? hour.substring(1) : hour;\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleAddRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', '+').set('repeaterValue', 1).set('repeaterUnit', 'h'));\n  }\n\n  handleRemoveRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(\n      timestamp.set('repeaterType', null).set('repeaterValue', null).set('repeaterUnit', null)\n    );\n  }\n\n  handleRepeaterTypeChange(newRepeaterType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', newRepeaterType));\n  }\n\n  handleRepeaterValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterValue', event.target.value));\n  }\n\n  handleRepeaterUnitChange(newRepeaterUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterUnit', newRepeaterUnit));\n  }\n\n  handleAddDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', '-').set('delayValue', 1).set('delayUnit', 'h'));\n  }\n\n  handleRemoveDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', null).set('delayValue', null).set('delayUnit', null));\n  }\n\n  handleDelayTypeChange(newDelayType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', newDelayType));\n  }\n\n  handleDelayValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayValue', event.target.value));\n  }\n\n  handleDelayUnitChange(newDelayUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayUnit', newDelayUnit));\n  }\n\n  renderTimeField(label, timeKey, hour, minute, showRemoveButton = true) {\n    return (\n      <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n        <div className=\"timestamp-editor__field-title\">{label}</div>\n        <div className=\"timestamp-editor__field\">\n          {!!hour ? (\n            <Fragment>\n              <input\n                type=\"time\"\n                className=\"timestamp-editor__time-input\"\n                value={`${hour.padStart(2, '0')}:${minute.padStart(2, '0')}`}\n                onChange={this.handleTimeChange(timeKey)}\n              />\n              {showRemoveButton && (\n                <i\n                  className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                  onClick={this.handleRemoveTime(timeKey)}\n                />\n              )}\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddTime(timeKey)}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderRepeater() {\n    const { repeaterType, repeaterValue, repeaterUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Repeater</div>\n        <div className=\"timestamp-editor__field timestamp-editor__field--delay-repeater\">\n          {!!repeaterType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['+', '++', '.+']}\n                  titles={[\n                    'Shift exactly the amount of time in the repeater (i.e. one month for +1m).',\n                    'Shift the date by as many intervals of the amount of time in the repeater (i.e. one or many months for for ++1m) as it takes to get this date into the future.',\n                    'Shift the date exactly the amount of time of the repeater relative to the time of the state change.',\n                  ]}\n                  selectedButton={repeaterType || '+'}\n                  onSelect={this.handleRepeaterTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={repeaterValue || 1}\n                onChange={this.handleRepeaterValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={['h', 'd', 'w', 'm', 'y']}\n                  titles={['hours', 'days', 'weeks', 'months', 'years']}\n                  selectedButton={repeaterUnit || 'h'}\n                  onSelect={this.handleRepeaterUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveRepeater}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddRepeater}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderDelay() {\n    const { delayType, delayValue, delayUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Delay</div>\n        <div className=\"timestamp-editor__field\">\n          {!!delayType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['-', '--']}\n                  titles={[\n                    'Set a different lead time before the entry is put into the agenda.',\n                    \"In case the task contains a repeater, the delay is considered to affect all occurrences; if you want the delay to only affect the first scheduled occurrence of the task, use '--' instead.\",\n                  ]}\n                  selectedButton={delayType || '-'}\n                  onSelect={this.handleDelayTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={delayValue || 1}\n                onChange={this.handleDelayValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={['h', 'd', 'w', 'm', 'y']}\n                  titles={['hours', 'days', 'weeks', 'months', 'years']}\n                  selectedButton={delayUnit || 'h'}\n                  onSelect={this.handleDelayUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveDelay}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddDelay}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const { timestamp, timestampId, planningItemIndex } = this.props;\n    const {\n      isActive,\n      year,\n      month,\n      day,\n      startHour,\n      startMinute,\n      endHour,\n      endMinute,\n    } = timestamp.toJS();\n    return (\n      <div>\n        <div className=\"timestamp-editor__render\">{renderAsText(timestamp)}</div>\n\n        <div className=\"timestamp-editor__date-time-fields-container\">\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Active</div>\n            <div className=\"timestamp-editor__field\">\n              <Switch isEnabled={isActive} onToggle={this.handleActiveToggle} />\n            </div>\n          </div>\n\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Date</div>\n            <div className=\"timestamp-editor__field\">\n              <input\n                data-testid=\"timestamp-selector\"\n                type=\"date\"\n                className=\"timestamp-editor__date-input\"\n                onChange={(event) => this.handleDateChange(event, planningItemIndex, timestampId)}\n                // Needed for iOS due to React bug\n                // https://github.com/facebook/react/issues/8938#issuecomment-519074141\n                onFocus={(event) => (event.nativeEvent.target.defaultValue = '')}\n                value={`${year}-${month}-${day}`}\n              />\n            </div>\n          </div>\n\n          {this.renderTimeField('Start time', 'start', startHour, startMinute, !endHour)}\n          {!!startHour && this.renderTimeField('End time', 'end', endHour, endMinute)}\n        </div>\n\n        {this.renderRepeater()}\n        {this.renderDelay()}\n      </div>\n    );\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(null, mapDispatchToProps)(TimestampEditor);\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TimestampEditor from './components/TimestampEditor';\nimport Drawer from '../../../UI/Drawer/';\n\nimport _ from 'lodash';\nimport format from 'date-fns/format';\nimport { Map } from 'immutable';\n\nexport default class TimestampEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddEndTimestamp', 'handleRemoveEndTimestamp']);\n  }\n\n  handleChange(key) {\n    return (newTimestamp) => this.props.onChange(this.props.timestamp.set(key, newTimestamp));\n  }\n\n  handleAddEndTimestamp() {\n    const { timestamp } = this.props;\n    const [year, month, day, dayName] = format(new Date(), 'yyyy MM dd eee').split(' ');\n    this.props.onChange(\n      timestamp.set(\n        'secondTimestamp',\n        Map({\n          year,\n          month,\n          day,\n          dayName,\n          isActive: timestamp.getIn(['firstTimestamp', 'isActive']),\n        })\n      )\n    );\n  }\n\n  handleRemoveEndTimestamp() {\n    this.props.onChange(this.props.timestamp.set('secondTimestamp', null));\n  }\n\n  render() {\n    const {\n      headerId,\n      timestamp,\n      timestampId,\n      onClose,\n      singleTimestampOnly,\n      planningItemIndex,\n    } = this.props;\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"timestamp-editor__title\">Edit timestamp</h2>\n\n        <TimestampEditor\n          headerId={headerId}\n          timestamp={timestamp.get('firstTimestamp')}\n          timestampId={timestampId}\n          planningItemIndex={planningItemIndex}\n          onClose={onClose}\n          onChange={this.handleChange('firstTimestamp')}\n        />\n\n        {!singleTimestampOnly &&\n          (!!timestamp.get('secondTimestamp') ? (\n            <Fragment>\n              <div className=\"timestamp-editor__separator\">\n                <div className=\"timestamp-editor__separator__margin-line\" />\n                to\n                <div className=\"timestamp-editor__separator__margin-line\" />\n              </div>\n\n              <TimestampEditor\n                headerId={headerId}\n                timestamp={timestamp.get('secondTimestamp')}\n                timestampId={timestampId}\n                onChange={this.handleChange('secondTimestamp')}\n              />\n\n              <div className=\"timestamp-editor__button-container\">\n                <button\n                  className=\"btn timestamp-editor__add-new-button\"\n                  onClick={this.handleRemoveEndTimestamp}\n                >\n                  Remove end timestamp\n                </button>\n              </div>\n            </Fragment>\n          ) : (\n            <div className=\"timestamp-editor__button-container\">\n              <button\n                className=\"btn timestamp-editor__add-new-button\"\n                onClick={this.handleAddEndTimestamp}\n              >\n                Add end timestamp\n              </button>\n            </div>\n          ))}\n\n        <br />\n      </Drawer>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer';\n\nimport { attributedStringToRawText } from '../../../../lib/export_org';\nimport generateId from '../../../../lib/id_generator';\nimport { parseMarkupAndCookies } from '../../../../lib/parse_org';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\nimport classNames from 'classnames';\nimport { fromJS } from 'immutable';\nimport _ from 'lodash';\nimport { computeAllPropertyNames, computeAllPropertyValuesFor } from '../../../../lib/org_utils';\n\nexport default class PropertyListEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddNewItem']);\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevItems = prevProps.propertyListItems;\n    const currentItems = this.props.propertyListItems;\n    if (prevItems.size === currentItems.size - 1 && currentItems.last().get('property') === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handlePropertyChange(propertyListItemId) {\n    return (event) => {\n      const propertyListItemIndex = this.props.propertyListItems.findIndex(\n        (propertyListItem) => propertyListItem.get('id') === propertyListItemId\n      );\n      this.props.onChange(\n        this.props.propertyListItems.setIn([propertyListItemIndex, 'property'], event.target.value)\n      );\n    };\n  }\n\n  handleValueChange(propertyListItemId) {\n    return (event) => {\n      const { propertyListItems, onChange } = this.props;\n\n      const propertyListItemIndex = propertyListItems.findIndex(\n        (propertyListItem) => propertyListItem.get('id') === propertyListItemId\n      );\n      onChange(\n        propertyListItems.setIn(\n          [propertyListItemIndex, 'value'],\n          fromJS(parseMarkupAndCookies(event.target.value))\n        )\n      );\n    };\n  }\n\n  handleRemoveItem(propertyListItemId) {\n    return () =>\n      this.props.onChange(\n        this.props.propertyListItems.filter(\n          (propertyListItem) => propertyListItem.get('id') !== propertyListItemId\n        )\n      );\n  }\n\n  handleAddNewItem() {\n    this.props.onChange(\n      this.props.propertyListItems.push(\n        fromJS({\n          property: '',\n          value: '',\n          id: generateId(),\n        })\n      )\n    );\n  }\n\n  render() {\n    const { onClose, propertyListItems, allOrgProperties } = this.props;\n    const allPropertyNames = computeAllPropertyNames(allOrgProperties);\n\n    const propertyListItemsWithAllPropVals = propertyListItems.map((p) => {\n      const propertyName = p.get('property');\n      const allPropertyValues = computeAllPropertyValuesFor(allOrgProperties, propertyName);\n      return [p, allPropertyValues];\n    });\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"drawer-modal__title\">Edit property list</h2>\n\n        <datalist id=\"drawer-modal__datalist-property-names\">\n          {allPropertyNames.map((propertyName, idx) => (\n            <option key={idx} value={propertyName} />\n          ))}\n        </datalist>\n\n        {propertyListItems.size === 0 ? (\n          <div className=\"no-items-message\">\n            There are no items in this property list.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one.\n          </div>\n        ) : (\n          <Droppable droppableId=\"property-list-editor-droppable\" type=\"PROPERTY-LIST\">\n            {(provided) => (\n              <div\n                className=\"property-list-editor__items-container\"\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n              >\n                <Fragment>\n                  {propertyListItemsWithAllPropVals.map(\n                    ([propertyListItem, allPropertyValues], index) => (\n                      <Draggable\n                        draggableId={`property-list-item--${index}`}\n                        index={index}\n                        key={propertyListItem.get('id')}\n                      >\n                        {(provided, snapshot) => (\n                          <div\n                            className={classNames('property-list-editor__item-container', {\n                              'property-list-editor__item-container--dragging': snapshot.isDragging,\n                            })}\n                            ref={provided.innerRef}\n                            {...provided.draggableProps}\n                          >\n                            <div className=\"item__textfields-container\">\n                              <input\n                                type=\"text\"\n                                className=\"textfield item-container__textfield\"\n                                value={propertyListItem.get('property')}\n                                onChange={this.handlePropertyChange(propertyListItem.get('id'))}\n                                ref={(textfield) => (this.lastTextfield = textfield)}\n                                list=\"drawer-modal__datalist-property-names\"\n                              />\n                              <input\n                                type=\"text\"\n                                className=\"textfield item-container__textfield\"\n                                value={attributedStringToRawText(propertyListItem.get('value'))}\n                                onChange={this.handleValueChange(propertyListItem.get('id'))}\n                                list={`drawer-modal__datalist-property-${index}-values`}\n                              />\n                              <datalist id={`drawer-modal__datalist-property-${index}-values`}>\n                                {allPropertyValues.map((propertyValue, idx) => (\n                                  <option key={idx} value={propertyValue} />\n                                ))}\n                              </datalist>\n                            </div>\n                            <div className=\"item-container__actions-container\">\n                              <i\n                                className=\"fas fa-times fa-lg\"\n                                onClick={this.handleRemoveItem(propertyListItem.get('id'))}\n                              />\n                              <i\n                                className=\"fas fa-bars fa-lg item-container__drag-handle drag-handle\"\n                                {...provided.dragHandleProps}\n                              />\n                            </div>\n                          </div>\n                        )}\n                      </Draggable>\n                    )\n                  )}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"property-list-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewItem} />\n        </div>\n      </Drawer>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nimport {\n  isTodoKeywordCompleted,\n  customFormatDistanceToNow,\n  getPlanningItemTypeText,\n} from '../../../../../../lib/org_utils';\nimport {\n  dateForTimestamp,\n  subtractTimestampUnitFromDate,\n  addTimestampUnitToDate,\n} from '../../../../../../lib/timestamps';\n\nimport {\n  format,\n  isToday,\n  startOfDay,\n  endOfDay,\n  isBefore,\n  isAfter,\n  isEqual,\n  isWithinInterval,\n  isPast,\n} from 'date-fns';\nimport classNames from 'classnames';\nimport { List } from 'immutable';\n\nexport default class AgendaDay extends PureComponent {\n  handleHeaderClick(path, headerId) {\n    return () => this.props.onHeaderClick(path, headerId);\n  }\n\n  render() {\n    const {\n      date,\n      files,\n      dateDisplayType,\n      onToggleDateDisplayType,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n    } = this.props;\n\n    const dateStart = startOfDay(date);\n    const dateEnd = endOfDay(date);\n\n    const planningItemsAndHeaders = this.getPlanningItemsAndHeaders({\n      files,\n      date,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n      dateStart,\n      dateEnd,\n    });\n\n    return (\n      <div className=\"agenda-day__container\">\n        <div className=\"agenda-day__title\">\n          {isToday(date) && <div className=\"agenda-day__today-indicator\" />}\n          <div className=\"agenda-day__title__day-name\">{format(date, 'eeee')}</div>\n          <div className=\"agenda-day__title__date\">{format(date, 'MMMM do, yyyy')}</div>\n        </div>\n\n        <div className=\"agenda-day__headers-container\">\n          <div>\n            {planningItemsAndHeaders.map(([planningItem, header]) => {\n              const planningItemDate = dateForTimestamp(planningItem.get('timestamp'));\n              const hasTodoKeyword = !!header.getIn(['titleLine', 'todoKeyword']);\n\n              const dateClassName = classNames('agenda-day__header-planning-date', {\n                'agenda-day__header-planning-date--overdue':\n                  hasTodoKeyword && isPast(planningItemDate),\n              });\n\n              return (\n                <div key={planningItem.get('id')} className=\"agenda-day__header-container\">\n                  <div className=\"agenda-day__header__planning-item-container\">\n                    <div className=\"agenda-day__header-planning-type\">\n                      {getPlanningItemTypeText(planningItem)}\n                    </div>\n                    <div className={dateClassName} onClick={onToggleDateDisplayType}>\n                      {dateDisplayType === 'absolute'\n                        ? format(planningItemDate, 'MM/dd')\n                        : customFormatDistanceToNow(planningItemDate)}\n\n                      {planningItem.getIn(['timestamp', 'startHour']) && (\n                        <Fragment>\n                          <br />\n                          {format(planningItemDate, 'h:mma')}\n                        </Fragment>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"agenda-day__header__header-container\">\n                    <TitleLine\n                      header={header}\n                      color=\"var(--base03)\"\n                      hasContent={false}\n                      isSelected={false}\n                      shouldDisableActions\n                      shouldDisableExplicitWidth\n                      onClick={this.handleHeaderClick(header.get('path'), header.get('id'))}\n                    />\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  getPlanningItemsAndHeaders({\n    files,\n    date,\n    agendaDefaultDeadlineDelayValue,\n    agendaDefaultDeadlineDelayUnit,\n    dateStart,\n    dateEnd,\n  }) {\n    const headers = List().concat(\n      ...files\n        .mapEntries(([path, file]) => [\n          path,\n          file.get('headers').map((header) => header.set('path', path)),\n        ])\n        .valueSeq()\n    );\n    const todoKeywordSets = files.map((file) => file.get('todoKeywordSets'));\n\n    return headers\n      .flatMap((header) => {\n        const planningItemsforDate = header.get('planningItems').filter((planningItem) => {\n          const timestamp = planningItem.get('timestamp');\n          if (!timestamp.get('isActive')) {\n            return false;\n          }\n          const planningItemDate = dateForTimestamp(timestamp);\n          const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n          const isCompletedTodo =\n            todoKeyword &&\n            isTodoKeywordCompleted(todoKeywordSets.get(header.get('path')), todoKeyword);\n          if (isCompletedTodo) {\n            return false;\n          }\n          switch (planningItem.get('type')) {\n            case 'DEADLINE':\n              if (isToday(date)) {\n                if (isBefore(planningItemDate, new Date())) {\n                  return true;\n                }\n                const [delayValue, delayUnit] = timestamp.get('delayType')\n                  ? [timestamp.get('delayValue'), timestamp.get('delayUnit')]\n                  : [agendaDefaultDeadlineDelayValue, agendaDefaultDeadlineDelayUnit];\n                const appearDate = subtractTimestampUnitFromDate(\n                  planningItemDate,\n                  delayValue,\n                  delayUnit\n                );\n                return isAfter(date, appearDate) || isEqual(date, appearDate);\n              } else {\n                return isWithinInterval(planningItemDate, { start: dateStart, end: dateEnd });\n              }\n            case 'SCHEDULED':\n              let appearDate = planningItemDate;\n              if (timestamp.get('delayType')) {\n                const hasBeenRepeated = header\n                  .get('propertyListItems')\n                  .some((propertyListItem) => propertyListItem.get('property') === 'LAST_REPEAT');\n                if (timestamp.get('delayType') === '--' && !hasBeenRepeated) {\n                  appearDate = addTimestampUnitToDate(\n                    planningItemDate,\n                    timestamp.get('delayValue'),\n                    timestamp.get('delayUnit')\n                  );\n                }\n              }\n              if (isToday(date) && isAfter(date, appearDate)) {\n                return true;\n              }\n              return isWithinInterval(appearDate, { start: dateStart, end: dateEnd });\n            default:\n              return isWithinInterval(planningItemDate, { start: dateStart, end: dateEnd });\n          }\n        });\n        return planningItemsforDate.map((planningItem) => [planningItem, header]);\n      })\n      .sortBy(([planningItem]) => {\n        const { startHour, startMinute, endHour, endMinute, month, day } = planningItem\n          .get('timestamp')\n          .toJS();\n        return [startHour ? 0 : 1, startHour, startMinute, endHour, endMinute, month, day];\n      });\n  }\n}\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport AgendaDay from './components/AgendaDay';\nimport Drawer from '../../../UI/Drawer';\nimport TabButtons from '../../../UI/TabButtons';\n\nimport { isMobileBrowser } from '../../../../lib/browser_utils';\nimport * as baseActions from '../../../../actions/base';\nimport * as orgActions from '../../../../actions/org';\nimport { determineIncludedFiles } from '../../../../reducers/org';\n\nimport _ from 'lodash';\nimport {\n  addDays,\n  addWeeks,\n  addMonths,\n  getDay,\n  subDays,\n  subWeeks,\n  subMonths,\n  startOfWeek,\n  startOfMonth,\n  getDaysInMonth,\n} from 'date-fns';\nimport format from 'date-fns/format';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction AgendaModal(props) {\n  const {\n    files,\n    onClose,\n    todoKeywordSets,\n    agendaTimeframe,\n    agendaDefaultDeadlineDelayValue,\n    agendaDefaultDeadlineDelayUnit,\n    agendaStartOnWeekday,\n  } = props;\n\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [dateDisplayType, setDateDisplayType] = useState('absolute');\n\n  const weekStartsOn = agendaStartOnWeekday < 0 ? getDay(selectedDate) : agendaStartOnWeekday;\n\n  function handleTimeframeTypeChange(agendaTimeframe) {\n    props.base.setAgendaTimeframe(agendaTimeframe);\n  }\n\n  function handleNextDateClick() {\n    switch (agendaTimeframe) {\n      case 'Day':\n        setSelectedDate(addDays(selectedDate, 1));\n        break;\n      case 'Week':\n        setSelectedDate(addWeeks(selectedDate, 1));\n        break;\n      case 'Month':\n        setSelectedDate(addMonths(selectedDate, 1));\n        break;\n      default:\n        return '';\n    }\n  }\n\n  function handleHeaderClick(path, headerId) {\n    props.onClose();\n    props.org.selectHeaderAndOpenParents(path, headerId);\n  }\n\n  function handlePreviousDateClick() {\n    switch (agendaTimeframe) {\n      case 'Day':\n        setSelectedDate(subDays(selectedDate, 1));\n        break;\n      case 'Week':\n        setSelectedDate(subWeeks(selectedDate, 1));\n        break;\n      case 'Month':\n        setSelectedDate(subMonths(selectedDate, 1));\n        break;\n      default:\n        return '';\n    }\n  }\n\n  function handleToggleDateDisplayType() {\n    setDateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function calculateTimeframeHeader() {\n    switch (agendaTimeframe) {\n      case 'Day':\n        return format(selectedDate, 'MMMM do');\n      case 'Week':\n        const weekStart = startOfWeek(selectedDate, { weekStartsOn });\n        const weekEnd = addWeeks(weekStart, 1);\n        return `${format(weekStart, 'MMM do')} - ${format(weekEnd, 'MMM do')} (W${format(\n          weekStart,\n          'w'\n        )})`;\n      case 'Month':\n        return format(selectedDate, 'MMMM');\n      default:\n        return '';\n    }\n  }\n\n  let dates = [];\n  switch (agendaTimeframe) {\n    case 'Day':\n      dates = [selectedDate];\n      break;\n    case 'Week':\n      const weekStart = startOfWeek(selectedDate, { weekStartsOn });\n      dates = _.range(7).map((daysAfter) => addDays(weekStart, daysAfter));\n      break;\n    case 'Month':\n      const monthStart = startOfMonth(selectedDate);\n      dates = _.range(getDaysInMonth(selectedDate)).map((daysAfter) =>\n        addDays(monthStart, daysAfter)\n      );\n      break;\n    default:\n  }\n\n  return (\n    <Drawer onClose={onClose} maxSize={true}>\n      <h2 className=\"agenda__title\">Agenda</h2>\n\n      <div className=\"agenda__tab-container\">\n        <TabButtons\n          buttons={['Day', 'Week', 'Month']}\n          selectedButton={agendaTimeframe}\n          onSelect={handleTimeframeTypeChange}\n          useEqualWidthTabs\n        />\n      </div>\n\n      <div className=\"agenda__timeframe-header-container\">\n        <i className=\"fas fa-chevron-left fa-lg\" onClick={handlePreviousDateClick} />\n        <div className=\"agenda__timeframe-header\">{calculateTimeframeHeader()}</div>\n        <i className=\"fas fa-chevron-right fa-lg\" onClick={handleNextDateClick} />\n      </div>\n\n      <div\n        className=\"agenda__days-container\"\n        style={isMobileBrowser ? undefined : { overflow: 'auto' }}\n      >\n        {dates.map((date) => (\n          <AgendaDay\n            key={format(date, 'yyyy MM dd')}\n            date={date}\n            files={files}\n            onHeaderClick={handleHeaderClick}\n            todoKeywordSets={todoKeywordSets}\n            dateDisplayType={dateDisplayType}\n            onToggleDateDisplayType={handleToggleDateDisplayType}\n            agendaDefaultDeadlineDelayValue={agendaDefaultDeadlineDelayValue}\n            agendaDefaultDeadlineDelayUnit={agendaDefaultDeadlineDelayUnit}\n          />\n        ))}\n      </div>\n\n      <br />\n    </Drawer>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  const path = state.org.present.get('path');\n  const file = state.org.present.getIn(['files', path]);\n  const allFiles = state.org.present.get('files');\n  const fileSettings = state.org.present.get('fileSettings');\n  const agendaStartOnWeekday = state.base.get('agendaStartOnWeekday');\n  return {\n    files: determineIncludedFiles(allFiles, fileSettings, path, 'includeInAgenda', false),\n    todoKeywordSets: file.get('todoKeywordSets'),\n    agendaTimeframe: state.base.get('agendaTimeframe'),\n    agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n    agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n    agendaStartOnWeekday: agendaStartOnWeekday == null ? 1 : +agendaStartOnWeekday,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AgendaModal);\n","import React, { Fragment, useEffect } from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\nimport { List, Map } from 'immutable';\n\nimport * as orgActions from '../../../../../../actions/org';\n\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nimport { dateForTimestamp } from '../../../../../../lib/timestamps';\nimport {\n  createIsTodoKeywordInDoneState,\n  getPlanningItemTypeText,\n  customFormatDistanceToNow,\n} from '../../../../../../lib/org_utils';\n\nimport { format, isPast } from 'date-fns';\nimport classNames from 'classnames';\n\nfunction TaskListView(props) {\n  function handleHeaderClick(path, headerId) {\n    return () => props.onHeaderClick(path, headerId);\n  }\n\n  const {\n    dateDisplayType,\n    onToggleDateDisplayType,\n    headersForFiles,\n    todoKeywordSetsForFiles,\n  } = props;\n\n  // Populate filteredHeaders\n  useEffect(() => {\n    props.org.setSearchFilterInformation('', 0, 'task-list');\n  }, [props.org]);\n\n  const planningItemsAndHeaders = getPlanningItemsAndHeaders({\n    headersForFiles,\n    todoKeywordSetsForFiles,\n  });\n\n  return (\n    <div className=\"agenda-day__container\">\n      <div className=\"agenda-day__headers-container\">\n        {planningItemsAndHeaders.map(([planningItem, header]) => {\n          const planningItemDate = planningItem\n            ? dateForTimestamp(planningItem.get('timestamp'))\n            : null;\n          const hasTodoKeyword = !!header.getIn(['titleLine', 'todoKeyword']);\n\n          const dateClassName = classNames('task-list__header-planning-date', {\n            'task-list__header-planning-date--overdue':\n              hasTodoKeyword && planningItem && isPast(planningItemDate),\n          });\n\n          let planningInformation = <div />;\n          if (planningItemDate) {\n            planningInformation = (\n              <div className=\"agenda-day__header__planning-item-container\">\n                <div className=\"task-list__header-planning-type\">\n                  {getPlanningItemTypeText(planningItem)}\n                </div>\n                <div className={dateClassName} onClick={onToggleDateDisplayType}>\n                  {dateDisplayType === 'absolute'\n                    ? format(planningItemDate, 'MM/dd')\n                    : customFormatDistanceToNow(planningItemDate)}\n\n                  {!!planningItem.getIn(['timestamp', 'startHour']) && (\n                    <Fragment>\n                      <br />\n                      {format(planningItemDate, 'h:mma')}\n                    </Fragment>\n                  )}\n                </div>\n              </div>\n            );\n          }\n          return (\n            <div key={header.get('id')} className=\"agenda-day__header-container\">\n              <div className=\"agenda-day__header__header-container\">\n                <TitleLine\n                  header={header}\n                  color=\"var(--base03)\"\n                  hasContent={false}\n                  isSelected={false}\n                  shouldDisableActions\n                  shouldDisableExplicitWidth\n                  onClick={handleHeaderClick(header.get('path'), header.get('id'))}\n                />\n                {planningInformation}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n\n  // Doing this on every render of the TaskListView is potentially\n  // inefficient and could be done in the reducer. However, doing it\n  // on every update of the headers state when not even looking at the\n  // Agenda is certainly more inefficient. Hence, we're doing it on\n  // every render.\n  function getPlanningItemsAndHeaders({ headersForFiles, todoKeywordSetsForFiles }) {\n    const headers = List().concat(\n      ...headersForFiles\n        .mapEntries(([path, headersOfFile]) => [\n          path,\n          headersOfFile.map((header) => header.set('path', path)),\n        ])\n        .valueSeq()\n    );\n    const isTodoKeywordInDoneState = todoKeywordSetsForFiles.map((todoKeywordSets) =>\n      createIsTodoKeywordInDoneState(todoKeywordSets)\n    );\n\n    return headers\n      .filter((header) => header.getIn(['titleLine', 'todoKeyword']))\n      .map((header) => {\n        const earliestPlanningItem = header\n          .get('planningItems')\n          .sortBy(getTimeFromPlanningItem)\n          .first();\n        return [earliestPlanningItem, header];\n      })\n      .sortBy(([planningItem, header]) => {\n        const doneState = isTodoKeywordInDoneState.get(header.get('path'))(\n          header.getIn(['titleLine', 'todoKeyword'])\n        );\n\n        const timeAsSortCriterion = planningItem\n          ? getTimeFromPlanningItem(planningItem)\n          : Number.MAX_SAFE_INTEGER; // Sort tasks without timestamp last\n        const title = header.getIn(['titleLine', 'rawTitle']);\n        return [doneState, timeAsSortCriterion, title];\n      });\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const files = state.org.present.get('files');\n  return {\n    // When no filtering has happened, yet (initial state), use all headers.\n    headersForFiles: state.org.present.getIn(['search', 'filteredHeaders']) || Map(),\n    todoKeywordSetsForFiles: files.map((file) => file.get('todoKeywordSets')),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nconst getTimeFromPlanningItem = (planningItem) =>\n  dateForTimestamp(planningItem.get('timestamp')).getTime();\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TaskListView);\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport TaskListView from './components/TaskListView';\nimport Drawer from '../../../UI/Drawer';\n\nimport { isMobileBrowser, isIos } from '../../../../lib/browser_utils';\n\nimport * as orgActions from '../../../../actions/org';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction TaskListModal(props) {\n  const [dateDisplayType, setdateDisplayType] = useState('absolute');\n\n  function handleHeaderClick(path, headerId) {\n    props.onClose();\n    props.org.selectHeaderAndOpenParents(path, headerId);\n  }\n\n  function handleToggleDateDisplayType() {\n    setdateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function handleFilterChange(event) {\n    props.org.setSearchFilterInformation(\n      event.target.value,\n      event.target.selectionStart,\n      'task-list'\n    );\n  }\n\n  const { onClose, searchFilter, searchFilterValid, searchFilterSuggestions } = props;\n\n  return (\n    <Drawer onClose={onClose} maxSize={true}>\n      <h2 className=\"agenda__title\">Task list</h2>\n\n      <datalist id=\"task-list__datalist-filter\">\n        {searchFilterSuggestions.map((string, idx) => (\n          <option key={idx} value={string} />\n        ))}\n      </datalist>\n\n      <div className=\"task-list__input-container\">\n        <input\n          type=\"text\"\n          value={searchFilter}\n          // Rationale: See SearchModal: index.js\n          autoFocus={!isIos()}\n          className={classNames('textfield', 'task-list__filter-input', {\n            'task-list__filter-input--invalid': !!searchFilter && !searchFilterValid,\n          })}\n          placeholder=\"e.g. -DONE doc|man :simple|easy :assignee:nobody|none\"\n          list=\"task-list__datalist-filter\"\n          onChange={handleFilterChange}\n        />\n      </div>\n\n      <div\n        className=\"task-list__headers-container\"\n        // On mobile devices, the Drawer already handles the touch\n        // event. Hence, scrolling within the Drawers container does\n        // not work with the same event. Therefore, we're just opting\n        // to scroll the whole drawer. That's not the best UX. And a\n        // better CSS juggler than me is welcome to improve on it.\n        style={isMobileBrowser ? undefined : { overflow: 'auto' }}\n      >\n        <TaskListView\n          onHeaderClick={handleHeaderClick}\n          dateDisplayType={dateDisplayType}\n          onToggleDateDisplayType={handleToggleDateDisplayType}\n        />\n      </div>\n\n      <br />\n    </Drawer>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  searchFilter: state.org.present.getIn(['search', 'searchFilter']) || '',\n  searchFilterValid: state.org.present.getIn(['search', 'searchFilterValid']),\n  searchFilterSuggestions: state.org.present.getIn(['search', 'searchFilterSuggestions']) || [],\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TaskListModal);\n","import React, { useEffect } from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport { Map } from 'immutable';\n\nimport * as orgActions from '../../../../../../actions/org';\nimport './stylesheet.css';\n\nimport { millisDuration } from '../../../../../../lib/timestamps';\n\nimport TitleLine from '../../../TitleLine';\nimport { getBreadcrumbsStringFunction } from '../../../../../../lib/org_utils';\n\nfunction HeaderListView(props) {\n  const { context } = props;\n  function handleHeaderClick(path, headerId) {\n    return () => props.onHeaderClick(path, headerId);\n  }\n\n  // Populate filteredHeaders\n  useEffect(() => {\n    // No specific searchFilter and cursorPosition, but set the\n    // context (like 'search' or 'refile')\n    props.org.setSearchFilterInformation('', 0, context);\n  }, [context, props.org]);\n\n  const { headers, allHeaders, showClockedTimes } = props;\n\n  return (\n    <div className=\"agenda-day__container\">\n      <div className=\"agenda-day__headers-container\">\n        {Array.from(headers.entries(), ([path, headersOfFile]) => {\n          const getBreadcrumbs = getBreadcrumbsStringFunction(allHeaders, path);\n          return headersOfFile.map((header) => {\n            return (\n              <div key={header.get('id')} className=\"agenda-day__header-container\">\n                <div className=\"search__breadcrumbs\">{getBreadcrumbs(header)}</div>\n                <div className=\"agenda-day__header__header-container\">\n                  <TitleLine\n                    header={header}\n                    color=\"var(--base03)\"\n                    hasContent={false}\n                    isSelected={false}\n                    shouldDisableActions\n                    shouldDisableExplicitWidth\n                    onClick={handleHeaderClick(path, header.get('id'))}\n                    addition={\n                      showClockedTimes && header.get('totalFilteredTimeLoggedRecursive') !== 0\n                        ? millisDuration(header.get('totalFilteredTimeLoggedRecursive'))\n                        : null\n                    }\n                  />\n                </div>\n              </div>\n            );\n          });\n        })}\n      </div>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  const files = state.org.present.get('files');\n  return {\n    allHeaders: files.map((file) => file.get('headers')),\n    headers: state.org.present.getIn(['search', 'filteredHeaders']) || Map(),\n    showClockedTimes: state.org.present.getIn(['search', 'showClockedTimes']),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderListView);\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { capitalize } from 'lodash';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport HeaderListView from './components/HeaderListView';\nimport Drawer from '../../../UI/Drawer';\n\nimport { isMobileBrowser, isIos } from '../../../../lib/browser_utils';\nimport { millisDuration } from '../../../../lib/timestamps';\n\nimport * as orgActions from '../../../../actions/org';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction SearchModal(props) {\n  const [dateDisplayType, setdateDisplayType] = useState('absolute');\n  const {\n    onClose,\n    searchFilter,\n    searchFilterValid,\n    searchFilterSuggestions,\n    context,\n    showClockedTimes,\n    clockedTime,\n  } = props;\n\n  function handleHeaderClick(path, headerId) {\n    props.onClose(path, headerId);\n  }\n\n  function handleToggleDateDisplayType() {\n    setdateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function handleFilterChange(event) {\n    props.org.setSearchFilterInformation(event.target.value, event.target.selectionStart, context);\n  }\n\n  return (\n    <Drawer onClose={onClose} maxSize={true}>\n      <div className=\"task-list__modal-title\">\n        <h2 className=\"agenda__title\">{capitalize(context)}</h2>\n        {showClockedTimes ? (\n          <span title=\"Sum of time logged on all search results directly (not including time logged on their children)\">\n            {millisDuration(clockedTime)}\n          </span>\n        ) : null}\n      </div>\n\n      <datalist id=\"task-list__datalist-filter\">\n        {searchFilterSuggestions.map((string, idx) => (\n          <option key={idx} value={string} />\n        ))}\n      </datalist>\n\n      <div className=\"task-list__input-container\">\n        <input\n          type=\"text\"\n          value={searchFilter}\n          // On iOS, setting autoFocus here will move the contents of\n          // the drawer off the screen, because the keyboard pops up\n          // late when the height is already set to '92%'. Some other\n          // complications: There's no API to check if the keyboard is\n          // open or not. When setting the height of the container to\n          // something like 48% for iOS, this works on iPhone (tested\n          // on Xs and 6S), but when the keyboard is closed, the\n          // container is still small when the user wants to read the\n          // longer list without the keyboard in the way. There might\n          // be a better way: If the drawer wouldn't move, iOS likely\n          // would set the heights correctly automatically.\n          autoFocus={!isIos()}\n          className={classNames('textfield', 'task-list__filter-input', {\n            'task-list__filter-input--invalid': !!searchFilter && !searchFilterValid,\n          })}\n          placeholder=\"e.g. -DONE doc|man :simple|easy :assignee:nobody|none\"\n          list=\"task-list__datalist-filter\"\n          onChange={handleFilterChange}\n        />\n      </div>\n\n      <div\n        className=\"task-list__headers-container\"\n        // On mobile devices, the Drawer already handles the touch\n        // event. Hence, scrolling within the Drawers container does\n        // not work with the same event. Therefore, we're just opting\n        // to scroll the whole drawer. That's not the best UX. And a\n        // better CSS juggler than me is welcome to improve on it.\n        style={isMobileBrowser ? undefined : { overflow: 'auto' }}\n      >\n        <HeaderListView\n          onHeaderClick={handleHeaderClick}\n          dateDisplayType={dateDisplayType}\n          onToggleDateDisplayType={handleToggleDateDisplayType}\n          context={context}\n        />\n      </div>\n\n      <br />\n    </Drawer>\n  );\n}\n\nconst mapStateToProps = (state) => ({\n  path: state.org.present.get('path'),\n  searchFilter: state.org.present.getIn(['search', 'searchFilter']) || '',\n  searchFilterValid: state.org.present.getIn(['search', 'searchFilterValid']),\n  searchFilterSuggestions: state.org.present.getIn(['search', 'searchFilterSuggestions']) || [],\n  showClockedTimes: state.org.present.getIn(['search', 'showClockedTimes']),\n  clockedTime: state.org.present.getIn(['search', 'clockedTime']),\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchModal);\n","const DEFAULT_BINDINGS = [\n  ['Select next header', 'selectNextVisibleHeader', 'ctrl+down'],\n  ['Select previous header', 'selectPreviousVisibleHeader', 'ctrl+up'],\n  ['Toggle header opened', 'toggleHeaderOpened', 'tab'],\n  ['Advance todo state', 'advanceTodo', 'alt+t'],\n  ['Edit title', 'editTitle', 'ctrl+h'],\n  ['Edit description', 'editDescription', 'ctrl+d'],\n  ['Exit edit mode', 'exitEditMode', 'alt+enter'],\n  ['Add header', 'addHeader', 'ctrl+enter'],\n  ['Remove header', 'removeHeader', 'backspace'],\n  ['Move header up', 'moveHeaderUp', 'alt+up'],\n  ['Move header down', 'moveHeaderDown', 'alt+down'],\n  ['Move header left', 'moveHeaderLeft', 'alt+shift+left'],\n  ['Move header right', 'moveHeaderRight', 'alt+shift+right'],\n  ['Undo', 'undo', 'ctrl+/'],\n];\n\nexport const calculateNamedKeybindings = (customKeybindings) =>\n  DEFAULT_BINDINGS.map(([bindingName, _bindingAction, binding]) => [\n    bindingName,\n    customKeybindings.get(bindingName, binding),\n  ]);\n\nexport const calculateActionedKeybindings = (customKeybindings) =>\n  DEFAULT_BINDINGS.map(([bindingName, bindingAction, binding]) => [\n    bindingAction,\n    customKeybindings.get(bindingName, binding),\n  ]);\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Redirect } from 'react-router-dom';\n\nimport { HotKeys } from 'react-hotkeys';\n\nimport './stylesheet.css';\n\nimport HeaderList from './components/HeaderList';\nimport ActionDrawer from './components/ActionDrawer';\nimport CaptureModal from './components/CaptureModal';\nimport SyncConfirmationModal from './components/SyncConfirmationModal';\nimport TagsEditorModal from './components/TagsEditorModal';\nimport TimestampEditorModal from './components/TimestampEditorModal';\nimport PropertyListEditorModal from './components/PropertyListEditorModal';\nimport AgendaModal from './components/AgendaModal';\nimport TaskListModal from './components/TaskListModal';\nimport SearchModal from './components/SearchModal';\nimport ExternalLink from '../UI/ExternalLink';\n\nimport * as baseActions from '../../actions/base';\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as orgActions from '../../actions/org';\nimport * as captureActions from '../../actions/capture';\nimport { ActionCreators as undoActions } from 'redux-undo';\n\nimport sampleCaptureTemplates from '../../lib/sample_capture_templates';\nimport { calculateActionedKeybindings } from '../../lib/keybindings';\nimport {\n  timestampWithId,\n  headerWithId,\n  extractAllOrgTags,\n  extractAllOrgProperties,\n  changelogHash,\n  STATIC_FILE_PREFIX,\n} from '../../lib/org_utils';\n\nimport _ from 'lodash';\nimport { fromJS, List, Map, Set } from 'immutable';\n\nclass OrgFile extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleSelectNextVisibleHeaderHotKey',\n      'handleSelectPreviousVisibleHeaderHotKey',\n      'handleToggleHeaderOpenedHotKey',\n      'handleAdvanceTodoHotKey',\n      'handleEditTitleHotKey',\n      'handleEditDescriptionHotKey',\n      'handleExitEditModeHotKey',\n      'handleAddHeaderHotKey',\n      'handleRemoveHeaderHotKey',\n      'handleMoveHeaderUpHotKey',\n      'handleMoveHeaderDownHotKey',\n      'handleMoveHeaderLeftHotKey',\n      'handleMoveHeaderRightHotKey',\n      'handleUndoHotKey',\n      'handleContainerRef',\n      'handleCapture',\n      'handlePopupClose',\n      'handleSearchPopupClose',\n      'handleRefilePopupClose',\n      'handleSyncConfirmationPull',\n      'handleSyncConfirmationPush',\n      'handleSyncConfirmationCancel',\n      'handleTagsChange',\n      'handlePropertyListItemsChange',\n    ]);\n\n    this.state = {\n      hasUncaughtError: false,\n    };\n  }\n\n  componentDidMount() {\n    const { staticFile, path } = this.props;\n\n    if (!!staticFile) {\n      this.props.org.setPath(STATIC_FILE_PREFIX + staticFile);\n      if (staticFile === 'changelog') {\n        this.props.base.setHasUnseenChangelog(false);\n        changelogHash().then((hash) => {\n          this.props.base.setLastSeenChangelogHeader(hash);\n        });\n      }\n\n      setTimeout(() => (document.querySelector('html').scrollTop = 0), 0);\n    } else if (!_.isEmpty(path)) {\n      if (this.props.fileIsLoaded(path)) {\n        this.props.org.sync({ path, shouldSuppressMessages: true });\n      } else {\n        this.props.syncBackend.downloadFile(path);\n      }\n      this.props.org.setPath(path);\n    }\n\n    this.activatePopup();\n  }\n\n  // If a fragment is set in the URL (by the activatePopup base\n  // action), activate the appropriate pop-up\n  activatePopup() {\n    const urlFragment = window.location.hash.substr(1);\n    if (!_.isEmpty(urlFragment)) {\n      this.props.base.activatePopup(urlFragment);\n    }\n  }\n\n  componentWillUnmount() {\n    const { staticFile } = this.props;\n\n    if (!!staticFile) {\n      this.props.base.unloadStaticFile();\n    } else {\n      this.props.org.resetFileDisplay();\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    const { headers, pendingCapture } = this.props;\n    if (!!pendingCapture && !!headers && headers.size > 0) {\n      this.props.org.insertPendingCapture();\n    }\n\n    const { path } = this.props;\n    if (!_.isEmpty(path) && path !== prevProps.path) {\n      this.props.syncBackend.downloadFile(path);\n      this.props.org.setPath(path);\n    }\n  }\n\n  componentDidCatch() {\n    // TODO: Track the `error` into a bug tracker\n    this.setState({ hasUncaughtError: true });\n  }\n\n  handleSelectNextVisibleHeaderHotKey() {\n    this.props.org.selectNextVisibleHeader();\n  }\n\n  handleSelectPreviousVisibleHeaderHotKey() {\n    this.props.org.selectPreviousVisibleHeader();\n  }\n\n  handleToggleHeaderOpenedHotKey() {\n    const { selectedHeaderId, closeSubheadersRecursively } = this.props;\n\n    if (selectedHeaderId) {\n      this.props.org.toggleHeaderOpened(selectedHeaderId, closeSubheadersRecursively);\n    }\n  }\n\n  handleAdvanceTodoHotKey() {\n    this.props.org.advanceTodoState(null, this.props.shouldLogIntoDrawer);\n  }\n\n  handleEditTitleHotKey() {\n    this.props.org.enterEditMode('title');\n  }\n\n  handleEditDescriptionHotKey() {\n    this.props.org.openHeader(this.props.selectedHeaderId);\n    this.props.org.enterEditMode('description');\n  }\n\n  handleExitEditModeHotKey() {\n    this.props.org.exitEditMode();\n    this.container.focus();\n  }\n\n  handleAddHeaderHotKey() {\n    this.props.org.addHeaderAndEdit(this.props.selectedHeaderId);\n  }\n\n  handleRemoveHeaderHotKey() {\n    const { selectedHeaderId } = this.props;\n\n    this.props.org.selectNextSiblingHeader(selectedHeaderId);\n    this.props.org.removeHeader(selectedHeaderId);\n  }\n\n  handleMoveHeaderUpHotKey() {\n    this.props.org.moveHeaderUp(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderDownHotKey() {\n    this.props.org.moveHeaderDown(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderLeftHotKey() {\n    this.props.org.moveHeaderLeft(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderRightHotKey() {\n    this.props.org.moveHeaderRight(this.props.selectedHeaderId);\n  }\n\n  handleUndoHotKey() {\n    this.props.undo.undo();\n  }\n\n  handleContainerRef(container) {\n    this.container = container;\n    if (this.container) {\n      this.container.focus();\n    }\n  }\n\n  handleCapture(templateId, content, shouldPrepend) {\n    this.props.org.insertCapture(templateId, content, shouldPrepend);\n  }\n\n  handlePopupClose() {\n    this.props.base.closePopup();\n  }\n\n  handleSearchPopupClose(path, headerId) {\n    this.props.base.closePopup();\n    if (path && headerId) {\n      this.props.org.selectHeaderAndOpenParents(path, headerId);\n    }\n  }\n\n  handleRefilePopupClose(targetPath, targetHeaderId) {\n    this.props.base.closePopup();\n    // When the user closes the drawer without selecting a header, do\n    // not trigger refiling.\n    if (targetHeaderId) {\n      const { loadedPath, selectedHeaderId } = this.props;\n      this.props.org.refileSubtree(loadedPath, selectedHeaderId, targetPath, targetHeaderId);\n    }\n  }\n\n  handleSyncConfirmationPull(path) {\n    this.props.org.sync({ path, forceAction: 'pull' });\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationPush(path) {\n    this.props.org.sync({ path, forceAction: 'push' });\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationCancel() {\n    this.props.base.closePopup();\n  }\n\n  handleTagsChange(newTags) {\n    this.props.org.setHeaderTags(this.props.selectedHeaderId, newTags);\n  }\n\n  handlePropertyListItemsChange(newPropertyListItems) {\n    this.props.org.updatePropertyListItems(this.props.selectedHeaderId, newPropertyListItems);\n  }\n\n  handleTimestampChange(popupData) {\n    if (!!popupData.get('timestampId')) {\n      return (newTimestamp) =>\n        this.props.org.updateTimestampWithId(popupData.get('timestampId'), newTimestamp);\n    } else if (popupData.get('logEntryIndex') !== undefined) {\n      return (newTimestamp) =>\n        this.props.org.updateLogEntryTime(\n          popupData.get('headerId'),\n          popupData.get('logEntryIndex'),\n          popupData.get('entryType'),\n          newTimestamp.get('firstTimestamp')\n        );\n    } else {\n      return (newTimestamp) =>\n        this.props.org.updatePlanningItemTimestamp(\n          popupData.get('headerId'),\n          popupData.get('planningItemIndex'),\n          newTimestamp.get('firstTimestamp')\n        );\n    }\n  }\n\n  renderActivePopup() {\n    const {\n      activePopupType,\n      activePopupData,\n      captureTemplates,\n      files,\n      headers,\n      selectedHeader,\n    } = this.props;\n\n    switch (activePopupType) {\n      case 'sync-confirmation':\n        return (\n          <SyncConfirmationModal\n            lastServerModifiedAt={activePopupData.get('lastServerModifiedAt')}\n            lastSyncAt={activePopupData.get('lastSyncAt')}\n            path={activePopupData.get('path')}\n            onPull={() => this.handleSyncConfirmationPull(activePopupData.get('path'))}\n            onPush={() => this.handleSyncConfirmationPush(activePopupData.get('path'))}\n            onCancel={this.handleSyncConfirmationCancel}\n          />\n        );\n      case 'capture':\n        const template = captureTemplates.find(\n          (template) => template.get('id') === activePopupData.get('templateId')\n        );\n        const path = template.get('file');\n        let headersOfCaptureTarget = headers;\n        if (path) {\n          const file = files.get(path);\n          headersOfCaptureTarget = file ? file.get('headers') : List();\n        }\n        return (\n          <CaptureModal\n            template={template}\n            headers={headersOfCaptureTarget}\n            onCapture={this.handleCapture}\n            onClose={this.handlePopupClose}\n          />\n        );\n      case 'tags-editor':\n        const allTags = extractAllOrgTags(headers);\n        return !!selectedHeader ? (\n          <TagsEditorModal\n            header={selectedHeader}\n            allTags={allTags}\n            onClose={this.handlePopupClose}\n            onChange={this.handleTagsChange}\n          />\n        ) : null;\n      case 'timestamp-editor':\n        let editingTimestamp = null;\n        if (activePopupData.get('timestampId')) {\n          editingTimestamp = timestampWithId(headers, activePopupData.get('timestampId'));\n        } else if (activePopupData.get('logEntryIndex') !== undefined) {\n          editingTimestamp = fromJS({\n            firstTimestamp: headerWithId(headers, activePopupData.get('headerId')).getIn([\n              'logBookEntries',\n              activePopupData.get('logEntryIndex'),\n              activePopupData.get('entryType'),\n            ]),\n          });\n        } else {\n          editingTimestamp = fromJS({\n            firstTimestamp: headerWithId(headers, activePopupData.get('headerId')).getIn([\n              'planningItems',\n              activePopupData.get('planningItemIndex'),\n              'timestamp',\n            ]),\n          });\n        }\n\n        return (\n          <TimestampEditorModal\n            headerId={activePopupData.get('headerId')}\n            timestamp={editingTimestamp}\n            timestampId={activePopupData.get('timestampId')}\n            planningItemIndex={activePopupData.get('planningItemIndex')}\n            singleTimestampOnly={!activePopupData.get('timestampId')}\n            onClose={this.handlePopupClose}\n            onChange={this.handleTimestampChange(activePopupData)}\n          />\n        );\n\n      case 'property-list-editor':\n        const allOrgProperties = extractAllOrgProperties(headers);\n        return selectedHeader ? (\n          <PropertyListEditorModal\n            onClose={this.handlePopupClose}\n            onChange={this.handlePropertyListItemsChange}\n            propertyListItems={selectedHeader.get('propertyListItems')}\n            allOrgProperties={allOrgProperties}\n          />\n        ) : null;\n      case 'agenda':\n        return <AgendaModal onClose={this.handlePopupClose} />;\n      case 'task-list':\n        return <TaskListModal onClose={this.handlePopupClose} />;\n      case 'search':\n        return <SearchModal onClose={this.handleSearchPopupClose} context=\"search\" />;\n      case 'refile':\n        return <SearchModal onClose={this.handleRefilePopupClose} context=\"refile\" />;\n      default:\n        return null;\n    }\n  }\n\n  render() {\n    const {\n      headers,\n      shouldDisableDirtyIndicator,\n      shouldDisableSyncButtons,\n      shouldDisableActions,\n      isDirty,\n      parsingErrorMessage,\n      path,\n      staticFile,\n      customKeybindings,\n      inEditMode,\n      orgFileErrorMessage,\n    } = this.props;\n\n    if (!path && !staticFile) {\n      return <Redirect to=\"/files\" />;\n    }\n\n    if (this.state.hasUncaughtError) {\n      return (\n        <div className=\"error-message-container\">\n          Uh oh, you ran into a bug!\n          <br />\n          <br />\n          This was probably the result of an error in attempting to parse your org file. It'd be\n          super helpful if you could{' '}\n          <ExternalLink href=\"https://github.com/200ok-ch/organice/issues/new\">\n            create an issue\n          </ExternalLink>{' '}\n          (and include the org file if possible!)\n        </div>\n      );\n    }\n\n    if (!!orgFileErrorMessage) {\n      return <div className=\"error-message-container\">{orgFileErrorMessage}</div>;\n    }\n\n    if (!headers) {\n      return <div />;\n    }\n\n    const keyMap = _.fromPairs(calculateActionedKeybindings(customKeybindings));\n\n    // Automatically call preventDefault on all the keyboard events that come through for\n    // these hotkeys.\n    const preventDefaultAndHandleEditMode = (callback, ignoreInEditMode = false) => (event) => {\n      if (ignoreInEditMode && inEditMode) {\n        return;\n      }\n\n      if (ignoreInEditMode && ['TEXTAREA', 'INPUT'].includes(document.activeElement.nodeName)) {\n        return;\n      }\n\n      event.preventDefault();\n      callback(event);\n    };\n\n    const handlers = {\n      selectNextVisibleHeader: preventDefaultAndHandleEditMode(\n        this.handleSelectNextVisibleHeaderHotKey\n      ),\n      selectPreviousVisibleHeader: preventDefaultAndHandleEditMode(\n        this.handleSelectPreviousVisibleHeaderHotKey\n      ),\n      toggleHeaderOpened: preventDefaultAndHandleEditMode(\n        this.handleToggleHeaderOpenedHotKey,\n        true\n      ),\n      advanceTodo: preventDefaultAndHandleEditMode(this.handleAdvanceTodoHotKey),\n      editTitle: preventDefaultAndHandleEditMode(this.handleEditTitleHotKey),\n      editDescription: preventDefaultAndHandleEditMode(this.handleEditDescriptionHotKey),\n      exitEditMode: preventDefaultAndHandleEditMode(this.handleExitEditModeHotKey),\n      addHeader: preventDefaultAndHandleEditMode(this.handleAddHeaderHotKey),\n      removeHeader: preventDefaultAndHandleEditMode(this.handleRemoveHeaderHotKey, true),\n      moveHeaderUp: preventDefaultAndHandleEditMode(this.handleMoveHeaderUpHotKey),\n      moveHeaderDown: preventDefaultAndHandleEditMode(this.handleMoveHeaderDownHotKey),\n      moveHeaderLeft: preventDefaultAndHandleEditMode(this.handleMoveHeaderLeftHotKey),\n      moveHeaderRight: preventDefaultAndHandleEditMode(this.handleMoveHeaderRightHotKey),\n      undo: preventDefaultAndHandleEditMode(this.handleUndoHotKey),\n    };\n\n    return (\n      <HotKeys keyMap={keyMap} handlers={handlers}>\n        <div className=\"org-file-container\" tabIndex=\"-1\" ref={this.handleContainerRef}>\n          {headers.size === 0 ? (\n            <div className=\"org-file__parsing-error-message\">\n              <h3>Couldn't parse file</h3>\n\n              {!!parsingErrorMessage ? (\n                <Fragment>{parsingErrorMessage}</Fragment>\n              ) : (\n                <Fragment>\n                  If you think this is a bug, please{' '}\n                  <ExternalLink href=\"https://github.com/200ok-ch/organice/issues/new\">\n                    create an issue\n                  </ExternalLink>{' '}\n                  and include the org file if possible!\n                </Fragment>\n              )}\n            </div>\n          ) : (\n            <HeaderList shouldDisableActions={shouldDisableActions} />\n          )}\n\n          {isDirty && !shouldDisableDirtyIndicator && (\n            <div className=\"dirty-indicator\">Unpushed changes</div>\n          )}\n\n          {!shouldDisableActions && (\n            <ActionDrawer\n              shouldDisableSyncButtons={shouldDisableSyncButtons}\n              staticFile={staticFile}\n            />\n          )}\n\n          {this.renderActivePopup()}\n        </div>\n      </HotKeys>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const files = state.org.present.get('files');\n  const path = state.org.present.get('path');\n  const loadedFiles = Set.fromKeys(files);\n  const fileIsLoaded = (path) => loadedFiles.includes(path);\n  const file = state.org.present.getIn(['files', path], Map());\n  const headers = file.get('headers');\n  const selectedHeaderId = file.get('selectedHeaderId', null);\n  const activePopup = state.base.get('activePopup', Map());\n\n  return {\n    loadedPath: path,\n    files,\n    headers,\n    selectedHeaderId,\n    isDirty: file.get('isDirty'),\n    fileIsLoaded,\n    selectedHeader: headers && headers.find((header) => header.get('id') === selectedHeaderId),\n    customKeybindings: state.base.get('customKeybindings'),\n    shouldLogIntoDrawer: state.base.get('shouldLogIntoDrawer'),\n    shouldLiveSync: state.base.get('shouldLiveSync'),\n    inEditMode: file.get('editMode'),\n    activePopupType: !!activePopup ? activePopup.get('type') : null,\n    activePopupData: !!activePopup ? activePopup.get('data') : null,\n    captureTemplates: state.capture.get('captureTemplates').concat(sampleCaptureTemplates),\n    pendingCapture: state.org.present.get('pendingCapture'),\n    closeSubheadersRecursively: state.base.get('closeSubheadersRecursively'),\n    orgFileErrorMessage: state.org.present.get('orgFileErrorMessage'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrgFile);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { withRouter, Link } from 'react-router-dom';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as baseActions from '../../actions/base';\nimport * as orgActions from '../../actions/org';\n\nimport './stylesheet.css';\n\nimport TabButtons from '../UI/TabButtons';\nimport Switch from '../UI/Switch';\nimport ExternalLink from '../UI/ExternalLink';\n\nconst Settings = ({\n  fontSize,\n  bulletStyle,\n  shouldTapTodoToAdvance,\n  shouldStoreSettingsInSyncBackend,\n  shouldLiveSync,\n  shouldSyncOnBecomingVisibile,\n  shouldShowTitleInOrgFile,\n  shouldLogIntoDrawer,\n  closeSubheadersRecursively,\n  shouldNotIndentOnExport,\n  agendaDefaultDeadlineDelayValue,\n  agendaDefaultDeadlineDelayUnit,\n  agendaStartOnWeekday,\n  hasUnseenChangelog,\n  syncBackend,\n  showClockDisplay,\n  colorScheme,\n  theme,\n  base,\n  org,\n}) => {\n  // This looks like hardcoding where it would be possible to dispatch\n  // on the `location.origin`, but here we assure that every instance\n  // of organice has a valid link to documentation. Self-building does\n  // not insure that, because building and hosting docs is not part of\n  // the application itself.\n  const documentationHost = window.location.origin.match(/staging.organice.200ok.ch/)\n    ? 'https://staging.organice.200ok.ch'\n    : 'https://organice.200ok.ch';\n\n  const handleSignOutClick = () =>\n    window.confirm('Are you sure you want to sign out?') ? syncBackend.signOut() : void 0;\n\n  const handleKeyboardShortcutsClick = () => base.pushModalPage('keyboard_shortcuts_editor');\n\n  const handleCaptureTemplatesClick = () => base.pushModalPage('capture_templates_editor');\n\n  const handleFileSettingsClick = () => base.pushModalPage('file_settings_editor');\n\n  const handleFontSizeChange = (newFontSize) => base.setFontSize(newFontSize);\n\n  const handleColorSchemeClick = (colorScheme) => base.setColorScheme(colorScheme);\n\n  const handleThemeClick = (theme) => base.setTheme(theme);\n\n  const handleBulletStyleChange = (newBulletStyle) => base.setBulletStyle(newBulletStyle);\n\n  const handleShouldTapTodoToAdvanceChange = () =>\n    base.setShouldTapTodoToAdvance(!shouldTapTodoToAdvance);\n\n  const handleAgendaDefaultDeadlineDelayValueChange = (event) =>\n    base.setAgendaDefaultDeadlineDelayValue(event.target.value);\n\n  const handleAgendaDefaultDeadlineDelayUnitChange = (newDelayUnit) =>\n    base.setAgendaDefaultDeadlineDelayUnit(newDelayUnit);\n\n  const handleAgendaStartOnWeekdayChange = (value) => base.setAgendaStartOnWeekday(value);\n\n  const handleShouldLiveSyncChange = () => base.setShouldLiveSync(!shouldLiveSync);\n\n  const handleShouldSyncOnBecomingVisibleChange = () =>\n    base.setShouldSyncOnBecomingVisibile(!shouldSyncOnBecomingVisibile);\n\n  const handleShouldShowTitleInOrgFile = () =>\n    base.setShouldShowTitleInOrgFile(!shouldShowTitleInOrgFile);\n\n  const handleShouldLogIntoDrawer = () => base.setShouldLogIntoDrawer(!shouldLogIntoDrawer);\n\n  const handleCloseSubheadersRecursively = () =>\n    base.setCloseSubheadersRecursively(!closeSubheadersRecursively);\n\n  const handleShouldNotIndentOnExport = () =>\n    base.setShouldNotIndentOnExport(!shouldNotIndentOnExport);\n\n  const handleShouldStoreSettingsInSyncBackendChange = () =>\n    base.setShouldStoreSettingsInSyncBackend(!shouldStoreSettingsInSyncBackend);\n\n  const handleShowClockDisplayClick = () => org.setShowClockDisplay(!showClockDisplay);\n\n  const handleChangelogClick = () => {\n    base.restoreStaticFile('changelog');\n    base.pushModalPage('changelog');\n  };\n\n  const handleHelpClick = () => {\n    base.restoreStaticFile('sample');\n    base.pushModalPage('sample');\n  };\n\n  return (\n    <div className=\"settings-container\">\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Font size</div>\n        <TabButtons\n          buttons={['Regular', 'Large']}\n          selectedButton={fontSize}\n          onSelect={handleFontSizeChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Color scheme</div>\n        <TabButtons\n          buttons={['Light', 'Dark']}\n          selectedButton={colorScheme}\n          onSelect={handleColorSchemeClick}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Theme</div>\n        <TabButtons\n          buttons={['Solarized', 'One', 'Gruvbox', 'Smyck', 'Code']}\n          selectedButton={theme}\n          onSelect={handleThemeClick}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Bullet style</div>\n        <TabButtons\n          buttons={['Classic', 'Fancy']}\n          selectedButton={bulletStyle}\n          onSelect={handleBulletStyleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Tap TODO to advance state</div>\n        <Switch isEnabled={shouldTapTodoToAdvance} onToggle={handleShouldTapTodoToAdvanceChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Live sync\n          <div className=\"setting-label__description\">\n            If enabled, changes are automatically pushed to the sync backend as you make them.\n          </div>\n        </div>\n        <Switch isEnabled={shouldLiveSync} onToggle={handleShouldLiveSyncChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Sync on application becoming visible\n          <div className=\"setting-label__description\">\n            If enabled, the current org file is pulled from the sync backend when the browser tab\n            becomes visible. This prevents you from having a stale file before starting to make\n            changes to it.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldSyncOnBecomingVisibile}\n          onToggle={handleShouldSyncOnBecomingVisibleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Show Org filename as Title\n          <div className=\"setting-label__description\">\n            When in an Org file view, it shows the filename in the HeaderBar.\n          </div>\n        </div>\n        <Switch isEnabled={shouldShowTitleInOrgFile} onToggle={handleShouldShowTitleInOrgFile} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Log into LOGBOOK drawer when item repeats\n          <div className=\"setting-label__description\">\n            Log TODO state changes (currently only for repeating items) into the LOGBOOK drawer\n            instead of into the body of the heading (default). See the Orgmode documentation on{' '}\n            <ExternalLink href=\"https://www.gnu.org/software/emacs/manual/html_node/org/Tracking-TODO-state-changes.html\">\n              <code>org-log-into-drawer</code>\n            </ExternalLink>{' '}\n            for more information.\n          </div>\n        </div>\n        <Switch isEnabled={shouldLogIntoDrawer} onToggle={handleShouldLogIntoDrawer} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          When folding a header, fold all subheaders too\n          <div className=\"setting-label__description\">\n            When folding a header, fold recursively all its subheaders, so that when the header is\n            reopened all subheaders are folded, regardless of their state prior to folding. This is\n            the default in Emacs Org mode. If this turned off, the fold-state of the subheaders is\n            preserved when the header is unfolded.\n          </div>\n        </div>\n        <Switch\n          isEnabled={closeSubheadersRecursively}\n          onToggle={handleCloseSubheadersRecursively}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Disable hard indent on Org export\n          <div className=\"setting-label__description\">\n            By default, the metadata body (including deadlines and drawers) of an exported org\n            heading is indented according to its level. If instead you prefer to keep your body text\n            flush-left, i.e.{' '}\n            <ExternalLink href=\"https://orgmode.org/manual/Hard-indentation.html\">\n              <code>(setq org-adapt-indentation nil)</code>\n            </ExternalLink>\n            , then activate this setting. The raw content text is left unchanged.\n          </div>\n        </div>\n        <Switch isEnabled={shouldNotIndentOnExport} onToggle={handleShouldNotIndentOnExport} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Store settings in sync backend\n          <div className=\"setting-label__description\">\n            Store settings and keyboard shortcuts in a .organice-config.json file in your sync\n            backend to sync between multiple devices.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldStoreSettingsInSyncBackend}\n          onToggle={handleShouldStoreSettingsInSyncBackendChange}\n        />\n      </div>\n\n      <div className=\"setting-container setting-container--vertical\">\n        <div className=\"setting-label\">Default DEADLINE warning period</div>\n\n        <div className=\"default-deadline-warning-container\">\n          <input\n            type=\"number\"\n            min=\"0\"\n            className=\"textfield default-deadline-value-textfield\"\n            value={agendaDefaultDeadlineDelayValue}\n            onChange={handleAgendaDefaultDeadlineDelayValueChange}\n          />\n\n          <TabButtons\n            buttons={'hdwmy'.split('')}\n            selectedButton={agendaDefaultDeadlineDelayUnit}\n            onSelect={handleAgendaDefaultDeadlineDelayUnitChange}\n          />\n        </div>\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Start of week for weekly agenda\n          <div className=\"setting-label__description\">\n            Akin to{' '}\n            <ExternalLink href=\"https://orgmode.org/manual/Weekly_002fdaily-agenda.html\">\n              <code>org-agenda-start-on-weekday</code>\n            </ExternalLink>\n          </div>\n        </div>\n        <TabButtons\n          buttons={['S', 'M', 'T', 'W', 'T', 'F', 'S', 'Today']}\n          values={[0, 1, 2, 3, 4, 5, 6, -1]}\n          titles={['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']}\n          selectedButton={agendaStartOnWeekday}\n          onSelect={handleAgendaStartOnWeekdayChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Display time summaries\n          <div className=\"setting-label__description\">\n            This puts overlays at the end of each headline, showing the total time recorded under\n            that heading, including the time of any subheadings.\n          </div>\n        </div>\n        <Switch isEnabled={showClockDisplay} onToggle={handleShowClockDisplayClick} />\n      </div>\n\n      <div className=\"settings-buttons-container\">\n        <button className=\"btn settings-btn\" onClick={handleCaptureTemplatesClick}>\n          Capture templates\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleKeyboardShortcutsClick}>\n          Keyboard shortcuts\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleFileSettingsClick}>\n          File settings\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleChangelogClick}>\n          Changelog\n          {hasUnseenChangelog && (\n            <div className=\"changelog-badge-container\">\n              <i className=\"fas fa-gift\" />\n              &nbsp; What's New?\n            </div>\n          )}\n        </button>\n\n        <Link to=\"/sample\" className=\"btn settings-btn\" onClick={handleHelpClick}>\n          Help\n        </Link>\n\n        <button className=\"btn settings-btn\">\n          <ExternalLink href={`${documentationHost}/documentation.html`}>\n            Documentation\n            <i className=\"fas fa-external-link-alt fa-sm\" />\n          </ExternalLink>{' '}\n        </button>\n\n        <button className=\"btn settings-btn\">\n          <ExternalLink href=\"https://github.com/200ok-ch/organice\">\n            Github repo\n            <i className=\"fas fa-external-link-alt fa-sm\" />\n          </ExternalLink>{' '}\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleSignOutClick}>\n          Sign out\n        </button>\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  // The default values here only relate to the settings view. To set\n  // defaults which get loaded on an initial run of organice, look at\n  // `util/settings_persister.js::persistableFields`.\n  const agendaStartOnWeekday = state.base.get('agendaStartOnWeekday');\n  return {\n    fontSize: state.base.get('fontSize') || 'Regular',\n    bulletStyle: state.base.get('bulletStyle'),\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n    agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n    agendaStartOnWeekday: agendaStartOnWeekday == null ? 1 : +agendaStartOnWeekday,\n    shouldStoreSettingsInSyncBackend: state.base.get('shouldStoreSettingsInSyncBackend'),\n    shouldLiveSync: state.base.get('shouldLiveSync'),\n    shouldSyncOnBecomingVisibile: state.base.get('shouldSyncOnBecomingVisibile'),\n    shouldShowTitleInOrgFile: state.base.get('shouldShowTitleInOrgFile'),\n    shouldLogIntoDrawer: state.base.get('shouldLogIntoDrawer'),\n    closeSubheadersRecursively: state.base.get('closeSubheadersRecursively'),\n    shouldNotIndentOnExport: state.base.get('shouldNotIndentOnExport'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n    showClockDisplay: state.org.present.get('showClockDisplay'),\n    colorScheme: state.base.get('colorScheme'),\n    theme: state.base.get('theme'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Settings));\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class ShortcutRow extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRebindClick', 'handleKeyPress']);\n\n    this.state = {\n      isEditMode: false,\n    };\n  }\n\n  componentDidMount() {\n    this.rebindArea.addEventListener('blur', () => this.setState({ isEditMode: false }));\n  }\n\n  handleRebindClick() {\n    this.setState({ isEditMode: true });\n    document.addEventListener('keypress', this.handleKeyPress);\n  }\n\n  handleKeyPress(event) {\n    this.setState({ isEditMode: false });\n    document.removeEventListener('keypress', this.handleKeyPress);\n\n    let key = null;\n    if (event.code.startsWith('Key')) {\n      key = event.code.substr(3).toLowerCase();\n    } else if (event.code.startsWith('Digit')) {\n      key = event.code.substr(5);\n    } else {\n      key = {\n        Minus: '-',\n        Equal: '=',\n        Backspace: 'backspace',\n        Enter: 'enter',\n        Return: 'return',\n        Tab: 'tab',\n        BracketLeft: '[',\n        BracketRight: ']',\n        Semicolon: ';',\n        Quote: '\"',\n        Backslash: '\\\\',\n        Comma: ',',\n        Period: '.',\n        Slash: '/',\n      }[event.code];\n    }\n\n    if (!key) {\n      return;\n    }\n\n    const modifiers = [\n      ['ctrlKey', 'ctrl'],\n      ['altKey', 'alt'],\n      ['metaKey', 'meta'],\n      ['shiftKey', 'shift'],\n    ];\n\n    const newModifiers = modifiers\n      .filter(([modifier, _]) => event[modifier])\n      .map(([_, symbol]) => symbol)\n      .join('+');\n    const newBinding = `${newModifiers}${!!newModifiers ? '+' : ''}${key}`;\n\n    this.props.onBindingChange(this.props.name, newBinding);\n  }\n\n  symbolizeKeybinding(binding) {\n    if (!binding) {\n      return '';\n    }\n\n    const replacements = [\n      ['ctrl', '^'],\n      ['alt', '⌥'],\n      ['option', '⌥'],\n      ['command', '⌘'],\n      ['meta', '⌘'],\n      ['shift', '⇧'],\n      ['backspace', '⌫'],\n      ['return', '⏎'],\n      ['enter', '⏎'],\n      ['left', '←'],\n      ['right', '→'],\n      ['up', '↑'],\n      ['down', '↓'],\n    ];\n\n    return replacements.reduce(\n      (currentBinding, [name, symbol]) => currentBinding.replace(RegExp(`${name}\\\\+?`), symbol),\n      binding\n    );\n  }\n\n  render() {\n    const { name, binding } = this.props;\n    const { isEditMode } = this.state;\n\n    const rebindAreaClassName = classNames('keyboard-shortcut-container__shortcut-key', {\n      'keyboard-shortcut-container__shortcut-key--edit-mode': isEditMode,\n    });\n\n    return (\n      <div className=\"keyboard-shortcut-container\">\n        <div className=\"keyboard-shortcut-container__shortcut-name\">{name}</div>\n        <div\n          className={rebindAreaClassName}\n          onClick={this.handleRebindClick}\n          tabIndex=\"-1\"\n          ref={(div) => (this.rebindArea = div)}\n        >\n          {isEditMode ? '...' : this.symbolizeKeybinding(binding)}\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { withRouter } from 'react-router-dom';\n\nimport { Map } from 'immutable';\n\nimport ShortcutRow from './components/ShortcutRow';\n\nimport * as baseActions from '../../actions/base';\n\nimport { calculateNamedKeybindings } from '../../lib/keybindings';\n\nimport './stylesheet.css';\n\nconst KeyboardShortcutsEditor = ({ customKeybindings, base }) => {\n  const handleBindingChange = (bindingName, newBinding) => {\n    const alreadyInUseBinding = calculateNamedKeybindings(customKeybindings).filter(\n      ([_, binding]) => binding === newBinding\n    )[0];\n\n    if (!!alreadyInUseBinding) {\n      alert(`That binding is already in use for \"${alreadyInUseBinding[0]}\"`);\n      return;\n    }\n\n    base.setCustomKeybinding(bindingName, newBinding);\n  };\n\n  return (\n    <div className=\"keyboard-shortcuts-editor-container\">\n      {calculateNamedKeybindings(customKeybindings).map(([name, binding]) => (\n        <ShortcutRow\n          key={name}\n          name={name}\n          binding={binding}\n          onBindingChange={handleBindingChange}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    customKeybindings: state.base.get('customKeybindings') || Map(),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(KeyboardShortcutsEditor));\n","import React, { Fragment, useState } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../../../OrgFile/components/ActionDrawer/components/ActionButton';\nimport Switch from '../../../UI/Switch/';\nimport ExternalLink from '../../../UI/ExternalLink';\n\nimport classNames from 'classnames';\n\nexport default ({\n  template,\n  index,\n  onFieldPathUpdate,\n  onAddNewTemplateOrgFileAvailability,\n  onRemoveTemplateOrgFileAvailability,\n  onAddNewTemplateHeaderPath,\n  onRemoveTemplateHeaderPath,\n  onDeleteTemplate,\n  syncBackendType,\n  loadedFilePaths,\n}) => {\n  const [isCollapsed, setIsCollapsed] = useState(!!template.get('description'));\n  const handleHeaderBarClick = () => setIsCollapsed(!isCollapsed);\n\n  const updateField = (fieldName) => (event) =>\n    onFieldPathUpdate(template.get('id'), [fieldName], event.target.value);\n\n  const toggleAvailabilityInAllOrgFiles = () =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['isAvailableInAllOrgFiles'],\n      !template.get('isAvailableInAllOrgFiles')\n    );\n\n  const togglePrepend = () =>\n    onFieldPathUpdate(template.get('id'), ['shouldPrepend'], !template.get('shouldPrepend'));\n\n  const handleAddNewOrgFileAvailability = () => {\n    onAddNewTemplateOrgFileAvailability(template.get('id'));\n  };\n\n  const handleRemoveOrgFileAvailability = (index) => () =>\n    onRemoveTemplateOrgFileAvailability(template.get('id'), index);\n\n  const handleOrgFileAvailabilityChange = (orgFileAvailabilityIndex) => (event) =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['orgFilesWhereAvailable', orgFileAvailabilityIndex],\n      event.target.value\n    );\n\n  const handleAddNewHeaderPath = () => onAddNewTemplateHeaderPath(template.get('id'));\n\n  const handleRemoveHeaderPath = (headerPathIndex) => () =>\n    onRemoveTemplateHeaderPath(template.get('id'), headerPathIndex);\n\n  const handleHeaderPathChange = (headerPathIndex) => (event) =>\n    onFieldPathUpdate(template.get('id'), ['headerPaths', headerPathIndex], event.target.value);\n\n  const handleDeleteClick = () => {\n    if (\n      window.confirm(\n        `Are you sure you want to delete the \"${template.get('description')}\" template?`\n      )\n    ) {\n      onDeleteTemplate(template.get('id'));\n    }\n  };\n\n  const renderDescriptionField = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Description:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('description', '')}\n          onChange={updateField('description')}\n        />\n      </div>\n    </div>\n  );\n\n  const renderIconField = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Letter:</div>\n        <input\n          type=\"text\"\n          className=\"textfield capture-template__letter-textfield\"\n          maxLength=\"1\"\n          value={template.get('letter', '')}\n          onChange={updateField('letter')}\n          autoCapitalize=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__field__or-container\">\n        <div className=\"capture-template__field__or-line\" />\n        <div className=\"capture-template__field__or\">or</div>\n        <div className=\"capture-template__field__or-line\" />\n      </div>\n\n      <div className=\"capture-template__field\">\n        <div>Icon name:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('iconName')}\n          onChange={updateField('iconName')}\n          autoCapitalize=\"none\"\n          autoCorrect=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or\n        calendar-plus) to use as the capture icon. You can search the available icons{' '}\n        <ExternalLink href=\"https://fontawesome.com/icons?d=gallery&s=solid&m=free\">\n          here\n        </ExternalLink>\n        .\n      </div>\n    </div>\n  );\n\n  const renderOrgFileAvailability = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Available in all org files?</div>\n        <Switch\n          isEnabled={template.get('isAvailableInAllOrgFiles')}\n          onToggle={toggleAvailabilityInAllOrgFiles}\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        You can make this capture template available in all org files, or just the ones you specify.\n        {syncBackendType === 'Dropbox' && (\n          <Fragment>\n            {' '}\n            Specify full paths starting from the root of your Dropbox, like{' '}\n            <code>/org/todo.org</code>\n          </Fragment>\n        )}\n        {syncBackendType === 'Google Drive' && (\n          <Fragment>\n            {' '}\n            Specify the file id of each file. You can find the file id in the URL of the file in\n            organice (e.g.,{' '}\n            <code>\n              /file/\n              {'<file id>'}\n            </code>\n            ).\n          </Fragment>\n        )}\n      </div>\n\n      <Collapse\n        isOpened={!template.get('isAvailableInAllOrgFiles')}\n        springConfig={{ stiffness: 300 }}\n      >\n        <div className=\"multi-textfields-container\">\n          {template.get('orgFilesWhereAvailable').map((orgFilePath, index) => (\n            <div key={`org-file-availability-${index}`} className=\"multi-textfield-container\">\n              <input\n                type=\"text\"\n                placeholder=\"e.g., /org/todo.org\"\n                className=\"textfield multi-textfield-field\"\n                value={orgFilePath}\n                onChange={handleOrgFileAvailabilityChange(index)}\n              />\n              <button\n                className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n                onClick={handleRemoveOrgFileAvailability(index)}\n              />\n            </div>\n          ))}\n        </div>\n\n        <div className=\"add-new-multi-textfield-button-container\">\n          <button\n            className=\"fas fa-plus add-new-multi-textfield-button\"\n            onClick={handleAddNewOrgFileAvailability}\n          />\n        </div>\n      </Collapse>\n    </div>\n  );\n\n  const renderFilePath = (template) => {\n    return (\n      <div className=\"capture-template__field-container\">\n        <div className=\"capture-template__field\">\n          <div>File: </div>\n          <select onChange={updateField('file')} style={{ width: '90%' }}>\n            {(loadedFilePaths.filter((path) => (path === template.get('file', '')).length) !== 0\n              ? loadedFilePaths\n              : [template.get('file'), ...loadedFilePaths]\n            ).map((path) => (\n              <option key={path} value={path}>\n                {path}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div className=\"capture-template__help-text\">\n          By default the file opened when capturing is the capture target. Select a specific file if\n          you want this template to always capture to that file. Make sure the file is loaded for it\n          to be selectable here. You might also consider to set the file to load on startup in the\n          file settings so it's always available.\n        </div>\n      </div>\n    );\n  };\n\n  const renderHeaderPaths = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Header path</div>\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Specify the path to the header under which the new header should be filed. One header per\n        textfield.\n      </div>\n\n      <div className=\"multi-textfields-container\">\n        {template.get('headerPaths').map((headerPath, index) => (\n          <div key={`header-path-${index}`} className=\"multi-textfield-container\">\n            <input\n              type=\"text\"\n              placeholder=\"e.g., Todos\"\n              className=\"textfield multi-textfield-field\"\n              value={headerPath}\n              onChange={handleHeaderPathChange(index)}\n            />\n            <button\n              className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n              onClick={handleRemoveHeaderPath(index)}\n            />\n          </div>\n        ))}\n      </div>\n\n      <div className=\"add-new-multi-textfield-button-container\">\n        <button\n          className=\"fas fa-plus add-new-multi-textfield-button\"\n          onClick={handleAddNewHeaderPath}\n        />\n      </div>\n    </div>\n  );\n\n  const renderPrependField = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Prepend?</div>\n        <Switch isEnabled={template.get('shouldPrepend')} onToggle={togglePrepend} />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        By default, new captured headers are appended to the specified header path. Enable this\n        setting to prepend them instead.\n      </div>\n    </div>\n  );\n\n  const renderTemplateField = (template) => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Template</div>\n      </div>\n\n      <textarea\n        className=\"textarea template-textarea\"\n        rows=\"3\"\n        value={template.get('template')}\n        onChange={updateField('template')}\n      />\n\n      <div className=\"capture-template__help-text\">\n        The template for creating the capture item. You can use the following template variables\n        that will be expanded upon capture:\n        <ul>\n          <li>\n            <code>%?</code> - Place the cursor here.\n          </li>\n          <li>\n            <code>%t</code> - Timestamp, date only.\n          </li>\n          <li>\n            <code>%T</code> - Timestamp, with date and time.\n          </li>\n          <li>\n            <code>%u</code> - Inactive timestamp, date only.\n          </li>\n          <li>\n            <code>%U</code> - Inactive timestamp, with date and time.\n          </li>\n          <li>\n            <code>%{'<custom variable>'}</code> - A custom variable from a URL param capture. See{' '}\n            <ExternalLink href=\"https://organice.200ok.ch/documentation.html#capture_templates\">\n              the README file\n            </ExternalLink>{' '}\n            for more details.\n          </li>\n        </ul>\n        You can also use <code>%u</code> and <code>%t</code> as part of the header path.\n      </div>\n    </div>\n  );\n\n  const renderDeleteButton = () => (\n    <div className=\"capture-template__field-container capture-template__delete-button-container\">\n      <button\n        className=\"btn settings-btn capture-template__delete-button\"\n        onClick={handleDeleteClick}\n      >\n        Delete template\n      </button>\n    </div>\n  );\n\n  const caretClassName = classNames(\n    'fas fa-2x fa-caret-right capture-template-container__header__caret',\n    {\n      'capture-template-container__header__caret--rotated': !isCollapsed,\n    }\n  );\n\n  return (\n    <Draggable draggableId={`capture-template--${template.get('id')}`} index={index}>\n      {(provided, snapshot) => (\n        <div\n          className={classNames('capture-template-container', {\n            'capture-template-container--dragging': snapshot.isDragging,\n          })}\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n        >\n          <div className=\"capture-template-container__header\" onClick={handleHeaderBarClick}>\n            <i className={caretClassName} />\n            <ActionButton\n              iconName={template.get('iconName')}\n              letter={template.get('letter')}\n              onClick={() => {}}\n              style={{ marginRight: 20 }}\n            />\n            <span className=\"capture-template-container__header__title\">\n              {template.get('description')}\n            </span>\n            <i\n              className=\"fas fa-bars fa-lg capture-template-container__header__drag-handle\"\n              {...provided.dragHandleProps}\n            />\n          </div>\n\n          <Collapse isOpened={!isCollapsed} springConfig={{ stiffness: 300 }}>\n            <div className=\"capture-template-container__content\">\n              {renderDescriptionField(template)}\n              {renderIconField(template)}\n              {renderOrgFileAvailability(template)}\n              {renderFilePath(template)}\n              {renderHeaderPaths(template)}\n              {renderPrependField(template)}\n              {renderTemplateField(template)}\n              {renderDeleteButton()}\n            </div>\n          </Collapse>\n        </div>\n      )}\n    </Draggable>\n  );\n};\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Droppable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport * as captureActions from '../../actions/capture';\n\nimport CaptureTemplate from './components/CaptureTemplate';\n\nimport { List } from 'immutable';\nimport { STATIC_FILE_PREFIX } from '../../lib/org_utils';\n\nconst CaptureTemplatesEditor = ({\n  captureTemplates,\n  syncBackendType,\n  capture,\n  loadedFilePaths,\n}) => {\n  const handleAddNewTemplateClick = () => capture.addNewEmptyCaptureTemplate();\n\n  const handleFieldPathUpdate = (templateId, fieldPath, newValue) =>\n    capture.updateTemplateFieldPathValue(templateId, fieldPath, newValue);\n\n  const handleAddNewTemplateOrgFileAvailability = (templateId) =>\n    capture.addNewTemplateOrgFileAvailability(templateId);\n\n  const handleRemoveTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) =>\n    capture.removeTemplateOrgFileAvailability(templateId, orgFileAvailabilityIndex);\n\n  const handleAddNewTemplateHeaderPath = (templateId) =>\n    capture.addNewTemplateHeaderPath(templateId);\n\n  const handleRemoveTemplateHeaderPath = (templateId, headerPathIndex) =>\n    capture.removeTemplateHeaderPath(templateId, headerPathIndex);\n\n  const handleDeleteTemplate = (templateId) => capture.deleteTemplate(templateId);\n\n  const handleReorderTemplate = (fromIndex, toIndex) =>\n    capture.reorderCaptureTemplate(fromIndex, toIndex);\n\n  return (\n    <div>\n      <Droppable droppableId=\"capture-templates-editor-droppable\" type=\"CAPTURE-TEMPLATE\">\n        {(provided) => (\n          <div\n            className=\"capture-templates-container\"\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {captureTemplates.size === 0 ? (\n              <div className=\"no-capture-templates-message\">\n                You don't currently have any capture templates - add one by pressing the{' '}\n                <i className=\"fas fa-plus\" /> button.\n                <br />\n                <br />\n                Capture templates show up in the action drawer and give you quick access to creating\n                new headers (like org-capture).\n              </div>\n            ) : (\n              <Fragment>\n                {captureTemplates.map((template, index) => (\n                  <CaptureTemplate\n                    key={template.get('id')}\n                    index={index}\n                    template={template}\n                    syncBackendType={syncBackendType}\n                    loadedFilePaths={loadedFilePaths}\n                    onFieldPathUpdate={handleFieldPathUpdate}\n                    onAddNewTemplateOrgFileAvailability={handleAddNewTemplateOrgFileAvailability}\n                    onRemoveTemplateOrgFileAvailability={handleRemoveTemplateOrgFileAvailability}\n                    onAddNewTemplateHeaderPath={handleAddNewTemplateHeaderPath}\n                    onRemoveTemplateHeaderPath={handleRemoveTemplateHeaderPath}\n                    onDeleteTemplate={handleDeleteTemplate}\n                    onReorder={handleReorderTemplate}\n                  />\n                ))}\n\n                {provided.placeholder}\n              </Fragment>\n            )}\n          </div>\n        )}\n      </Droppable>\n\n      <div className=\"new-capture-template-button-container\">\n        <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={handleAddNewTemplateClick} />\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const loadedFilePaths = state.org.present\n    .get('files', List())\n    .keySeq()\n    .toJS()\n    .filter((path) => !path.startsWith(STATIC_FILE_PREFIX));\n  loadedFilePaths.unshift('');\n  return {\n    captureTemplates: state.capture.get('captureTemplates', List()),\n    syncBackendType: state.syncBackend.get('client').type,\n    loadedFilePaths,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CaptureTemplatesEditor);\n","import React, { useState } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport Switch from '../../../UI/Switch';\n\nimport classNames from 'classnames';\n\nexport default ({ setting, index, onFieldPathUpdate, onDeleteSetting, loadedFilepaths, path }) => {\n  const [isCollapsed, setIsCollapsed] = useState(true);\n  const handleHeaderBarClick = () => setIsCollapsed(!isCollapsed);\n\n  const updateField = (fieldName) => (event) =>\n    onFieldPathUpdate(setting.get('id'), [fieldName], event.target.value);\n\n  const toggleLoadOnStartup = () =>\n    onFieldPathUpdate(setting.get('id'), ['loadOnStartup'], !setting.get('loadOnStartup'));\n\n  const toggleIncludeInAgenda = () =>\n    onFieldPathUpdate(setting.get('id'), ['includeInAgenda'], !setting.get('includeInAgenda'));\n\n  const toggleIncludeInSearch = () =>\n    onFieldPathUpdate(setting.get('id'), ['includeInSearch'], !setting.get('includeInSearch'));\n\n  const toggleIncludeInTasklist = () =>\n    onFieldPathUpdate(setting.get('id'), ['includeInTasklist'], !setting.get('includeInTasklist'));\n\n  const toggleIncludeInRefile = () =>\n    onFieldPathUpdate(setting.get('id'), ['includeInRefile'], !setting.get('includeInRefile'));\n\n  const handleDeleteClick = () => {\n    if (\n      window.confirm(`Are you sure you want to delete the settings for \"${setting.get('path')}\"?`)\n    ) {\n      onDeleteSetting(setting.get('id'));\n    }\n  };\n\n  const renderPathField = (setting) => {\n    if (setting.get('path') === '') {\n      updateField('path')({ target: { value: path || loadedFilepaths[0] } });\n    }\n    return (\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Path: </div>\n          <select onChange={updateField('path')} style={{ width: '90%' }}>\n            {[setting.get('path'), ...loadedFilepaths].map((path) => (\n              <option key={path} value={path}>\n                {path}\n              </option>\n            ))}\n          </select>\n        </div>\n      </div>\n    );\n  };\n\n  const renderOptionFields = (setting) => (\n    <>\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Sync on startup?</div>\n          <Switch isEnabled={setting.get('loadOnStartup')} onToggle={toggleLoadOnStartup} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, files are loaded from localStorage when available and are only synced when\n          visited or when a sync is manually triggered. Enable this setting to always sync this file\n          when opening organice.\n        </div>\n      </div>\n\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Include in Agenda?</div>\n          <Switch isEnabled={setting.get('includeInAgenda')} onToggle={toggleIncludeInAgenda} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, only the currently opened file is included in the agenda. Enable this setting\n          to always include this file. The currently viewed file is always included.\n        </div>\n      </div>\n\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Include in Search?</div>\n          <Switch isEnabled={setting.get('includeInSearch')} onToggle={toggleIncludeInSearch} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, only the current viewed file is included in search. Enable this setting to\n          always include this file. The currently loaded file is always included.\n        </div>\n      </div>\n\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Include in Tasklist?</div>\n          <Switch isEnabled={setting.get('includeInTasklist')} onToggle={toggleIncludeInTasklist} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, only the current viewed file is included in the tasklist. Enable this setting\n          to always include this file. The currently loaded file is always included.\n        </div>\n      </div>\n\n      <div className=\"file-setting__field-container\">\n        <div className=\"file-setting__field\">\n          <div>Include in Refile?</div>\n          <Switch isEnabled={setting.get('includeInRefile')} onToggle={toggleIncludeInRefile} />\n        </div>\n\n        <div className=\"file-setting__help-text\">\n          By default, only the currently viewed file is available as a refile targets. Enable this\n          setting to always include this file. The currently loaded file is always included.\n        </div>\n      </div>\n    </>\n  );\n\n  const renderDeleteButton = () => (\n    <div className=\"file-setting__field-container file-setting__delete-button-container\">\n      <button className=\"btn settings-btn file-setting__delete-button\" onClick={handleDeleteClick}>\n        Delete setting\n      </button>\n    </div>\n  );\n\n  const caretClassName = classNames(\n    'fas fa-2x fa-caret-right file-setting-container__header__caret',\n    {\n      'file-setting-container__header__caret--rotated': !isCollapsed,\n    }\n  );\n\n  return (\n    <Draggable draggableId={`file-setting--${setting.get('path')}`} index={index}>\n      {(provided, snapshot) => (\n        <div\n          className={classNames('file-setting-container', {\n            'file-setting-container--dragging': snapshot.isDragging,\n          })}\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n        >\n          <div className=\"file-setting-container__header\" onClick={handleHeaderBarClick}>\n            <i className={caretClassName} />\n            <div className=\"file-setting-icons\">\n              <div\n                className={classNames('load-on-startup-icon', {\n                  'fas fa-sync-alt fa-lg file-setting-icon': setting.get('loadOnStartup'),\n                })}\n              />\n              <div\n                className={classNames({\n                  'fas fa-calendar-alt fa-lg file-setting-icon': setting.get('includeInAgenda'),\n                })}\n              />\n              <div\n                className={classNames({\n                  'fas fa-search fa-lg file-setting-icon': setting.get('includeInSearch'),\n                })}\n              />\n              <div\n                className={classNames({\n                  'fas fa-tasks fa-lg file-setting-icon': setting.get('includeInTasklist'),\n                })}\n              />\n              <div\n                className={classNames({\n                  'fas fa-file-export fa-lg file-setting-icon': setting.get('includeInRefile'),\n                })}\n              />\n            </div>\n\n            <span className=\"file_setting-container__header__title\">{setting.get('path')}</span>\n\n            <i\n              className=\"fas fa-bars fa-lg file-setting-container__header__drag-handle\"\n              {...provided.dragHandleProps}\n            />\n          </div>\n\n          <Collapse isOpened={!isCollapsed} springConfig={{ stiffness: 300 }}>\n            <div className=\"file-setting-container__content\">\n              {renderPathField(setting)}\n              {renderOptionFields(setting)}\n              {renderDeleteButton()}\n            </div>\n          </Collapse>\n        </div>\n      )}\n    </Draggable>\n  );\n};\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Droppable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport * as orgActions from '../../actions/org';\n\nimport FileSetting from './components/FileSetting';\n\nimport { List } from 'immutable';\nimport { STATIC_FILE_PREFIX } from '../../lib/org_utils';\n\nconst FileSettingsEditor = ({\n  fileSettings,\n  loadedFilepaths,\n  currentPathIfWithoutFileSetting,\n  org,\n}) => {\n  const handleAddNewSettingClick = () => org.addNewEmptyFileSetting();\n\n  const handleFieldPathUpdate = (settingId, fieldPath, newValue) =>\n    org.updateFileSettingFieldPathValue(settingId, fieldPath, newValue);\n\n  const handleDeleteSetting = (settingId) => org.deleteFileSetting(settingId);\n\n  const handleReorderSetting = (fromIndex, toIndex) => org.reorderFileSetting(fromIndex, toIndex);\n\n  return (\n    <div>\n      <Droppable droppableId=\"file-setting-editor-droppable\" type=\"FILE-SETTING\">\n        {(provided) => (\n          <div\n            className=\"file-setting-container\"\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {fileSettings.size === 0 ? (\n              <div className=\"no-file-setting-message\">\n                You don't currently have any file settings - add one by pressing the{' '}\n                <i className=\"fas fa-plus\" /> button.\n                <br />\n                <br />\n                File settings allow you to configure how specific files are handeled when multiple\n                files are loaded. Make sure a file is loaded to create a setting entry.\n              </div>\n            ) : (\n              <Fragment>\n                {fileSettings.map((setting, index) => (\n                  <FileSetting\n                    key={setting.get('id')}\n                    index={index}\n                    setting={setting}\n                    path={currentPathIfWithoutFileSetting}\n                    loadedFilepaths={loadedFilepaths}\n                    onFieldPathUpdate={handleFieldPathUpdate}\n                    onDeleteSetting={handleDeleteSetting}\n                    onReorder={handleReorderSetting}\n                  />\n                ))}\n\n                {provided.placeholder}\n              </Fragment>\n            )}\n          </div>\n        )}\n      </Droppable>\n\n      {loadedFilepaths.length !== 0 && (\n        <div className=\"new-capture-template-button-container\">\n          <button\n            className=\"fas fa-plus fa-lg btn btn--circle\"\n            onClick={handleAddNewSettingClick}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  const path = state.base.get('lastViewedPath');\n  const fileSettings = state.org.present.get('fileSettings', List());\n  const existingSettings = fileSettings.map((setting) => setting.get('path'));\n  const paths = state.org.present.get('files', List()).keySeq();\n  const currentPathIfWithoutFileSetting = !existingSettings.find((filePath) => filePath === path)\n    ? path\n    : null;\n  const loadedFilepaths = paths\n    .filter((path) => !path.startsWith(STATIC_FILE_PREFIX))\n    .filter((path) => !existingSettings.find((settingPath) => settingPath === path))\n    .toJS();\n  return {\n    fileSettings,\n    loadedFilepaths,\n    currentPathIfWithoutFileSetting,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FileSettingsEditor);\n","export default __webpack_public_path__ + \"static/media/dropbox.9d61ebe9.svg\";","export default __webpack_public_path__ + \"static/media/google_drive.48c4558c.png\";","/* global gapi */\n\nimport React, { PureComponent, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport DropboxLogo from './dropbox.svg';\nimport GoogleDriveLogo from './google_drive.png';\n\nimport { persistField } from '../../util/settings_persister';\n\nimport { Dropbox } from 'dropbox';\n\nimport _ from 'lodash';\n\nfunction WebDAVForm() {\n  const [isVisible, setIsVisible] = useState(false);\n  const [url, setUrl] = useState('');\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n\n  return !isVisible ? (\n    <div\n      id=\"webdavLogin\"\n      onClick={() => {\n        setIsVisible(true);\n      }}\n    >\n      <h2>WebDAV</h2>\n    </div>\n  ) : (\n    <div id=\"webdavLogin\">\n      <h2>WebDAV</h2>\n      <form\n        onSubmit={(event) => {\n          event.preventDefault();\n          persistField('authenticatedSyncService', 'WebDAV');\n          persistField('webdavEndpoint', url);\n          persistField('webdavUsername', username);\n          persistField('webdavPassword', password);\n          window.location = window.location.origin + '/';\n        }}\n      >\n        <p>\n          <label>URL:</label>\n          <input\n            name=\"url\"\n            type=\"url\"\n            value={url}\n            className=\"textfield\"\n            onChange={(e) => {\n              setUrl(e.target.value);\n            }}\n          />\n        </p>\n        <p>\n          <label>Username:</label>\n          <input\n            type=\"text\"\n            className=\"textfield\"\n            value={username}\n            onChange={(e) => {\n              setUsername(e.target.value);\n            }}\n          />\n        </p>\n        <p>\n          <label>Password:</label>\n          <input\n            type=\"password\"\n            className=\"textfield\"\n            value={password}\n            onChange={(e) => {\n              setPassword(e.target.value);\n            }}\n          />\n        </p>\n        <input type=\"submit\" value=\"Sign-in\" />\n      </form>\n    </div>\n  );\n}\n\nfunction GoogleDriveNote() {\n  const [isVisible, setIsVisible] = useState(false);\n\n  return !isVisible ? (\n    <div\n      id=\"googleDriveNote\"\n      onClick={() => {\n        setIsVisible(true);\n      }}\n    >\n      <h4>Click to read news regarding use of Google drive</h4>\n    </div>\n  ) : (\n    <div id=\"googleDriveNote\">\n      <h2>News regarding use of Google drive</h2>\n      We are waiting for Google to put{' '}\n      <a href=\"https://github.com/200ok-ch/organice/issues/127\">\n        Google Drive for this instance into production mode\n      </a>\n      . Until that has happend, only 100 users can use this instance of organice. If you cannot log\n      in here, but want to use Google Drive,{' '}\n      <a href=\"https://organice.200ok.ch/documentation.html#google_drive\">\n        here are the instructions\n      </a>{' '}\n      on running your own instance of organice with Google Drive enabled.\n      <p>\n        If you don't want to do that, you are welcome to use Dropbox or WebDAV as synchronisation\n        back-ends.\n      </p>\n    </div>\n  );\n}\n\nexport default class SyncServiceSignIn extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleDropboxClick', 'handleGoogleDriveClick']);\n  }\n\n  handleDropboxClick() {\n    persistField('authenticatedSyncService', 'Dropbox');\n\n    const dropbox = new Dropbox({\n      clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID,\n      fetch: fetch.bind(window),\n    });\n    dropbox.auth.getAuthenticationUrl(window.location.origin + '/').then((authURL) => {\n      window.location = authURL;\n    });\n  }\n\n  handleGoogleDriveClick() {\n    try {\n      gapi.load('client:auth2', () => {\n        gapi.client\n          .init({\n            apiKey: process.env.REACT_APP_GOOGLE_DRIVE_API_KEY,\n            clientId: process.env.REACT_APP_GOOGLE_DRIVE_CLIENT_ID,\n            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\n            scope: 'https://www.googleapis.com/auth/drive',\n          })\n          .then(() => {\n            persistField('authenticatedSyncService', 'Google Drive');\n\n            gapi.auth2.getAuthInstance().signIn({\n              ux_mode: 'redirect',\n              redirect_uri: window.location.origin,\n            });\n          });\n      });\n    } catch (error) {\n      alert(\n        `The Google Drive API client isn't available - you might be blocking it with an ad blocker`\n      );\n      return;\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"sync-service-sign-in-container\">\n        <p className=\"sync-service-sign-in__help-text\">\n          organice syncs your files with Dropbox, Google Drive and WebDAV.\n        </p>\n        <p className=\"sync-service-sign-in__help-text\">Click to sign in with:</p>\n\n        <div className=\"sync-service-container\" onClick={this.handleDropboxClick}>\n          <img src={DropboxLogo} alt=\"Dropbox logo\" className=\"dropbox-logo\" />\n        </div>\n\n        <div className=\"sync-service-container\">\n          <img\n            src={GoogleDriveLogo}\n            onClick={this.handleGoogleDriveClick}\n            alt=\"Google Drive logo\"\n            className=\"google-drive-logo\"\n          />\n          <GoogleDriveNote />\n        </div>\n\n        <div className=\"sync-service-container\">\n          <WebDAVForm />\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Route, Switch, Redirect, withRouter } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport { List, Set } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport { changelogHash, STATIC_FILE_PREFIX } from '../../lib/org_utils';\nimport PrivacyPolicy from '../PrivacyPolicy';\nimport HeaderBar from '../HeaderBar';\nimport Landing from '../Landing';\nimport FileBrowser from '../FileBrowser';\nimport LoadingIndicator from '../LoadingIndicator';\nimport OrgFile from '../OrgFile';\nimport Settings from '../Settings';\nimport KeyboardShortcutsEditor from '../KeyboardShortcutsEditor';\nimport CaptureTemplatesEditor from '../CaptureTemplatesEditor';\nimport FileSettingsEditor from '../FileSettingsEditor';\nimport SyncServiceSignIn from '../SyncServiceSignIn';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as orgActions from '../../actions/org';\nimport * as baseActions from '../../actions/base';\nimport { loadTheme } from '../../lib/color';\n\nclass Entry extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'renderChangelogFile',\n      'renderSampleFile',\n      'renderFileBrowser',\n      'renderFile',\n      'setChangelogUnseenChanges',\n    ]);\n  }\n\n  componentDidMount() {\n    this.setChangelogUnseenChanges();\n    this.props.filesToLoad.forEach((path) => this.props.syncBackend.downloadFile(path));\n    this.props.filesToSync.forEach((path) => this.props.org.sync({ path }));\n  }\n\n  // TODO: Should this maybe done on init of the application and not in the component?\n  setChangelogUnseenChanges() {\n    const { lastSeenChangelogHash, isAuthenticated } = this.props;\n    changelogHash().then((changelogHash) => {\n      const hasChanged =\n        isAuthenticated &&\n        lastSeenChangelogHash &&\n        !_.isEqual(changelogHash, lastSeenChangelogHash);\n\n      this.props.base.setHasUnseenChangelog(hasChanged);\n    });\n  }\n\n  componentDidUpdate() {\n    this.shouldPromptWhenLeaving()\n      ? (window.onbeforeunload = () => true)\n      : (window.onbeforeunload = undefined);\n  }\n\n  componentWillUnmount() {\n    window.onbeforeunload = undefined;\n  }\n\n  renderChangelogFile() {\n    return (\n      <OrgFile\n        staticFile=\"changelog\"\n        shouldDisableDirtyIndicator={true}\n        shouldDisableActions={true}\n        shouldDisableSyncButtons={false}\n        parsingErrorMessage={\n          \"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n        }\n      />\n    );\n  }\n\n  renderSampleFile() {\n    return (\n      <OrgFile\n        staticFile=\"sample\"\n        shouldDisableDirtyIndicator={true}\n        shouldDisableActionDrawer={false}\n        shouldDisableSyncButtons={true}\n        parsingErrorMessage={\n          \"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n        }\n      />\n    );\n  }\n\n  renderFileBrowser({\n    match: {\n      params: { path = '' },\n    },\n  }) {\n    if (!!path) {\n      path = '/' + path;\n    }\n\n    return <FileBrowser path={path} />;\n  }\n\n  renderFile({\n    match: {\n      params: { path },\n    },\n  }) {\n    if (!!path) {\n      path = '/' + path;\n    }\n    if (\n      this.props.path &&\n      !this.props.path.startsWith(STATIC_FILE_PREFIX) &&\n      this.props.path !== path\n    ) {\n      this.props.org.sync({ path: this.props.path });\n      return <Redirect push to={'/file' + this.props.path} />;\n    } else {\n      return (\n        <OrgFile\n          path={path}\n          shouldDisableDirtyIndicator={false}\n          shouldDisableActionDrawer={false}\n          shouldDisableSyncButtons={false}\n        />\n      );\n    }\n  }\n\n  shouldPromptWhenLeaving() {\n    return this.props.hasDirtyFiles;\n  }\n\n  render() {\n    const {\n      isAuthenticated,\n      loadingMessage,\n      fontSize,\n      activeModalPage,\n      pendingCapture,\n      location: { pathname },\n      colorScheme,\n      theme,\n    } = this.props;\n\n    loadTheme(theme, colorScheme);\n\n    const pendingCapturePath = !!pendingCapture && `/file${pendingCapture.get('capturePath')}`;\n    const shouldRedirectToCapturePath = pendingCapturePath && pendingCapturePath !== pathname;\n\n    const className = classNames('entry-container', {\n      'entry-container--large-font': fontSize === 'Large',\n    });\n\n    return (\n      <>\n        <HeaderBar />\n        <div className={className}>\n          <LoadingIndicator message={loadingMessage} />\n\n          {activeModalPage === 'changelog' ? (\n            this.renderChangelogFile()\n          ) : isAuthenticated ? (\n            [\n              'keyboard_shortcuts_editor',\n              'settings',\n              'capture_templates_editor',\n              'file_settings_editor',\n              'sample',\n            ].includes(activeModalPage) ? (\n              <Fragment>\n                {activeModalPage === 'keyboard_shortcuts_editor' && <KeyboardShortcutsEditor />}\n                {activeModalPage === 'capture_templates_editor' && <CaptureTemplatesEditor />}\n                {activeModalPage === 'file_settings_editor' && <FileSettingsEditor />}\n                {activeModalPage === 'sample' && this.renderSampleFile()}\n              </Fragment>\n            ) : (\n              <Switch>\n                {shouldRedirectToCapturePath && <Redirect to={pendingCapturePath} />}\n                <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\n                <Route path=\"/file/:path+\" render={this.renderFile} />\n                <Route path=\"/files/:path*\" render={this.renderFileBrowser} />\n                <Route path=\"/sample\" exact={true} render={this.renderSampleFile} />\n                <Route path=\"/settings\" exact={true}>\n                  <Settings />\n                </Route>\n                <Redirect to=\"/files\" />\n              </Switch>\n            )\n          ) : (\n            <Switch>\n              <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\n              <Route path=\"/sample\" exact={true} render={this.renderSampleFile} />\n              <Route path=\"/sign_in\" exact={true} component={SyncServiceSignIn} />\n              <Route path=\"/\" exact={true} component={Landing} />\n              <Redirect to=\"/\" />\n            </Switch>\n          )}\n        </div>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  const files = state.org.present.get('files');\n  const path = state.org.present.get('path');\n  const filesToLoadOnStartup = state.org.present\n    .get('fileSettings')\n    .filter((setting) => setting.get('loadOnStartup'))\n    .map((setting) => setting.get('path'));\n  const loadedFiles = Set.fromKeys(files);\n  const fileIsLoaded = (path) => loadedFiles.includes(path);\n  const filesToLoad = filesToLoadOnStartup.filter((path) => !fileIsLoaded(path));\n  const filesToSync = filesToLoadOnStartup.filter((path) => fileIsLoaded(path));\n  const hasDirtyFiles = !!files.find((file) => file.get('isDirty'));\n  return {\n    path,\n    filesToLoad,\n    filesToSync,\n    loadingMessage: state.base.get('loadingMessage'),\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    fontSize: state.base.get('fontSize'),\n    lastSeenChangelogHash: state.base.get('lastSeenChangelogHash'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    pendingCapture: state.org.present.get('pendingCapture'),\n    hasDirtyFiles,\n    colorScheme: state.base.get('colorScheme'),\n    theme: state.base.get('theme'),\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Entry));\n","import { debounce } from 'lodash';\n\nimport { setPath, sync } from '../actions/org';\nimport { setIsOnline } from '../actions/base';\nimport { STATIC_FILE_PREFIX } from './org_utils';\n\n// When offline, don't sync and don't enable sync button. When online,\n// enable sync button. When newly online, force sync of all things\n// possibly dirty.\nexport function listenToNetworkConnectionEvents(store) {\n  // Is the user online when starting up the application?\n  store.dispatch(setIsOnline(navigator.onLine));\n\n  window.onoffline = function () {\n    store.dispatch(setIsOnline(false));\n  };\n\n  window.ononline = function () {\n    store.dispatch(setIsOnline(true));\n    // Add grace period, because browsers might get the event `onLine`\n    // too soon to actually do network requests.\n    setTimeout(() => {\n      sync({ shouldSuppressMessages: true, forceAction: 'manual' })(store.dispatch, store.getState);\n    }, 2000);\n  };\n}\n\n// Generally, opening files and other routing is done with the\n// `react-router-dom` package (i.e. `<Link/ > tags). However, organice\n// also should react to browser buttons.\nexport function listenToBrowserButtons(store) {\n  const path = store.getState().org.present.get('path');\n\n  const urlPathMatch = window.location.href.match(/.*file(\\/.*)/);\n\n  let urlPath = path;\n\n  // The user has gone 'back' or 'forward' and is showing a 'file'\n  // URL.\n  if (urlPathMatch) {\n    urlPath = urlPathMatch[1];\n  }\n\n  window.onpopstate = function () {\n    // If the current 'path' in Redux is not the same as the one in\n    // the URL.\n    if (path !== urlPath) {\n      store.dispatch(setPath(path));\n    }\n  };\n}\n\n// BEGIN: Sync on Becoming Visible\n\nconst dispatchSync = (store) => {\n  if (\n    store.getState().syncBackend.get('client') &&\n    store.getState().base.get('shouldSyncOnBecomingVisibile')\n  ) {\n    const path = store.getState().org.present.get('path');\n    let filesToLoadOnStartup = store\n      .getState()\n      .org.present.get('fileSettings')\n      .filter((setting) => setting.get('loadOnStartup'))\n      .map((setting) => setting.get('path'));\n    if (\n      path &&\n      !path.startsWith(STATIC_FILE_PREFIX) &&\n      !filesToLoadOnStartup.find((filepath) => path === filepath)\n    ) {\n      filesToLoadOnStartup = filesToLoadOnStartup.push(path);\n    }\n    filesToLoadOnStartup.forEach((path) => {\n      sync({ path, shouldSuppressMessages: true })(store.dispatch, store.getState);\n    });\n  }\n};\n\n// The 'visibilitychange' event might get triggered in some browsers\n// many times for one 'real' event of the browser becoming visible to\n// the user. Debouncing through lodash ensures that it is called at\n// maximum once every second.\nconst debouncedDispatchSync = debounce(dispatchSync, 1000);\n\n// Dealing with vendor prefixes\nfunction getHiddenProp() {\n  const prefixes = ['webkit', 'moz', 'ms', 'o'];\n\n  // if 'hidden' is natively supported just return it\n  if ('hidden' in document) return 'hidden';\n\n  // otherwise loop over all the known prefixes until we find one\n  for (let i = 0; i < prefixes.length; i++) {\n    if (prefixes[i] + 'Hidden' in document) return prefixes[i] + 'Hidden';\n  }\n\n  // otherwise it's not supported\n  return null;\n}\n\nexport function syncOnBecomingVisible(store) {\n  let visProp = getHiddenProp();\n  if (visProp) {\n    const evtname = visProp.replace(/[H|h]idden/, '') + 'visibilitychange';\n    document.addEventListener(evtname, () => debouncedDispatchSync(store));\n  }\n}\n\n// END: Sync on Becoming Visible\n","import React, { PureComponent } from 'react';\nimport { Provider } from 'react-redux';\nimport Store from './store';\nimport {\n  readInitialState,\n  loadSettingsFromConfigFile,\n  subscribeToChanges,\n  persistField,\n  getPersistedField,\n} from './util/settings_persister';\n\nimport runAllMigrations from './migrations';\nimport parseQueryString from './util/parse_query_string';\nimport { BrowserRouter as Router } from 'react-router-dom';\n\nimport { DragDropContext } from 'react-beautiful-dnd';\n\nimport { reorderCaptureTemplate } from './actions/capture';\nimport { reorderTags, reorderPropertyList, reorderFileSetting } from './actions/org';\nimport { signOut } from './actions/sync_backend';\nimport { setDisappearingLoadingMessage, restoreStaticFile } from './actions/base';\n\nimport createDropboxSyncBackendClient from './sync_backend_clients/dropbox_sync_backend_client';\nimport createGoogleDriveSyncBackendClient from './sync_backend_clients/google_drive_sync_backend_client';\nimport createWebDAVSyncBackendClient from './sync_backend_clients/webdav_sync_backend_client';\n\nimport './base.css';\n\nimport Entry from './components/Entry';\n\nimport {\n  listenToBrowserButtons,\n  syncOnBecomingVisible,\n  listenToNetworkConnectionEvents,\n} from './lib/initial_setup';\n\nimport _ from 'lodash';\nimport { Map } from 'immutable';\n\nexport default class App extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    runAllMigrations();\n\n    const initialState = readInitialState();\n\n    window.initialHash = window.location.hash.substring(0);\n    const hashContents = parseQueryString(window.location.hash);\n    const authenticatedSyncService = getPersistedField('authenticatedSyncService', true);\n    let client = null;\n\n    if (!!authenticatedSyncService) {\n      switch (authenticatedSyncService) {\n        case 'Dropbox':\n          const dropboxAccessToken = hashContents.access_token;\n          if (dropboxAccessToken) {\n            client = createDropboxSyncBackendClient(dropboxAccessToken);\n            initialState.syncBackend = Map({\n              isAuthenticated: true,\n              client,\n            });\n            persistField('dropboxAccessToken', dropboxAccessToken);\n            window.location.hash = '';\n          } else {\n            const persistedDropboxAccessToken = getPersistedField('dropboxAccessToken', true);\n            if (!!persistedDropboxAccessToken) {\n              client = createDropboxSyncBackendClient(persistedDropboxAccessToken);\n              initialState.syncBackend = Map({\n                isAuthenticated: true,\n                client,\n              });\n            }\n          }\n          break;\n        case 'Google Drive':\n          client = createGoogleDriveSyncBackendClient();\n          initialState.syncBackend = Map({\n            isAuthenticated: true,\n            client,\n          });\n          break;\n        case 'WebDAV':\n          client = createWebDAVSyncBackendClient(\n            getPersistedField('webdavEndpoint'),\n            getPersistedField('webdavUsername'),\n            getPersistedField('webdavPassword')\n          );\n          initialState.syncBackend = Map({\n            isAuthenticated: true,\n            client,\n          });\n          break;\n        default:\n      }\n    }\n\n    const queryStringContents = parseQueryString(window.location.search);\n    const { captureFile, captureTemplateName, captureContent } = queryStringContents;\n    if (!!captureFile && !!captureTemplateName) {\n      const capturePath = captureFile.startsWith('/') ? captureFile : `/${captureFile}`;\n      const customCaptureVariables = Map(\n        Object.entries(queryStringContents)\n          .map(([key, value]) => {\n            const CUSTOM_VARIABLE_PREFIX = 'captureVariable_';\n            if (key.startsWith(CUSTOM_VARIABLE_PREFIX)) {\n              return [key.substring(CUSTOM_VARIABLE_PREFIX.length), value];\n            }\n\n            return null;\n          })\n          .filter((item) => !!item)\n      );\n      initialState.org.present = initialState.org.present.set(\n        'pendingCapture',\n        Map({\n          capturePath,\n          captureTemplateName,\n          captureContent,\n          customCaptureVariables,\n        })\n      );\n    }\n\n    this.store = Store(initialState);\n    this.store.subscribe(subscribeToChanges(this.store));\n\n    if (!!client) {\n      client.isSignedIn().then((isSignedIn) => {\n        if (isSignedIn) {\n          loadSettingsFromConfigFile(this.store.dispatch, this.store.getState);\n        } else {\n          this.store.dispatch(signOut());\n        }\n      });\n    } else {\n      if (!!this.store.getState().org.present.get('pendingCapture')) {\n        this.store.dispatch(\n          setDisappearingLoadingMessage(\n            `You need to sign in before you can use capture templates`,\n            5000\n          )\n        );\n      }\n    }\n\n    // Initially load the sample file.\n    this.store.dispatch(restoreStaticFile('sample'));\n\n    listenToBrowserButtons(this.store);\n    syncOnBecomingVisible(this.store);\n    listenToNetworkConnectionEvents(this.store);\n\n    _.bindAll(this, ['handleDragEnd']);\n  }\n\n  handleDragEnd(result) {\n    if (!result.destination) {\n      return;\n    }\n\n    if (result.type === 'TAG') {\n      this.store.dispatch(reorderTags(result.source.index, result.destination.index));\n    } else if (result.type === 'PROPERTY-LIST') {\n      this.store.dispatch(reorderPropertyList(result.source.index, result.destination.index));\n    } else if (result.type === 'CAPTURE-TEMPLATE') {\n      this.store.dispatch(reorderCaptureTemplate(result.source.index, result.destination.index));\n    } else if (result.type === 'FILE-SETTING') {\n      this.store.dispatch(reorderFileSetting(result.source.index, result.destination.index));\n    }\n  }\n\n  render() {\n    return (\n      <DragDropContext onDragEnd={this.handleDragEnd}>\n        <Router>\n          <Provider store={this.store}>\n            <div className=\"App\">\n              <Entry />\n            </div>\n          </Provider>\n        </Router>\n      </DragDropContext>\n    );\n  }\n}\n","import { fromJS } from 'immutable';\nimport { createClient } from 'webdav';\nimport { isEmpty } from 'lodash';\n\n/**\n * Gets a directory listing ready to be rendered by organice.\n *  - Filters files from `listing` down to org files.\n *  - Sorts folders atop of files.\n *  - Sorts both folders and files alphabetically.\n * @param {Array} listing\n */\nexport const filterAndSortDirectoryListing = (listing) => {\n  return listing\n    .filter((file) => {\n      // Show all folders\n      if (file.type === 'directory') return true;\n      // And only file with the 'org' extension\n      return file.basename.match(/org$|org_archive$/);\n    })\n    .sort((a, b) => {\n      // Folders before files\n      if (a.type === 'directory' && b.type !== 'directory') {\n        return -1;\n      } else {\n        return a.basename > b.basename ? 1 : -1;\n      }\n    });\n};\n\nexport default (url, login, password) => {\n  const webdavClient = createClient(url, { username: login, password: password });\n  const isSignedIn = () =>\n    new Promise((resolve) => {\n      // There's no direct API to know if the login worked. So, let's\n      // check if the root folder contents can be accessed.\n      getDirectoryListing('/')\n        .then(() => {\n          resolve(true);\n        })\n        .catch((error) => {\n          console.error(\"Login didn't work, error: \", JSON.stringify(error));\n          resolve(false);\n        });\n    });\n\n  const transformDirectoryListing = (listing) => {\n    const sortedListing = filterAndSortDirectoryListing(listing);\n    return fromJS(\n      sortedListing.map((entry) => ({\n        id: entry.filename,\n        name: entry.basename,\n        isDirectory: entry.type === 'directory',\n        path: entry.filename,\n      }))\n    );\n  };\n\n  const getDirectoryListing = (path) =>\n    new Promise((resolve, reject) => {\n      webdavClient\n        .getDirectoryContents(path)\n        .then((response) =>\n          resolve({\n            listing: transformDirectoryListing(response),\n          })\n        )\n        .catch(reject);\n    });\n\n  const getMoreDirectoryListing = (_additionalSyncBackendState) => {\n    // TODO\n    return new Promise((resolve, reject) => resolve());\n  };\n\n  const uploadFile = (path, contents) =>\n    new Promise((resolve, reject) =>\n      webdavClient.putFileContents(path, contents, { overwrite: true }).then(resolve).catch(reject)\n    );\n\n  const updateFile = uploadFile;\n  const createFile = uploadFile;\n\n  const getFileContentsAndMetadata = (path) =>\n    new Promise((resolve, reject) =>\n      webdavClient\n        .stat(path)\n        .then((stat) => {\n          webdavClient\n            .getFileContents(path, { format: 'text' })\n            .then((response) => {\n              resolve({\n                contents: response,\n                lastModifiedAt: new Date(Date.parse(stat.lastmod)).toISOString(),\n              });\n            })\n            .catch((error) => {\n              console.error(path, ': get file failed', error);\n              reject();\n            });\n        })\n        .catch((error) => {\n          if (error && error.response && [401, 403].indexOf(error.response.status) !== -1)\n            alert(login + '@' + url + ': ' + error.response.statusText);\n          console.error(path, ': get stat failed', error);\n          reject();\n        })\n    );\n\n  const getFileContents = (path) => {\n    if (isEmpty(path)) return Promise.reject('No path given');\n    return new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(path)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n  };\n\n  const deleteFile = (path) =>\n    new Promise((resolve, reject) =>\n      webdavClient\n        .deleteFile(path)\n        .then(resolve)\n        .catch((error) => {\n          if (error && error.response && error.response.status === 404) return;\n          console.error(path, ': delete failed', error);\n          reject();\n        })\n    );\n\n  return {\n    type: 'WebDAV',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}